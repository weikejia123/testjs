/*!
 * 
 * SpreadJS Library 16.1.1
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var e,i,n;function r(n){var t,t,t=i[n];return void 0!==t||(t=i[n]={exports:{}},e[n].call(t.exports,t,t.exports,r)),t.exports}e={"./dist/plugins/hyperlink/hyperlink.js":function(P,n,t){var e,k,c,f,o,i,m,u,t,r,x,s,h,E,p,l,a,b,F,d,w,v,T,$,I,R,V,W,q,B,D,J,K,g,Q,X,y,C,z,_,H,j,Y,G,M,Z,nn,tn,en,rn,on,un,O,n,sn,ln;function S(n,t){return sn.call(this,n,t)||this}function A(n,t){return ln.call(this,n,t)||this}function U(n,t,e,i){return x(i)&&(i=3),!x(n.getHyperlink(t,e,i))}function an(){var n=i(X);return u(n).css(v,T).css($,0).css(W,2).css(q,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(B,K).css(J,Q).css(I,"9pt Arial"),n}function cn(n,t,e){var i,r,o,i,r,o,e;e&&(r=(i=n&&n.qc()).getElementsByClassName(y)[0],o=!1,x(r)&&((r=an()).className=y,i.insertBefore(r,l),o=!0),i=u(r),!o&&i.isVisible()||(i.text(e),o=(r=n.rt.it()).left+t.x,e=r.top+t.y+20,i.css(V,e).css(R,o),i.show()))}function L(n){var t,n,t,n=(n&&n.qc()).getElementsByClassName(y)[0];x(n)||u(n).hide()}function fn(n,t){x(t)||(t.drawUnderline&&(x(n.textDecoration)?n.textDecoration=1:0!==n.textDecoration&&1!=(1&n.textDecoration)&&(n.textDecoration+=1)),t.isVisited?t.visitedLinkColor===l?n.foreColor="rgba(0,0,0,0)":t.visitedLinkColor===p?n.foreColor=z:n.foreColor=t.visitedLinkColor:x(t.linkColor)?t.linkColor===p&&n.foreColor||(n.foreColor=C):n.foreColor=t.linkColor)}function N(n){if(n&&n.cellType){var n=n.cellType.typeName;if(!un[n])return 1}}function hn(n,t,e,i,r,o,u){var s,l,a,n,u,s=0,l=0,a=n.width,n=n.height,u=pn(u);return u&&(a-=u),s=o=o||0,1===i?s=(a-t)/2:2===i&&(s=a-t-o),1===r?l=(n-e)/2:2===r&&(l=n-e),u&&(s+=u),{x:s,y:l}}function pn(n){var t={context:n,value:0};return r.et(n.sheet,"getOutlineColumnOffset",t),t.value}function dn(n,t){var e,i,r,e=o(t),i,r;return{x:0,y:0,width:a(0,k.q.Wt(n,t,!0)),height:n.split(/\r\n|\r|\n/).length*e}}function wn(n,t,e,i,r,o,u){var n,i,n=dn(n,i),i=hn(r,n.width,n.height,t,e,o,u);return n.x=i.x,n.y=i.y,n}function vn(n,t,e,i,r,o){var u,s,l,a,c,f,h,p,u,d,w,v,g,y,C,u=r.sheet,s=u.Dn;if(!x(e)){if(e.textOrientation)return!0;if(l=u.getValue(r.row,r.col,r.sheetArea),o=o||u.getText(r.row,r.col,r.sheetArea))for(o=o.replace(/\s+/g," "),a=e&&e.font?e.font:s.Nn(),a=s._n(a),c=[o],f=gn(e),e.wordWrap&&(o=(c=k.q.un(o,i.width-3-f,a)).join("\r\n")),h=e.hAlign,p=e.vAlign,u=wn(o,h=3===h?m(h,l,e.formatter||e._autoFormatter):h,p,a,i,f,r),d=i.y+u.y,w=0;w<c.length;w++)if(v=wn(c[w],h,p,a,i,f,r),g=i.x+v.x,y=b(g+v.width,i.x+i.width),d=b((C=d)+v.height,i.y+i.height),g<=n&&n<y&&C<=t&&t<d)return!0}return!1}function gn(n){return 8*(n.textIndent||0)}e=this&&this.__extends||(O=function(n,t){return(O=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}O(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HyperlinkTargetType=void 0,k=t("Core"),c=t("Common"),f=t("SheetsCalc"),o=k.mt.vt,i=k.mt.En,m=k.mt.gt,u=k.GC$,t=k.Commands.ActionBase,r=k.CellTypes.Base,x=c.Common.lt.ht,s=c.Common.lt.tv,h=c.Common.zf.TY,E=c.Common.ft,p=void 0,l=null,a=Math.max,b=Math.min,F=Math.floor,d=window.open,w=c.Common.zf.fJ,v="position",T="absolute",$="margin",I="font",R="left",V="top",W="padding",q="border",B="box-sizing",D="pointer",J="background-color",K="content-box",g="default",Q="white",X="div",y="gc-spread-hyperlink-tooltip",z="followedHyperlink",_=C="hyperlink",H="openUrl",j="generateHyperlink",Y=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,G=/^(mailto:\/\/)?([a-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([a-z0-9\-])+\.([a-z0-9\-]){2,63}(\?subject=.+)?$/gi,M=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|www\.[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9]+\.[^\s]{2,}|www\.[a-z0-9]+\.[^\s]{2,})/gi,(n=Z=n.HyperlinkTargetType||(n.HyperlinkTargetType={}))[n.blank=0]="blank",n[n.self=1]="self",n[n.parent=2]="parent",n[n.top=3]="top",k.GC$.extend(k.Y8.prototype,{getHyperlink:function(n,t,e){var i,e;return x(e)&&(e=3),(e=(i=this).W_(e).J_(n,t))&&!x(e.hyperlink)?e.hyperlink:l},setHyperlink:function(n,t,e,i){var r,o,u,s,s,l,o,a,r=this;if(x(i)&&(i=3),(o=e&&e.url)&&o.match(M)&&0<o.match(M).length?w(o,u="www.")&&(e.url="http://"+o):o&&o.match(G)&&0<o.match(G).length&&(w(o,s="mailto:")||(e.url=s+o)),s=0<r.P8?[["sheetModels",i],p]:p,l=r.W_(i).J_(n,t,!0,s?s[0]:p),x(l))s&&(s.length=0);else{if(o=l.hyperlink,x(e))l.hyperlink=null,delete l.hyperlink;else for(a in l.hyperlink={url:"",linkColor:p,visitedLinkColor:p,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""},l.hyperlink)e[a]!==p&&(l.hyperlink[a]=e[a]);s&&(s[0].push("hyperlink"),s[1]=o,s[2]=l.hyperlink)}s&&0<s.length&&r.G8.push(s)}}),k.GC$.extend(k.Worksheet.prototype,{getHyperlink:function(n,t,e){var i,r;return 0===e?l:(x(e)&&(e=3),r=(i=this).Ut,s(r.getHyperlink(n,t,e)))},setHyperlink:function(n,t,e,i){var r,o,u,s;0===i||(x(i)&&(i=3),u=(o=(r=this).Ut).getRowCount(i),s=o.getColumnCount(i),n<0)||u<=n||t<0||s<=t||(o.do("setHyperlink",n,t,e,i),this.zw())}}),e(S,sn=t),S.prototype.execute=function(){var n,t,e,i,r,o,n,u,u,u,s,u,s,l,l,l,l,a,r,n=this,t=n.Mf,e=!1,i=t.parent,r=t,o=n.tT.url;if(!x(o))if(n=n.tT.target||0,0===o.indexOf(u="sjs://")||"#"===o[0]){if(u=u.length,u="#"===o[0]?o.substr(1):o.substr(u),(s=(s=(0,f.formulaToRanges)(t,u,0,0,!(s=void 0)))&&0===s.length?(0,f.formulaToRanges)(t,u,0,0,!1,!0):s)&&0<s.length){if(u=s[0].sheetName,s=s[0].ranges[0],u!==t.name()&&i.getSheetFromName(u).visible()===k.SheetTabVisible.visible){if(l=i.getSheetFromName(u),i.ki(k.Events.ActiveSheetChanging,l={oldSheet:r,newSheet:l,cancel:!1}),l.cancel)return;i.setActiveSheet(u),l=i.getActiveSheetIndex(),i.w2.Tg(l),r!==(t=i.getActiveSheet())&&i.ki(k.Events.ActiveSheetChanged,{oldSheet:r,newSheet:t})}i.getSheetFromName(u).visible()===k.SheetTabVisible.visible&&(t.OA(s.row+s.rowCount,s.col+s.colCount),t.setSelection(s.row,s.col,s.rowCount,s.colCount))}}else x(o)||(l="mailto:",o.match(M)&&0<o.match(M).length?w(o,a="www.")&&(o="http://"+o):o.match(G)&&0<o.match(G).length&&(w(o,l)||(o=l+o)),w(o,l)&&1<c.Common.zf.DU(o,"?")&&(o=(r=o.split("?"))[0]+"?"+r.slice(1).join("%3F")),d(h(o),["_blank","_self","_parent","_top"][n]));return!1},nn=S,k.Commands[H]={canUndo:!1,execute:function(n,t,e){return k.Commands.zA(n,nn,t,e)}},e(A,ln=t),A.prototype.execute=function(){var n,t,e,i,r,o,e,u,s,s,n=this,t=n.Mf,e=n.tT,i=e.url,r=e.row,o=e.col,e=e.sheetArea;if(null===i)u=null;else{if("string"!=typeof i)return!1;if(!((s=(!(s=i.match(M))||s.length<1)&&(!(s=i.match(G))||s.length<1)?i.match(Y):s)&&0<s.length&&0===i.indexOf(s[0])&&i.length===s[0].length))return!1;u={url:i,linkColor:C,visitedLinkColor:z}}return t.Ut.startTransaction(),t.suspendPaint(),t.suspendEvent(),t.setHyperlink(r,o,u,e),t.resumeEvent(),t.resumePaint(),s=k.Commands.TI(t.name()),n.tT[s]=t.Ut.endTransaction(),!0},A.prototype.undo=function(){var n,t,e,n,t=this.Mf;return t.suspendPaint(),t.suspendEvent(),e=k.Commands.TI(t.name()),t.Ut.undo(this.tT[e]),t.resumeEvent(),t.resumePaint(),!0},tn=A,k.Commands[j]={canUndo:!0,execute:function(n,t,e){return k.Commands.zA(n,tn,t,e)}},k.Workbook.ch(_,en={init:function(){this.commandManager().register(H,k.Commands[H]),this.commandManager().register(j,k.Commands[j])}}),k.Worksheet.ch(_,rn={setHyperlinkWhenEditing:function(n){var t,e,i,n,r,o,t=n.url,e=n.row,i=n.col,n=n.sheetArea,r=this,o=r.getParent();o.options.allowAutoCreateHyperlink&&o.commandManager().execute({cmd:j,sheetName:r.name(),url:t,row:e,col:i,sheetArea:n})}}),r.ch(_,on={applyHyperlinkStyle:function(n){var t,e,i,r,t,t=n.sheet,e=n.row,i=n.col,r=n.style,t=t.getHyperlink(e,i,n.sheetArea);N(r)||fn(r,t)},getCellTextHitInfo:function(n){var t,e,i,r,o,u,s,l,a,c,f,c,t=n.context.sheetArea,e=n.cellStyle,i=n.context,r=i.sheet,o=i.row,u=i.col;U(r,o,u,t)&&!N(e)&&((s=n.cellRect)&&(l=r.C0(o),a=r.S0(u),c=r.Fi(),f=void 0,r.getSpan(o,u,t)||!x(t)&&3!==t?2===t?f=c.B1(l):1===t&&(f=c.L1(a)):f=c.c9(l,a),f)&&(s=s.getIntersectRect(f)),!x(t)||3===t)&&e&&s&&(c=r.getText(o,u,t),n.paddingHitInfo={row:o,col:u,x:n.x,y:n.y,sheetArea:t,sheet:r,isFocusAware:!0,isReservedLocation:vn(n.x,n.y,e,s,i,c)})},processMouseUpOnCellPadding:function(n){var t,e,i,r,o,e,n,e,n,e,t=n.sheet,e=n.cellStyle,i=n.row,r=n.col,o=n.sheetArea;t&&!t.isEditing()&&U(t,i,r,o)&&!N(e)&&n.isReservedLocation&&(e=t.Dg(),L(t),e&&(e.style.cursor=g),(n=t.Ut.getHyperlink(i,r,o)).isVisited=!0,e=n.command,x(e)||""===e||e===H?t.getParent().commandManager().execute({cmd:H,sheetName:t.name(),url:n.url,target:n.target}):"string"==typeof e?t.getParent().commandManager().execute({cmd:e,row:i,col:r,sheetName:t.name(),sheetArea:o}):"function"==typeof e&&e.call(l,t,i,r,o),n=t.getColumnCount(),e=new k.Range(i,-1,1,n),t.repaint(t.getRangeRect(1,1,e)))},processMouseMoveOnCellPadding:function(n){var t,e,i,r,o,r,t,t=n.row,e=n.col,i=n.sheet,r=n.cellStyle,o=n.sheetArea;!U(i,t,e,o)||N(r)||!i||i.isEditing()&&i.getActiveRowIndex()===t&&i.getActiveColumnIndex()===e||(r=i.Dg(),t=i.getHyperlink(t,e,o),n.isReservedLocation?r&&(cn(i,n,t.tooltip),r.style.cursor=D):(L(i),r&&(r.style.cursor=g)))},processMouseLeaveOnCellPadding:function(n){var t,e,i,n,e,t=n.sheet,e=n.row,i=n.col,n=n.sheetArea;L(t),U(t,e,i,n)&&t&&(e=t.Dg())&&(e.style.cursor=g)},onUpdateContainer:function(n){var t,e,i,n,t=n.cellStyle,e=n.context.row,i=n.context.col,n=n.context.sheet.getHyperlink(e,i);N(t)||fn(t,n)}}),un={0:!0,1:!0,2:!0,3:!0,4:!0}},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},i={},n=r("./dist/plugins/hyperlink/hyperlink.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Hyperlink=n}();