/*!
 * 
 * SpreadJS Library 16.1.1
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var r,i,n;function e(n){var t,t,t=i[n];return void 0!==t||(t=i[n]={exports:{}},r[n].call(t.exports,t,t.exports,e)),t.exports}r={"./dist/plugins/sheetsCalc/calc-extra-save.js":function(n,t,r){var s,o,e,i,a,c,h,l,v,d,w;function u(n){var t,r,i,e;if(Array.from)return Array.from(n.keys());for(t=[],r=0,i=n.keys();r<i.length;r++)e=i[r],t.push(e);return t}function f(u,f,o){for(var n,t,n=function(n){var t,n,e,r,i,t=f[n];if(t.l)for(n=C(t.k),e=u.oT(n[1],n[2],!0),t.v&&u.nbt(e),t.b,e.aT=t.l.map(function(n){return parseInt(n,10)}),r=function(n){var i=t.l[n];e[i]=(0,s.createMap)(),t[i].map(function(n){var t,r,r,t=C(n),r=t[0];"?"!==r[0]&&"!"!==r[0]||(r=r.slice(1)),r=o[r],e[i].set(n,r.oT(t[1],t[2],!0))})},i=0;i<t.l.length;i++)r(i)},t=0;t<f.length;t++)n(t)}function C(n){return n.split(",").map(function(n,t){return n=0<t?parseInt(n,10):n})}function m(n,t,r){var i,e,u,f,o,s,a,c,h,c,i=n.uT(!0);for(e in t.l)if(t.l.hasOwnProperty(e))for(f in u=t[e])if(u.hasOwnProperty(f))for(o=f.split(",").map(function(n,t){return"?"!==n[0]&&"!"!==n[0]||(n=n.slice(1)),parseInt(n,10)}),s=0;s<u[f].length;s++)c=(h=r[c="?"!==(c=(a=C(u[f][s]))[0])[0]&&"!"!==c[0]?c:c.slice(1)]).oT(a[1],a[2],!0),i.processListener(parseInt(e,10),o[0],o[1],o[2],o[3],c,!0)}function _(n){var t,r,t=null;return(n.isVolatile||n.ebt||n.aT&&0<n.aT.length)&&((t={}).k=n.getKey(),n.isVolatile&&(t.v=!0),n.ebt&&(t.b=!0),n.aT)&&n[0]&&(r="0",t[0]=u(n[0]),t.l=n.aT),t}function p(n){var t,r,i,e,u,f,i,n,t=[],r=n.dataTable;for(u in r)if(r.hasOwnProperty(u)&&(f=r[u]))for(e in f)f.hasOwnProperty(e)&&(i=f[e])&&(i=_(i.calc))&&t.push(i);return(n=g(n))&&t.push(n),t}function g(n){var n,t,r,i,e,n=n.uT();if(n)return t={k:"rangeCalc"},r="0",i=n[0],e={},i&&i.forEach(function(n,t){e[t]=u(n.content)}),t[0]=e,t.l=n.aT,t}function b(n,t){var r,i,e,u,f,o,r={};if(t&&t.idMap){for(u in e={},i=n.rO)i.hasOwnProperty(u)&&(e[i[u].getSource().getName()]=i[u]);for(u in f=t.idMap)f.hasOwnProperty(u)&&(o=f[u],r[u]=e[o])}return r}function A(n){var t,r,i,t=n.rO,r={};for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i].getSource().getName());return r}function R(n,t){return j(n,t)}function j(n,t){var r,i,e,u,f,r,r,i=n.t;if(4===i||2===i||3===i||8===i||100===i)(e=new s.Expression(i)).value=n.v;else{if(5===i)(e=new s.Expression(5)).value=s.CalcError.ibt(n.v);else if(6===i)(e=new s.Expression(6)).value=new s.CalcArray(n.v);else if(9===i)e=(0,s.rbt)(n.o,j(n.v,t),n.w&&j(n.w,t));else if(10===i)(e=new s.Expression(10)).value=j(n.v,t);else if(11===i)e=new s.Expression(11);else if(7===i)for(e=new s.Expression(7),n.f&&(e.function=j(n,t)),n.n&&(e.function=t.getFunction(n.n),e.functionName=n.n),u=e.arguments=[],f=0;f<n.p.length;f++)n.p[f]&&(u[f]=j(n.p[f],t));else 1===i?(e=new s.ReferenceExpression(1),(r=n.v.split("*"))[0]&&(e.source=t.getExternalSource("",r[0])),r[1]&&(e.endSource=t.getExternalSource("",r[1])),r[2]&&(e.row=parseInt(r[2],10)),r[3]&&(e.column=parseInt(r[3],10)),r[4]&&(e.endRow=parseInt(r[4],10)),r[5]&&(e.endColumn=parseInt(r[5],10)),r=parseInt(r[6],10),e.rowRelative=!!(r&a),e.columnRelative=!!(r&c),e.endRowRelative=!!(r&h),e.endColumnRelative=!!(r&l),e.isFullRow=!!(r&v),e.isFullColumn=!!(r&d),e.isArrayReference=!!(r&w),e.isFullRow&&(e.column=e.endColumn=s.BAND_INDEX_CONST),e.isFullColumn&&(e.row=e.endRow=s.BAND_INDEX_CONST)):13===i?(e=new o.obt,r=n.v,e.abt=r[0],e.source=r[1],e.ubt=r[2],e.sbt=r[3],e.cbt=r[4],e.fbt=r[5],e.lbt=r[6],e.hbt=r[7],e.source=t.getExternalSource("",e.source),e.abt=t.getTableByName(e.abt)):e.type;n.es&&(e.ensureSingle=!0)}return e}function F(n){return x(n)}function x(n){var t,r,i,i;if(!n)return n;if(t={t:n.type},n.ensureSingle&&(t.es=1),4===n.type||2===n.type||3===n.type||8===n.type||100===n.type)t.v=n.value;else if(5===n.type)t.v=n.value._code;else if(6===n.type)t.v=n.value.array;else if(9===n.type)t.o=n.operatorType,t.v=x(n.value),t.w=n.value2&&x(n.value2);else if(10===n.type)t.v=x(n.value);else if(7===n.type)for((0,s.isExpression)(n.function)?t.f=x(n.function):n.functionName&&(t.n=n.functionName),t.p=[],r=0;r<n.arguments.length;r++)t.p[r]=x(n.arguments[r]);else 1===n.type?(i=(n.rowRelative&&a)|(n.columnRelative&&c)|(n.endRowRelative&&h)|(n.endColumnRelative&&l)|(n.isFullRow&&v)|(n.isFullColumn&&d)|(n.isArrayReference&&w),i=[n.source&&n.source.getName(),n.endSource&&n.endSource.getName(),n.row,n.column,n.endRow,n.endColumn,i],n.isFullRow&&(i[3]=i[5]=e),n.isFullColumn&&(i[2]=i[4]=e),t.v=i.join("*")):13===n.type?t.v=[n.abt.name(),n.source.getName(),n.ubt,n.sbt,n.cbt,n.fbt,n.lbt,n.hbt]:n.type;return t}Object.defineProperty(t,"__esModule",{value:!0}),t.exprToJSON=t.exprFromJSON=t.dbt=t.vbt=t.mbt=t.gbt=t.pbt=void 0,s=r("CalcEngine"),o=r("./dist/plugins/sheetsCalc/parser-sheets.js"),e=null,i=void 0,a=1,c=2,h=4,l=8,v=16,d=32,w=64,t.pbt=f,t.gbt=m,t.mbt=p,t.vbt=b,t.dbt=A,t.exprFromJSON=R,t.exprToJSON=F},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(F,n,t){var r,M,i,p,_,T,C,Z,S,s,g,L,J,$,G,P,W,b,V,X,H,Y,z,x,A,y,E,N,k,t,t,e,D,o,a,c,I,O,B,u,e,K,f,h,l,Q;function q(n){var t="_xlfn.";return n&&"string"==typeof n&&0<=n.toLowerCase().indexOf(t)?n.replace(/_xlfn\.|_xlws\./gi,""):n}function nn(n){if(n)return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function v(n,t,r,i,e){var u=this;u.Zc=n,u.FY=r,u.jpt=i,u.WK=t,V(e)||(u.TZ=e)}function d(n,t,r,i,e,u,f){var n,i,n=K.call(this,n,i,e,u,f)||this,i=n;return i.bbt=t,i.ybt=r,n}function tn(n){var t=f.call(this,J)||this;return t.references=n,t}function rn(n){var t,r,i,e,u,f;if(!(n<0||(t=a[n]))){for(r=n,e=(i="").length,n+=1;0<n;n=Math.floor((n-1)/26))u=i.substring(0,e),f=i.substring(e),i=u+String.fromCharCode(65+(n-1)%26)+f;t=i.toString(),a[r]=t}}function w(n,t,r,i){var e,t,u,f;for(void 0===i&&(i={}),e=h.call(this,n&&n.Uw(i.sheetArea),t,r,i)||this,n||(n=w.wbt=w.wbt||new M.Worksheet,e.source)||(e.source=n.Uw(i.sheetArea)),e.Mf=n,e.row=r&&r.row||0,e.column=r&&r.col||0,u=(t=n.getCalcService()).getResolvers(),f=0;f<u.length;f++)if(u[f]instanceof _.SheetReferenceResolver)return e;return t.addResolver(new _.SheetReferenceResolver(n)),t.addResolver(new _.StructureReferenceResolver(n)),e}function en(n){n.indexOf("LET(")}function m(n,t){var r=l.call(this,J)||this;return r.getCalcSourceModel=function(){return this.Mbt},r.createSourceModel=function(n){return new T.CalcSourceModel(n,this)},r.getRangeKey=function(n,t){return n.id+","+t.row+","+t.col+","+t.rowCount+","+t.colCount},r.getSheetRangeReference=function(n){var t,t,r,i,e,u,f,t=this.Mf,t=t&&t.parent;if(n.endSource&&t&&t.sheets&&n.endSource instanceof m){for(r=t.sheets,i=!1,e=void 0,u=[],f=0;f<r.length;f++){if((e=r[f].Uw())===this)i=!0;else if(e===n.endSource){u.push(e.getReference(n));break}i&&u.push(e.getReference(n))}return new o(u)}},r.Mf=n,r.nT=t||3,r}function R(n){var t=Q.call(this,J)||this;return t.createSourceModel=function(n){return new T.CalcSourceModel(n,this)},t.vpt=n,t.Cbt={},t}function un(n,t,r,i,e,u){var n,f,n,n=n&&n instanceof M.Worksheet&&n,f=new T.Parser;return r=r===$?0:r,i=i===$?0:i,n=new c(n,!!e,(0,T.eV)(r,i)),u&&(n.culture=!0),f.parse(n,t)}function U(n,t,r,i,e,u){var n,f,n,n=n&&n instanceof M.Worksheet&&n,f=new T.Parser;return r=r===$?0:r,i=i===$?0:i,(n=new c(n,!!e,(0,T.eV)(r,i))).Sbt=u,f.unparse(n,t)}function fn(n,t,r,i,e){var u;return on(n,un(n,t,r=r===$?0:r,i=i===$?0:i,e,!0),r,i)}function on(n,t,r,i,e){var u,f,e,u=n.op();return r===$&&(r=n.getActiveRowIndex()),i===$&&(i=n.getActiveColumnIndex()),f=!0,e&&e.convertNullToZero!==$&&(f=e.convertNullToZero),e=n.Uw(),u.BI(e,t,(0,T.eV)(r,i),!1,f)}function sn(n,t,r,i,e){var u,f,e,n,u=n.op();return r===$&&(r=n.getActiveRowIndex()),i===$&&(i=n.getActiveColumnIndex()),f=!0,e&&e.convertNullToZero!==$&&(f=e.convertNullToZero),e=n.Uw(),(n=(0,T.eV)(r,i)).Tbt=Math.random().toString(36).substring(2),u.Abt(e,t,n,f)}function j(n,t,r,i,e){var u,f,o,s,a,c,h,l,v,d,w,u=n.row,f=n.col,o=n.row+n.rowCount-1,s=n.col+n.colCount-1,a=!1,c=!1,h=!1,l=!1;return 4<=arguments.length&&(u-=(a=0!=(1&i))?t:0,o-=(c=0!=(4&i))?t:0,f-=(h=0!=(2&i))?r:0,s-=(l=0!=(8&i))?r:0),e&&(d=cn(n,e,t),w=hn(n,e,t),d)&&w?_.StructureReferenceResolver.create(e,d,w,n.col-e.dataRange().col,n.col+n.colCount-e.dataRange().col-1):1===n.rowCount&&1===n.colCount?(0,T.knt)(J,J,u,f,a,h):(n.row<0&&(u=o=C.BAND_INDEX_CONST),n.col<0&&(f=s=C.BAND_INDEX_CONST),(0,T.lJ)(J,J,u,f,o,s,a,h,c,l,t,r))}function an(n){return 0<=n.indexOf("[")&&1<n.indexOf("]")}function cn(n,t,r){if(1===n.rowCount){if(t.hasHeadersRow()&&n.row===t.startRow())return 2;if(t.hasTotalsRow()&&n.row===t.endRow())return 8;if(r===n.row)return 1}else{if(t.hasHeadersRow()&&n.row===t.startRow()){if(n.rowCount===t.dataRange().rowCount+1)return 6;if(t.hasTotalsRow()&&n.rowCount===t.dataRange().rowCount+1+1)return 14}if(n.row===t.dataRange().row){if(n.rowCount===t.dataRange().rowCount)return 3;if(t.hasTotalsRow()&&n.rowCount===t.dataRange().rowCount+1)return 12}}return $}function hn(n,t,r){return n.col===t.startColumn()&&n.colCount===t.dataRange().colCount?1:1===n.colCount?2:n.col>=t.startColumn()&&n.col+n.colCount-1<=t.endColumn()?4:$}function ln(n,t,r,i,e){var n,i,u,e,n=j(n,t,r,i),i=new c(J,!!e,(0,T.eV)(t,r)),u,e=(new T.Parser).unparse(i,n);return i.L0(),e}function vn(n,t,r,i,e,u,f){var t,e,o,t=j(t,r,i,e,f),e=new c(n,!!u,(0,T.eV)(r,i)),o;return(new T.Parser).unparse(e,t)}function dn(n,t,r,i){var e,t,u,f,o,s,a,c,h,o,s;if(!t)return null;if(r=r||0,i=i||0,f=!1,(t=(e=n.op()).parse(n.Uw(),t,r,i,!0,!0))&&(7===t.type&&"ANCHORARRAY"===t.functionName&&(t=t.arguments[0],f=!0),!(u=t.source)||13!==t.type)&&1===t.type&&t.endSource){for(o=t.source,s=t.endSource,a=o.getSources(s),c=!1,h=0;h<a.length;h++)if(a[h]===n.Uw()){c=!0;break}t=c&&t}return t&&t.getRange&&(!u||u===n.Uw())&&(o=t.getRange(r,i))?(f&&(s=new T.CalcReference(n.qgt,[o]).getSpillRef())&&s.$gt&&(o=s.$gt[0]),new M.Range(o.row,o.col,o.rowCount,o.colCount)):null}function wn(n,t,r,i,e,u){var f,o,s,a,c,h,l,v,d,w,C,m,f=[],o=[];if(t)for(s={},r=r||0,i=i||0,a=new T.Parser,c=_.Vgt(a,t,n,r,i,$,e,u),h=0;h<c.length;h++)if((l=c[h].sheetRanges)&&!L(l))for(v=0;v<l.sheets.length;v++)for((o=s[d=l.sheets[v]])||(s[d]=o=[],f.push({sheetName:d,ranges:o})),w=l[d],C=0;C<w.length;C++)m=w[C],V(m)||o.push(new M.Range(m.row,m.col,m.rowCount,m.colCount));return f}function Cn(n,t,r,i,e){var u,e,u,u=new T.Parser,e=new c(J,!!e,(0,T.eV)(t,r)),u=mn(u,e,n,t,r,i);return e.L0(),u}function mn(n,t,r,i,e,u,f){for(var o,s,a,a,c,o="",s=0;s<r.length;s++)a=j(r[s],i,e,u),a=n.unparse(t,a),o+=0<s?(c=f&&p.Common.CultureManager.Fe().NumberFormat.listSeparator||",")+" "+a:a;return o}function _n(n,t,r,i,e,u,f){var o,s,a,c,h,l,v,d,w,C,m,_,o=i.getValue(t,r),v=!1,d=100,w=.001,C=.01,a=(A(o)?+o:0)-f,s=i.getValue(e,u),h=(A(s)?+s:0)-f;if(A(s)&&Math.abs(h)<w)v=!0;else if(b(s))v=!1;else for(c=a+(0===a?C:C*a),m=0;!v&&m<d;m++)c=p.Common.st.E8(c,13),n.setValue(t,r,c),s=i.getValue(e,u),l=(A(s)?+s:0)-f,A(s)&&Math.abs(l)<w?v=!0:c=b(s)?(a+c)/2:a-c==0?a+(0===a?C:C*a):h-l==0?a+2*(c-a):(_=c-l*(a-c)/(h-l),a=c,h=l,_);return v||n.setValue(t,r,o),v}r=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}u(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Object.defineProperty(n,"__esModule",{value:!0}),n.goalSeek=n.RangeReferenceRelative=n.Ibt=n.rangesToFormula=n.formulaToRanges=n.formulaToRange=n.rangeToFormulaWithStructReference=n.rangeToFormula=n.isValidExternalReference=n.rangeToExpression=n.xbt=n.evaluateExpression=n.evaluateFormula=n.expressionToFormula=n.formulaToExpression=n.SpreadSource=n.SheetSource=n.SheetParserContext=n.SheetRangeReference=n.FormatterNameInfo=n.NameInfo=n.ReferenceStyle=n.encodeNameFormula=n.processFunctionPrefix=void 0,M=t("Core"),i=t("Core"),p=t("Common"),_=t("./dist/plugins/sheetsCalc/parser-sheets.js"),T=t("CalcEngine"),C=t("./dist/plugins/sheetsCalc/calc.ns.js"),Z=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),S=p.Common.lt,s=p.Common.zf,g=S.Dh,L=S._h,J=null,$=void 0,G=["v","n","s","b","d","sn"],P=T.Errors.Value,W=p.Formatter&&p.Formatter.GeneralFormatter,b=T.Convert.BJ,V=S.ht,X=M.mt.xr,H=M.range_parser.jc,Y=M.mt.vo,z=M.Util.addXLFNPrefix,x="=",A=function(n){return T.Convert.q8(n,!0)},y=M.Range.prototype.contains,E=s.Gmt,N="number",k=M.UsedRangeUtil.updateUsedRangeByData,n.processFunctionPrefix=q,n.encodeNameFormula=nn,(t=T.CalcSource.prototype).referenceToArray=function(n,t,r,i,e,u,f,o){var s,a,c,h,l,v,d,w,C,m,_,p,g,b,A,R,j,s=this,h=1,l=1,C=[],w=n.getRangeCount();if(0===w)C.isError=!0;else{for(p=s.getRowCount(),g=s.getColumnCount(),r=r===$||r,b=0;b<w;b++){if(r||C.push(_=[]),0===(h=n.getRowCount(b)))return C.isError=!0,C;if(0===(l=n.getColumnCount(b)))return C.isError=!0,C;if(v=n.getRow(b),d=n.getColumn(b),2!==r){if(p<=v||g<=d)return(C=[J]).rowCount=1,C.colCount=1,C.rangeCount=1,C;g<d+l&&(l=g-d)}for(p<v+h&&(h=p-v),A=void 0,R=0;R<h;R++)for(a=v+R,r||_.push(A=[]),j=0;j<l;j++){if(m=s.getValue(a,c=d+j),i&&T.Convert.BJ(m))return(C=[m]).isError=!0,C;if(m=T.Convert.Nbt(m,t,!T.ExcelCompatibleCalcMode,u,o),e&&m===T.Convert.CalcConvertedError)return(C=[P]).isConvertError=!0,C;m===J&&u||(2===r?C[R*l+j]=m:(r?C:A).push(m))}}(C=r||1!==w?C:C[0]).rowCount=h,C.colCount=l,C.rangeCount=w}return C},t.getSheetReference=function(){var n=this;return n.kbt=n.kbt||new T.CalcReference(n),n.kbt},(e=t=n.ReferenceStyle||(n.ReferenceStyle={}))[e.a1=0]="a1",e[e.r1c1=1]="r1c1",i.ReferenceStyle=t,v.prototype.getName=function(){return this.Zc},v.prototype.getRow=function(){return this.FY},v.prototype.getColumn=function(){return this.jpt},v.prototype.getExpression=function(){return this.WK},v.prototype.getComment=function(){return this.TZ},v.prototype.SB=function(n,t){t&&t.push({type:"customName",nameInfo:this,expr:this.WK}),this.WK=n},n.NameInfo=e=v,i.NameInfo=e,r(d,K=e),d.prototype.getFormatter=function(){return this.bbt},d.prototype.getSheetTabName=function(){return this.ybt},n.FormatterNameInfo=d,T.CalcSource.prototype.createSourceModel=function(n){return new T.CalcSourceModel(n,this)},f=T.CalcReference,r(tn,f),tn.prototype.toArray=function(n,t,r,i,e){for(var u,f,o,s,u=this.references,f=[],o=0;o<u.length;o++){if((s=u[o].rT.referenceToArray(u[o],n,t,r,i,e)).isError&&r)return s;t?Array.prototype.push.apply(f,s):f.push(s),o||(f.rowCount=s.rowCount,f.colCount=s.colCount)}return f.rangeCount=u.length,f},o=tn,n.SheetRangeReference=o,a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],h=T.ParserContext,r(w,h),w.prototype.getExternalSource=function(n,t){var r,i,e,u,f,o,r=this,i=r.Mf.parent,e=r.Mf.Uw();if(n&&(!i||i.name!==n))return J;if(!i)return s.Dbt(r.Mf.name(),t)?e:J;if(an(t))return i._p.parseSource(t,e.G3);if((u=i.sheets)&&0<u.length)for(f=0;f<u.length;f++)if(o=u[f],s.Dbt(o.name(),t))return o.Uw();return T.ParserContext.prototype.getExternalSource.call(this,n,t)},w.prototype.getExternalSourceToken=function(n){return n.getName(this)},w.prototype.getTableByName=function(n){var t,r,i,e,u,t=this.Mf.tables,r=!0,i=t?t._bt(n,!0):J;if(!i&&(e=this.Mf.parent&&this.Mf.parent.sheets))for(u=0;u<e.length&&(!(t=e[u].tables)||!(i=t._bt(n,!0)));u++);return i||this.Mf.parent&&this.Mf.parent.Efe(n)},w.prototype.getTableByIndex=function(n,t){var r=this.Mf.tables;return r?r.Hq(n,t,!0):J},w.prototype.setSource=function(n){var n=this.source=n;n&&n.getSheet&&(this.Mf=n.getSheet())},w.prototype.L0=function(){this.Mf&&this.Mf!==w.wbt&&this.Mf.L0(),this.Mf=J},c=w,n.SheetParserContext=c,I=new p.Common.ResourceManager(M.SR),l=T.CalcSource,r(m,l),m.prototype.getReferenceSheetNames=function(){return this.Ebt||{}},m.prototype.addReferenceSheetName=function(n){var t=this;t.Ebt||(t.Ebt={}),t.Ebt[n]=1},m.prototype.setReferenceSheetNames=function(n){this.Ebt=n},m.prototype.startCalculation=function(){this.jbt||(this.Obt(),this.K5=[])},m.prototype.endCalculation=function(n){this.jbt=J,this.Rbt=J,!1!==n&&this.Bbt(),this.K5=J;var n=this.Mbt.uT(!1);n&&n.clearListenersCache()},m.prototype._F=function(){var n=this;n.Fbt?n.K5&&(n.Pbt=n.Pbt.concat(n.K5),n.K5=[]):(n.Pbt=n.K5||[],n.Fbt=setTimeout(function(){n.Bbt(n.Pbt),delete n.Pbt,delete n.Fbt},0))},m.prototype.Bbt=function(n){var n,t,r,n=n||this.K5;n&&0<n.length&&(r=(t=this.Mf).Ut.W_(3).B8,t.ki(M.Events.RangeChanged,{isUndo:!V(r&&r.vE),sheet:t,sheetName:t.name(),row:0,col:0,rowCount:t.getRowCount(),colCount:t.getColumnCount(),changedCells:n,action:6},t.QI))},m.prototype.clearValueCache=function(){this.Obt()},m.prototype.Obt=function(){var n=this.getRowCount(),t=this.getColumnCount();this.jbt={rowCount:n,colCount:t},this.Rbt={arrayInfo:[]}},m.prototype.Gw=function(){this.jbt=J,this.Rbt=J,this.K5=J},m.prototype.getValue=function(n,t){for(var r,i,e,u,f,o,n,s,a,c,h,l,v,d,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(u=(e=this).Mf,typeof n==N)f=n,o=arguments[1],t=arguments[2];else if(n.row!==$)f=n.row,o=n.col;else if(n.name)return null;return n=e.nT,f<0||o<0?P:u.Gbt&&u.Ubt===f&&u.Hbt===o?u.zbt:(s=e.jbt,a=G[t=t||0],s?(c=s.rowCount,h=s.colCount,d=v=l=void 0,c<=f||h<=o?J:((d=(v=(v=(l=(l=s[f])||(s[f]={}))[o])||(l[o]={v:u.getValue(f,o,n)}))[a])===$&&(d=T.Convert.Nbt(v.v,t,!T.ExcelCompatibleCalcMode),v[a]=d),M.mt.V0(d))):f>=e.getRowCount()||o>=e.getColumnCount()?J:e.Mf.getValue(f,o,n))},m.prototype.getIdentity=function(n,t){var r,i,e,u,t,r=this,i=t.row,e=t.rowCount||1,u=t.column,t=t.columnCount||1;return-1===i&&(i=0,e=r.getRowCount()),-1===u&&(u=0,t=r.getColumnCount()),r.getName()+"."+i+"."+e+"."+u+"."+t},m.prototype.getReference=function(n){var t=this,r=n.row,i=n.col;return-1===r&&(n.row=0,n.rowCount=t.getRowCount(),n.rowUndefine=!0),-1===i&&(n.col=0,n.colCount=t.getColumnCount(),n.colUndefine=!0),new T.CalcReference(t,[n])},m.prototype.getSources=function(n){var t,r,i,e,u;if(this.Mf&&this.Mf.parent&&this.Mf.parent.sheets&&n instanceof m){for(t=this.Mf.parent.sheets,r=!1,i=void 0,e=[],u=0;u<t.length;u++){if((i=t[u].Uw())===this&&(r=!0),i===n){e.push(i);break}r&&e.push(i)}return e}},m.prototype.Vbt=function(i,e){var n,u,f,o,n,u=this.Rbt,f=u&&u.arrayInfo;f&&(o=!1,f.forEach(function(n,t){var r,n;n&&(r=n.reference,n=n.key,y.call(r.$gt[0],i,e))&&(delete u[n],f[t]=$,o=!0)}),o)&&(u.arrayInfo=[],f.forEach(function(n){n&&u.arrayInfo.push(n)}))},m.prototype.referenceToArray=function(n,t,r,i,e,u,f,o){var s,a,c,h,l,v,d,w,C,m,_,p,g,b,A,R,j,F,x,y,E,N,k,D,I,O,B,l=h=1,C=[],p=(s=this).Mf,g=s.jbt,b=s.Rbt,j=G[t=t||0];if(0===(w=n.getRangeCount()))C.isError=!0;else{if(b&&(m=b[R=n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+t+"_"+r]))return m;for(F=this.getRowCount(),x=this.getColumnCount(),r=r===$||r,y=0;y<w;y++){if(r||C.push(_=[]),0===(h=n.getRowCount(y)))return C.isError=!0,C;if(0===(l=n.getColumnCount(y)))return C.isError=!0,C;if(v=n.getRow(y),d=n.getColumn(y),2!==r){if(F<=v||x<=d)return(C=r?[J]:[[J]]).rowCount=1,C.colCount=1,C.rangeCount=1,C;x<d+l&&(l=x-d)}for(F<v+h&&(h=F-v),N=E=void 0,k=p.Gbt,D=0;D<h;D++)for(a=v+D,r||_.push(E=[]),g&&(g[a]||(g[a]={}),A=g[a]),I=0;I<l;I++){if(c=d+I,k&&p.Ubt===a&&p.Hbt===c)m=p.zbt,k=!1;else{if(g?(N=A[c])?m=N.v:(m=p.getValue(a,c,s.nT),N=A[c]={v:m}):m=p.getValue(a,c,s.nT),f&&(B=void 0,"@"===(B=(O=p.getFormatter())instanceof W?O.formatString():O)?m=p.getText(a,c):m instanceof Date&&(m=S.uJ(m)),L(N)||(N=A[c]={v:m})),i&&T.Convert.BJ(m))return(C=[m]).isError=!0,C;if(N&&N[j]!==$)m=N[j];else if(m=T.Convert.Nbt(m,t,!T.ExcelCompatibleCalcMode,u,o),N&&(N[j]=m),e&&N===m)return(C=[P]).isConvertError=!0,C}T.Convert.Ybt(m,u)||(2===r?C[D*l+I]=m:(r?C:E).push(m))}}(C=r||1!==w?C:C[0]).rowCount=h,C.colCount=l,C.rangeCount=w,b&&(n.Zbt&&b.arrayInfo.length<200||!isNaN(w)&&!isNaN(h)&&!isNaN(l)&&100<w*h*l&&w*h*l<1e6&&b.arrayInfo.length<50)&&(b[R]=C,b[R].rowCount=h,b[R].colCount=l,b[R].rangeCount=w,b.arrayInfo.push({reference:n,key:R}))}return C},m.prototype.getColumnCount=function(){var n=this.Mf;return n.xT?0:n.getColumnCount(this.nT)},m.prototype.getRowCount=function(){var n=this.Mf;return n.xT?0:n.getRowCount(this.nT)},m.prototype.isHiddenRow=function(n,t){var r=this.Mf,i;return!!(r.iA&&r.iA()||!t)&&0===r.getRowHeight(n)},m.prototype.getName=function(){var n,t,n=this.nT,t=V(this.Wbt)?this.Mf.name():this.Wbt;return n===M.SheetArea.colHeader?t+"CH":n===M.SheetArea.rowHeader?t+"RH":t},m.prototype.Qbt=function(){var n=this,t,t;return t=(t=n.t8)||(n.t8=n.Mf.Ut.t8)},m.prototype.setArray=function(n,t,r,i,e){return this.Qbt().setArray(this,n,t,r,i,e)},m.prototype.updateItem=function(n,t,r){return this.Qbt().updateItem(this,n,t,r)},m.prototype.HE=function(n,t){this.Qbt().HE(n,t)},m.prototype.zE=function(){this.Qbt().zE()},m.prototype.setValue=function(n){for(var t,r,i,e,u,f,o,s,n,a,i,c,c,c,h,l,v,v,d,w,d,v,w,C,i,i,C,d,m,t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e=(i=this).Mf,o=i.nT,n.row!==$)u=n.row,f=n.col,s=1;else{if(n.name)return;u=n,f=arguments[1],s=2}n=arguments[s],a=arguments[s+1],(i=i.jbt)&&(c=i[u])&&(c=c[f])&&(c.v=n,c.b!==$&&(c.b=$),c.d!==$&&(c.d=$),c.n!==$&&(c.n=$),c.s!==$&&(c.s=$),c.sn=$),c=M.mt.Z0(n),h=e.Ut,l=!1,v=(v=e.tables)&&v.find(u,f),3===o&&v&&(d=v.showHeader()&&u===v.headerIndex(),w=v.showFooter()&&u===v.footerIndex(),d||w||(l=v.Kbt(u,f,c))),d=e.H3,3===o&&!l&&d&&d._dataSource&&(w=!1,(v=d.getValue(u,f)).hasBinding&&(C=void 0,C=i?(C=(i=i.bindingRows=i.bindingRows||{})[u])||(i[u]=g({},e.getDataItem(u))):g({},e.getDataItem(u)),h.dE(u,f,{gE:C,d6:v.value}),w=d.setValue(u,f,c,h.G8)),l="dataManagerBindingSource"===d.K$?w:v.hasBinding),i=e.pivotTables,(l=3===o&&!l&&i?i.eJt(u,f,c):l)||(C="__hyperlink__",!V(c)&&c[C]&&(d=c[C],h.setHyperlink&&h.do("setHyperlink",u,f,m={url:d}),c=c.toString()),h.do("setValue",u,f,c,o,!0,!0,arguments[s+2],!0,!0)),e.iL=!0,this.K5?this.K5.push({row:u,col:f,sheetArea:o}):e.ki(M.Events.CellChanged,{sheet:e,sheetName:e.name(),row:u,col:f,sheetArea:o,propertyName:"value",oldValue:a,newValue:n,KO:!0})},m.prototype.getCustomFunction=function(n){return this.Mf?this.Mf.Jbt(n):J},m.prototype.getCustomName=function(n){var n=this.getCustomNameInfo(n);return n?n.getExpression():J},m.prototype.getCustomNameInfo=function(n){return n=E(n),this.Mf?this.Mf.getCustomName(n):J},m.prototype.getSheet=function(){return this.Mf},m.prototype.setFormula=function(n,t,r,i,e){var u,f,o,s,a,f,a,u=this;if(u.Mf.Ut.G8&&(s=u.Mf.Ut.G8.formulas,o=u.getCalcSourceModel(),s=s||(u.Mf.Ut.G8.formulas={}),-1<=n)&&-1<=t){if((a=u.getCalcService()).backupR1C1Formula&&(f=u.Mbt.pB(n,t),r=U(u.Mf,f,n,t,!0,!1)),!i&&a.allowDynamicArray&&(i=u.Mbt.sT(n,t)),f=(f=s[n])||(s[n]={}),r&&"="===r[0]&&(r=r.substring(1)),a=f[t]&&f[t].formula,e){if(f[t]&&f[t].oldFormula)return;i=g({},i),f[t]=g({},f[t],{oldFormula:r,oldArrayInfo:i}),r||delete f[t].oldArrayInfo}else f[t]=g({},f[t],{formula:r,arrayInfo:i}),r||delete f[t].arrayInfo;o.usedRange&&k(o.usedRange,n,t,a,r)}},m.prototype.setArrayFormula=function(n,t,r,i,e){var u;this.setFormula(n,t,e,{row:n,col:t,rowCount:r,colCount:i})},m.prototype.setFormulaByName=function(n,t,r){var i,e,i,i=this;i.Mf.Ut.G8&&((i=(i=(e=(e=i.Mf.Ut.G8.formulas)||(i.Mf.Ut.G8.formulas={})).names)||(e.names={}))[n]=g({},i[n],{formula:t,oldFormula:r}))},m.prototype.refresh=function(){this.Mf.repaint()},m.prototype.toJSON=function(n,t,r,i,e){var u,f,o,s,a,c,h,l,v,d,w,C,m,_,p,g,b,A,R,j,F,x,y,E,N,k,k,D,f=t,h=this.Mf,l=n.data||{},v=!0,d=this.op(),w=this===h.qgt,_=0;for(w&&(C=(0,T.createMap)(),h.Xbt=m={}),p=d.forceR1C1Formula,g=0;g<=r;g++)if(u=l.dataTable||{},o=f[g]){for(v=!(a=u[g]),a=a||{},b=0;b<=i;b++)if(A=(s=o[b])&&s.WK,s&&(A||s.qbt)){c=a[b]||{};try{j=R=void 0,w&&A&&!s.$bt&&(F=A.tyt=A.tyt||U(h,A,g,b,!0,!1)).indexOf("!")<0&&(!(x=C.get(F))||x.baseColumn>b?(j=d.unparse(this,s.WK,g,b,!1,!0)).indexOf("[")<0&&(p&&(j=F),C.set(F,{formula:j,baseRow:g,baseColumn:b})):(R=x.obj)?((y=m[R.si]).lastRow=g,y.lastColumn=Math.max(b,y.lastColumn)):(R=x.obj={si:_},m[_]={formula:x.formula,baseRow:x.baseRow,baseColumn:x.baseColumn,lastRow:g,lastColumn:b},u[x.baseRow][x.baseColumn].formula=x.obj,_++)),j=p&&A?R||A.tyt||U(h,A,g,b,!0,!1):s.qbt||R||j||d.unparse(this,A,g,b,!1,!0),s.$bt?s.$bt.row===g&&s.$bt.col===b&&(c.arrayInfo=s.$bt,c.formula=j):c.formula=j,v=!1,a[b]=c}catch(n){}}if(v){if(u!==l.dataTable)continue}else u[g]=a;l.dataTable=u}if(m&&(m.nextIndex=_),e){for(E=l.columnDataArray||[],N=0;N<e.length;N++)(k=e[N])&&k.WK&&(k=this.op().unparse(this,k.WK,0,N,!1,!0),(D=E[N]||{}).formula=k,E[N]=D);0<E.length&&(l.columnDataArray=E)}L(l)||(n.data=l)},m.prototype.wh=function(n,t,r,i,S,e){var u,f,o,s,a,c,h,l,v,d,w,C,m,_,p,g,b,A,R,j,F,x,y,E,N,k,D,I,O,B,u=X(n,M.XFileConstants.bo),f=this.op();for(f.nyt=!0,w=0,(l=this===(h=this.Mf).qgt)&&(v=(0,T.createMap)(),h.Xbt=d={}),C=n.lossless.exprs=[],m=0;m<=r;m++)if(o=t[m],a=u[m],o)for(a=a||(u[m]={}),_=0;_<=i;_++)if(s=o[_],c=a[_],p=s&&s.WK,s&&p){c=c||{};try{A=b=g=void 0,R=-1,(j=s.$bt)||(F=h.Ut.t8.anchors)[m]&&F[m][_]&&(j={row:m,rowCount:(x=F[m][_]).rowCount,col:_,colCount:x.colCount,isDynamicArray:!0},x.isValid||(j.isInvalid=!0)),l&&!j&&(y=p.tyt=p.tyt||U(h,p,m,_,!0,!1),(E=M.Util.ko(e))||y.indexOf("!")<0)&&(!(N=v.get(y))||N.baseColumn>_?(b=f.unparse(this,s.WK,m,_,!1,!0)).indexOf("[")<0&&v.set(y,{formula:b,baseRow:m,baseColumn:_}):((g=N.obj)?((k=d[g.si]).lastRow=m,k.lastColumn=Math.max(_,k.lastColumn)):(g=N.obj={si:w},d[w]={formula:N.formula,baseRow:N.baseRow,baseColumn:N.baseColumn,lastRow:m,lastColumn:_},w++),A=g.si,b=void 0)),V(A)&&(b=s.qbt||b||f.unparse(this,p,m,_,!1,!0),e&&e.includeCalcModelCache&&(D=(0,Z.exprToJSON)(p),s.eyt||(D.nw=1),C.push(D),R=C.length-1),b=Y(z(b))),j?(j.row===m&&j.col===_&&(I=H(j),(j.isInvalid||!j.rowCount)&&0<I.indexOf(":")&&(I=I.substring(0,I.indexOf(":"))),c.f=b,c.r=I),j.isDynamicArray&&(c.a="1")):(c.f=b,c.d="shared",c.g=A,c.c=1),-1!==R&&(c.x=R)}catch(n){}a[_]=c}for(O in d)Object.prototype.hasOwnProperty.call(d,O)&&(B=d[O],I=H(new M.Range(B.baseRow,B.baseColumn,B.lastRow-B.baseRow+1,B.lastColumn-B.baseColumn+1)),(c=u[B.baseRow][B.baseColumn]).r=I,c.g=parseInt(O,10));delete f.nyt},(n.SheetSource=O=m).prototype.getParserContext=function(n,t,r){return t=t||(0,T.eV)(0,0),new c(this.Mf,n,t,r)},Q=T.CalcSource,r(R,Q),R.prototype.addUsedCustomName=function(n){this.Cbt[n]=1},R.prototype.getUsedCustomNames=function(){return this.Cbt||{}},R.prototype.getCustomFunction=function(n){return this.vpt?this.vpt.getCustomFunction(n):J},R.prototype.getCustomName=function(n){var n=this.getCustomNameInfo(n);return n?n.getExpression():J},R.prototype.getCustomNameInfo=function(n){return this.vpt?this.vpt.getCustomName(n)||this.vpt.xO(n):J},n.SpreadSource=R,n.formulaToExpression=un,n.expressionToFormula=U,n.evaluateFormula=fn,n.evaluateExpression=on,n.xbt=sn,n.rangeToExpression=j,n.isValidExternalReference=an,n.rangeToFormula=ln,n.rangeToFormulaWithStructReference=vn,n.formulaToRange=dn,n.formulaToRanges=wn,n.rangesToFormula=Cn,n.Ibt=mn,n.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},n.goalSeek=_n},"./dist/plugins/sheetsCalc/calc.ns.js":function(n,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_COLUMN_COUNT=t.MAX_ROW_COUNT=t.BAND_INDEX_CONST=void 0;var r=r("Core");t.BAND_INDEX_CONST=-2147483648,t.MAX_ROW_COUNT=r.XmlConstants.Io,t.MAX_COLUMN_COUNT=r.XmlConstants.xo},"./dist/plugins/sheetsCalc/external-reference.js":function(n,t,r){var i,F,e,E,f,r,x,y,N,k,D,c,I,O,u,o,s,a,h;function l(n,t,r,i){var n=n&&n[t];return n&&n[r]&&n[r][i]}function v(n,t,r,i){var n,t,e,n=n.sheets[t]&&n.sheets[t].data.dataTable,t=n&&n[r]&&n[r][i]&&n[r][i].value;return t&&t.richText?(e="",t.richText.forEach(function(n){e+=n.text}),e):t}function d(n,t,r){var i,n,e,r,i=h.call(this,k)||this;return i.getSheetRangeReference=function(n){var t,r,i,e,u,t=this.rT.sheetNames;if(n.endSource&&t&&n.source instanceof d){for(r=!1,i=[],e=0;e<t.length&&((r=t[e]===n.source.oyt?!0:r)&&(u=new d("["+this.rT.i+"]"+t[e],this.ayt,!0),i.push(u.getReference(n))),t[e]!==n.endSource.oyt);e++);return new f.SheetRangeReference(i)}return E.Errors.Name},n=n.split("]"),r&&(e=n[0].substring(1)),t.iyt[e]?i.rT=t.iyt[e]:(r=n[0].indexOf("["),i.rT=t.ryt(n[0].substring(r+1),n[0].substring(0,r),!0)),i.oyt=n[1],i.ayt=t,i}function w(n,t){var r,i,e;if(n)for(r in n)D(n,r)&&(e=(i=n[r]).getExpression())&&e.forEachNodes(function(n){(1===n.type||5===n.type||8===n.type)&&n.source instanceof o&&(t[n.source.rT.i]=!0)})}function C(n,t){var t=n.getRange(t.row,t.column);return t.sheetName=n.source.oyt,t}function m(n){this.iyt=n||{},this.uyt={},this.syt()}i=this&&this.__extends||(a=function(n,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}a(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalReferenceManager=t.ExternalSource=void 0,F=r("Core"),e=r("Common"),E=r("CalcEngine"),f=r("./dist/plugins/sheetsCalc/calc-spreadjs.js"),r=e.Common.lt,x=F.XFileConstants.Rr,y=F.XFileConstants.Lr,N=void 0,k=null,D=e.Common.kh,c=r.ht,I=F.Util.wr,O=F.Util.Mr,u=/^'?\[\d+\]/,h=E.CalcSource,i(d,h),d.prototype.cyt=function(n,t,r){var i,e,i=n.getKey();this.rT=this.ayt.fyt(this.rT),this.S2(),e=this.ayt.uyt[this.rT.i]=this.ayt.uyt[this.rT.i]||{},t?e[i]?e[i][1].push(r):e[i]=[n,[r]]:e[i]&&delete e[i]},d.prototype.S2=function(){this.rT.data=this.rT.data||{};var n=this.rT.data[this.oyt];return n||(this.rT.sheetNames.push(this.oyt),n=this.rT.data[this.oyt]={isNew:!0}),n},d.prototype.getValue=function(n,t){var r,i,n,r=this.S2(),i=r[n];return i=i||(r[n]={}),c(i[t])&&(i[t]=N),r.isNew?E.Errors.Reference:(n=i[t])&&n._code&&(n._error||n._calcError)?new E.CalcError(n._error||n._calcError):n},d.prototype.getRowCount=function(){return E.MAX_ROW_COUNT},d.prototype.getColumnCount=function(){return E.MAX_COLUMN_COUNT},d.prototype.createSourceModel=function(){return k},d.prototype.getCalcSourceModel=function(){return k},d.prototype.setCalcSourceModel=function(){},d.prototype.getPeerSource=function(n){return new d("["+this.rT.i+"]"+n,this.ayt,!0)},d.prototype.getSources=function(n){var t,r,i,e,u,t=this.rT.sheetNames,r=[];if(n&&t&&n.oyt)for(i=!1,e=0;e<t.length&&((i=t[e]===this.oyt?!0:i)&&(u=new d("["+this.rT.i+"]"+t[e],this.ayt,!0),r.push(u)),t[e]!==n.oyt);e++);return r},d.prototype.referenceToArray=function(n,t,r,i,e,u,f,o){var s,a,c,h,l,v,d,w,C,m,_,p,g,b,A,R,j,F,x,y,s=this,h=1,l=1,C=[],p=s.rT.Rbt,g=s.oyt+n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+t+"_"+r;if(p){if(p.has(g))return p.get(g)}else p=s.rT.Rbt=(0,E.createMap)();if(0===(w=n.getRangeCount()))C.isError=!0;else{for(b=s.getRowCount(),A=s.getColumnCount(),r=r===N||r,R=0;R<w;R++){if(r||C.push(_=[]),v=n.getRow(R),d=n.getColumn(R),0===(h=n.getRowCount(R)))return C.isError=!0,C;if(-1===h&&(v=0,h=b),0===(l=n.getColumnCount(R)))return C.isError=!0,C;if(-1===l&&(d=0,l=A),b<=v||A<=d)return(C=r?[k]:[[k]]).rowCount=1,C.colCount=1,C.rangeCount=1,C;for(b<v+h&&(h=b-v),A<d+l&&(l=A-d),j=void 0,F=!1,x=0;x<h;x++)for(a=v+x,r||_.push(j=[]),y=0;y<l;y++)m=s.getValue(a,c=d+y),F||(m=E.Convert.Nbt(m,t,!E.ExcelCompatibleCalcMode,u,o),i&&E.Convert.BJ(m)&&(F=(C=[m]).isError=!0),E.Convert.Ybt(m,u))||(r?C:j).push(m);if(F)return C}(C=r||1!==w?C:C[0]).rowCount=h,C.colCount=l,C.rangeCount=w,p&&p.set(g,C)}return C},d.prototype.getName=function(n){var n,n=this.jfe?"":this.ayt.uyt[this.rT.i]&&(!this.rT||n&&n.lyt)?"[".concat(this.rT.i,"]"):"".concat(this.rT.option.path,"[").concat(this.rT.option.name,"]");return n+this.oyt},d.prototype.getIdentity=function(n,t){var r,i,e,u,t,r=this,i=t.row,e=t.rowCount||1,u=t.column,t=t.columnCount||1;return-1===i&&(i=0,e=r.getRowCount()),-1===u&&(u=0,t=r.getColumnCount()),r.getName(n)+"."+i+"."+e+"."+u+"."+t},o=d,t.ExternalSource=o,m.prototype.parseSource=function(n,t){return new o(n,this,t)},m.prototype.ryt=function(n,t,r,i){var e,u;for(e in this.iyt)if(D(this.iyt,e)&&(u=this.iyt[e])&&u.option.name===n&&u.option.path===t)return u;if(!r)for(e in this.iyt)if(D(this.iyt,e)&&(u=this.iyt[e]).option.name===n&&""===t)return u;return i?N:{option:{name:n,path:t},sheetNames:[],data:{}}},m.prototype.syt=function(){for(var n in this.iyt)this.iyt[n]&&(this.iyt[n].i=n)},m.prototype.fyt=function(n){var t,t,t=this.ryt(n.option.name,n.option.path,!0,!0);return t||(t=Object.keys(this.iyt).length+1,(this.iyt[t]=n).i=t,n)},m.prototype.Ep=function(n){var t,r,i,e,u,f,r={},i={},e=1;for(u in this.iyt)D(this.iyt,u)&&(this.uyt[u]&&!F.GC$.isEmptyObject(this.uyt[u])||(t||(t={},w(n.hyt,t),n.sheets.forEach(function(n){w(n.hyt,t)})),t[u]))&&(r[(f=this.iyt[u]).i=e]=f,i[e]=this.uyt[u],e++);this.iyt=r,this.uyt=i},m.prototype.toJSON=function(){var n,t,r,n={};for(t in this.iyt)D(this.iyt,t)&&(r=this.iyt[t],n[t]={option:{name:r.option.name,path:r.option.path},sheetNames:r.sheetNames,data:r.data});return n},m.prototype.wh=function(n){var g,b,t,A,R,j,r,i,g=this.iyt,b=[],t={n_:"externalReferences",c_:b},A={},R=n.workbook.rels,j=0,r=function(n){var t,r,i,n,e,u,f,o,s,a,c,h,l,v,d,w,C,m,_,p;if(D(g,n)){for(j++,r=(t=g[n]).option.id=x+I(R),R.c_.push({n_:y,Id:r,Type:F.RelationshipConstants.uc,Target:O(F.XFileConstants.nu+"/"+F.XFileConstants.tu+n)}),b.push({n_:"externalReference","r:id":r}),n={n_:"sheetNames",c_:i=[]},e={n_:"sheetDataSet",c_:[]},(u=t.sheetNames)&&u.forEach(function(n){i.push({n_:"sheetName",val:F.mt.xfe(n)})}),f=t.data,o=0,s=u.length;o<s;o++){if(a=f[u[o]],c={n_:F.XFileConstants.bo,sheetId:o},a)if(a.isNew)c.refreshError=1;else{for(l in h=[],a)if(a.hasOwnProperty(l)&&(v=parseInt(l,10)+1,!isNaN(v))){for(m in C={n_:"row",r:v,c_:w=[]},d=a[l])d.hasOwnProperty(m)&&d[m]!==N&&(_=d[m],(p={n_:"cell"}).r=F.IndexHelper.nr(parseInt(m,10))+v,"string"==typeof _?p.t="str":"boolean"==typeof _?(p.t="b",_=_?"1":"0"):_&&_.code&&(p.t="e","#SPILL!"!==(_=_._calcError||_.error)&&"#CALC!"!==_||(_="#VALUE!")),p.c_=[{n_:"v",c_:[_]}],w.push(p));h.push(C)}c.c_=h}e.c_.push(c)}A[r]={n_:"externalLink",r_:[13,14,1,21],c_:[{n_:"externalBook","r:id":"rId1",r_:[8],c_:[n,e]}],option:t.option}}};for(i in g)r(i);return{externalReferencesNode:t,externalLinks:A,count:j}},m.prototype.dyt=function(n,e,t){var r,u,f,r,n,o,i,s,a,r=e&&e.sheets&&Object.keys(e.sheets),u=r&&e.sheets[r[0]].data&&e.sheets[r[0]].data.dataTable,f=u?v:l,r=this.ryt(n,t||"",N,!0);if(!c(r))for(s in n=r.i,delete(o=this.iyt[n]).Rbt,o.sheetNames.forEach(function(n){var t,r,i,t;for(r in(u?e.sheets:e)[n]&&delete o.data[n].isNew,o.data[n])if(D(o.data[n],r))for(i in o.data[n][r])D(o.data[n][r],i)&&(o.data[n][r][i]=f(e,n,r,i))}),i=this.uyt[n]||{})D(i,s)&&(a=i[s][0]).vyt()},m.prototype._6=function(t,n,r){var i,e,i=this;"string"==typeof t?i.dyt(t,n,r):t&&(e=i.myt(!0)).forEach(function(n){t[n.filePath+n.name]&&i.dyt(n.name,t[n.filePath+n.name],n.filePath)})},m.prototype.myt=function(n){var t,r,i,e,u,f,o,t=[];for(r in this.iyt)if(D(this.iyt,r)){if(i=this.iyt[r],e={name:i.option.name,filePath:i.option.path},n)for(o in u=this.uyt[r]||{},e.items=[],f=function(n){var t,r,n,n;D(u,n)&&(r={row:(t=u[n][0]).row,col:t.column,sheetName:t.w3.rT.getName()},n=1===(n=u[n][1]).length?C(n[0],t):n.map(function(n){return C(n,t)}),e.items.push({target:r,source:n}))},u)f(o);t.push(e)}return t},t.ExternalReferenceManager=m},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(u,n,t){var X,r,F,A,S,f,M,t,w,Y,C,z,T,m,g,k,L,i,o,_,r;function a(n,t){var r,i,e,n,r=C(n.row,(t=t||this).row),i=C(n.column,t.column),e=Y(n.row+n.rowCount,t.row+t.rowCount),n=Y(n.column+n.columnCount,t.column+t.columnCount);return e<=r||n<=i?T:{row:r,column:i,rowCount:e-r,columnCount:n-i,intersectWith:a}}function e(n,t,r,i,e,u,f,o){var s=this;s.gyt=n,s.pyt=t,s.byt=r,s.yyt=i,s.wyt=e,s.Myt=u,s.Sx=f,s.Cyt=o}function N(n,t,r,i){return(!i||n<t)&&r}function V(n){return[n.row,n.col,n.rowCount,n.colCount].join(",")}function J(n,t,r,i){var e,e;(e=(e=n[t])||(n[t]={}))[r]=i}function $(n,t,r){var n=n[t];return n&&n[r]}function K(){}function p(n,t,r,i,e,u,f,o,s,a,c,h){var l,v,d,n;return 0<=r||!e?(l=i+(e?r:0),v=u+(f?r:0),d=c&&b(o,n,c),n=!c&&b(o,n,c),(d||n)&&(!h&&s+a<=r||h&&s<=r)&&(l-=e?a:0,v-=f?a:0),d=c&&b(o,t,c),n=!c&&b(o,t,c),(d||n)&&(!h&&s<=l||h&&(e&&s<=r+i||!e&&s<=i)?(l+=a,v+=a):(!h&&s<=v||h&&(f&&s<=r+u||!f&&s<=u))&&(v+=a)),l-=e?r:0,v-=f?r:0,h&&s+a<=r&&(l+=e?a:0,v+=f?a:0),{index:l,endIndex:v}):{index:i,endIndex:u}}function O(n,t,r,i,e,u,f,o,s,a,c,h){if(t&&!h){var h=s?e.row:e.column,l=s?e.rowRelative:e.columnRelative,v=void 0;if(s&&0<=r||!s&&0<=i||!l){if(a)v=p(n,t,s?r:i,h,l,-1,!1,u,f,o,s,c).index;else if(v=Z(n,t,s?r:i,h,l,u,f,o,s,c),m(v))return(0,X.Syt)(v);v!==h&&(e=e.offset(s?v-h:0,s?0:v-h,!0))}}return e}function B(n,t,r,i,e,u,f,o,s,a,c,h){var h,h,l,v,d,w,a,n;if(t&&!h){if(3===(h=e.Tyt())||s&&2===h||!s&&1===h)return e;if(h=s?e.rowRelative:e.columnRelative,l=s?e.endRowRelative:e.endColumnRelative,v=s?e.row:e.column,d=s?e.endRow:e.endColumn,w=void 0,s&&0<=r||!s&&0<=i||!h||!l){if(a)w=p(n,t,s?r:i,v,h,d,l,u,f,o,s,c);else if(w=W(n,t,s?r:i,v,h,d,l,u,f,o,s,c),m(w))return(0,X.Syt)(w);a=w.index,n=w.endIndex,a===v&&n===d||(e=e.offset2(s?a-v:0,s?0:a-v,s?n-d:0,s?0:n-d,r,i))}}return e}function H(n,t,r,i,e,u,f,o,s,a){if(t){var t=e;if(t&&u===t.source)return t.offsetWhenInsertRemoveColumn(f,o,s,a)}return e}function R(n,t,r,i,e,u,f,o,s,a,c,h){var l,v,d,w,C,m,_,p,g,b,l=R,v=i;if(i){if(1===i.type&&i.hmt())v=O(n,i.source||n,t,r,i,e,u,f,o,s,c,h);else if(1===i.type)v=B(n,i.source||n,t,r,i,e,u,f,o,s,c,h);else if(10===i.type)(d=l(n,t,r,i.value,e,u,f,o,s,z,c,h))!==i.value&&(v=(0,X.Ayt)(d));else if(9===i.type)w=l(n,t,r,i.value,e,u,f,o,s,z,c,h),C=i.value2&&l(n,t,r,i.value2,e,u,f,o,s,z,c,h),w===i.value&&C===i.value2||(v=(0,X.rbt)(i.operatorType,w,C));else if(7===i.type){for(m=T,p=_=void 0,b=(g=i).arguments.length,p=0;p<b;p++)if((d=l(n,t,r,_=g.arguments[p],e,u,f,o,s,z,c,h))!==_){(m=[])[p]=d;break}if(m){for(p=0;p<b;p++)_=g.arguments[p],m[p]!==z&&m[p]!==T||(m[p]=l(n,t,r,_,e,u,f,o,s,z,c,h));v=(0,X.YJ)(g,m)}}else c&&!n.Iyt||o||13!==i.type||(v=H(n,n,t,r,i,e,u,f,s,c));return v}}function c(e,u,f,o,n,t,r,i,s,a,c){var h,l,v,l,h=function(n,t,r,i){return u.call(this,n,r,i,t,e,f,o,s,a,z,c)},l=e.getSheet(),v=l.b8&&(l.parent||l).xyt(),l=l.Ut&&l.Ut.pj();d(v,h,s,l)}function d(n,t,r,i){var e,e,u,f,o,s,a,c,h,l,v,d,w,o,C,m,_,p,g,b;if(n)for(s=0;s<n.length;s++){for(c=a=!0,h=A.maxRowCount-1,l=A.maxColumnCount-1,d=0,w=(v=(e=n[s].validator)._S).length;d<w&&(C=(o=v[d]).rowCount,m=o.colCount,f=o.row,o=o.col,-1!==C&&(c=!1,h=f<h?f:h),-1!==m&&(a=!1,l=o<l?o:l),a||c);d++);if(!(r&&c||!r&&a)&&(_=(u=n[s].sheet).Uw(),(p=(e=e.condition()).getExpressions())&&0<p.length)){for(g=0;g<p.length;g++)b=p[g],p[g]=t(_,b,h,l);e.setExpressions(p,i)}}}function h(n){var r,t,i,r=[],t=n.parent,i;return(t&&t.sheets||[n]).forEach(function(t){var n=t.conditionalFormats,n=n&&n.getRules();n&&n.length&&n.forEach(function(n){n.KK&&r.push({rule:n,sheet:t})})}),r}function l(e,u,f,o,s,a){var n,t,r,i,n=function(n,t,r,i){return u.call(this,n,r,i,t,e,f,o,s,a)},t=e.getSheet(),r,i;v(h(t),n,t.Ut&&t.Ut.pj(),s,a)}function v(n,t,r,i,e){var u,f,o,s,a,c,h,a,l,v,d,s,w,C,m,_,p,g,b,A,R,j,F,x,R,y,E,N;if(n)for(u=0,f=n.length;u<f;u++){if(s=(o=n[u].rule).ranges(),c=(a=k(s)).r,h=a.c,l=(a=n[u].sheet).Uw(),v=o.condition(),(d=a.tables)&&s&&1===s.length&&(w=(s=s[0]).row,C=s.col,m=s.rowCount,_=s.colCount,p=void 0,e&&i?p=d.AJ(w,C,m,_):a.EB&&a.Nyt&&(p=[a.Nyt]),p)&&p.length){for(g=!1,b=0,A=p.length;b<A;b++)if(j=(R=p[b]).row,F=R.col,x=R.rowCount,R=R.colCount,w===j&&m===x&&F<=C&&C+_<=F+R){g=!0;break}if(g)continue}if(v||(o.initCondition(),v=o.condition()),(y=v&&v.getExpressions())&&0<y.length){for(E=0;E<y.length;E++)N=y[E],y[E]=t(l,N,c,h);v.setExpressions(y,r)}}}function U(n,e,u){var t,n,r,t=function(n,t,r,i){return G.call(this,n,r,i,t,e,u)},n=n.getSheet(),r;v(h(n),t,n.Ut.pj())}function Z(n,t,r,i,e,u,f,o,s,a){var c,h,n,u,t;if(0<=r||!e){if(c=i+(e?r:0),h=s&&b(u,n,s),n=!s&&b(u,n,s),(h||n)&&f<=r&&(c+=e?o:0),h=s&&b(u,t,s),n=!s&&b(u,t,s),h||n)if(u=r+i,t=r+o+i,!a&&f+o<=c||a&&f+o<=u)c-=o;else if(!a&&f<=c||a&&f<=u&&f<=t&&t<=f+o)return g;return c-=e?r:0,a&&f<=r&&(c-=e?o:0),c}return i}function b(n,t,r){var r=r?{2:!0}:{1:!0};return n===t||n.Mf===t.Mf&&(3===n.nT&&r[t.nT]||r[n.nT]&&3===t.nT)}function W(n,t,r,i,e,u,f,o,s,a,c,h){var l,v,d,w,n,o,t;if(0<=r||!e){if(l=i+(e?r:0),v=u+(f?r:0),d=s+a-1,w=c&&b(o,n,c),n=!c&&b(o,n,c),(w||n)&&s<=r&&(l+=e?a:0,v+=f?a:0),w=c&&b(o,t,c),n=!c&&b(o,t,c),w||n)if(o=r+i,t=r+u,!h&&d<l||h&&d<o)l-=a,v-=a;else{if(!h&&s<=l&&v<=d||h&&s<=o&&t<=d)return g;!h&&v<s||h&&t<s||(!h&&d<=v||h&&d<=t?(l=!h&&l<=s||h&&o<=s?l:s,v-=a):v=s-1)}return l-=e?r:0,v-=f?r:0,h&&s<=r&&(l-=e?a:0,v-=e?a:0),{index:l,endIndex:v}}return{index:i,endIndex:u}}function Q(n,t,r){var i,e,u,f,o,s,a,c,a,a,c,a,h,l,c,a,v,d,i=Q,e=t;if(t)if(t.source)if(s=t.source,(a=t.endSource)&&s!==a){if(!(c=s.Mf&&s.Mf.parent))return X.kyt;a===r?(a=r.S3,e.endSource=c.getSheet(a-1).Uw()):s===r&&(a=r.S3,e.source=c.getSheet(a).Uw()),delete r.S3,e.source===e.endSource&&delete e.endSource}else(n!==r&&s===r||n===r&&s!==r)&&(e=X.kyt);else if(10===t.type)(u=i(n,t.value,r))!==t.value&&(e=(0,X.Ayt)(u));else if(9===t.type)c=i(n,t.value,r),a=t.value2&&i(n,t.value2,r),c===t.value&&a===t.value2||(e=(0,X.rbt)(t.operatorType,c,a));else if(7===t.type){for(h=T,l=t.arguments.length,o=0;o<l;o++)if((u=i(n,f=t.arguments[o],r))!==f){(h=[])[o]=u;break}if(h){for(o=0;o<l;o++)f=t.arguments[o],h[o]!==z&&h[o]!==T||(h[o]=i(n,f,r));e=(0,X.YJ)(t,h)}}else 8===t.type&&(c=n||r,a=w(t.value),s=(v=c.getCustomName(a))&&v.source||(v=(d=c.Lbt.getGlobalSourceModel()||c.getCalcSourceModel()).getSource().getCustomName(a))&&v.source?v.source:s)&&(n!==r&&s===r||n===r&&s!==r)&&(e=X.kyt);return e}function D(n,t,r,i,e){return Q(n,i,e)}function q(n,t){return n.yyt===n.gyt&&t!==n.yyt}function nn(n,t,r,i,e,u){var f,o,s,a,c,h,l,v,d,l,w,C,m,C,w,m,d,f=!!i.source,o=i.source||n,s=i.rowRelative,a=i.columnRelative,d=t,l=r,w=e.yyt.Mf;if(u&&u.isCustomName&&(C=i.row,m=i.column,d=e.wyt+(C-e.pyt)+w.lT(e.wyt,C-e.pyt+1,!0),l=e.Myt+(m-e.byt)+w.lT(e.Myt,m-e.byt+1)),C=e.Dyt(d),w=e._yt(l),(0<=t||!s)&&(0<=r||!a)){if(c=i.row+(s?t:0),h=i.column+(a?r:0),u&&u.isNameID||n===e.gyt&&(v=n===e.yyt?e.Eyt(e.yyt,t,r,1,1):(m=t,d=r,u&&u.crossSheetMoved&&(m-=C,d-=w),e.jyt(e.gyt,m,d,1,1))),o===e.yyt&&e.Eyt(o,c,h,1,1)&&!e.jyt(o,c,h,1,1)&&(!s&&!a||!v))return X.kyt;if(l=(f&&o===e.gyt||!f&&n===e.gyt)&&(!v&&e.jyt(e.gyt,c,h,1,1)||v&&e.Eyt(e.yyt,s?c:c+C,a?h:h+w,1,1)),v&&(c-=s?C:0,h-=a?w:0),l&&(c+=C,h+=w),h-=a?r:0,o=i.source,e.gyt!==e.yyt&&(l&&v?f&&(o=e.yyt):l?o=e.yyt:v&&!f&&(o=e.gyt)),(c-=s?t:0)!==i.row||h!==i.column||o!==i.source)return(0,X.knt)(o,T,c,h,s,a)}else if((0<=t||!s)&&-1===r){if(c=i.row+(s?t:0),e.Eyt(n,t,r,1,1)&&(c-=s?C:0),e.jyt(o,c,-1,1,-1))c+=C;else if(e.Eyt(o,c,-1,1,-1))return X.kyt;if((c-=s?t:0)!==i.row)return(0,X.knt)(i.source,T,c,i.column,s,i.columnRelative)}else if(-1===t&&0<=r&&!a){if(h=i.column+(a?r:0),e.Eyt(n,t,r,1,1)&&(h-=a?w:0),e.jyt(o,c,h,1,1))h+=w;else if(e.Eyt(o,c,h,1,1))return X.kyt;if(h-=a?r:0,c!==i.row||h!==i.column)return(0,X.knt)(i.source,i.endSource,i.row,h,i.rowRelative,a)}return i}function j(n,t){var r,i,e,u;return(t=n.getIntersect(t,0,0))?(r=n.row,i=n.col,e=n.rowCount,u=n.colCount,n.rowCount===t.rowCount&&n.colCount===t.colCount||(n.rowCount===t.rowCount?(n.col===t.col&&(i=n.col+t.colCount),u=n.colCount-t.colCount):n.colCount===t.colCount&&(n.row===t.row&&(r=n.row+t.rowCount),e=n.rowCount-t.rowCount)),(0,S.Ec)(r,i,e,u)):T}function tn(n,t,r,i,e){var n,u;return t&&n&&(!(n=t.getIntersect(n,0,0))&&(u=t.getIntersect(r,0,0))||!!(n&&n.rowCount===t.rowCount&&0!==e||n.colCount===t.colCount&&0!==i))}function rn(n,t,r){var n=n.getRange(t,r);return(0,S.Ec)(n.row,n.col,n.rowCount,n.colCount)}function x(n,t,r,i){var t,e,t=j(n,t);return t?(e=t.union(r),i?(e.col=n.col,e.colCount=n.colCount):(e.row=n.row,e.rowCount=n.rowCount)):e=r,{startRow:e.row,endRow:e.row+e.rowCount-1,startColumn:e.col,endColumn:e.col+e.colCount-1}}function y(n,t,r,i,e){var u,n,t,u=j(n,t),n=n.getIntersect(t,0,0);return n?(n.row+=i,n.col+=e,{startRow:(t=u?u.union(n):r).row,endRow:t.row+t.rowCount-1,startColumn:t.col,endColumn:t.col+t.colCount-1}):T}function en(n,t){var r,i,e,n,u,f,o,t,r=n.row,i=n.col,e=n.rowCount,n=n.colCount,u=t.row,f=t.col,o=t.rowCount,t=t.colCount;return 1===e&&1!==n?f<i&&i<=f+t-1||f<=i+n-1&&i+n-1<f+t-1:1!==n||1===e||u<r&&r<=u+o-1||u<=r+e-1&&r+e-1<u+o-1}function un(n,t,r,i,e,u){var i,e,u,f,o,s,a,c,h,l,v,d,n,w,C,m,_,p,i=rn(i,e,u),e=i.row,u=i.row+i.rowCount-1,f=i.col,o=i.col+i.colCount-1,s=n.pyt,a=s+n.Sx-1,c=n.byt,h=c+n.Cyt-1,l=n.wyt,v=n.Myt,d=(0,S.Ec)(s,c,n.Sx,n.Cyt),n=(0,S.Ec)(l,v,n.Sx,n.Cyt),w=i.getIntersect(n,0,0);if(tn(d,i,n,t,r))if(p=_=void 0,m=0!==t)if(p=s<=u&&u<=a,(_=s<=e&&e<=a)&&p)e+=t,u+=t;else if(_&&!p){if(t<=0)e+=t;else if(!(u<s+t)){if(!(a+t<u))return y(i,d,n,t,r);if(s===e)return x(i,d,n,m);e+=t}}else if(!_&&p){if(0<=t)u+=t;else if(!(a+t<e)){if(!(e<l))return y(i,d,n,t,r);if(a===u)return x(i,d,n,m);u+=t}}else w&&!w.equals(n)&&en(i,n)&&(e=(C=j(i,w)).row,u=C.row+C.rowCount-1,f=C.col,o=C.col+C.colCount-1);else if(p=c<=o&&o<=h,(_=c<=f&&f<=h)&&p)f+=r,o+=r;else if(_&&!p){if(r<0)f+=r;else if(!(o<c+r)){if(!(h+r<o))return y(i,d,n,t,r);if(c===f)return x(i,d,n,m);f+=r}}else if(!_&&p){if(0<r)o+=r;else if(!(h+r<f)){if(!(f<v))return y(i,d,n,t,r);if(h===o)return x(i,d,n,m);o+=r}}else w&&!w.equals(n)&&en(i,n)&&(e=(C=j(i,w)).row,u=C.row+C.rowCount-1,f=C.col,o=C.col+C.colCount-1);return{startRow:e,endRow:u,startColumn:f,endColumn:o}}function s(n,t,r,i){return t<r||r+i-1<n}function fn(n,t,r,i){return r<=n&&t<=r+i-1}function on(n,t,r,i){return n<r&&r+i-1<t}function sn(n,t,r,i){return r===n&&r+i-1<t||n<r&&r+i-1===t}function an(n,t,r,i){return r<n&&n<=r+i-1&&r+i-1<t||n<r&&r<=t&&t<r+i-1}function E(n,t,r,i,e){return r<=n&&e<=n||t<=r+i-1&&t<=e+i-1}function cn(n,t,r,i,e){for(var u,f,o,u=[s,fn,on,sn,an],o=0;o<u.length;o++)if(u[o](n,t,r,i)){f=o+"_";break}if(r===e)f+="9";else for(o=0;o<u.length;o++)if(r!==e&&u[o](n,t,e,i)){f+=o;break}return f}function hn(n,t,r,i,e){return{row:C(n.startRow,t),col:C(n.startColumn,r),endRow:Y(n.endRow,i),endCol:Y(n.endColumn,e)}}function ln(n,t,r,i,e){return n===e.yyt&&e.wyt<=t&&t<=e.Sx+e.wyt-1&&e.Myt<=r&&r<=e.Cyt+e.Myt-1&&(t=t+e.pyt-e.wyt,r=r+e.byt-e.Myt),{startRow:i.row+(i.rowRelative?t:0),endRow:i.endRow+(i.endRowRelative?t:0),startColumn:i.column+(i.columnRelative?r:0),endColumn:i.endColumn+(i.endColumnRelative?r:0)}}function I(n,t,r,i,e,u,f,o,s){return M(u)&&(u=t.startRow),M(f)&&(f=t.startColumn),M(o)&&(o=t.endRow),M(s)&&(s=t.endColumn),(0,X.lJ)(e||n.source,T,n.rowRelative?u-r:u,n.columnRelative?f-i:f,n.endRowRelative?o-r:o,n.endColumnRelative?s-i:s,n.rowRelative,n.columnRelative,n.endRowRelative,n.endColumnRelative,r,i)}function vn(n,t,r,i,e){var u,n,f,o,n,s,a,c,h,l,v,d,u=ln(n,t,r,i,e),n=i.source||n;if(e.gyt===n&&e.yyt===n)switch(n=(f=cn(u.startRow,u.endRow,e.pyt,e.Sx,e.wyt))+"-"+(o=cn(u.startColumn,u.endColumn,e.byt,e.Cyt,e.Myt)),s=e.wyt-e.pyt,a=e.Myt-e.byt,c=hn(u,e.pyt,e.byt,e.pyt+e.Sx-1,e.byt+e.Cyt-1),d=v=l=h=void 0,n){case _.outToCover+"-"+_.outToCover:case _.crossToCover+"-"+_.outToCover:case _.outToCover+"-"+_.crossToCover:case _.crossToCover+"-"+_.crossToCover:case _.coverToCover+"-"+_.outToCover:case _.outToCover+"-"+_.coverToCover:case _.coverNoMove+"-"+_.outToCover:case _.outToCover+"-"+_.coverNoMove:return X.kyt;case _.outToCross+"-"+_.outToCover:case _.coverToCross+"-"+_.outToCover:case _.insideToCross+"-"+_.outToCover:case _.partToCross+"-"+_.outToCover:case _.crossToCross+"-"+_.outToCover:case _.crossNoMove+"-"+_.outToCover:case _.outToCross+"-"+_.coverNoMove:case _.outToCross+"-"+_.coverToCover:case _.outToCross+"-"+_.crossToCover:case _.insideToCross+"-"+_.coverNoMove:case _.insideToCross+"-"+_.coverToCover:case _.insideToCross+"-"+_.crossToCover:return e.wyt<=u.startRow?I(i,u,t,r,T,e.wyt+e.Sx):I(i,u,t,r,T,T,T,e.wyt-1);case _.outToCover+"-"+_.outToCross:case _.outToCover+"-"+_.coverToCross:case _.outToCover+"-"+_.insideToCross:case _.outToCover+"-"+_.partToCross:case _.outToCover+"-"+_.crossToCross:case _.outToCover+"-"+_.crossNoMove:case _.coverNoMove+"-"+_.outToCross:case _.coverToCover+"-"+_.outToCross:case _.crossToCover+"-"+_.outToCross:case _.coverNoMove+"-"+_.insideToCross:case _.coverToCover+"-"+_.insideToCross:case _.crossToCover+"-"+_.insideToCross:return e.Myt<u.startColumn?I(i,u,t,r,T,T,e.Myt+e.Cyt):I(i,u,t,r,T,T,T,T,e.Myt-1);case _.partToOut+"-"+_.coverNoMove:case _.crossToOut+"-"+_.coverNoMove:if(!E(u.startRow,u.endRow,e.pyt,e.Sx,e.wyt))return I(i,u,t,r);case _.coverNoMove+"-"+_.partToOut:case _.coverNoMove+"-"+_.crossToOut:if(f===_.coverNoMove&&!E(u.startColumn,u.endColumn,e.byt,e.Cyt,e.Myt))return I(i,u,t,r);case _.crossToInside+"-"+_.coverNoMove:case _.coverNoMove+"-"+_.crossToInside:return u.startRow>=e.pyt&&o===_.coverNoMove||u.startColumn>=e.byt&&f===_.coverNoMove?I(i,u,t,r,T,c.row+s,c.col+a):I(i,u,t,r,T,T,T,c.endRow+s,c.endCol+a);case _.partToInside+"-"+_.coverNoMove:return u.startRow>=e.pyt?I(i,u,t,r,T,Y(c.row+s,c.endRow+1)):I(i,u,t,r,T,T,T,C(c.endRow+s,c.row-1));case _.coverNoMove+"-"+_.partToInside:return u.startColumn>=e.byt&&f===_.coverNoMove?I(i,u,t,r,T,T,Y(c.col+a,c.endCol+1)):I(i,u,t,r,T,T,T,T,C(c.endCol+a,c.col-1));case _.partToCross+"-"+_.coverNoMove:case _.crossToPart+"-"+_.coverNoMove:case _.crossToCross+"-"+_.coverNoMove:if(E(u.startRow,u.endRow,e.pyt,e.Sx,e.wyt))return u.startRow>=e.pyt?I(i,u,t,r,T,c.row+s):I(i,u,t,r,T,T,T,c.endRow+s);case _.crossToCover+"-"+_.coverNoMove:case _.partToPart+"-"+_.coverNoMove:return e.pyt<e.wyt?I(i,u,t,r,T,Y(c.row+s,c.endRow+1),T,c.endRow+s):I(i,u,t,r,T,c.row+s,T,C(c.endRow+s,c.row-1));case _.coverNoMove+"-"+_.partToCross:case _.coverNoMove+"-"+_.crossToPart:case _.coverNoMove+"-"+_.crossToCross:if(E(u.startColumn,u.endColumn,e.byt,e.Cyt,e.Myt))return u.startColumn>=e.byt?I(i,u,t,r,T,T,c.col+a):I(i,u,t,r,T,T,T,T,c.endCol+a);case _.coverNoMove+"-"+_.crossToCover:case _.coverNoMove+"-"+_.partToPart:return e.byt<e.Myt?I(i,u,t,r,T,T,Y(c.col+a,c.endCol+1),T,c.endCol+a):I(i,u,t,r,T,T,c.col+a,T,C(c.endCol+a,c.col-1));case _.crossToCross+"-"+_.coverToCover:case _.crossToPart+"-"+_.coverToCover:case _.partToCross+"-"+_.coverToCover:if(E(u.startRow,u.endRow,e.pyt,e.Sx,e.wyt))return I(i,u,t,r);case _.coverToCover+"-"+_.crossToCross:case _.coverToCover+"-"+_.crossToPart:case _.coverToCover+"-"+_.partToCross:if(f===_.coverToCover&&E(u.startColumn,u.endColumn,e.byt,e.Cyt,e.Myt))return I(i,u,t,r);case _.coverToCover+"-"+_.partToPart:case _.partToPart+"-"+_.coverToCover:case _.coverToCover+"-"+_.crossToCover:case _.crossToCover+"-"+_.coverToCover:return I(i,u,t,r,T,c.row+s,c.col+a,c.endRow+s,c.endCol+a);case _.partToPart+"-"+_.crossToCover:case _.partToCross+"-"+_.crossToCover:case _.crossToPart+"-"+_.crossToCover:case _.crossToCross+"-"+_.crossToCover:return E(u.startRow,u.endRow,e.pyt,e.Sx,e.wyt)?I(i,u,t,r):(l=c.row===u.startRow?c.col===u.startColumn?(v=u.endColumn,d=c.col+a,h=c.endRow+s,c.row+s):(v=u.startColumn,d=c.endCol+a,h=f===_.partToCross||f===_.crossToCross?e.pyt+s-1:u.endRow,u.startRow):c.col===u.startColumn?(v=u.endColumn,d=c.col+a,h=u.endRow,f===_.partToCross||f===_.crossToCross?e.pyt+e.Sx-1+s+1:u.startRow):(v=u.startColumn,d=c.endCol+a,h=f===_.partToCross||f===_.crossToCross?c.row+s:u.startRow,c.endRow+s),I(i,u,t,r,T,Y(h,l),Y(v,d),C(h,l),C(v,d)));case _.crossToCover+"-"+_.partToPart:case _.crossToCover+"-"+_.partToCross:case _.crossToCover+"-"+_.crossToPart:case _.crossToCover+"-"+_.crossToCross:return E(u.startColumn,u.endColumn,e.byt,e.Cyt,e.Myt)?I(i,u,t,r):(l=c.row===u.startRow?(h=(d=c.col===u.startColumn?(v=c.endCol+a,c.col+a):(v=u.endColumn,o===_.partToCross||o===_.crossToCross?e.byt+e.Cyt-1+a+1:u.startColumn),u.endRow),c.row+s):c.col===u.startColumn?(v=u.startColumn,d=o===_.partToCross||o===_.crossToCross?e.byt+a-1:u.endColumn,h=c.endRow+s,u.startRow):(v=o===_.partToCross||o===_.crossToCross?c.col+a:u.startColumn,d=c.endCol+a,h=u.startRow,c.endRow+s),I(i,u,t,r,T,Y(h,l),Y(v,d),C(h,l),C(v,d)));case _.coverToOut+"-"+_.coverToOut:case _.coverToOut+"-"+_.coverToCross:case _.coverToOut+"-"+_.coverToCover:case _.coverToOut+"-"+_.coverNoMove:case _.coverToCross+"-"+_.coverToOut:case _.coverToCross+"-"+_.coverToCross:case _.coverToCross+"-"+_.coverToCover:case _.coverToCross+"-"+_.coverNoMove:case _.coverToCover+"-"+_.coverToOut:case _.coverToCover+"-"+_.coverToCross:case _.coverToCover+"-"+_.coverToCover:case _.coverToCover+"-"+_.coverNoMove:case _.coverNoMove+"-"+_.coverToOut:case _.coverNoMove+"-"+_.coverToCross:case _.coverNoMove+"-"+_.coverToCover:return I(i,u,t,r,T,u.startRow+s,u.startColumn+a,u.endRow+s,u.endColumn+a);default:return I(i,u,t,r)}}function dn(n,t,r,i,e,u,f,o){var s,a,c,h,l,v,d,w,C,m,_,p,g,b,A,R,j,F,x,y,E,g,N,k,g,b,D,I,u,g,b,A,D,I,u,b,A,s=!!i.source,a=s?i.source:n,g=u&&u.isDataValidator,b=q(e,n),A=!1,c=i.rowRelative,h=i.columnRelative,l=i.endRowRelative,v=i.endColumnRelative;if(0<=t||!c||!l||0<=r||!h||!v){if(d=i.row+(c?t:0),w=i.endRow+(l?t:0),C=i.column+(h?r:0),_=w-d+1,p=(m=i.endColumn+(v?r:0))-C+1,!g&&b){if(k=e.jyt(a,d,C,_,p))return i.offset(f,o,!0,t,r);if(e.Eyt(a,d,C,_,p))return X.kyt;if(a!==e.gyt||a!==e.yyt||0!==f&&0!==o)return i;A=!0}if(u&&u.isNameID||n===e.gyt&&(N=n===e.yyt?e.Eyt(e.yyt,t,r,1,1):(g=t,b=r,u&&u.crossSheetMoved&&(g-=f,b-=o),e.jyt(e.gyt,g,b,1,1))),(A||n===a&&n===e.gyt&&n===e.yyt)&&(D=t,I=r,N&&(D-=f,I-=o),0===f||0===o)){if(!(u=un(e,f,o,i,D,I)))return X.kyt;if(0===o&&f&&u.endColumn>=m&&u.startColumn<=C||0===f&&o&&u.endRow>=w&&u.startRow<=d)return g=u.startRow,b=u.startColumn,A=u.endRow,D=u.endColumn,g===d&&A===w&&b===C&&D===m?i:(c&&(g-=t),l&&(A-=t),h&&(b-=r),v&&(D-=r),(0,X.lJ)(i.source,T,g,b,A,D,c,h,l,v,t,r))}if(N&&(I=e.wyt-e.pyt,u=e.Myt-e.byt,_+=(c?-I:0)+(l?I:0),p+=(h?-u:0)+(v?u:0)),a===e.yyt&&e.Eyt(a,d,C,_,p)&&!p&&(!c&&!h&&!l&&!v||!N))return X.kyt;if(g=(s&&a===e.gyt||!s&&n===e.gyt)&&(!N&&e.jyt(e.gyt,d,C,_,p)||N&&e.Eyt(e.yyt,c?d:d+f,h?C:C+o,_,p)),N&&(d-=F=c?f:0,w-=x=l?f:0,C-=y=h?o:0,m-=E=v?o:0),b=!1,g)d+=R=f,w+=R,C+=j=o,m+=j;else if(e.Eyt(a,d,C,_,p)){if(!(A=e.intersectWith(a,d,C,_,p))||A.rowCount!==_&&A.colCount!==p)return X.kyt;d=A.row+f,C=A.col+o,w=d+A.rowCount,m=C+A.colCount,b=!0}return w-=l?t:0,C-=h?r:0,m-=v?r:0,e.gyt===e.yyt?a=s?i.source:z:(a=i.source,g&&N&&s?a=e.yyt:g&&N||(g?a=e.yyt:N&&!s&&(a=e.gyt))),(d-=c?t:0)!==i.row||C!==i.column||w!==i.endRow||m!==i.endColumn||b||a!==i.source?(0,X.lJ)(a,T,d,C,w,m,c,h,l,v,t,r):void 0}if((0<=t||!c||!l)&&-1===r){if(d=i.row+(c?t:0),(w=i.endRow+(l?t:0))<d)return X.kyt;if(e.Eyt(n,t,r,1,1)&&(d-=F=c?f:0,w-=x=l?f:0),e.jyt(a,d,-1,_=w-d+1,-1))d+=R=f,w+=R;else if(e.Eyt(a,d,-1,_,-1))return X.kyt;return w-=l?t:0,(d-=c?t:0)!==i.row||w!==i.endRow?(0,X.lJ)(i.source,T,d,i.column,w,i.endColumn,c,i.columnRelative,l,i.endColumnRelative,t,r):void 0}if(-1===t&&(0<=r||!h||!v)){if(C=i.column+(h?r:0),(m=i.endColumn+(v?r:0))<C)return X.kyt;if(e.Eyt(n,t,r,1,1)&&(C-=y=h?o:0,m-=E=v?o:0),e.jyt(a,-1,C,-1,p=m-C+1))C+=j=o,m+=j;else if(e.Eyt(a,-1,C,-1,p))return X.kyt;return m-=v?r:0,(C-=h?r:0)!==i.column||m!==i.endColumn?(0,X.lJ)(i.source,T,i.row,C,i.endRow,m,i.rowRelative,h,i.endRowRelative,v,t,r):void 0}}function wn(n,t,r,i,e,u){var f,o,s,a,c,h,l,v,d,w,C,m,v,d,_,p,g,p,_,g,u,g,b,A,C,R,b,A,R,b,g,v,u,d,f,o=!!i.source?i.source:n,s=i.Tyt(),v=t,d=r,_=e.yyt.Mf;if(u&&u.isCustomName&&(p=i.row,g=i.column,v=e.wyt+(p-e.pyt)+_.lT(e.wyt,p-e.pyt+1,!0),d=e.Myt+(g-e.byt)+_.lT(e.Myt,g-e.byt+1)),p=e.Dyt(v),_=e._yt(d),0===s){if(g=!e.Oyt&&vn(n,t,r,i,e))return g;if(g=dn(n,t,r,i,e,u,p,_))return g}else if(1===s){if(a=i.rowRelative,h=i.endRowRelative,0<=t||!a||!h){if(v=i.row+(a?t:0),(d=i.endRow+(h?t:0))<v)return X.kyt;if(m=n===e.gyt&&n===e.yyt&&e.Eyt(e.yyt,t,r,1,1),o===e.gyt&&o===e.yyt&&0===e.byt&&0===e.Myt&&e.Cyt===o.getColumnCount()){if(u=e.pyt,g=e.wyt,m&&(v-=p,d-=p),A=u+(b=e.Sx),R=u<=d&&d<A,(C=u<=v&&v<A)&&R)return m?i:i.offset(p,_,!0,t,r);if(b=g+b,C&&g<=d?(v+=p,d<b&&g<=d&&(d=b-1,v=A)):R&&v<=b&&(d+=p,g<=v)&&w<b&&(v=g,d=u-1),d-=h?t:0,(v-=a?t:0)!==i.row||d!==i.endRow)return(0,X.lJ)(i.source,i.endSource,v,F.BAND_INDEX_CONST,d,F.BAND_INDEX_CONST,a,c,h,l,t,r)}if(m)return i.offset(-p,_,!0,t,r)}}else if(2===s){if(c=i.columnRelative,l=i.endColumnRelative,w=i.column+(c?r:0),(C=i.endColumn+(l?r:0))<w)return X.kyt;if(m=n===e.gyt&&n===e.yyt&&e.Eyt(e.yyt,t,r,1,1),o!==e.gyt||o!==e.yyt)return i.offset(p,-_,!1,t,r);if(0===e.pyt&&0===e.wyt&&e.Sx===o.getRowCount()){if(A=e.byt,R=e.Myt,m&&(w-=c?_:0,C-=l?_:0),g=A+(b=e.Cyt),u=A<=C&&C<g,(v=A<=w&&w<g)&&u)return m&&c&&l?i:i.offset(p,_,!0,t,r);if(d=R+b,v&&R<=C)w+=_,C<d&&R<=C&&(C=d-1,w=g);else if(u&&w<=d)C+=_,R<=w&&w<d&&(w=R,C=A-1);else if(m)return i.offset(-p,-_,!1,t,r);if(C-=l?r:0,(w-=c?r:0)!==i.column||C!==i.endColumn)return(0,X.lJ)(i.source,i.endSource,F.BAND_INDEX_CONST,w,F.BAND_INDEX_CONST,C,a,c,h,l,t,r)}if(m)return i.offset(p,-_,!0,t,r)}return i}function G(n,t,r,i,e,u,f){var o,s,a,c,h,l,v,d,w,o=G,s=i;if(1===i.type&&i.hmt())s=u?nn(n,t,r,i,e,f):mn(n,t,r,i,e);else if(1===i.type)s=u?wn(n,t,r,i,e,f):_n(n,t,r,i,e);else if(10===i.type)(a=o(n,t,r,i.value,e,u,f))!==i.value&&(s=(0,X.Ayt)(a));else if(9===i.type)c=o(n,t,r,i.value,e,u,f),h=i.value2&&o(n,t,r,i.value2,e,u,f),c===i.value&&h===i.value2||(s=(0,X.rbt)(i.operatorType,c,h));else if(7===i.type){for(l=T,d=v=void 0,w=i.arguments.length,d=0;d<w;d++)if((a=o(n,t,r,v=i.arguments[d],e,u,f))!==v){(l=[])[d]=a;break}if(l){for(d=0;d<w;d++)v=i.arguments[d],l[d]!==z&&l[d]!==T||(l[d]=o(n,t,r,v,e,u,f));s=(0,X.YJ)(i,l)}(0,X.isExpression)(i.function)&&(s.function=o(n,t,r,i.function,e,u,f))}return s}function Cn(n,t,r){var i,e,u,f,o,o,s,a,c,h,o,l,v,d,i=t.gyt.getSheet();if(!0!==i.EB)for(e=i.Ut.pj(),u=0;u<n.length;u++)if(o=(f=n[u].validator)._S,s=(o=k(o)).r,a=o.c,h=(c=n[u].sheet).Uw(),(l=(o=f.condition()).getExpressions())&&0<l.length){for(v=0;v<l.length;v++)d=l[v],l[v]=G(h,s,a,d,t,r,{isDataValidator:!0});o.setExpressions(l,e)}}function mn(n,t,r,i,e){var u,f,o,s,a,c,h,u=i.source||n,f=i.rowRelative,o=i.columnRelative,c=e.Dyt(t),h=e._yt(r);if((0<=t||!f)&&(0<=r||!o)){if(s=i.row+(f?t:0),a=i.column+(o?r:0),e.Eyt(n,t,r,1,1)?(s-=f?c:0,a-=o?h:0):e.jyt(n,s,a,1,1)&&(s+=f?c:0,a+=o?h:0),e.jyt(u,s,a,1,1)?(s+=c,a+=h):e.Eyt(u,s,a,1,1)&&(s-=c,a-=h),a-=o?r:0,(s-=f?t:0)!==i.row||a!==i.column)return(0,X.knt)(i.source,T,s,a,f,o)}else if((0<=t||!f)&&-1===r){if(s=i.row+(f?t:0),e.Eyt(n,t,-1,1,-1)?s-=f?c:0:e.jyt(n,s,-1,1,-1)&&(s+=f?c:0),e.jyt(u,s,-1,1,-1)?s+=c:e.Eyt(u,s,-1,1,-1)&&(s-=c),(s-=f?t:0)!==i.row||a!==i.column)return(0,X.knt)(i.source,T,s,i.column,f,i.columnRelative)}else if(-1===t&&0<=r&&!o&&(a=i.column+0,e.Eyt(n,-1,r,-1,1)?a-=0:e.jyt(n,-1,a,-1,1)&&(a+=0),e.jyt(u,-1,a,-1,1)?a+=h:e.Eyt(u,-1,a,-1,1)&&(a-=h),a-=0,s!==i.row||a!==i.column))return(0,X.knt)(i.source,T,i.row,a,i.rowRelative,o);return i}function _n(n,t,r,i,e){var u,f,o,s,a,c,h,l,v,d,w,C,m,_,p,g,b,A,R,j,u=i.source||n,f=i.Tyt(),R=e.Dyt(t),j=e._yt(r);if(0===f){if(v=i.rowRelative,d=i.columnRelative,w=i.endRowRelative,C=i.endColumnRelative,!(0<=t)&&v&&w||!(0<=r)&&d&&C)if(!(0<=t)&&v&&w||-1!==r){if(-1===t&&(0<=r||!d||!C)){if((a=i.column+(d?r:0))<(c=i.endColumn+(C?r:0)))return X.kyt;if(e.Eyt(n,-1,r,-1,1)?(a-=g=d?j:0,c-=A=C?j:0):e.jyt(n,-1,r,-1,1)&&(a+=g=d?j:0,c+=A=C?j:0),e.jyt(u,-1,a,-1,l=c-a)?(a+=_=j,c+=_):e.Eyt(u,-1,a,-1,l)&&(a-=_=j,c-=_),c-=C?r:0,(a-=d?r:0)!==i.column||c!==i.endColumn)return(0,X.lJ)(i.source,T,a,i.endRow,c,i.rowRelative,d,i.endRowRelative,C,t,r)}}else{if((o=i.row+(v?t:0))<(s=i.endRow+(w?t:0)))return X.kyt;if(e.Eyt(n,t,-1,1,-1)?(o-=p=v?R:0,s-=b=v?R:0):e.jyt(n,t,-1,1,-1)&&(o+=p=v?R:0,s+=b=v?R:0),e.jyt(u,o,-1,h=s-o,-1)?(o+=m=R,s+=m):e.Eyt(u,o,-1,h,-1)&&(o-=m=R,s-=m),s-=w?t:0,(o-=v?t:0)!==i.row||s!==i.endRow)return(0,X.lJ)(i.source,T,o,i.column,s,i.endColumn,v,i.columnRelative,w,i.endColumnRelative,t,r)}else if(o=i.row+(v?t:0),s=i.endRow+(w?t:0),a=i.column+(d?r:0),h=s-o,l=(c=i.endColumn+(C?r:0))-a,e.Eyt(n,t,r,1,1)?(o-=p=v?R:0,s-=b=w?R:0,a-=g=d?j:0,c-=A=C?j:0):e.jyt(n,o,a,h,l)&&(o+=p=v?R:0,s+=b=w?R:0,a+=g=d?j:0,c+=A=C?j:0),e.jyt(u,o,a,h,l)?(o+=m=R,s+=m,a+=_=j,c+=_):e.Eyt(u,o,a,h,l)&&(o-=m=R,s-=m,a-=_=j,c-=_),s-=w?t:0,a-=d?r:0,c-=C?r:0,(o-=v?t:0)!==i.row||a!==i.column||s!==i.endRow||c!==i.endColumn)return(0,X.lJ)(i.source,T,o,a,s,c,v,d,w,C,t,r)}else if(1===f){if(v=i.rowRelative,w=i.endRowRelative,0<=t||!v||!w){if((o=i.row+(v?t:0))<(s=i.endRow+(w?t:0)))return X.kyt;if(e.Eyt(n,t,-1,1,-1)?(o-=p=v?R:0,s-=b=w?R:0):e.jyt(n,t,-1,1,-1)&&(o+=p=v?R:0,s+=b=w?R:0),e.jyt(u,o,-1,h=s-o,-1)?(o+=m=R,s+=m):e.Eyt(u,o,-1,h,-1)&&(o-=m=R,s-=m),s-=w?t:0,(o-=v?t:0)!==i.row||s!==i.endRow)return(0,X.lJ)(i.source,T,o,F.BAND_INDEX_CONST,s,F.BAND_INDEX_CONST,v,!1,w,!1,t,r)}}else if(2===f){if(d=i.columnRelative,C=i.endColumnRelative,a=i.column+(d?r:0),(c=i.endColumn+(C?r:0))<a)return X.kyt;if(e.Eyt(n,-1,r,-1,1)?(a-=g=d?j:0,c-=A=C?j:0):e.jyt(n,-1,r,-1,1)&&(a+=g=d?j:0,c+=A=C?j:0),e.jyt(u,-1,a,-1,l=c-a)?(a+=_=j,c+=_):e.Eyt(u,-1,a,-1,l)&&(a-=_=j,c-=_),c-=C?r:0,(a-=d?r:0)!==i.column||c!==i.endColumn)return(0,X.lJ)(i.source,T,F.BAND_INDEX_CONST,a,F.BAND_INDEX_CONST,c,!1,d,!1,C,t,r)}return i}function P(n,t,r,i,e,u){n.Ryt(t,r,i,e,!0,!1,u)}function pn(n,t,r){var i,e,u,f,o,s,a,c,h,i=pn,e=t;if(8===t.type){if(t.value===r&&(!t.source||t.source===n.getSource()))return(0,X.Syt)(g,t.source)}else if(10===t.type)(u=i(n,t.value,r))!==t.value&&(e=(0,X.Ayt)(u));else if(9===t.type)s=i(n,t.value,r),a=t.value2&&i(n,t.value2,r),s===t.value&&a===t.value2||(e=(0,X.rbt)(t.operatorType,s,a));else if(7===t.type){for(c=T,h=t.arguments.length,o=0;o<h;o++)if((u=i(n,f=t.arguments[o],r))!==f){(c=[])[o]=u;break}if(c){for(o=0;o<h;o++)f=t.arguments[o],c[o]!==z&&c[o]!==T||(c[o]=i(n,f,r));e=(0,X.YJ)(t,c)}}return e}Object.defineProperty(n,"__esModule",{value:!0}),n.adjustFormulaOnMoveSwap=n.CalcOperatorAdjustor=n.MoveSwapInfo=void 0,X=t("CalcEngine"),r=t("Common"),F=t("./dist/plugins/sheetsCalc/calc.ns.js"),A=t("./dist/plugins/sheetsCalc/parser-sheets.js"),S=t("Core"),f=r.Common.lt.Dh,M=r.Common.lt.ht,t=r.Common.zf,w=t.Gmt,Y=Math.min,C=Math.max,z=void 0,T=null,m=X.Convert.BJ,g=X.Errors.Reference,k=S.util.z0,e.prototype.Dyt=function(n){var t,r,n,r,t=this,r=t.yyt.Mf;return t.Oyt=r&&r.o5(),t.Oyt&&0<=n?(n=n-t.wyt+1,r=r.ix(t.wyt,n,!0),t.wyt-t.pyt+r):t.wyt-t.pyt},e.prototype._yt=function(n){var t,r,n,r,t=this,r=t.yyt.Mf;return t.Oyt=r&&r.o5(),t.Oyt&&0<=n?(n=n-t.Myt+1,r=r.ix(t.Myt,n),t.Myt-t.byt+r):t.Myt-t.byt},e.prototype.jyt=function(n,t,r,i,e){var u=this;return u.gyt===n&&(-1===u.pyt||u.pyt<=t&&t+i<=u.pyt+u.Sx)&&(-1===u.byt||u.byt<=r&&r+e<=u.byt+u.Cyt)},e.prototype.Eyt=function(n,t,r,i,e){var u,f,o,s,a,c,h,u=this,f=u.yyt.Mf,o=f&&f.o5(),s=u.wyt,a=u.Myt,c=u.Sx,h=u.Cyt;return o&&(c+=f.lT(s,c,!0),h+=f.lT(a,h)),u.yyt===n&&(-1===s||s<=t&&t+i<=s+c)&&(-1===a||a<=r&&r+e<=a+h)},e.prototype.intersectWith=function(n,t,r,i,e){var u,t,f,u=this;return u.yyt!==n?T:(t=u.Byt(n,t,r,i,e),(f=u.Byt(n,u.pyt,u.byt,i,e)).intersectWith(t))},e.prototype.Byt=function(n,t,r,i,e){var u,f,o,s,u,f,o,s;return{row:-1===t?0:t,column:-1===r?0:r,rowCount:-1===t||-1===i?n.rowCount:i,columnCount:-1===r||-1===e?n.colCount:e,intersectWith:a}},L=e,n.MoveSwapInfo=L,K.gB=function(n,t,r,i,e,u,f,o,s,a,c){var h,l,v,d,w,C,m,_,p,h=r,l=K,v=this.gB;if(r)if(10===(C=r.type))h=(0,X.Ayt)(v.call(l,n,t,r.value,i,e,u,f,o,s,a,c));else if(1===C&&r.hmt()){if(d=Y((r.source||t).getRowCount(),F.MAX_ROW_COUNT),w=Y((r.source||t).getColumnCount(),F.MAX_COLUMN_COUNT),r.rowRelative&&(r.row+i<0||r.row+i>=d)||r.columnRelative&&(r.column+e<0||r.column+e>=w))return(0,X.Syt)(g,r.source);h=r.offset(0,0,!1)}else if(1===C){if(d=Y((r.source||t).getRowCount(),F.MAX_ROW_COUNT),w=Y((r.source||t).getColumnCount(),F.MAX_COLUMN_COUNT),r.rowRelative&&!r.isFullColumn&&(r.row+i<0||r.row+i>d)||r.columnRelative&&!r.isFullRow&&(r.column+e<0||r.column+e>w)||r.endRowRelative&&!r.isFullColumn&&(r.endRow+i<0||r.endRow+i>d)||r.endColumnRelative&&!r.isFullRow&&(r.endColumn+e<0||r.endColumn+e>w))return(0,X.Syt)(g,r.source,r.endSource);h=r.offset(0,0,!1,i,e)}else if(9===r.type)h=(0,X.rbt)(r.operatorType,v.call(l,n,t,r.value,i,e,u,f,o,s,a,c),r.value2&&v.call(l,n,t,r.value2,i,e,u,f,o,s,a,c));else if(7===C){if(_=[],r.arguments&&0<r.arguments.length)for(p=0;p<r.arguments.length;p++)_[p]=v.call(l,n,t,r.arguments[p],i,e,u,f,o,s,a,c);h=(0,X.YJ)(r,_)}else 13===C&&(h=r.offsetWhenCopy(n,t,i,e,u,f,o,s,a,c));return h},K.copyFormula=function(n,t,r,i,e,u,M,T,L,J){var $,f,G,o,P,s,a,c,h,l,v,d,w,C,m,_,p,g,b,V,A,H,U,R,j,F,x,y,Z,W,E,N,k,D,D,D,D,I,O,D,B,S,$=n,f=i,G=n.getSource(),o=i.getSource(),P=K;if($&&f){for(s=o&&o.getSheet().Ut.pj(),c=r,h=e,l=u,v=M,d=T,(a=t)<0&&(a=0,v=Y(n.rC(),i.rC())),r<0&&(c=0,d=Y(n.cC(),i.cC())),e<0&&(h=0),u<0&&(l=0),w=new X.CalcSourceModel(n.op(),G),g=o.getSheet(),b=!J&&g.o5(),V=v,A=d,H=g.getRowCount(),U=g.getColumnCount(),C=0;C<v;C++)for(m=0;m<d;m++)$.Lyt(w,C+a,m+c,C,m);for(R={},j=i.op(),_=C=0;C<v&&C+h<H;C++)if(F=C+h,b&&0===g.getRowHeight(F))v++;else{if(!L||!o.isHiddenRow(F,!0))for(p=m=0,d=A;m<d&&m+l<U;m++)if(x=m+l,b&&0===g.getColumnWidth(x))d++;else{if(y=w.pB(_,p)){if(y===R)continue;if(y=P.gB(G,o,y,F,x,Z=e+C-t-_,W=u+m-r-p,e,u,V,A),E=w.sT(_,p),o){if(b&&E)continue;if(E&&!E.isDynamicArray){for(N=E.rowCount,k=E.colCount,0<(D=a-E.row)&&(N-=D),(D=v-C)<N&&(N=D),0<(D=c-E.col)&&(k-=D),(D=d-m)<k&&(k=D),I=0;I<N;I++)for(O=0;O<k;O++)w.bB(C+I,m+O,R);i.setArrayFormula(F,x,N,k,j.unparse(o,y,F,x),z,s)}else D=y?j.unparse(o,y,F,x):z,o.setFormula(F,x,D,z),(B=w.Fyt(_,p))&&(S=new X.EvaluateContext(o,(0,X.eV)(F,x),!1),B=(B=f.Lbt.allowDynamicArray?(0,X.h0t)(S,y,!1,0,0,!0,!0):(0,X.Pyt)(S,y,!1,0,0,!1,!1))===y?z:B),f.Gyt(F,x,y,B,E,s)}else f.bB(F,x,y),f.Uyt(F,x,E)}else f&&f.pB(F,x)&&f.Gyt(F,x,z,z,z,s);p++}_++}}},K.moveFormula=function(n,t,r,i,e,u,f,o){var s,a,c,h,l,v,d,w,C,m,n,_,p,g,b,A,R,j,F,x,y,E,N,k,D,I,O,B,O,m,n,s=n.b3(),a=i.b3(),c=s.op();if(s&&a){for(h=i.getRowCount(),l=i.getColumnCount(),v=s.pj(),d=a.pj(),w=c.Hyt(),t<0&&(t=0,f=Y(n.getRowCount(),h)),e<0&&(e=0),r<0&&(r=0,o=Y(n.getColumnCount(),l)),u<0&&(u=0),C=!(n===i&&n.name()===i.name()),n=o,_=m=f,(g=i.o5())&&(m+=i.lT(e,f,!0),n+=i.lT(u,o)),s.mF(t,r,f,o),P(s,t,r,f,o),a.mF(e,u,m,n),P(a,e,u,m,n),b=[],A=0;A<f;A++)for(R=0;R<o;R++)j=s.pB(A+t,R+r),F=s.sT(A+t,R+r),x=s.Fyt(A+t,R+r),j&&(b[A*o+R]={WK:j,$bt:F,eyt:x},s.zyt(A+t,R+r,v),F&&(A+t!==F.row||R+r!==F.col)||s.rT.setFormula(A+t,R+r,T,z));for(k=C?{}:null,y=A=0;A<_&&A+e<h;A++)if(D=A+e,g&&0===i.getRowHeight(D))_++;else{for(E=R=0,p=o;R<p&&u+R<l;R++)if(I=R+u,g&&0===i.getColumnWidth(I))p++;else{if(O=b[y*o+E]){if(j=O.WK,F=O.$bt,g&&F){E++;continue}c&&F&&!F.isDynamicArray&&F.row===t+A&&F.col===r+R&&(N=(0,S.Ec)(D,I,F.rowCount,F.colCount)),B=F&&!F.isDynamicArray?N:z,x=O.eyt,a.Vyt(d,D,I),a.bB(D,I,j),a.Uyt(D,I,B),a.Yyt(D,I,x),B&&(B.row!==D||B.col!==I)||(O=a.getFormula(D,I),a.rT.setFormula(D,I,O,B)),C&&(k[D+", "+I]=j)}else M(a.pB(D,I))||(a.Vyt(d,D,I),a.bB(D,I,z),a.Uyt(D,I,z));E++}y++}w.Zyt(s,t,r,f,o),w.Zyt(a,e,u,m,n),n=(m=s.getSource().getSheet()).b8&&(m.parent||m).xyt(),w.Wyt(n,s.getSource(),t,r,a.getSource(),e,u,f,o,!0,k),!0==C&&w.Wyt(n,s.getSource(),t,r,a.getSource(),e,u,f,o,!0,k)}},K.prototype.isAdjustCell=function(n){return n.preAdj||this.y3&&n===this.y3[0]},K.prototype.isAdjust=function(n){return n.preAdj||this.y3&&n===this.y3[0]},K.prototype.Qyt=function(n,t){var r=this,i,e;isNaN(t)||(r.y3||(r.y3={},r.Kyt={}),i=r.y3[t],e=r.Kyt[t],n&&!n.preAdj&&n!==i&&(i?e.nextAdj=n:r.y3[t]=n,n.preAdj=e,n.nextAdj=T,r.Kyt[t]=n))},K.prototype.Jyt=function(n,t){var r,i,i,e,r=this;isNaN(t)||(i=r.y3&&r.y3[t],n&&(n.preAdj||n===i)&&(i=n.preAdj,e=n.nextAdj,i?i.nextAdj=e:r.y3[t]=e,e?e.preAdj=i:r.Kyt[t]=i,n.preAdj=T,n.nextAdj=T))},K.prototype.Xyt=function(n,t,r,i,e,u,f){this.qyt(n,R,t,r,i,e,u,f);var f=0,o=0,s=0,a=0;0===t&&(i&&e?s=r:i?f=r:e?a=r:o=r),c(n,R,t,r,f,o,s,a,i,e,u),l(n,R,t,r,i,e)},K.prototype.qyt=function(n,t,r,i,e,u,f,o){var s,a,c,h,l,v,d,w,C,m,_,p,g,b,A,R,j,F,x,y,E,s=this,a=s.y3;if(a){for(m={};a[0];){if(C=(c=(d=a[0]).w3).pj(),w=c.getSource(),$(m,h=d.row,l=d.column));else{if(!(v=c.pB(h,l))||t===D&&w===n)(c.getRowExpression&&c.getRowExpression(h)||c.getColumnExpression&&c.getColumnExpression(l))&&c.gF(h,l,1,1);else if(v=t.call(s,w,h,l,v,n,r,i,e,u,z,f,o),_=c.sT(h,l)){if(w===n&&(p=u?i:-i,e?r<=_.row&&(_.row+=p):r<=_.col&&(_.col+=p)),h===_.row&&l===_.col)if(_.isDynamicArray)c.SB(h,l,v,_,!0,N(e?h:l,r,C,n.id===w.id));else for(g=h;g<h+_.rowCount;g++)for(m[g]||(m[g]={}),b=l;b<l+_.colCount;b++)c.SB(g,b,v,_,g===h&&b===l,N(e?g:b,r,C,n.id===w.id)),J(m,g,b,!0)}else c.SB(h,l,v,_,!0,N(e?h:l,r,C,n.id===w.id))}s.Jyt(d,0)}for(;a[1];)C=(c=(d=a[1]).w3).pj(),h=d.row,c.getRowExpression&&(v=c.getRowExpression(h))&&c.SB&&(w=c.getSource(),c.SB(h,-1,t.call(s,w,h,-1,v,n,r,i,e,u),z,!0,N(h,r,C,n.id===w.id))),s.Jyt(d,1);for(;a[2];)C=(c=(d=a[2]).w3).pj(),l=d.column,c.getColumnExpression&&(v=c.getColumnExpression(l))&&c.SB&&(w=c.getSource(),c.SB(-1,l,t.call(s,w,-1,l,v,n,r,i,e,u),z,!0,N(l,r,C,n.id===w.id))),s.Jyt(d,2);for(;a[3];)R=(A=a[3]).name,v=(c=A.w3).$yt(R),j=t.call(s,c.getSource(),0,0,v,n,r,i,e,u,{isNameID:!0}),c.twt(R,j),s.Jyt(A,3);for(F in a)if(3<(x=+F)&&a.hasOwnProperty(F))for(;a[F];)E=(y=a[F]).w3,v=t.call(s,E,0,0,y.expression,n,r,i,e,u),E.setExpression(y.id,y.name,v),s.Jyt(y,x)}},K.prototype.nwt=function(n){var t=this,r,i,e;P(n.getCalcSourceModel(),0,0,n.getRowCount(),n.getColumnCount()),t.qyt(n,D),c(n,D,0,0,0,0,0,0,!0,!1),l(n,D,0,0,!0,!1)},K.prototype.Wyt=function(n,t,r,i,e,u,f,o,s,a,c){var h,l,v,d,w,C,m,_,p,g,b,A,R,j,F,j,x,y,E,N,k,D,I,O,B,S,h=this,l=G,v=new L(t,r,i,e,u,f,o,s),p={};if(n&&Cn(n,v,a),U(t,v,a),R={},b=h.y3){for(;b[0];){if(d=(w=b[0]).w3,C=w.row,m=w.column,g=d.pj(),$(p,C,m));else{if(_=d.pB(C,m),A=d.getSource(),_)if(j=z,c&&c[C+", "+m]&&(A=t,j={crossSheetMoved:!0}),_=l.call(h,A,C,m,_,v,a,j),j=void 0,(F=d.sT(C,m))&&!F.isDynamicArray)if(j=V(F),C===F.row&&m===F.col)for(R[j]=!0,x=C;x<C+F.rowCount;x++)for(p[x]||(p[x]={}),y=m;y<m+F.colCount;y++)d.SB(x,y,_,F,x===C&&y===m,g),J(p,x,y,!0);else R[j]||(d.SB(C,m,_,F,!1,g),J(p,C,m,!0));else d.SB(C,m,_,F,!0,g);else(d.getRowExpression&&d.getRowExpression(C)||d.getColumnExpression&&d.getColumnExpression(m))&&d.gF(C,m,1,1)}h.Jyt(w,0)}for(;b[1];)d=(w=b[1]).w3,C=w.row,g=d.pj(),d.getRowExpression&&(_=d.getRowExpression(C))&&d.ewt&&d.ewt(C,l.call(h,A,C,-1,_,v,a),z,g),h.Jyt(w,1);for(;b[2];)d=(w=b[2]).w3,m=w.column,g=d.pj(),d.getColumnExpression&&(_=d.getColumnExpression(m))&&d.iwt&&d.iwt(m,l.call(h,A,-1,m,_,v,a),z,g),h.Jyt(w,2);for(;b[3];)N=(E=b[3]).name,_=(d=E.w3).$yt(N),k=l.call(h,A,0,0,_,v,a),d.twt(N,k),h.Jyt(E,3);for(D in b)if(3<(I=+D)&&b.hasOwnProperty(D))for(;b[D];)S=(B=(O=b[D]).w3).getSource(),_=l.call(h,S,0,0,O.expression,v,a),B.setExpression(O.id,O.name,_),h.Jyt(O,I)}},K.prototype.Zyt=function(n,t,r,i,e){for(var u,f,o,s,a,c,h,l,u=this,f=t+i,o=r+e,c=t;c<f;c++)for(h=r;h<o;h++)s=n.rwt(c,h),a=n.pB(c,h),(s||a)&&(u.Jyt(s,0),n.owt(c,h,0),l=n.oT(c,h,!0),s&&a&&(s.row!==l.row||s.column!==l.column)&&(l.oldRow=s.row,l.oldColumn=s.column),u.Qyt(l,0))},K.prototype.awt=function(n,t,r){for(var i,e,u,i=this,e=t;-1!==e&&e<t+r;e++)(n.rwt(-1,e)||n.pB(-1,e))&&(n.owt(-1,e,2),u=n.uwt(e,!0),i.Qyt(u,2))},K.prototype.swt=function(n,t,r){for(var i,e,u,i=this,e=t;-1!==e&&e<t+r;e++)(n.rwt(e,-1)||n.pB(e,-1))&&(n.owt(e,-1,1),u=n.cwt(e,!0),i.Qyt(u,1))},K.prototype.fwt=function(n){for(var t,r,i,e,u,f,o,t=this,r=n.op().getAllSourceModels(),u=0;u<r.length;u++)if((f=r[u]).lwt)for(i=f.lwt(),o=0;o<i.length;o++)(e=i[o])&&e.isVolatile&&e instanceof X.CellCalc&&!t.isAdjustCell(e)&&t.Qyt(e,0)},K.prototype.onBeforeAddRemoveRows=function(n,i,t){[n,t].forEach(function(n){var t,r;n&&(t=n.rC(),r=n.cC(),n.mF(i,0,t-i,r),n.hwt(i,t-i),P(n,i,-1,t-i,-1,!0))})},K.prototype.onAfterAddRemoveRows=function(n,i,e,u,t,r){var f=this;[n,r].forEach(function(n){var t,r;n&&(t=n.rC(),r=n.cC(),u?n.gF(i,0,e,r):t+=e,f.Zyt(n,i,0,t-i,r),f.swt(n,i,t-i),f.fwt(n))}),f.Xyt(n.getSource(),i,e,!0,u,z,t),n.op().autoCalculation&&n.op().recalculateAll(!1)},K.prototype.onAfterAddRemoveColumns=function(n,i,e,u,t,r){var f=this;[n,r].forEach(function(n){var t,r;n&&(t=n.rC(),r=n.cC(),u?n.gF(0,i,t,e):r+=e,f.Zyt(n,0,i,t,r-i),f.awt(n,i,r-i),f.fwt(n))}),f.Xyt(n.getSource(),i,e,!1,u,z,t),n.op().autoCalculation&&n.op().recalculateAll(!1)},K.prototype.onBeforeAddRemoveColumns=function(n,i,t){[n,t].forEach(function(n){var t,r;n&&(t=n.rC(),r=n.cC(),n.mF(0,i,t,r-i),n.dwt(i,r-i),P(n,-1,i,-1,r-i,!0))})},K.prototype.onAfterRemoveName=function(n,t){var n=n.vwt(t,!1);n&&(n.updateListening(!0,!1),n.vyt(),n.updateListeningOnRemoved())},K.prototype.adjustFormulaOnRemoveName=pn,K.prototype.invalidName=function(n,t){var r,n;t&&(n=(r=n.getCalcSourceModel()).vwt(t.toUpperCase(),!0))&&n.mB()},K.prototype.onAfterRemoveTable=function(n,t){for(var r,i,e,u,f,o,s,a,c,h,l,v,d,r=this,o=0;o<n.length;o++)P((s=n[o]).source().getCalcSourceModel(),s.startRow(),s.startColumn(),s.endRow()-s.startRow()+1,s.endColumn()-s.startColumn()+1);if(a=r.y3)for(c={};a[0];){if(i=(h=a[0]).w3,$(c,e=h.row,u=h.column));else{if(f=i.pB(e,u))if(f=K.adjustExpressionOnRemoveTable(f,n,e,u,t),(l=i.sT(e,u))&&!l.isDynamicArray)for(l=(0,S.Ec)(e,u,l.rowCount,l.colCount),v=e;v<e+l.rowCount;v++)for(c[v]||(c[v]={}),d=u;d<u+l.colCount;d++)i.SB(v,d,f,l,v===e&&d===u),J(c,v,d,!0);else i.SB(e,u,f,l,!0);else(i.getRowExpression&&i.getRowExpression(e)||i.getColumnExpression&&i.getColumnExpression(u))&&i.gF(e,u,1,1)}r.Jyt(h,0)}},K.adjustExpressionOnRemoveTable=function(n,t,r,i,e){var u,f,o,s,a,c,h,l,v,d,w,f,o,C,m,_,p,g,u=K.adjustExpressionOnRemoveTable;if(9===n.type){if(f=n.value,o=n.value2,s=u(f,t,r,i,e),a=o&&u(o,t,r,i,e),f!==s||o!==a)return(0,X.rbt)(n.operatorType,s,a)}else if(7===n.type){for(c=!1,h=[],l=0;l<n.arguments.length;l++)d=u(v=n.arguments[l],t,r,i,e),c=c||v!==d,h.push(d);if(c)return(0,X.YJ)(n,h)}else if(10===n.type){if((f=n.value)!==(o=u(f,t,r,i,e)))return(0,X.Ayt)(o)}else if(13===n.type)for(C=n,l=0;l<t.length;l++)if(C.baseTable===t[l])return e?X.kyt:(m=C.getRange(-1===r?0:r,-1===i?0:i,!0),_=-1===r||1===C.referencePortions(),p=1===m.rowCount&&1===m.columnCount,g=C.source,p?(0,X.knt)(g,T,m.row,m.col,_,!1):(0,X.lJ)(g,T,m.row,m.col,m.row+m.rowCount-1,m.col+m.colCount-1,_,!1,_,!1));return n},i=K,n.CalcOperatorAdjustor=i,(o=X.CalcService.prototype).mwt=function(){return new i},(r=_=_||{}).outToOut="0_0",r.outToCover="0_1",r.outToInside="0_2",r.outToPart="0_3",r.outToCross="0_4",r.outNoMove="0_9",r.coverToOut="1_0",r.coverToCover="1_1",r.coverToCross="1_4",r.coverNoMove="1_9",r.insideToOut="2_0",r.insideToInside="2_2",r.insideToPart="2_3",r.insideToCross="2_4",r.insideNoMove="2_9",r.partToOut="3_0",r.partToInside="3_2",r.partToPart="3_3",r.partToCross="3_4",r.partNoMove="3_9",r.crossToOut="4_0",r.crossToCover="4_1",r.crossToInside="4_2",r.crossToPart="4_3",r.crossToCross="4_4",r.crossNoMove="4_9",n.adjustFormulaOnMoveSwap=G},"./dist/plugins/sheetsCalc/parser-sheets.js":function(N,d,n){var t,I,b,O,B,A,R,j,r,n,i,w,S,M,c,u,e,f,o,k,D,J,$,G,a,P,V,s,h,n,n,l,v;function H(n){return r(n+1).split("")}function U(n,t){var r=t+1;return n<0?n%r+r:t<n?n%r:n}function Z(n){return new O.ErrorSource(n)}function W(n,t,r,i,e,u,f){return 3===f||0<=r&&0<=i||1===f&&0<=r||2===f&&0<=i}function X(n,t,r,i,e){var u,u,f,f,f,u=A.BAND_INDEX_CONST,u={Ky:u,iw:u,gwt:!0,pwt:!0,bwt:!1,ywt:0,wwt:!0},f=t?Q(n,r,i,0):K(n,0,e);if(f.DX?(u.Ky=f.Mwt,u.gwt=f.Cwt):(u.iw=f.Mwt,u.pwt=f.Cwt),u.ywt=f.ywt,u.bwt=f.bwt,f.bwt&&!(f.ywt>=n.length)){if(!t&&f.DX||t&&!f.DX)return{bwt:!1};if(f=n[u.ywt],(t||!(0,O.isNumber)(f)&&"$"!==f)&&(!t||"C"!==f&&"c"!==f))return{bwt:!1};f=t?Q(n,r,i,u.ywt):K(n,u.ywt,e),u.ywt=f.ywt,!f.bwt||!t&&!f.DX||t&&f.DX?u.bwt=!1:(u.ywt<n.length&&(u.wwt=!1),t?(u.iw=f.Mwt,u.pwt=f.Cwt):(u.Ky=f.Mwt,u.gwt=f.Cwt),u.bwt=!0)}return u}function Y(n){return(0,O.Swt)(n)||95===n.charCodeAt(0)}function z(n,t,r){for(var i=n,e=t[n],n=!1;i<r&&!Y(e);)++i<r&&(e=t[i]);if(i<r){for(;i<r&&Y(e);)++i<r&&(e=t[i]);i<r&&(n=!0)}return n}function K(n,t,r){var i,e,u,f,o,s,a,c,h,l,v,i={Cwt:!0,bwt:!1},e=n.length;if(!(e<=t||("$"===n[t]&&(i.Cwt=!1,t++),e<=t)))if(o=n[u=t],(f=0,O.isNumber)(o)&&"0"!==o){for(i.DX=!0;u<e&&(0,O.isNumber)(o);)++u<e&&(o=n[u]);if(7<u-t)return i;for(s=u-1,a=0;t<=s;s--,a++)f+=(n[s].charCodeAt(0)-48)*k[a];if(f<=d.maxRowCount)i.Mwt=f-1,i.ywt=u,i.bwt=!0}else if((0,O.Swt)(o)){for(i.DX=!1;u<e&&(0,O.Swt)(o);)++u<e&&(o=n[u]);if(3<(c=u-t)||z(u,n,e))return i;for(l=h=u-1;t<=l;l--){if(!(65<=(v=n[l].charCodeAt(0))&&v<=90||97<=v&&v<=122))return i;f+=((32|v)-96)*w[h-l]}if(f<=d.maxColumnCount)i.Mwt=f-1,i.ywt=u,i.bwt=!0}return i}function Q(n,t,r,i){var e,u,f,o,s,a,t,r,e,u={ywt:i,Mwt:A.BAND_INDEX_CONST,DX:!0,Cwt:!1,bwt:!1},f=n.length;if(f<=i)return u;if("R"===(s=n[o=i])||"r"===s)u.DX=!0,a=t;else{if("C"!==s&&"c"!==s)return u;u.DX=!1,a=r}if(o++,f<=++i)return u.ywt=i,u.Mwt=a,u.Cwt=!0,u.bwt=!0,u;if("["===(s=n[o])&&(i++,o++,u.Cwt=!0),f<=i)return u;if(t=!1,s=n[o],u.Cwt&&"-"===s&&(i++,o++,t=!0),f<=i)return u;if(s=n[o],!(0,O.isNumber)(s))return u.Cwt||(u.ywt=i,u.Mwt=a,u.Cwt=!0,u.bwt=!0),u;for(;o<f&&(0,O.isNumber)(s);)++o<f&&(s=n[o]);if(r=parseInt(n.slice(i,o).join(""),10),u.Cwt){if(f<=o||"]"!==n[o])return u;o++}return r<(u.DX?d.maxRowCount:d.maxColumnCount)?(u.Mwt=u.Cwt?(r=t?-r:r)+a:r-1,u.ywt=o,u.bwt=!0,u):void 0}function q(n,t,r,i){var e,u,f,o,e=n.row||0,u=n.column||0;if(r.source===O.BangSource)i.push("!");else if(r.source&&!(f=m(n,i,r.source,r.endSource)))return void i.push("#","R","E","F","!");8===(o=r.type)||5===o||r.value&&r._error?i.push(r.value.toString()):r.hmt()?(!r.source&&n.addSheetName&&n.source&&m(n,i,n.source,S),C(n.useR1C1,e,u,r.row,r.column,r.rowRelative,r.columnRelative,i)):(!r.source&&n.addSheetName&&n.source&&m(n,i,n.source,S),nn(n.source,n.useR1C1,e,u,r.row,r.column,r.endRow,r.endColumn,r.rowRelative,r.columnRelative,r.endRowRelative,r.endColumnRelative,i,r.Tyt()))}function C(n,t,r,i,e,u,f,o,s){var a,a,a=d.maxRowCount-1;(0===(s=s||0)||1===s)&&-a<i&&i<=2*a&&(i=U(i+=u?t:0,a)),a=d.maxColumnCount-1,W(t,r,i,e=(0===s||2===s)&&-a<e&&e<=2*a?U(e+=f?r:0,a):e,u,f,s)?n?2!==s&&(o.push("R"),0<=i&&(t!==i||!u)&&(u?o.push("["+(i-t)+"]"):o.push(++i+"")),e<0)||1!==s&&(o.push("C"),r===e&&f||(f?o.push("["+(e-r)+"]"):o.push(++e+""))):(0<=e&&(f||o.push("$"),o.push.apply(o,H(e))),i<0||(i++,u||o.push("$"),o.push(i+""))):o.push(O.Errors.Reference.toString())}function nn(n,t,r,i,e,u,f,o,s,a,c,h,l,v){3===(v=v||0)&&(e=0,f=d.maxRowCount-1,v=1),C(t,r,i,e,u,s,a,l,v);var s=A.BAND_INDEX_CONST;t&&e===f&&u===o&&(f===s||o===s)||f===s&&o===s||(l.push(":"),C(t,r,i,f,o,c,h,l,v))}function m(n,t,r,i){if(n.getExternalSourceToken){if(r!==O.BangSource){var r=tn(n,n.getExternalSourceToken(r).split(""),i&&n.getExternalSourceToken(i).split(""));if(!(0<r.length))return!1;t.push.apply(t,r)}return t.push("!"),!0}return!1}function tn(n,t,r){if(!t||0===t.length)return[];var i=t,e;if(en(t,!1,n.lyt)||r&&en(r,!1,n.lyt)){for(i=["'"],e=0;e<t.length;e++)"'"===t[e]&&i.push("'"),i.push(t[e]);if(r)for(i.push(":"),e=0;e<r.length;e++)"'"===r[e]&&i.push("'"),i.push(r[e]);i.push("'")}else if(r)for(i.push(":"),e=0;e<r.length;e++)i.push(r[e]);return i}function _(n,t,r){var i,e;if(n&&0!==n.length){if(!t){if((0,O.isNumber)(n[0]))return!1;if(fn(n))return!1;if(o.test(n[0]))return!1}for(e=0;e<n.length;e++)if(i=n[e],t){if("*"===i||":"===i||"["===i||"]"===i||"?"===i||"\\"===i||"/"===i)return!1}else if(u[i]||O.operaterTypesMap[i]||"\u3000"===i&&(r||b.Common.CultureManager.Fe().isJCKCulture))return!1}return!0}function rn(n){var t,r;if(n&&0!==n.length)for(r=0;r<n.length;r++)if(t=n[r],D[t]||O.operaterTypesMap[t])return;return 1}function en(n,t,r){var i,e,e,u;if((0,O.isDigit)(+n[0]))return 1;if(0<(e=(i=n).lastIndexOf("[")))return 1;if(0===e){if(!(0<(e=n.lastIndexOf("]"))))return 1;if(!rn(u=n.slice(1,e)))return 1;i=n.slice(e+1)}return!_(i,t,r)}function un(n){var t,r,n,t=n.search(/[0-9]/),r=n.substr(0,t),n=parseInt(n.substr(t),10);return(t<=2||3===t&&r<="XFD")&&n<=d.maxRowCount}function fn(n){var n=n.join("").toUpperCase();return!!("RC"===n||"C"===n||"R"===n||e.test(n)||f.test(n)&&un(n))}function F(n){var t=new O.Expression(8);return t.value=n,t}function on(n){var t=n;return t=n&&3<=n.length&&"["===n[0]&&"0"===n[1]&&"]"===n[2]?3===n.length?"":n.substring(3):t}function sn(n,t,r){var i,n,e,u,f,o,n=n.source;return i=n&&(e=n.G3,u=n.S8,f=n.T8,e)&&(o=0<=t&&t<u&&f<=r||u<=t&&0<=r&&r<f)?n:i}function p(n){var t=h.call(this,8e3)||this;return t.Mf=n,t}function an(n,t,r,i,e){return 0===t.uit&&0===t.Twt||!i&&0===t.uit&&4===t.Twt&&(!e||r<n.length-2&&":"===n[r+1].Awt&&0===n[r+2].uit&&4===n[r+2].Twt)}function cn(n,t,r,i,e){return t<=n.startRow()&&r<=n.startColumn()&&t+i>n.endRow()&&r+e>n.endColumn()}function g(){return l.call(this,13)||this}function hn(n,t){this.abt.Iwt(n,this,t)}function x(n){var t=v.call(this,7900)||this;return t.Mf=n,t}function ln(n,t,r){var i,e,u,r,f,o,f,s,a,c,h,l,v,v,d,i=r,e=0,u=t[e],r=Rn(n,t,e,u),f=r.nM;if(!f){if(o=n.keepUnknownFormulas)return;E()}for(i.baseTable=f,e=r.xwt,u=t[++e],f=e;" "===u;)u=t[++e];for("@"!==u&&"["!==u&&(u=t[e=f]),c=a=!(s=1),h=t.length;0!==s&&e<h;)if("["===u&&(s++,u=t[++e]),"#"===u)a&&s<=1&&E(),v=(l=An(t,e,u,s)).Nwt,e=l.xwt,u=l.kwt,s=l.Dwt,a?2===i.hbt&&3===v||2===v&&3===i.hbt?i.hbt=6:3===i.hbt&&8===v||3===v&&8===i.hbt?i.hbt=12:E():i.hbt=v,a=!0;else if("@"===u){for((1<s||a)&&E(),a=!0,i.hbt=1,u=t[++e];" "===u;)u=t[++e];","===u&&E()}else{for(v=e;!j(u)&&"]"!==u&&"["!==u;)if("'"===u&&e++,","===u){for(u=t[++e],d=e;" "===u;)u=t[++e];if("["===u){e=d,u=",";break}}else u=t[++e];if(v<e&&((c||"["===u&&1<s)&&E(),e=(l=dn(i,t,e,u,s,v)).xwt,u=l.kwt,s=l.Dwt,c=!0),"]"===u){if(0===--s)break;e>=t.length&&E(),u=t[++e]}","===u&&(u=t[++e])}a||(i.hbt=n._wt?1:16),c||(i.cbt=0,i.fbt=i.abt.endColumn()-i.abt.startColumn(),i.lbt=1)}function vn(n,t,r){return n.slice(t,r).join("")}function dn(n,t,r,i,e,u){var n,f,o,s,a,c,h,h,u,l,h,n=n,f=[],s=!1,a=!1;if(1<e)s=!0,e--,f=t.slice(u,r),":"===(i=t[++r])&&(a="["===(i=t[++r]),o=(h=gn(t,r,i,e)).sbt,r=h.xwt,i=h.kwt,e=h.Dwt);else if("["===i){for(a=!0,i=t[c=r-1];" "===i;)i=t[--c];":"!==i&&E(),f=wn(f=t.slice(u,c)),o=(h=gn(t,r,i=t[r],e)).sbt,r=h.xwt,i=h.kwt,e=h.Dwt}else n.hbt!==S&&16!==n.hbt||(s=!0),0<(c=(h=t.slice(u,r)).indexOf(":"))?(f=h.slice(0,c),"["!==(o=h.slice(c+1))[0]&&E()):f=h;if(u=mn(n,f,s),n.ubt=f.join(""),n.sbt=n.ubt,o?(l=mn(n,o,a),n.lbt=4,n.sbt=o.join("")):(l=u,n.lbt=2),l<u&&(h=u,u=l,l=h),n.cbt=u,n.fbt=l,++r<t.length)for(i=t[r];" "===i;)i=t[++r];return{xwt:r,kwt:i,Dwt:e}}function wn(n){for(var t=n.length-1;0<=t&&" "===n[t];)t--;for(;0<=t&&" "!==n[t];)t--;return 0<=t?n.slice(t+1,n.length-t-1):n}function Cn(n){for(var t=0,r=n.length,i=0;t<r&&" "===n[t];)t++;for(i=t,t=r-1;i<t&&" "===n[t];)t++;return i<=t?n.slice(i,t+1):n}function mn(n,t,r){var i,e,u,r;if(t&&_n(t,r)){for(i=[],e=0,u=t.length;e<u;e++)"'"===t[e]&&e<u-1&&e++,i.push(t[e]);return t=i,(r=n.abt.getColumnIndexInTable(t.join("")))<0&&E(),r}return-1}function _n(n,t){var r,i,e;if(t)return 1;if(r="","#"!==(i=r=n[0])&&"@"!==r&&" "!==r&&","!==r&&":"!==r&&"["!==r&&"]"!==r){for(e=1;e<n.length;e++){if(","===(r=n[e])||":"===r||"["===r&&"'"!==i||"]"===r&&"'"!==i||"@"===r&&"'"!==i||"#"===r&&"'"!==i)return;i=r}return 1}}function y(n){for(var t,r,i,t=[],i=0;i<n.length;i++)"["!==(r=n[i])&&"]"!==r&&"@"!==r&&"#"!==r&&"'"!==r||t.push("'"),t.push(r);return t.join("")}function pn(n){var t,r,t="";if("#"===(t=n[0])||" "===t||"@"===t||" "===t||","===t||":"===t||"["===t||"]"===t)return 1;for(r=1;r<n.length;r++)if(" "===(t=n[r])||","===t||":"===t||"["===t||"]"===t||"@"===t||"#"===t)return 1}function gn(n,t,r,i){var e,u,u,e=!1;if("["===r)for(e=!0,i++,r=n[++t];" "===r;)r=n[++t];for(u=t;"]"!==r&&(","!==r||1<i);)"'"===r&&t++,r=n[++t];return t<=u&&E(),u=n.slice(u,t),1<i&&i--,{sbt:u=e?u:Cn(u),xwt:t,kwt:r,Dwt:i}}function bn(n){var t,r,t=(0,O.getMapping)()&&(0,O.getMapping)().tableFunctionsMapping;if(!j(t))for(r in t)if(t[r].toLowerCase()===n)return r.toLowerCase();return n}function An(n,t,r,i){for(var e,u,f,o,s,a,e=14,u=t;"]"!==r;)"'"===r&&t++,r=n[++t];for(f=bn(f=vn(n,u,t).toLowerCase().trim()),o=!1,s=0;s<c.length;s++)if(f===(a=c[s])){e=V[f],o=!0;break}if(o||E(),++t>=n.length)i--;else{for(r=n[t];" "===r;)r=n[++t];if(","===r){for(i<=1&&E(),r=n[++t];" "===r;)r=n[++t];"["===r&&(i++,r=n[++t])}1<i&&i--}return{Nwt:e,xwt:t,kwt:r,Dwt:i}}function Rn(n,t,r,i){for(var e,u,f,o,u=0,f=t.length;"["!==i&&r<f;)i=t[++r];return{nM:e=0<r?(o=vn(t,0,r),n.getTableByName(o)):n.getTableByIndex(n.row,n.column),xwt:r,kwt:i}}function E(){throw i().Exp_FormulaInvalid}function jn(n,t,r){var i,e,u,f,o,s,a,i=(0,O.getMapping)()&&(0,O.getMapping)().tableFunctionsMapping,e=(0,O.sR)().d2t,u=i?i["#All"]:e.All.name,f=i?i["#This row"]:e.thisRow.name,o=i?i["#Headers"]:e.Headers.name,s=i?i["#Data"]:e.Data.name,a=i?i["#Totals"]:e.Totals.name;switch(n){case 1:return r?"["+f+"]":"@";case 2:return t?"["+o+"]":o;case 3:return t?"["+s+"]":s;case 8:return t?"["+a+"]":a;case 6:return"["+o+"], ["+s+"]";case 12:return"["+s+"], ["+a+"]"}return t?"["+u+"]":u}function Fn(n,t){var r,i,e,u,f,o,s,a,r,c,h;for(n.unshift(new O.FormulaToken("=",1,0,0,0)),u=[],f=0,e=n.length-1;0<e;e--)n[e].lp===n[e-1].lp&&n[e].Awt===n[e-1].Awt||(u[f]=n[e],f++);for(u[f]=n[e],u.reverse(),o=[],a=s=0;a<u.length;a++,s++)i=xn(u[a]),o[s]=u[a],(r=a+1<u.length?u[a+1].lp:t.length)>u[a].lp+i&&(r=new O.FormulaToken(t.slice(u[a].lp+i,r),7,u[a].lp+i),u[a].ywt=u[a].lp+i-1,o[++s]=r);for(c=0;c<o.length;c++)h=o[c].Awt.trim(),3===o[c].Twt?o[c].Awt='"'+o[c].Awt+'"':"("===h||"{"===h?(o[c].uit=1,o[c].Twt=1):")"!==h&&"}"!==h||(o[c].uit=1,o[c].Twt=2);return o}function xn(n){return 1===n.uit&&"ARRAY"===n.Awt?1:0===n.uit&&3===n.Twt?(n.Ewt||n.Awt).length+2:0===n.uit&&12===n.Twt?n.Awt.length+3:n.Awt.length}function T(n,t,r){var t,i;n&&t&&((i=n[t=t.getName&&t.getName()||"!"])||(i=n[t]=[],n.sheets||(n.sheets=[]),n.sheets.push(t)),i.push(r))}function L(n,t,r,i,e,u){var f,o,f,s;if(n){for(;10===n.type;)n=n.value;if(!(2<=(n=12===n.type?n.value:n).type&&n.type<=6))if(1===n.type)f=n.getRange(e,u),!i.source||n.source&&n.source!==i.source||t.push(f),T(r,n.source||i.source,f);else if(13===n.type)f=n.getRange(e,u),n.source===i.source&&f&&t.push(f),T(r,n.source||i.source,f);else if(8===n.type)n.jwt||(n.jwt=!0,f=M,n.source?n.source.op()&&(f=new O.EvaluateContext(n.source,(0,O.eV)(e,u))):f=i,L(f.getName(n.value),t,r,f,e,u),n.jwt=S);else if(9===n.type)L(n.value,t,r,i,e,u),n.value2&&L(n.value2,t,r,i,e,u);else if(7===n.type)for(s=0;s<n.arguments.length;s++)L(n.arguments[s],t,r,i,e,u)}}function yn(n,t,r,i,e,u,f,o,s){var u,t,a,c;n.setParserOption(u),u=[],t=t.split(""),j(s)&&(s=I.SheetArea.viewport);try{a=!!o||r.op().useR1C1,c=r.Uw(s).getParserContext(!f&&a,(0,O.eV)(i,e),{sheetArea:s}),u=n.parseToTokens(c,t,!1)}catch(n){}return En(n,u=Fn(u,t),t,r,i,e,f,o,s)}function En(n,t,r,i,e,u,f,o,s){var a,c,h,l,o,v,d,w,C,m,_,p,g,b,A,R,j,F,x,y,E,N,k,D;for(void 0===s&&(s=I.SheetArea.viewport),c=S,h=i.Uw(s),l=i.op(),o=!!o||l.useR1C1,l?(a=new B.SheetParserContext(i,!f&&o,(0,O.eV)(e,u),{sheetArea:s}),c=new O.EvaluateContext(h,(0,O.eV)(e,u),!1)):a=new O.ParserContext(M,!1,(0,O.eV)(0,0)),a.ignoreError=!0,v=[],w=0;w<t.length;w++)try{if("["===(d=t[w]).Awt||"#"===d.y4[0]||3===d.Twt)v.push({text:d.Ewt||d.Awt,type:d.uit,subType:d.Twt,canDrag:!1,ranges:d.ranges,value:d.Awt});else if(w=Nn(n,a,t,w,C=[]),m=void 0,0<C.length){for(_=0;_<C.length;_++)if((p=C[_])instanceof O.FormulaToken)v.push({text:r.slice(p.lp,p.ywt+1).join(""),type:p.uit,subType:p.Twt,canDrag:m,ranges:[],value:p.Awt});else if(p.WK){if(b=(g=p.WK).type,A=g.source,R=r.slice(p.lp,p.ywt+1).join(""),j=[],F={},m=!0,x=g.getRange&&g.getRange(e,u),8===b)m=!1,c&&(y=c,L(E=(y=g.source?new O.EvaluateContext(g.source,(0,O.eV)(e,u),!1):y).getName(g.value),j,F,c,e,u));else if(13===b||22===b)m=!1,A&&h&&A.Mf===h.Mf&&x?j.push(x):j=null,T(F,A,x);else if(1===b)if(g.endSource)for(k=g.endSource,D=A.getSources(k),_=0;_<D.length;_++){if(D[_]===h){j.push(x);break}T(F,D[_],x)}else T(F,A||h,x),(!A||h&&A.Mf===h.Mf)&&j.push(x);else j=null;j&&0<j.length?v.push({text:R,type:0,subType:7,canDrag:m,ranges:j,value:R,sheetRanges:F,sheetArea:A&&A.nT||h.nT}):v.push({text:R,type:d.uit,subType:d.Twt,canDrag:m,ranges:j,value:R,sheetRanges:F})}}else v.push({text:d.Awt,type:d.uit,subType:d.Twt,canDrag:!1,ranges:d.ranges,value:d.Awt})}catch(n){v.push({text:d.Awt,type:d.uit,subType:d.Twt,canDrag:!1,ranges:d.ranges,value:d.Awt})}return v}function Nn(n,t,r,i,e){var u,n,t,n,f,f,r,u=r[i];return u&&"function"!=typeof u&&0===u.uit&&(t=n.resolveToken(t,r,n=[],i)-1,1===(f=(n=n[0]).type)||13===f||8===f||5===f||22===f&&n.source)?(f=r[t],r={lp:u.lp,ywt:f.ywt,WK:n},e.push(r),t):i}t=this&&this.__extends||(s=function(n,t){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}s(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Object.defineProperty(d,"__esModule",{value:!0}),d.Vgt=d.getValidaColumnName=d.StructureReferenceResolver=d.obt=d.StructReferenceColumnSpecifier=d.StructReferencePortions=d.SheetReferenceResolver=d.validateSheetName=d.Cmt=d.maxColumnCount=d.maxRowCount=void 0,I=n("Core"),b=n("Common"),O=n("CalcEngine"),B=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),A=n("./dist/plugins/sheetsCalc/calc.ns.js"),R=n("./dist/plugins/sheetsCalc/external-reference.js"),j=b.Common.lt.ht,r=I.util.Vf,n=new b.Common.ResourceManager(I.SR),i=n.getResource.bind(n),d.maxRowCount=I.XmlConstants.Io,d.maxColumnCount=I.XmlConstants.xo,w=[1,26,676],c=["#all","#data","#headers","#totals","#this row"],u={" ":!(M=null),"'":!(S=void 0),"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"\uff08":!0,"\uff09":!0,".":!0,";":!0,",":!0,"`":!0,"+":!0,"~":!0,"\uff01":!0,"":!0,"\u3001":!0,"\uff5d":!0,"\uff5b":!0,"\u3010":!0,"\u3011":!0,"-":!0,"\uff1b":!0,"\uff1a":!0,"\u2018":!0,"\u201c":!0,"\u201d":!0,"\u2019":!0,"\uff0c":!0,"\u3002":!0,"=":!0},e=/^(R|C|RC)?(0*[1-9]\d*)/,f=/^[A-z]{1,3}0*[1-9]\d{0,6}$/,o=/[\u00A2\u00A3\u00A5\u00A6\u00A9\u00AB\u00AC\u00AE\u09E6-\u09EF\u09F2-\u0A03\u0AE2-\u0AF1\u0BE6-\u0BFA\u0E3F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1878-\u187F\u18A9\u18AB-\u18FF\u191D-\u194F\u196E\u196F\u1975-\u197F\u19AA-\u19C0\u19C8-\u19FF\u2000-\u200F\u2011\u2012\u2017\u201A\u201B\u201E\u201F\u2022-\u2024\u2028-\u202F\u2031\u2034\u2036-\u203A\u203C-\u2070\u2072\u2073\u2075-\u207E\u2080\u2085-\u208F\u2095-\u20CF\u2100\u2101\u2104\u2106\u2108\u2114\u2117\u2118\u211E-\u2120\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2152\u2155-\u215A\u215F\u2189-\u218F\u219A-\u21D1\u21D3\u21D5-\u21FF\u2201\u2204-\u2206\u2209\u220A\u220C-\u220E\u2210\u2212-\u2214\u2216-\u2219\u221B\u221C\u2221\u2222\u2224\u2226\u222D\u222F-\u2233\u2238-\u223B\u223E-\u2247\u2249-\u224B\u224D-\u2251\u2253-\u225F\u2262\u2263\u2268\u2269\u226C\u226D\u2270-\u2281\u2284\u2285\u2288-\u2294\u2296-\u2298\u229A-\u22A4\u22A6-\u22BE\u22C0-\u2311\u2313-\u245F\u24B6-\u24CF\u24EA-\u24FF\u254C-\u254F\u2575-\u2580\u2590\u2591\u2596-\u259F\u25A2\u25AA-\u25B1\u25B4\u25B5\u25B8-\u25BB\u25BE\u25BF\u25C2-\u25C5\u25C9\u25CA\u25CC\u25CD\u25D2-\u25E1\u25E6-\u25EE\u25F0-\u2604\u2607\u2608\u260A-\u260D\u2610-\u261B\u261D\u261F-\u263F\u2641\u2643-\u265F\u2662\u2666\u266B\u266E\u2670-\u2BFF\u3004\u3018-\u301C\u3020\u302A-\u3030\u3036\u3037\u303F\u321D-\u321F\u322A-\u3230\u3233-\u3238\u323A-\u325F\u327C-\u327E\u3280-\u32A2\u32A9-\u3302\u3304-\u330C\u330E-\u3313\u3315-\u3317\u3319-\u3321\u3324\u3325\u3328-\u332A\u332C-\u3335\u3337-\u333A\u333C-\u3348\u334B\u334C\u334E-\u3350\u3352-\u3356\u3358-\u337A\u337F\u3385-\u3387\u33CB\u33CC\u33D4\u33D7\u33D9\u33DA\u33DE-\u33FF\uD80B-\uD83F\uFDFC-\uFE2F\uFE32\uFE45-\uFE48]/,k=[1,10,100,1e3,1e4,1e5,1e6,1e6],d.Cmt=_,d.validateSheetName=_,D={"'":1,"[":1,"]":1,"?":1,"%":1," ":1},h=O.TokenResolver,t(p,h),p.prototype.resolveToken=function(n,t,r,i){var e,u,f,o,s,a,c,h,l,v,d,w,h,C,m,w,m,l,h,C,l,w,h,_,p,g,e=n.useR1C1,u=n.row||0,f=n.column||0,s=r.length,a=r[i],c=a.Awt,h=a.uit,l=a.Twt;if(0!==h&&6!==l)return!1;if(0===h&&0===l&&i<s-2&&":"===r[i+1].Awt&&12===r[i+2].Twt&&r[i+2].Awt.indexOf(":")<0||0===h&&12===l){if(C=h=void 0,m=c.lastIndexOf(":"),w=c.lastIndexOf("]"),(c=b.Common.zf.fJ(c,"'")&&b.Common.zf.dT(c,"'")?c.substring(1,c.length-1):c)&&(w<m?(h=c.substring(0,m-1),C=c.substring(m)):("'"===(h=c).charAt(0)&&(h=h.substring(1,h.length-1)),0===l&&(C=r[i+2].Awt,i+=2,"'"===C.charAt(0))&&(C=C.substring(1,C.length-1)))),i++,w=!!h,(h=on(h))&&(v=(v=c?n.getExternalSource("",h):O.BangSource)||Z(h),C=on(C))&&(v instanceof R.ExternalSource?(d=v.getPeerSource(C)).jfe=!0:d=(d=n.getExternalSource("",C))||Z(C)),(a=r[i])&&"["===a.y4[0])return!1;if(!a)return F(c);c=a.Awt}if(m=i===s-1?M:r[i+1],an(r,a,i,e,!0)){if(l=n&&n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray,!(h=X(a.y4,e,u,f,l)).bwt&&!w)return!1;if(a.Twt=7,h.bwt&&h.wwt){if(C=h.Ky,l=h.iw,w=h.gwt,h=h.pwt,i<s-2&&5===m.uit&&":"===m.Awt&&an(r,m=r[i+2],i+2,e,!1)&&(_=X(m.y4,e,u,f)).bwt&&C===A.BAND_INDEX_CONST==(_.Ky===A.BAND_INDEX_CONST)&&l===A.BAND_INDEX_CONST==(_.iw===A.BAND_INDEX_CONST))return u=C===A.BAND_INDEX_CONST?0:u,f=l===A.BAND_INDEX_CONST?0:f,{index:i+3,expr:(0,O.lJ)(v,d,C-(w?u:0),l-(h?f:0),_.Ky-(_.gwt?u:0),_.iw-(_.pwt?f:0),w,h,_.gwt,_.pwt,u,f)};if(C===A.BAND_INDEX_CONST||l===A.BAND_INDEX_CONST){if(e)return C-=C!==A.BAND_INDEX_CONST&&w?u:0,l-=l!==A.BAND_INDEX_CONST&&h?f:0,{index:i+1,expr:(0,O.lJ)(v,d,C,l,C,l,w,h,w,h,u,f)};if(!v)return!1;o=F(c)}if(!o)return j(v)&&(v=sn(n,u,f)),{index:i+1,expr:o=(0,O.knt)(v,d,p=C-(w?u:0),g=l-(h?f:0),w,h)}}else o=F(c)}else if(6===a.Twt)(o=new O.Expression(5)).value=O.CalcError.parse(a.Awt);else{if(!v)return!1;o=F(c)}return v&&(o.source=v),d&&(o.endSource=d),{index:i+1,expr:o}},p.prototype.unparse=function(n,t,r,i){var e=r&&r.type;return(1===e||8===e||5===e)&&(q(n,t,r,i),!0)},d.SheetReferenceResolver=p,(n=$=d.StructReferencePortions||(d.StructReferencePortions={}))[n.ThisRow=1]="ThisRow",n[n.Headers=2]="Headers",n[n.Data=3]="Data",n[n.Totals=8]="Totals",n[n.HeadersAndData=6]="HeadersAndData",n[n.DataAndTotals=12]="DataAndTotals",n[n.All=14]="All",n[n.NotSpecific=16]="NotSpecific",(n=G=d.StructReferenceColumnSpecifier||(d.StructReferenceColumnSpecifier={}))[n.All=1]="All",n[n.NotSpecific=1]="NotSpecific",n[n.SingleColumn=2]="SingleColumn",n[n.ColumnRange=4]="ColumnRange",l=O.Expression,t(g,l),g.prototype.tableName=function(){return this.abt.tableName()},Object.defineProperty(g.prototype,"baseTable",{get:function(){return this.abt},set:function(n){this.abt=n,this.source=n.source()},enumerable:!1,configurable:!0}),g.prototype._K=function(){this.Owt=this.abt.startColumn()},g.prototype.columnReferenceStart=function(){return this.cbt+this.abt.startColumn()},g.prototype.columnReferenceEnd=function(){return this.fbt+this.abt.startColumn()},g.prototype.referencePortions=function(){return this.hbt},g.prototype.referenceColumnSpecifier=function(){return this.lbt},g.prototype.getRange=function(n,t,r){var i,e,u,f,o,s,a,c,h,l,v,d,e,i=this,e=i.abt;switch(i._K(),h=e.startRow(),l=e.endRow(),v=e.hasTotalsRow(),d=e.hasHeadersRow(),i.hbt){case 3:case 16:u=d?h+1:h,o=v?l-1:l;break;case 2:if(d)o=u=h;else{if(!r)return M;o=u=h-1}break;case 8:if(v)o=u=l;else{if(!r)return M;o=u=l+1}break;case 1:o=u=n;break;case 6:u=h+(r&&!d?-1:0),o=v?l-1:l;break;case 12:u=d?h+1:h,o=l+(r&&!v?1:0);break;default:u=h+(r&&!d?-1:0),o=l+(r&&!v?1:0)}if(22===i.type){if(f=i.abt.getColumnIndexInTable(i.ubt),s=i.abt.getColumnIndexInTable(i.sbt),-1===f||-1===s)return M}else f=i.columnReferenceStart(),s=i.columnReferenceEnd();return e=e.endColumn(),1===i.lbt&&(s=e),e<f||e<s?(i._error=!0,M):o<u||!r&&u<h||!r&&l<o?M:(0,O.Rwt)(u,f,a=o-u+1,c=s-f+1)},g.prototype.offsetWhenInsertRemoveColumn=function(n,t,r,i){var e,u,i,r,e=this,u=e.Owt;return j(u)&&(e._K(),u=e.Owt),j(u)||n<u||n===u&&r&&!i||n>e.fbt+u?e:(t=r?t:-t,i=n-u,(r=new g).baseTable=e.abt,r.fbt=e.fbt+t,r.cbt=e.cbt,n<=u+e.cbt&&(r.cbt+=t,r.cbt<i)&&(r.cbt=i),r.lbt=e.lbt,r.hbt=e.hbt,r.fbt<r.cbt?O.kyt:r)},g.prototype.offsetWhenCopy=function(n,t,r,i,e,u,f,o,s,a){var c,h,l,v,r,i,e,u,d,w,c=this,h=new B.SheetParserContext(t.Mf,t.Lbt.useR1C1,(0,O.eV)(r,i)),l=h.getTableByIndex(r,i),v=c.offset();return l&&(r=r-e,i=i-u,e=f-e,u=o-u,d=void 0,(d=(n===t?h:w=new B.SheetParserContext(n.Mf,n.Lbt.useR1C1,(0,O.eV)(r,i))).getTableByIndex(r,i))!==l)&&d===c.abt&&cn(d,e,u,s,a)&&cn(l,f,o,s,a)&&(v.baseTable=l),v},g.prototype.Bwt=function(n){var t,r,i,t=this,r=new g;return r.baseTable=t.abt,r.fbt=t.fbt,r.cbt=t.cbt,2===t.lbt&&n&&(i=t.abt.endColumn()-t.abt.startColumn()+1,r.cbt+=n%=i,r.cbt<0&&(r.cbt+=i),r.fbt=r.cbt),r.lbt=t.lbt,r.hbt=t.hbt,r},g.prototype.offset=function(n,t,r){var i,e,i=this,e=new g;return e.baseTable=i.baseTable,e.hbt=i.hbt,e.cbt=i.cbt,e.fbt=i.fbt,e.lbt=i.lbt,e},g.prototype.Lwt=function(n,t){var r=this.abt;return n>=r.startRow()&&t>=r.startColumn()&&n<=r.endRow()&&t<=r.endColumn()},g.prototype.Fwt=function(n,t,r){this.abt.Pwt(n,t,r)},a=g,d.obt=a,v=O.TokenResolver,t(x,v),x.prototype.resolveToken=function(n,t,r,i){var e,r,u,f,e,o,s,e,e=r[i],r=r[i+1];if(0===e.uit){if(f=u=void 0,0===e.Twt||7===e.Twt)u=e.Awt;else{if(12!==e.Twt||!r||0!==r.uit||0!==r.Twt||"["!==r.y4[0])return M;u=(e="'"===(e=e.Awt)[0]?e.substr(1,e.length-2):e)+r.Awt,f=!0}if("]"===u.charAt(u.length-1))try{return o=new a,ln(n,u.split(""),o),o.baseTable?(o.abt.Mf.NMi&&((s=o).type=22,s.Iwt=hn),f?{index:i+2,expr:o}:o):new O.Expression(0)}catch(n){}else if(e=n.getTableByName&&n.getTableByName(u))return x.create(e)}return M},x.prototype.unparse=function(n,t,r,i){var e,u,f,o,s,a,t,c,o,f,u,f,o;if(13!==r.type&&22!==r.type)return!1;if(u=(e=r).abt.Gwt,f=j(u)?e.abt.tableName():u,n.Sbt)o=e.getRange(n.row,n.column,!0),q(n,t,s=(0,O.lJ)(e.source,M,o.row,o.col,o.row+o.rowCount-1,o.col+o.colCount-1,!1,!1,!1,!1),i);else{if(t=i.length,22===e.type&&e.baseTable.Mf.xT)a=!0;else if(16===e.hbt&&1===e.lbt)return i.push(f),void(n.lyt&&i.push("[]"));(c=n.source===e.abt.source()&&e.Lwt(n.row,n.column))&&!n.lyt&&!e.abt.Mf.NMi||(o=j(u)?e.abt.tableName():u,(f=e.abt.Mf)&&f.NMi&&!(0,d.validateSheetName)(o.split(""))&&(o=tn(n,o.split(""),null).join("")+"!"),i.push(o)),i.push("["),16!==e.hbt&&(u=jn(e.hbt,1!==e.lbt,n.lyt),i.push(u)),1!==e.lbt&&(1===e.hbt&&!n.lyt||16===e.hbt||i.push(", "),(f=22===r.type?e.ubt:e.abt.getColumnName(e.cbt))?f=y(f):a=!0,a||(4===e.lbt?(o=22===r.type?e.sbt:e.abt.getColumnName(e.fbt))?(o=y(o),i.push("[",f,"]:[",o,"]")):a=!0:1===e.hbt&&!n.lyt&&!pn(f)||16===e.hbt?i.push(f):i.push("[",f,"]"))),a?(i.length=t,i.push("#REF!")):i.push("]")}return!0},x.create=function(n,t,r,i,e){void 0===t&&(t=$.NotSpecific),void 0===r&&(r=G.NotSpecific),void 0===i&&(i=0),void 0===e&&(e=n.endColumn()-n.startColumn());var u=new a;return u.baseTable=n,u.hbt=t,u.cbt=i,u.fbt=e,u.lbt=r,u},d.StructureReferenceResolver=x,d.getValidaColumnName=y,V={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},d.Vgt=yn},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(n,t,r){var i,e,i=this&&this.__createBinding||(Object.create?function(n,t,r,i){void 0===i&&(i=r);var e=Object.getOwnPropertyDescriptor(t,r);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(n,i,e)}:function(n,t,r,i){n[i=void 0===i?r:i]=t[r]}),e=this&&this.__exportStar||function(n,t){for(var r in n)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,n,r)};Object.defineProperty(t,"__esModule",{value:!0}),e(r("./dist/plugins/sheetsCalc/calc.ns.js"),t),e(r("./dist/plugins/sheetsCalc/parser-sheets.js"),t),e(r("./dist/plugins/sheetsCalc/calc-spreadjs.js"),t),e(r("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),t),e(r("./dist/plugins/sheetsCalc/worksheet-formula.js"),t),r("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(n,t,r){var $,t,i,e,A,G,R,u,c,r,j,F,x,f,y,d,E,P,V,N,H,w,k,o,D,I,U,e;function O(n){n.forEach(function(n){var n=n.Uw();n.zE(),delete n.G3})}function C(n,a,c,h){$.GC$.each(n,function(n,t){var r,i,e,u,f,o,t,s,r,r=t.getName(),i=t.getRow(),e=t.getColumn(),u=t.getExpression(),f=t.getComment(),o=t.getFormatter&&t.getFormatter(),t=t.getSheetTabName&&t.getSheetTabName();u&&(r={name:r,formula:s=o||a.unparse(c,u,i,e,!1,!0),sheetTabName:t,row:i,col:e},f&&(r.comment=f),h.push(r))})}function Z(n,t){var n,r,i,n=E(n);if("str"===t)r=n;else if("b"===t)r="1"===n;else if("e"===t){switch(i=x,n){case"#DIV/0!":i=7;break;case"#N/A":i=42;break;case"#NAME?":i=29;break;case"#NULL!":i=0;break;case"#NUM!":i=36;break;case"#REF!":i=23;break;case"#VALUE!":i=15}r=i!==x?{error:n,code:i}:x}else r=parseFloat(n);return r}Object.defineProperty(t,"__esModule",{value:!0}),$=r("Core"),t=r("Common"),i=r("CalcEngine"),e=r("./dist/plugins/sheetsCalc/calc-spreadjs.js"),A=r("./dist/plugins/sheetsCalc/calc-spreadjs.js"),G=r("./dist/plugins/sheetsCalc/external-reference.js"),R=r("./dist/plugins/sheetsCalc/calc-extra-save.js"),u=e.SpreadSource,c=t.Common.zf.Gmt,r=new t.Common.ResourceManager($.SR),j=r.getResource.bind(r),F=void 0,x=null,f=t.Common.kh,y=t.Common.lt.ht,d=$.mt.o1,E=$.mt.c1,P=$.mt.xr,V=$.mt.go,N=$.Util.Sr,H=$.IndexHelper.$i,w=$.Util.addXLFNPrefix,k=$.mt.n1,o=$.mt.vo,D=$.Util.io,I=$.XFileConstants.mo,U=$.XFileConstants.Ki,(e=$.Workbook.prototype).Qp=function(n){var t,r,t=this,r=t.Lp;t.Lp=new i.CalcService,t.Lp.useR1C1=1===t.options.referenceStyle,t.Lp.allowDynamicArray=t.options.allowDynamicArray,t.Lp.iterativeCalculation=t.options.iterativeCalculation,t.Lp.iterativeCalculationMaximumIterations=t.options.iterativeCalculationMaximumIterations,t.Lp.iterativeCalculationMaximumChange=t.options.iterativeCalculationMaximumChange,n&&r&&t.Lp.cloneFrom(r),t.yC=new u(t),t.wC=t.Lp.getGlobalSourceModel(t.yC)},e.addCustomFunction=function(n){this.Uwt(n)},e.Uwt=function(n){if(!(n&&n instanceof i.Functions.Function))throw new Error(j().Exp_InvalidCustomFunction);n.name=c(n.name),this.Amt[n.name]=n},e.getCustomFunction=function(n){return n?this.Amt[c(n)]:F},e.removeCustomFunction=function(n){n&&(delete this.Amt[c(n)],this.Hwt())},e.clearCustomFunctions=function(){this.Amt={}},e.addCustomName=function(n,t,r,i,e){this.zwt(this.hyt,n,t,r,i,!1,e)},e.Vwt=function(n){return!this.hyt[c(n)]},e.isValidCustomName=function(n){return n&&$.mt.P0(n)&&this.Vwt(n)},e.pp=function(n,t,r,i,e,u,f,o){var s,a,s=this;if(!t||!r)throw new Error(j().Exp_InvalidCustomName);o&&s.Lp?(a=o.Ywt(r,i,e),n[c(t)]=new A.FormatterNameInfo(t,r,o.name(),a,i,e)):s.zwt(n,t,r,i,e,u,f)},e.zwt=function(n,t,r,i,e,u,f){var o,s,s,a,o,o=this;if(!t||!r||!u&&!o.isValidCustomName(t))throw new Error(j().Exp_InvalidCustomName);if(o.Lp){if(s=(s=(0,$.jf)(this))?s.Uw():x,a=void 0,u)try{a=o.Lp.parse(s,r,i,e,!1,!1,!0)}catch(n){}else a=o.Lp.parse(s,r,i,e);n[c(t)]=new A.NameInfo(t,a,i,e,f),u||((o={})[t]=t,this.Zwt(o,!0))}},e.Wwt=function(n,t,r,i,e,u,f,o){var s,r,s=this;if(!t||!r||!f&&!s.isValidCustomName(t))throw new Error(j().Exp_InvalidCustomName);s.Lp&&(n[c(t)]=new A.NameInfo(t,i,e,u,o),f||((r={})[t]=t,this.Zwt(r,!0)))},e.getCustomName=function(n){return n?this.hyt[c(n)]:F},e.xO=function(n){return n?this.bp[c(n)]:F},e.getCustomNames=function(){var r=[];return $.GC$.each(this.hyt,function(n,t){r.push(t)}),r},e.Qwt=function(){var r=[];return $.GC$.each(this.bp,function(n,t){r.push(t)}),r},e.removeCustomName=function(n){var t;n&&(delete this.hyt[c(n)],(t={})[n]=n,this.Zwt(t,!1))},e.o3=function(n){var t;n&&(delete this.bp[c(n)],(t={})[n]=n,this.Zwt(t,!1))},e.clearCustomNames=function(){var n=this.hyt;this.hyt={},this.Zwt(n,!1)},e.Kwt=function(){var n=this.bp;this.bp={},this.Zwt(n,!1)},e.Zwt=function(n,t){var r,i;if(n){for(i in r=this.wC,n)r&&r.updateNameCalc(i,t);this.Hwt()}},e.Hwt=function(){var n;this.Lp&&!this.Lp.IsSuspended()&&(n=this.getActiveSheet())&&(n.suspendPaint(),this.Lp.recalculateAll(),n.resumePaint())},e.getCalcService=function(){return this.Lp},e.op=function(){return this.Lp},e.suspendCalcService=function(n){this.Lp&&this.Lp.suspend(n)},e.resumeCalcService=function(n){this.Lp&&this.Lp.resume(n)},e.getCircularReference=function(){var n,t,r,i,n=this.Jwt(),t=[];for(r in n=this.Xwt(n))f(n,r)&&(i=r.split("\\"),t.push({row:+i[1],col:+i[2],rowCount:1,colCount:1,sheetName:i[0]}));return t},e.updateExternalReference=function(n,t,r){this.suspendPaint(),this.suspendCalcService(),this._p._6(n,t,r),this.resumeCalcService(!1),this.resumePaint()},e.getExternalReferences=function(n){return this._p.myt(n)},e.Jwt=function(){var h={};return this.sheets.forEach(function(n){var t,r,i,e,u,f,o,s,a,c,c,t=n.b3(),r=n.getRowCount(),i=n.getColumnCount(),e=n.name();if(t)for(u=0;u<r;u++)for(f=0;f<i;f++)for(o=e+"\\"+u+"\\"+f,s=n.qwt(u,f),!h[o]&&0<s.length&&(h[o]={from:[],to:[]}),a=0;a<s.length;a++)c=(c=s[a]).sheetName+"\\"+c.row+"\\"+c.col,h[c]||(h[c]={from:[],to:[]}),h[c].from.push(o),h[o].to.push(c)}),h},e.Xwt=function(r){var i,n,t;function e(n,t){n.splice(n.indexOf(t),1)}for(i=!0;0<Object.keys(r).length&&i;)for(t in i=!1,n=function(t){var n;f(r,t)&&(0===(n=r[t]).from.length?(n.to.forEach(function(n){e(r[n].from,t)}),delete r[t],i=!0):0===n.to.length&&(n.from.forEach(function(n){e(r[n].to,t)}),delete r[t],i=!0))},r)n(t);return r},$.Workbook.ch("calc",{priority:1e3,init:function(){this.Amt={},this.hyt={},this.bp={},this._p=new G.ExternalReferenceManager},toJson:function(n){var t,r,r,o,r,i,e,s,t,a,t=this,r=t.Amt;$.GC$.isEmptyObject(r)||(n.customFunctions=r),r=t._p.toJSON(t),$.GC$.isEmptyObject(r)||(n.externalReference=r),o=[],r=[],i=t.getCustomNames(),e=t.Qwt(),s=t.Lp,t=this.getActiveSheet(),a=t?t.Uw():x,i&&s&&($.GC$.each(i,function(n,t){var r,i,e,u,t,f,r,r=t.getName(),i=t.getRow(),e=t.getColumn(),u=t.getExpression(),t=t.getComment();u&&(r={name:r,formula:f=s.unparse(a,u,i,e,!1,!0),row:i,col:e},t&&(r.comment=t),o.push(r))}),C(e,s,a,r),0<o.length&&(n.names=o),0<r.length)&&(n.formatStringNames=r)},wh:function(n,t,o){var r,i,i,e,u,f,s,i,e,a,u,c,u,h,l,v,u,i,r=this,i=r.Amt;$.GC$.isEmptyObject(i)||(n.workbook.lossless.customFunctions=i),r._p&&(e=(i=r._p.wh(n)).externalReferencesNode,u=i.externalLinks,0<(f=i.count))&&(n.workbook.c_.push(e),n.externalLinks=u),s=[],i=d(n.workbook,"definedNames"),e=r.getCustomNames(),a=r.Lp,u=this.getActiveSheet(),c=u?u.Uw():x,u=r.yC,h=u&&u.getUsedCustomNames()||{},e&&0<e.length&&a&&(i||n.workbook.c_.push(i={n_:"definedNames",c_:[]}),l=i.c_,v=!o||!1!==o.includeUnusedNames,$.GC$.each(e,function(n,t){var r,i,e,u,t,f,r,t,r=t.getName(),i=t.getRow(),e=t.getColumn(),u=t.getExpression(),t=t.getComment();u&&(v||h[r])&&(r={n_:"definedName",name:r,comment:t,c_:[f=w((0,A.encodeNameFormula)(a.unparse(c,u,i,e,!1,!0)))]},o&&o.includeCalcModelCache&&(t=(0,R.exprToJSON)(u),s.push(t),r.e=s.length-1),l.push(r))})),0<s.length&&(n.workbook.lossless.exprs=s),u=[],(i=r.Qwt())&&0<i.length&&a&&(C(i,a,c,u),0<u.length)&&(n.workbook.lossless.formatStringNames=u),n.workbook.lossless.idMap=(0,R.dbt)(a)},preFromSJSFormat:function(n,M,T){var t,r,i,e,u,f,o,s,a,c,h,l,v,o,d,w,C,m,_,p,g,b,A,R,j,F,L,x,y,E,N,k,D,I,I,k,O,B,S,J,t=P(n.workbook,"externalReferences"),r=n.externalLinks;if(t&&r&&t.c_&&0<t.c_.length){for(e in i={},r)if(r.hasOwnProperty(e)){if(u=r[e],f={},o=P(u,"externalBook")){if(a=[],(s=P(o,"sheetNames"))&&s.c_&&s.c_.length){for(c=0,h=s.c_.length;c<h;c++)(l=s.c_[c])&&(v=l.val)&&(v=$.mt.Nfe(v),a.push(v));f.sheetNames=a}if(o=P(o,"sheetDataSet")){if(d={},w=V(o,$.XFileConstants.bo))for(C=0,m=w.length;C<m;C++)if(p=+(_=w[C]).sheetId,g="1"===_.refreshError,b=d[v=a[p]]={},g&&(b.isNew=!0),A=V(_,"row"))for(R=0,j=A.length;R<j;R++)if((F=A[R])&&(x=b[L=F.r-1]={},y=V(F,"cell")))for(E=0,N=y.length;E<N;E++)D=void 0,(k=y[E])&&((I=k.r)&&(D=H(I)),I=k.t,O=void 0,(k=P(k,"v"))&&(O=Z(k,I)),x[D]=O);f.data=d}}f.option=u.option,i[e]=f}for(B={},J=(S=t.c_).length,c=0;c<J;c++)B[c+1]=i[S[c][U]];this._p=new G.ExternalReferenceManager(B)}},yh:function(e,r,i){var u,t,f,o,n,s,a,c,h,l,v,d,w,C,m,m,_,p,g;function b(){var n,n;return t||(n=(n=(0,$.jf)(u)||u.sheets[0])?n.Uw():x,t=n&&n.getParserContext(!1)),t}if(f=(u=this).Lp,o=i&&!i.fullRecalc,n=$.Util.wo(i,u.v2),f&&(f.suspend(),f.lb=o),u.clearCustomNames(),(s=u.sheets).forEach(function(n){n.Uw().G3=!0}),a=e.workbook.lossless,i&&(i.$wt=(0,R.vbt)(f,a)),(c=r.workbookNames)&&0<c.length&&c.forEach(function(n){var t=n.name,r=E(n),i=n.comment;a&&a.exprs&&a.exprs[n.e]?u.Wwt(u.hyt,t,""+(0,A.processFunctionPrefix)($.mt.n1(r)),(0,R.exprFromJSON)(a.exprs[n.e],b()),0,0,!0,i,!0):r&&u.zwt(u.hyt,t,""+(0,A.processFunctionPrefix)($.mt.n1(r)),0,0,!0,i,!0)}),u.Kwt(),h=a&&a.formatStringNames)for(l=0;l<h.length;l++)v=h[l],y(v.sheetTabName)&&u.pp(this.bp,v.name,v.formula,v.row,v.col,!0,v.comment,F,!0);if(u.clearCustomFunctions(),d=a&&a.customFunctions)for(w in d)d.hasOwnProperty(w)&&(C=d[w],m=(0,$.getTypeFromString)(C.typeName))&&((m=new m).fromJSON(C),u.Uwt(m));n||(_=[],p=e.workbook.rels&&e.workbook.rels.c_,(g=P(e.workbook,I).c_).forEach(function(n){var t,t,n,n,n,r,i,t=D(k(n.name)),t=u.getSheetFromName(t),n=n[U],n=N(p,n),n=n&&n.Target;n&&(r=u.getSheetRelsName(n),i=void 0,i=(-1<n.indexOf("xl/chartsheets")?e.chartsheets:e.sheets)[r],_.push({sheet:t,sheetData:i}))}),_.forEach(function(n){n.sheet&&n.sheet.nameFunctionFromSJSFormat(n.sheetData,r,i)}),_.forEach(function(n,t){n.sheet&&n.sheet.formulaFromSJSFormat(n.sheetData,r,i)})),i.incrementLoadTask.addTask(function(n,t,r){f&&(o?f.resumeWithoutCalc():f.resume(!1),delete f.lb),O(s)},[f,e,i],o?F:j().STEP.startCalc,function(){return o?$.STEP_RATE.end:$.STEP_RATE.loadFileData+$.STEP_RATE.parseFile+$.STEP_RATE.loadSheetDataWithCalc+$.STEP_RATE.loadSheetFormulaWithCalc})},Mb:function(e,t,r){var u,f,o,n,s,i,a,c,h,l,v,d,w,C,C,m,_,p,u=this,f=u.Lp,o=r&&!r.fullRecalc,n=$.Util.wo(r,u.v2);if(f&&(f.suspend(),f.lb=o),u.clearCustomNames(),(s=u.sheets).forEach(function(n){n.Uw().G3=!0}),i=e.workbook.lossless,(a=t.workbookNames)&&0<a.length&&a.forEach(function(n){var t=n.name,r=E(n),n=n.comment;r&&u.zwt(u.hyt,t,""+(0,A.processFunctionPrefix)($.mt.n1(r)),0,0,!0,n,!0)}),u.Kwt(),c=i&&i.formatStringNames)for(h=0;h<c.length;h++)l=c[h],y(l.sheetTabName)&&u.pp(this.bp,l.name,l.formula,l.row,l.col,!0,l.comment,F,!0);if(u.clearCustomFunctions(),v=i&&i.customFunctions)for(d in v)v.hasOwnProperty(d)&&(w=v[d],C=(0,$.getTypeFromString)(w.typeName))&&((C=new C).fromJSON(w),u.Uwt(C));n||(m=[],_=e.workbook.rels&&e.workbook.rels.c_,(p=P(e.workbook,I).c_).forEach(function(n){var t,t,n,n,n,r,i,t=D(k(n.name)),t=u.getSheetFromName(t),n=n[U],n=N(_,n),n=n&&n.Target;n&&(r=u.getSheetRelsName(n),i=void 0,i=(-1<n.indexOf("xl/chartsheets")?e.chartsheets:e.sheets)[r],m.push({sheet:t,sheetData:i}))}),m.forEach(function(n){n.sheet&&n.sheet.nameFunctionFromSJSFormat(n.sheetData,t,r)}),m.forEach(function(n){n.sheet&&n.sheet.formulaFromSJSFormat(n.sheetData,t,r)})),r.incrementLoadTask.addTask(function(n,t,r){var i;f&&(o?f.resumeWithoutCalc():(f.resume(!1),delete f.tMt,(i=u.getActiveSheet())&&i.zw()),delete f.lb),O(s)},[f,e,r])},preFromJson:function(n,t,r){this._p=new G.ExternalReferenceManager(n.externalReference)},fromJson:function(n,t,r){var i,e,u,f,o,s,a,c,h,l,v,d,w,C,m,_,p,g,g,b,A,R,i=this,e=i.Lp,u=n.noRecalc||r&&r.doNotRecalculateAfterLoad;if(e&&(e.suspend(),e.lb=u),i.clearCustomNames(),a=[],s=n.sheets)for(h in s)"string"==typeof h&&(l=s[h],o=i.getSheetFromName(l.name||h))&&(o.Uw().G3=!0);if(v=n.names)for(d=0;d<v.length;d++)w=v[d],i.zwt(this.hyt,w.name,w.formula,w.row,w.col,!0,w.comment);if(i.Kwt(),C=n.formatStringNames)for(d=0;d<C.length;d++)w=C[d],y(w.sheetTabName)&&i.pp(this.bp,w.name,w.formula,w.row,w.col,!0,w.comment);if(i.clearCustomFunctions(),m=n.customFunctions)for(_ in m)m.hasOwnProperty(_)&&(p=m[_],g=(0,$.getTypeFromString)(p.typeName))&&((g=new g).fromJSON(p,t),i.Uwt(g));if(s){for(h in f=0,s)"string"==typeof h&&(l=s[h],o=i.getSheetFromName(l.name||h))&&(a.push(o),o.nameFunctionsFromJSON(l,t,r),f++);for(c=a.length,f=0;f<c;f++)(o=a[f]).formulaFromJSON(s[o.name()],t,r)}for(e&&(u?e.resumeWithoutCalc():(e.resume(!1),delete e.tMt),delete e.lb),b=0,A=a;b<A.length;b++)(R=(o=A[b]).Uw()).zE(),delete R.G3},Yp:function(n,t,r){var o,s,a,i,c,e,h,u,f,l,v,d,w,C,m,_,p,g,g,o=this,s=o.Lp,a=n.noRecalc||r&&r.doNotRecalculateAfterLoad;if(s&&(s.suspend(),s.lb=a),o.clearCustomNames(),e=n.sheets,h=[],e)for(f in e)"string"==typeof f&&(l=e[f],c=o.getSheetFromName(l.name||f))&&(c.Uw().G3=!0);if(v=n.names)for(d=0;d<v.length;d++)w=v[d],o.zwt(this.hyt,w.name,w.formula,w.row,w.col,!0,w.comment);if(o.Kwt(),C=n.formatStringNames)for(d=0;d<C.length;d++)w=C[d],y(w.sheetTabName)&&o.pp(this.bp,w.name,w.formula,w.row,w.col,!0,w.comment);if(o.clearCustomFunctions(),m=n.customFunctions)for(_ in m)m.hasOwnProperty(_)&&(p=m[_],g=(0,$.getTypeFromString)(p.typeName))&&((g=new g).fromJSON(p,t),o.Uwt(g));if(e){for(f in i=0,e)"string"==typeof f&&(l=e[f],c=o.getSheetFromName(l.name||f))&&(h.push(c),c.nameFunctionsFromJSON(l,t,r),i++);for(u=h.length,i=0;i<u;i++)(c=h[i]).formulaFromJSON(e[c.name()],t,r)}r.incrementLoadTask.addTask(function(n,t,r){var i,e,u,f;for(s&&(a?s.resumeWithoutCalc():(s.resume(!1),delete s.tMt,(i=o.getActiveSheet())&&i.zw()),delete s.lb),e=0,u=h;e<u.length;e++)(f=(c=u[e]).Uw()).zE(),delete f.G3},[s,n,r])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(f,n,t){var g,r,N,w,b,C,k,A,m,c,p,t,R,j,i,_,e,l,F,o,h,x,y,J,$,G,E,D,t;function u(n){return"="===n.charAt(0)}function P(n){var t,r;return{left:n.indexOf("["),right:n.indexOf("]")}}function V(n){var n=P(n),t=n.left,n=n.right;return 0<=t&&t<n}function H(n){var t=P(n),r=t.left,t=t.right,n=n.indexOf("@");return r<n&&n<t}function U(n){return u(n)&&H(n)}function Z(n){return u(n)&&V(n)}function W(n,t){var r,i;if(n.NMi){if(Z(t=t.trim()))return 1;if(0<=t.indexOf("{{")&&0<=t.indexOf("}}"))for(r=t.split(/{{|}}/),i=0;i<r.length;i++)if(Z(r[i].trim()))return 1}}function X(n,t,r,i){return r===A&&(r=n.getActiveRowIndex()),n.NMi.nMt(t,r,i)}function Y(n){return n.columnRelative}function z(n){return n.endColumnRelative}function K(n){return n.rowRelative}function Q(n){return n.endRowRelative}function I(n){return n.op()}function q(n){n.column}function v(n){return n.toUpperCase()===i?e:n}function nn(){var n=this;n.eMt?n.eMt=!1:(n.Amt={},n.hyt={},n.iMt?n.iMt.clearAll():n.T3=new w.SheetSource(n,g.SheetArea.colHeader),n.rMt?n.rMt.clearAll():n.A3=new w.SheetSource(n,g.SheetArea.rowHeader),n.oMt?n.oMt.clearAll():n.qgt=new w.SheetSource(n,g.SheetArea.viewport))}function tn(n,t){var r,i,e,u,f,r=n.Ut.t8&&n.Ut.t8.anchors;if(r)for(i in t.spillCells={},r)if(Object.prototype.hasOwnProperty.call(r,i))for(u in e=r[i])!Object.prototype.hasOwnProperty.call(e,u)||(f=e[u]).isValid||(t.spillCells[i+","+u]=1)}function s(n,t,r,i,e,u){var n=n.iT(t,r,i,e,u),t=n&&n.formulas;return t&&0<t.length}function rn(n,t,r,i,e,u,f){var o=s(n,t,r,i,e,3);return!o&&u&&(e=n.getColumnCount(2),o=s(n,t,0,i,e,2)),!o&&f&&(i=n.getRowCount(1),o=s(n,0,r,i,e,1)),o}function en(n){for(var t,r,i,e,u,t=[],r=[],i=0;i<n.length;i++)u=""+(e=n[i]).row+e.col+e.rowCount+e.colCount+e.sheetName,t.indexOf(u)<0&&(t.push(u),r.push(e));return r}function un(n,t){var n=n.formulaLoad/n.total;return t?.4*n+.5:.3*n+.4}function fn(n,t,r,i,e,u){var f,o,s,a,c,a,c,f=i.Uw(),o=n&&n.formula;o&&(s=void 0,"object"==typeof o&&(a=i.b3(u),(c=i.Xbt[o.si]).baseRow===t&&c.baseColumn===r?o=c.formula:(s=a.pB(c.baseRow,c.baseColumn))?(s.aMt=o.si,i.Lp.tMt&&i.Lp.tMt[f.id+","+c.baseRow+","+c.baseColumn]&&(i.Lp.tMt[f.id+","+t+","+r]={id:f.id,row:t,col:r})):(o=c.formula,c.baseRow=t,c.baseColumn=r)),(a=n.arrayInfo)&&!a.isDynamicArray?i.uMt(t,r,E(a.rowCount,10),E(a.colCount,10),o,!0,u):(c=f.getCalcSourceModel(),a&&(a.isInvalid&&f.HE(t,r),c.FE=!0,f.Qbt().setArray(f,a.row,a.col,a.rowCount,a.colCount,[],!0),delete c.FE),i.zI(t,r,o,s,!0,u,!0,!a),a&&c.Uyt(t,r,a)))}function O(n,t,r,i,e,u,f){var o,s,a,c,h,l,v,d,o,u,o=e&&e.incrementLoadTask;if(o&&!o.isTerminated){for(s=o.isBusyFunc,a=u=u||0,n.suspendPaint(),c=30,h=new Date;a<r;){if(l=t[a])for(v=0;v<i;v++)fn(l[v],a,v,n,!0,f);if(a++,s&&s())break;if(30<(d=new Date)-h)break}n.resumePaint(),(o=(e=e||{})&&e.incrementalLoading)&&(o.loadStatus.formulaLoad+=a-u,u=un(o.loadStatus,e.doNotRecalculateAfterLoad),n.parent&&n.parent.ki(g.Events.ProgressChanged,{loadStatus:o.loadStatus,progress:u,sheet:n}),o.loading)&&o.loading(u,{sheet:n}),a<r&&e.incrementLoadTask.pushTask(O,[n,t,r,i,e,a])}}function a(n,t,r,i,e){for(var u,f,o,u=0;u<r;u++)if(f=t[u])for(o=0;o<i;o++)fn(f[o],u,o,n,!0,e)}function on(n,t,r,i,e,u,f){var o,s,a,s,c,h,l,v,d,l,l,o=n.Uw(),s=n.Ut,a=s.ap||0,s=s.fp||0;t===A||(c=x(t.f),h=t.g,(l=t.r)!==A&&(v=F(l)),"shared"===t.d&&0<=h&&(c=(c&&(l={formula:c},v&&(l.lastRow=v.rowCount+v.row-1,l.lastColumn=v.colCount+v.col-1,l.baseRow=v.row,l.baseColumn=v.col,v=k),u[h]||(u[h]=l,u.nextIndex=Math.max(u.nextIndex,h+1))),{si:h}),(l=n.Xbt[c.si]).baseRow===r&&l.baseColumn===i?c=l.formula:(d=e.pB(l.baseRow,l.baseColumn))?(d.aMt=c.si,n.Lp.tMt&&n.Lp.tMt[o.id+","+l.baseRow+","+l.baseColumn]&&(n.Lp.tMt[o.id+","+r+","+i]={id:o.id,row:r,col:i})):(c=l.formula,l.baseRow=r,l.baseColumn=i)),j(c))||(1==+t.a&&v&&(v.isDynamicArray=!0,f)&&f.spillCells&&f.spillCells[r+","+i]&&(v.isInvalid=!0),c=(0,w.processFunctionPrefix)(c),v&&!v.isDynamicArray?a<=r&&i<s?n.uMt(r,i,E(v.rowCount,10),E(v.colCount,10),c,!0,2):r<a&&s<=i?n.uMt(r,i,E(v.rowCount,10),E(v.colCount,10),c,!0,1):a<=r&&s<=i&&n.uMt(r,i,E(v.rowCount,10),E(v.colCount,10),c,!0,3):(v&&(v.isInvalid&&o.HE(r,i),o.Qbt().setArray(o,v.row,v.col,v.rowCount,v.colCount,[],!0)),!d&&f&&f.exprs&&f.exprs[t.x]&&(d=(0,C.exprFromJSON)(f.exprs[t.x],o.getParserContext(!1)),f.exprs[t.x].nw)&&(d.sMt=!0),a<=r&&i<s?n.zI(r,i,c,d,!0,2,!0,!v):r<a&&s<=i?n.zI(r,i,c,d,!0,1,!0,!v):a<=r&&s<=i&&n.zI(r,i,c,d,!0,3,!0,!v),v&&e.Uyt(r,i,v)))}function B(n,t,r,i,e,u,f,o){var s,a,c,h,l,v,d,w,C,m,_,f,f,s,a=(u&&u.incrementLoadTask).isBusyFunc,c=f=f||0;for(n.suspendPaint(),n.suspendCalcService(),l=30,(h=u.openMode===g.OpenMode.incremental)&&(v=new Date),d=n.Xbt=n.Xbt||{nextIndex:0},w=n.b3(3);c<r;){if(C=t[c])for(m=0;m<i;m++)on(n,C[m],c,m,w,d,e);if(c++,!o&&a&&a())break;if(h&&(_=new Date,!o)&&30<_-v)break}n.resumeCalcService(),n.resumePaint(),u.loadStatus.formulaLoad+=c-f,h&&(f=u.loadStatus.formulaLoad/u.loadStatus.total,f=+(u.fullRecalc?.3*f+.5:.4*f+.6).toFixed(5),u.incrementLoadTask.progress)&&u.incrementLoadTask.progress({progress:f,sheetName:n.name(),step:p.I5(R().STEP.loadSheetFormula,[n.name()])}),c<r&&u.incrementLoadTask.pushTask(B,[n,t,r,i,e,u,c])}function sn(r,i,e,u){var n=g.Worksheet.fh;n&&m(n,function(n,t){var t=t.fromJsonAfterFormula;t&&t.call(r,i,e,u)})}function an(r,i,e,u){var n=g.Worksheet.fh;n&&m(n,function(n,t){var t=t.fromJsonAfterSJSFormula;t&&t.call(r,i,e,u)})}function cn(t,r,i,n,e,u){var f,o,s,a,c,h,l,f=g.Worksheet.fh,o=!1,s=[],a=n.getReferenceSheetNames(),c=t&&t.v2,h=function(n){var i;a.hasOwnProperty(n)&&(o=!0,i=(0,g._f)(t,n),c.sheetsState[n]||c.refSheetsState[n]||!i||(c.refSheetsState[n]=1,c.getSheet(n,function(r){var n,n,n=i.NMi;n?(n.yh(r,e,u),n.E0i=r.order,(n=(0,g.Ip)(n,r.lossless.addition,t.dataManager()))&&s.push(n)):(i.yh(r,e,u,!0),i.E0i=r.order),f&&m(f,function(n,t){t.refSheetLazyLoaded&&t.refSheetLazyLoaded.call(i,r,e,u)})})))};for(l in a)h(l);o&&f&&m(f,function(n,t){t.afterRefSheetLazyLoaded&&t.afterRefSheetLazyLoaded.call(r,i,e,u)}),0<s.length&&u&&u.fullRecalc&&Promise.all(s).then(function(){t.suspendPaint(),t.mp[0].Mf.recalcAll(!0),t.resumePaint()})}function hn(n,t,r){var i,e,u,u;if(n)for(i in n)(u=(e=n[i]).WK)!==A&&(u=r.unparse(t,u,0,0),e.WK=r.parse(t,u,0,0))}function ln(i){return function(n){var t,r,t,t=n.w3.rT,r=(t?t.Mf:this).name(),t=(t?t.Mf:this)._id;i[t+" "+n.row+" "+n.column]={row:n.row,col:n.column,rowCount:1,colCount:1,sheetName:r}}}function vn(n){var t,r,t=[];for(r in n)n.hasOwnProperty(r)&&t.push(n[r]);return t}function d(n,e,t,r,u,i,f){var i,t;i&&n.lossless&&[n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach(function(n,t){var t,n,r,i;n&&n.dataTable&&(n=n.dataTable,r=e.getRowCount(t=t+1),i=e.getColumnCount(t),f?O(e,n,r,i,u,0,t):a(e,n,r,i,t))}),i&&t.cMt&&n.lossless.tree&&0<n.lossless.tree.length&&(delete t.cMt,i=null,"rangeCalc"===(t=n.lossless.tree)[t.length-1].k&&(i=t.pop()),(0,C.pbt)(e.b3(),t,u.$wt),i)&&(0,C.gbt)(e.b3(),i,u.$wt),f?u.incrementLoadTask.pushTask(an,[e,n,r,u]):an(e,n,r,u)}function S(n,t){var r,i,e,n;return!t||(r=n.getRow(),i=n.getColumn(),(n=n.getExpression().getRange(r,i))&&!(n=n instanceof g.Range?n:new g.Range(n.row,n.col,n.rowCount,n.colCount)).containsRange(t))}function M(i,e,u,f,o,s){var n,a,c,h,l,v,t,r,d,w,C,h=!f&&i.Ut.pj(),l=!!s;if(i.parent&&i.parent.sheets)for(v=i.parent.sheets,t=i.parent.getCustomNames(),r=i.parent.Qwt(),d=!j(i.parent.fMt)&&i.parent.wJt(),t&&m(t,function(n,t){S(t,s)&&(a=t.getExpression(),(c=T(null,i,e,u,f,o,a,l))!==a)&&t.SB(c,h)}),r&&m(r,function(n,t){S(t,s)&&(a=t.getExpression(),(c=T(null,i,e,u,f,o,a,l))!==a)&&t.SB(c,h)}),d&&m(d,function(n,t){S(t,s)&&(a=t.getExpression(),(c=T(null,i,e,u,f,o,a,l))!==a)&&t.SB(c,h)}),w=function(r){(n=v[r].getCustomNames())&&m(n,function(n,t){S(t,s)&&(a=t.getExpression(),(c=T(v[r],i,e,u,f,o,a,l))!==a)&&t.SB(c,h)})},C=0;C<v.length;C++)w(C);else(n=i.getCustomNames())&&m(n,function(n,t){S(t,s)&&(a=t.getExpression(),(c=T(i,i,e,u,f,o,a,l))!==a)&&t.SB(c,h)})}function T(n,t,r,i,e,u,f,o){var s,a,c,h,l,v,d,w,C,m,_,p,h,v,l,d,l,d,h,v,g,b,A,R,j,F,x,y,a,F,E;if(f){if(s=t.Uw(),a=(0,N.Syt)(N.Errors.Reference,s),9===f.type){if(h=f.value,l=f.value2,v=T(n,t,r,i,e,u,h,o),d=l&&T(n,t,r,i,e,u,l,o),h!==v||l!==d)return(0,N.rbt)(f.operatorType,v,d)}else if(7===f.type){for(w=!1,C=[],m=void 0,_=0;_<f.arguments.length;_++)p=T(n,t,r,i,e,u,m=f.arguments[_],o),w=w||m!==p,C.push(p);if(w)return(0,N.YJ)(f,C)}else if(1===f.type&&f.hmt()){if(c=f.source||n&&n.Uw(),l=h=f.row,d=v=f.column,c&&c===s&&(u&&!f.rowRelative||!u&&!f.columnRelative)){if(u&&e)h+=r<=h?i:0;else if(!u&&e)v+=r<=v?i:0;else if(u){if(r+i<=h)h-=i;else if(r<=h)return a}else if(r+i<=v)v-=i;else if(r<=v)return a;if(h!==l||v!==d)return(0,N.knt)(s,k,h,v,f.rowRelative,f.columnRelative)}}else if(1===f.type){if(c=f.source||n&&n.Uw(),l=f.row,d=f.column,h=f.endRow,v=f.endColumn,g=f.rowRelative,b=f.columnRelative,A=f.endRowRelative,R=f.endColumnRelative,j=l,F=d,x=h,y=v,c&&c===s){if(u&&e)l+=!g&&r<=l?i:0,h+=!A&&r<=h?i:0;else if(!u&&e)d+=!b&&r<=d?i:0,v+=!R&&r<=v?i:0;else if(u&&!e){if(!g&&r<=l&&!A&&h<r+i)return a;if(g&&A||h<r)return f;if(!g)if(r+i<=l)l-=i;else if(!(l<r)){if(A)return a;r<l&&(l=r)}if(!A)if(r+i<=h)h-=i;else{if(g)return a;h<r+i&&(h=r-1)}}else{if(!b&&r<=d&&!R&&v<r+i)return a;if(b&&R||v<r)return f;if(!b)if(r+i<=d)d-=i;else if(!(d<r)){if(R)return a;r<d&&(d=r)}if(!R)if(r+i<=v)v-=i;else{if(b)return a;v<r+i&&(v=r-1)}}if(d!==F||v!==y||l!==j||h!==x)return(0,N.lJ)(s,k,l,d,h,v,g,b,A,R)}}else if(10===f.type){if((a=f.value)!==(F=T(n,t,r,i,e,u,a,o)))return(0,N.Ayt)(F)}else 13===f.type&&(c=f.source||n&&n.Uw())&&c===s&&!u&&(f=f.offsetWhenInsertRemoveColumn(r,i,e,o));return f}}function dn(n,t){var r,i,e,u,f,o,s,a,t,c,i,r=t.w3,i=r.getSource(),f=-1,o=-1;t.name?(u=t.name,a=t.id,j(a)?e=r.getNodeByName(u):(e={WK:t.expression},s=!0)):(f=t.row,o=t.column,e=r.getNode(f=void 0===f?-1:f,o=void 0===o?-1:o)),t=e.WK,c=e.$bt,i=n.unparse(i,t,f<0?0:f,o<0?0:o),c&&(!0!==n.allowDynamicArray||!0===n.allowDynamicArray&&!c.isDynamicArray)?f===c.row&&o===c.col&&r.setArrayFormula(c.row,c.col,c.rowCount,c.colCount,i):u?s?r.setFormula(a,u,i):r.setFormulaByName(u,i):r.setFormula(f,o,i,null,!0,!0),e.WK.lMt=t.lMt}function wn(n){for(var t,r,i,e,u,f,o,s,a,c,h,l,v,d,w,t=I(n),r,i,e,u=[n.b3(g.SheetArea.colHeader),n.b3(g.SheetArea.rowHeader),n.b3(g.SheetArea.viewport)],f=0;f<u.length;f++){if(!(o=u[f]))return;for(s=o.getAllNodes(),a=0;a<s.length;a++)if(h=(c=s[a]).calc)for(l=h.aT,v=void 0,d=0;d<l.length;d++)(w=h[l[d]])&&w.forEach(function(n){n&&n instanceof N.PathCalc&&dn(t,n)})}}function Cn(n,t,r,i,e,u,f,o,s,a){b.CalcOperatorAdjustor.copyFormula(n.b3(),t,r,i.b3(),e,u,f,o,s,a)}function mn(n,t){var n=n.offset(0,0,!1,0,0);return n.rowRelative=n.endRowRelative=n.columnRelative=n.endColumnRelative=t,n}function L(n,t,r,i,e,u,f,o,s,a){var c,h,l,v,d,w,C,m,_,c,h,l,v,c,h,p,v,l,c;if(a){if(9===a.type){if(c=a.value,h=a.value2,l=L(n,t,r,i,e,u,f,o,s,c),v=h&&L(n,t,r,i,e,u,f,o,s,h),c!==l||h!==v)return(0,N.rbt)(a.operatorType,l,v)}else if(7===a.type){for(d=!1,w=[],C=void 0,m=0;m<a.arguments.length;m++)_=L(n,t,r,i,e,u,f,o,s,C=a.arguments[m]),d=d||C!==_,w.push(_);if(d)return(0,N.YJ)(a,w)}else if(1===a.type){if(c=!K(a)&&!Y(a),h=!Q(a)&&!z(a),l=t.Uw(),(!a.source||a.source===l)&&c&&h)return v=e.Uw(),c=new b.MoveSwapInfo(l,r,i,v,u,f,o,s),h=mn(a,!0),(v=(0,b.adjustFormulaOnMoveSwap)(l,0,0,h,c,!0,p={isCustomName:!0}))===h?a:1===v.type&&mn(v,!1)||v}else if(10===a.type&&(l=a.value)!==(c=L(n,t,r,i,e,u,f,o,s,l)))return(0,N.Ayt)(c);return a}}function _n(n,t){var r,i,e,u,f,o,s,a,r=n.printInfo&&n.printInfo();if(r)for(i=t.split(","),e=0;e<i.length;e++)for(u=(0,w.formulaToRanges)(n,i[e],0,0),f=0;f<u.length;f++)for(o=u[f].ranges,s=0;s<o.length;s++)-1===(a=o[s]).col||-1===a.colCount?(r.repeatRowStart(a.row),r.repeatRowEnd(a.row+a.rowCount-1)):-1!==a.row&&-1!==a.rowCount||(r.repeatColumnStart(a.col),r.repeatColumnEnd(a.col+a.colCount-1))}function pn(n,t,r,i,e){var n=n[t];n&&(i=n.rT,j(e)||(i.Wbt=e),n.toJSON({data:r}),delete i.Wbt)}function gn(n,t,r,i,e,u){n&&(t&&!t.fullRecalc?n.resumeWithoutCalc():n.resume(!1),delete n.lb),r.zE(),delete r.G3,u.resumePaint()}Object.defineProperty(n,"__esModule",{value:!0}),n.QB=n.XB=n.hMt=n.dMt=void 0,g=t("Core"),r=t("Common"),N=t("CalcEngine"),w=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),b=t("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),C=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),k=null,A=void 0,m=g.GC$.each,c=r.Common.zf.Gmt,p=r.Common.zf,t=new r.Common.ResourceManager(g.SR),R=t.getResource.bind(t),j=r.Common.lt.ht,i="_XLNM.PRINT_AREA",_="PRINT_AREA",e="Print_Area",l=g.mt.xr,F=g.range_parser._c,o=g.IndexHelper.nr,h=g.mt.$i,x=g.mt.n1,y=g.Util.addXLFNPrefix,J=/(\$?)([A-Z]+)(\$?)(\d+)/,$=/(\$?)(\d+):(\$?)(\d+)/,G=/(\$?)([A-Z]+):(\$?)([A-Z]+)/,E=parseInt,D=g.UsedRangeUtil.updateUsedRangeByData,n.dMt=a,(t=g.Worksheet.prototype).resetCalc=function(){nn.call(this),this.eMt=!0},t.recalcAll=function(n){var t,r,i,e,u,f,o,s,a,c,h,t=I(this);if(t){if(this.suspendPaint(),t.suspend(!0),n)for(i=void 0,i=(r=this.parent)&&r.sheets||[this],hn(r&&r.hyt,this.Uw(),t),e=0;e<i.length;e++)for(f=(u=i[e]).Uw(),hn(u.hyt,f,t),s=(o=f.getCalcSourceModel()).getAllNodes(),a=0;a<s.length;a++)(h=(c=s[a]).calc)&&c.WK&&dn(t,h);t.resume(n),this.resumePaint()}},t.recalcRange=function(n,t,r,i){var e=I(this);e&&e.recalcRange(this.Uw(),n,t,r,i)},t.recalcRows=function(n){var t,r,t=I(this);if(t&&!t.ignoreDirty()){for(t.suspend(),r=0;r<n.length;r++)t.recalculate(this.qgt,n[r],-1);t.resume(!1)}},t.recalcCols=function(n){var t,r,t=I(this);if(t&&!t.ignoreDirty()){for(t.suspend(),r=0;r<n.length;r++)t.recalculate(this.qgt,-1,n[r]);t.resume(!1)}},t.gL=function(n,t,r){var i,e,i=I(this);i&&!i.ignoreDirty()&&(e=this.qgt,1===r?e=this.T3:2===r&&(e=this.A3),i.recalculate(e,n,t))},t.getCalcService=function(){return this.Lp||(this.Lp=new N.CalcService,this.Uw(g.SheetArea.colHeader).setCalcService(this.Lp),this.Uw(g.SheetArea.rowHeader).setCalcService(this.Lp),this.Uw().setCalcService(this.Lp),this.Lp.initParserContext(this.Uw())),this.Lp},t.op=function(){return this.getCalcService()},t.suspendCalcService=function(n){var t=I(this);t&&t.suspend(n)},t.resumeCalcService=function(n){var t=I(this);t&&t.resume(n)},t.Uw=function(n){return j(n)||3===n?this.qgt:1===n?this.T3:2===n?this.A3:k},t.b3=function(n){var t=this;return 1===n?(!t.iMt&&t.T3&&(t.iMt=t.op().getSourceModel(t.T3)),t.iMt):2===n?(!t.rMt&&t.A3&&(t.rMt=t.op().getSourceModel(t.A3)),t.rMt):(!t.oMt&&t.qgt&&(t.oMt=t.op().getSourceModel(t.qgt)),t.oMt)},t.vMt=function(n,t,r,i,e){var e=this.b3(e);return e&&e.mMt(n,t,r,i,!0,!0)},t.KT=function(n,t,r,i,e,u){var f=this.vMt(n,t,r,i,3);return!f&&e&&(i=this.getColumnCount(2),f=this.vMt(n,0,r,i,2)),!f&&u&&(r=this.getRowCount(1),f=this.vMt(0,t,r,i,1)),f},t.iT=function(n,t,r,i,e){var e=this.b3(e);return e&&e.mMt(n,t,r,i,!1,!0)},t.mT=function(n,t,r,i,e,u,f){var o,e,o=(e=void 0===e?!0:e)&&this.KT(n,t,r,i,u,f),e=!e&&rn(this,n,t,r,i,u,f);return!o&&!e||(this.jT(4,R().Exp_ChangePartOfArray),!1)},t.addCustomFunction=function(n){this.Uwt(n),this.recalcAll()},t.Uwt=function(n){if(!(n&&n instanceof N.Functions.Function))throw new Error(R().Exp_InvalidCustomFunction);n.name=c(n.name),this.Amt[n.name]=n},t.getCustomFunction=function(n){return n?this.Amt[c(n)]:k},t.removeCustomFunction=function(n){n&&(delete this.Amt[c(n)],this.recalcAll())},t.clearCustomFunctions=function(){this.Amt={},this.recalcAll()},t.Jbt=function(n){var t,r,t;return n?(r=(t=this).parent,!(t=t.getCustomFunction(n))&&r&&r.getCustomFunction?r.getCustomFunction(n):t):k},t.addCustomName=function(n,t,r,i,e){this.zwt(n,t,r,i,!1,e)},t.getCustomName=function(n){return n?this.hyt[c(n)]:A},t.getCustomNames=function(){var r=[];return m(this.hyt,function(n,t){r.push(t)}),r},t.removeCustomName=function(n){var n,t;n&&(n=c(n),delete this.hyt[n],(t={})[n]=n,this.Zwt(t,!1))},t.clearCustomNames=function(){var n,t,n=this,t=n.hyt;n.hyt={},this.Zwt(t,!1)},t.createNameInfo=function(n,t,r,i,e){var u,f,u,f,u=this,f=I(u),u=u.Uw();return f&&u?(f=f.parse(u,t,i,e),new w.NameInfo(n,f,i,e,r)):k},t.Vwt=function(n){var t,r,t,t=this,r=!t.hyt[c(n)];return r=r&&(t=t.tables)?!t.findByName(n):r},t.isValidCustomName=function(n){return n&&g.mt.P0(n)&&this.Vwt(n)},t.zwt=function(n,t,r,i,e,u){var f,o,s,a,o,f=this;if(!n||!t||!e&&!f.isValidCustomName(n))throw new Error(R().Exp_InvalidCustomName);if(o=I(f),s=f.Uw(),o&&s){if(a=void 0,e)try{a=o.parse(s,t,r,i,!1,!1,!0)}catch(n){}else a=o.parse(s,t,r,i);f.hyt[c(n)]=new w.NameInfo(n,a,r,i,u),e||((o={})[n]=n,this.Zwt(o,!0))}},t.Wwt=function(n,t,r,i,e,u,f,o){var s,t,a,t,s=this;if(!n||!t||!u&&!s.isValidCustomName(n))throw new Error(R().Exp_InvalidCustomName);t=I(s),a=s.Uw(),t&&a&&(s.hyt[c(n)]=new w.NameInfo(n,r,i,e,f),u||((t={})[n]=n,this.Zwt(t,!0)))},t.Zwt=function(n,t){var r,i,r=this.b3();if(r){for(i in n)r.updateNameCalc(i,t);this.recalcAll()}},t.gMt=function(n){var t,r,t;return n?(r=(t=this).parent,!(t=t.getCustomName(n))&&r&&r.getCustomName?r.getCustomName(n):t):k},t.setFormula=function(n,t,r,i){this.zI(n,t,r,k,!1,i)},t.zI=function(n,t,r,i,e,u,f,o,s){var a,c,h,l,v,d,w,w,C,d,l,c,h,o,w,a=this;j(u)&&(u=3),n<0||n>=a.getRowCount(u)||t<0||t>=a.getColumnCount(u)?a.jT(0,R().Exp_IndexOutOfRange):(c=0<=n?n:0,h=0<=t?t:0,l=a.Uw(u),v=a.options.keepUnknownFormulas,(d=a.Lp).forceR1C1Formula?(w=d.useR1C1,d.useR1C1=!0,i=i||(r&&d?d.parse(l,r,c,h,!1,e,!1,v):k),d.useR1C1=w):i=i||(r&&d?d.parse(l,r,c,h,!1,e,e,v):k),i&&o&&(i.ensureSingle=!0),w=a.tables,3===u&&0<=n&&0<=t&&w&&!(C=w.pMt(n,t,1,1,r,i))||(d=v&&r&&!i,l=a.b3(u),c=a.conditionalFormats,l&&(h=l.getFormula(n,t),o=a.Ut,l.FE=!0,l.setFormula(n,t,r,i,e,A,o.pj(),s,v),delete l.FE,l.usedRange&&D(l.usedRange,n,t,h,r),d&&(w=l.getNode(n,t,!0))&&(w.qbt=r),c&&c.dl(),a.hasFormula(n,t,u)&&o.JE(n,t,u),f?a.Lj(a,[{row:n,col:t}],0):(a.Rj("formula",n,t,u,h,r),a.ki(g.Events.WorksheetDataChanged,{type:"formula"}))),a.Q1i&&a.Q1i(n,t,1,1,u),a.zw()))},t.eL=function(n,t,r,i,e,u,f,o){var s,a,c,h,l,v,d,s=this,a=this.op();if(n<0||n>=s.getRowCount()||t<0||t>=s.getColumnCount())s.jT(0,R().Exp_IndexOutOfRange);else if(h=s.b3(f))for(l=n;l<r+n;l++)for(v=t;v<i+t;v++)l===n&&v===t&&(s.zI(n,t,e,k,!1,f),c=h.pB(n,t),s.Xbt=s.Xbt||{nextIndex:0},d=s.Xbt.nextIndex,s.Xbt[d]={formula:a.unparse(this.qgt,c,n,t,!1,!0),baseRow:n,baseColumn:t,lastRow:n+r-1,lastColumn:t+i-1},s.Xbt.nextIndex++,c.aMt=d),s.zI(l,v," ",c,!0,f,!0,!0)},t.setArrayFormula=function(n,t,r,i,e,u){this.uMt(n,t,r,i,e,!1,u)},t.uMt=function(n,t,r,i,e,u,f,o){var s,a,c,h,a,l,v,d,w;if(void 0===f&&(f=3),s=this,n<0||n+r>s.getRowCount()||t<0||t+i>s.getColumnCount())s.jT(0,R().Exp_IndexOutOfRange);else if(s.Ut.eE(n,t,r,i))s.jT(0,R().Exp_ArrayFormulaSpan);else if(a=s.tables,!(3===f&&0<=n&&0<=t&&a)||(c=a.pMt(n,t,r,i,e))){if(h=s.b3(f),a=s.conditionalFormats,h){for(l=[],v=n;v<n+r;v++)for(l[v]=[],d=t;d<t+i;d++)l[v][d]=h.getFormula(v,d);for(h.setArrayFormula(n,t,r,i,e,u,s.Ut.pj(),o,!1),v=n;v<n+r;v++)for(d=t;d<t+i;d++)h.usedRange&&D(h.usedRange,v,d,l[v][d],e);if(a&&a.dl(),s.vf<1){for(w=[],v=n;v<n+r;v++)for(d=t;d<t+i;d++)w.push({row:v,col:d});s.SI(n,t,r,i,w,5,f,e)}}s.zw()}},t.getFormula=function(n,t,r,i){var r=this.b3(r);return r?r.getFormula(n,t,i):k},t.bMt=function(n,t,r){var r=this.b3(r);return r?r.pB(n,t):k},t.getFormulaInformation=function(n,t,r,i){var e,r,u,f,f,o,s,e={},r=this.b3(r);return r&&((u=r.pB(n,t))?(f=r.sT(n,t),e.hasFormula=!0,f&&(e.baseRange=new g.Range(f.row,f.col,f.rowCount,f.colCount)),e.isArrayFormula=f&&!f.isDynamicArray,n=f?f.row:n,t=f?f.col:t,i||(e.formula=this.Lp.unparse(this.qgt,u,n,t),e.formulaWithCulture=this.Lp.unparse(this.qgt,u,n,t,!0)),e.hasFormula=!!e.formula):(f=this.Ut.getDynamicArrayInfo(n,t))&&f.isValid&&(o=f.row,s=f.col,e.baseRange=new g.Range(f.row,f.col,f.rowCount,f.colCount),n===o&&t===s||(u=r.pB(o,s),i||(e.formulaWithCulture=this.Lp.unparse(this.qgt,u,o,s,!0)),e.hasFormula=!0,e.isDynamicArray=!0))),e},t.VI=function(n,t,r,i,e,u){var f,o,s,a,c,h,l,v,d,w,C,m;for(r||(r=this,i=n,e=t,u=[]),f=r.qwt(i,e),o=this.name(),s=0;s<f.length;s++){if(u[c=(a=f[s]).sheetName+"_"+a.row+"_"+a.col+"_"+a.rowCount+"_"+a.colCount])return!1;if(u[c]=!0,(a.row<=n&&n<a.row+a.rowCount||-1===a.rowCount)&&(a.col<=t&&t<a.col+a.colCount||-1===a.colCount)&&o===a.sheetName)return!0;for(h=a.sheetName===o?r:r.parent.getSheetFromName(a.sheetName),l=a.rowCount,v=a.row,d=a.colCount,w=a.col,-1===l&&(l=h.getRowCount(),v=0),-1===d&&(d=h.getColumnCount(),w=0),C=v;C<l+v;C++)for(m=w;m<d+w;m++)if(this.VI(n,t,h,v,w,u))return!0}return!1},t.getPrecedents=function(n,t){var r,i,i,e,u,n,u,r=[],i=this.b3();return i&&(i=i.Fyt(n,t)||i.pB(n,t),n=(u=(e=this.getFormulaInformation(n,t,3,!0)).baseRange)?u.row:n,u=u?u.col:t,this.yMt(i,n,u,r),r=en(r)),r},t.getDependents=function(a,c){var h,n,l,h=[],n=this.parent&&this.parent.sheets||[this],l=this.name();return n.forEach(function(n){for(var t,r,i,e,u,f,o,s,t=n.getRowCount(),r=n.getColumnCount(),i=n.name(),e=0;e<t;e++)for(u=0;u<r;u++)for(f=n.getPrecedents(e,u),o=0;o<f.length;o++)if((s=f[o]).sheetName===l&&(-1===s.row||s.row<=a&&a+1<=s.row+s.rowCount)&&(-1===s.col||s.col<=c&&c+1<=s.col+s.colCount)){h.push({row:e,col:u,rowCount:1,colCount:1,sheetName:i});break}}),h},t.qwt=function(r,i){var e,n,t,n,n,e={},n=this.b3().oT(r,i),t=this.b3().uT();return n&&(n=n[0])&&n.forEach(ln(e)),t&&(n=t[0])&&n.forEach(function(n){var t;(-1===n.row||n.row<=r&&r+1<=n.row+n.rowCount)&&(-1===n.col||n.col<=i&&i+1<=n.col+n.colCount)&&n.content.forEach(ln(e))}),vn(e)},t.yMt=function(n,t,r,i){var e,u,u,f,o,s;if(n)switch(e=n.type){case N.ExpressionType.reference:case N.ExpressionType.structReference:u=n.getRange(t,r),i.push({row:u.row,col:u.col,rowCount:u.rowCount,colCount:u.colCount,sheetName:(n.source&&n.source.Mf?n.source.Mf:this).name()});break;case N.ExpressionType.operator:this.yMt(n.value,t,r,i),this.yMt(n.value2,t,r,i);break;case N.ExpressionType.expand:case N.ExpressionType.parentheses:this.yMt(n.value,t,r,i);break;case N.ExpressionType.name:u=this.gMt(n.value),this.yMt(u.getExpression(),t,r,i);break;case N.ExpressionType.function:for(f=n.arguments,o=0;o<f.length;o++)s=f[o],this.yMt(s,t,r,i)}},t.hasFormula=function(n,t,r){var r=this.b3(r);return!!r&&r.hasFormula(n,t)},t.wMt=function(){var n=this.b3();n&&n.MMt(function(n){n.CMt(),n.yB()})},t.clearFormula=function(n,t,r,i,e){var u,f,o,u=this;for(n<0&&(n=0,r=u.getRowCount()),t<0&&(t=0,i=u.getColumnCount()),f=0;f<r;f++)if(e(u,f+n))for(o=0;o<i;o++)u.setFormula(f+n,o+t,k)},t.nameFunctionsFromJSON=function(n,t,r,i){var e,u,f,o,s,s,a,c,h;if(n){if(e=this,u=n.customFunctions)for(f in u)u.hasOwnProperty(f)&&(o=u[f],s=(0,g.getTypeFromString)(o.typeName))&&((s=new s).fromJSON(o,t),e.Uwt(s));if((a=n.names)&&0<a.length){for(c=0;c<a.length;c++)h=a[c],e.zwt(v(h.name),h.formula,h.row,h.col,!0,h.comment);e.wMt()}i&&i()}},t.formulaFromJSON=function(n,t,e){var u,f,o;n&&((u=this).Xbt=n.sharedFormulas,f=e&&e.ignoreFormula,o=e&&e.incrementalLoading,[n.colHeaderData,n.rowHeaderData,n.data].forEach(function(n,t){var t,n,r,i;n&&!f&&n.dataTable&&(n=n.dataTable,r=u.getRowCount(t=t+1),i=u.getColumnCount(t),o?O(u,n,r,i,e,0,t):a(u,n,r,i,t))}),o?e.incrementLoadTask.pushTask(sn,[u,n,t,e]):sn(u,n,t,e))},t.formulaFromSJSFormat=function(n,t,r,i){var e,u,f,o,s,a,u,c,h,e=this,u=e.Uw(),f=!r||!1!==r.includeFormulas,o=g.Util.Mo(r),s=g.Util.wo(r,e.parent&&e.parent.v2),a=e.b3(3);u.G3=!0,f&&n.lossless&&n.lossless.tree&&r.$wt&&(a.cMt=!0,u.setReferenceSheetNames(n.lossless.referenceSheetNames)),(u=l(n,g.XFileConstants.bo))?(c=u.rowCount,h=u.colCount,i?(f&&B(e,u,c,h,n.lossless,r,0,i),d(n,e,a,t,r,f,o)):(f&&r.incrementLoadTask.addTask(B,[e,u,c,h,n.lossless,r,0],p.I5(R().STEP.loadSheetFormula,[e.name()]),function(){var n=r.loadStatus.formulaLoad/r.loadStatus.total;return r.fullRecalc?s?.5:n*g.STEP_RATE.loadSheetFormulaWithCalc+g.STEP_RATE.loadSheetDataWithCalc+g.STEP_RATE.parseFile+g.STEP_RATE.loadFileData:s?.6:n*g.STEP_RATE.loadSheetFormula+g.STEP_RATE.loadSheetData+g.STEP_RATE.parseFile+g.STEP_RATE.loadFileData},e.name()),r.incrementLoadTask.addTask(d,[n,e,a,t,r,f,o]))):i?d(n,e,a,t,r,f,o):r.incrementLoadTask.addTask(d,[n,e,a,t,r,f,o])},t.nameFunctionFromSJSFormat=function(n,t,r){var i,e,u,f,o,s,s,a,c,i=this,e=i?i.Uw():k,u=n.lossless&&n.lossless.customFunctions;if(u)for(f in u)u.hasOwnProperty(f)&&(o=u[f],s=(0,g.getTypeFromString)(o.typeName))&&((s=new s).fromJSON(o),i.Uwt(s));a=n.lossless&&n.lossless.definedNames,c=n.lossless&&n.lossless.nExpr,a&&0<a.length&&(a.forEach(function(n){var t=""+n.c_[0];"_xlnm.Print_Titles"===n.name?_n(i,t):c&&c[n.e]?i.Wwt(v(n.name),(0,w.processFunctionPrefix)(g.mt.n1(t)),(0,C.exprFromJSON)(c[n.e],e.getParserContext(!1)),0,0,!0,n.comment,"_xlnm.Print_Area"!==n.name):i.zwt(v(n.name),(0,w.processFunctionPrefix)(g.mt.n1(t)),0,0,!0,n.comment,"_xlnm.Print_Area"!==n.name)}),i.wMt())},t.SMt=function(n){var t=this,r=t.Lp;r&&!n||(t.Lp=n||new N.CalcService,t.Uw(g.SheetArea.colHeader).setCalcService(t.Lp),t.Uw(g.SheetArea.rowHeader).setCalcService(t.Lp),t.Uw(g.SheetArea.viewport).setCalcService(t.Lp),t.Lp.initParserContext(t.Uw()),r?(n.setSourceModel(t.T3,r.getSourceModel(t.T3)),n.setSourceModel(t.A3,r.getSourceModel(t.A3)),n.setSourceModel(t.qgt,r.getSourceModel(t.qgt))):(t.iMt=t.Lp.getSourceModel(t.T3),t.rMt=t.Lp.getSourceModel(t.A3),t.oMt=t.Lp.getSourceModel(t.qgt)),t.oMt.usedRange=new g.BaseUsedRange)},t.setCalc=function(n,t){this.Lp=n,this.qgt=t||this.qgt,this.oMt=n.getSourceModel(this.qgt),this.parent&&(this.parent.Lp=n)},t.YA=function(){this.ol(!1,1)},t.TMt=function(n,t){var r,i,e,u,f,o,s,a,c,h,l,v,d,w,C,m,_,p,r=this,i=n.changeType,e=n.row,u=n.rowCount,f=n.col,o=n.colCount,s=n.sheetArea,a=j(s)||s===g.SheetArea.viewport,c=r.b3(s),h=c.usedRange;c&&(v=(l=r.Ut).pj(),d=I(c),w=c.rT,C=d.Hyt(),m=d.MX.asyncManager,"addingRows"===i?r.mT(e,0,0,r.getColumnCount(),void 0,!0,!1)?(_=a?r.b3(2):A,C.onBeforeAddRemoveRows(c,e,_),t||(0,g.clearSpillValuesOnAddRemove)(l,e,u,!0,!0,s),M(r,e,u,!0,!0),[c,_].forEach(function(n){n&&n.addRows(e,u)}),m.addRows(w,e,u)):n.canAdd=!1:"addRows"===i?(d.suspend(),_=a?r.b3(2):A,C.onAfterAddRemoveRows(c,e,u,!0,t,_),d.resume(!1),v&&v.push({type:"addRows",row:e,rowCount:u,sheetArea:s}),h&&h.addHeadInfo(e,u,!0)):"deletingRows"===i?r.mT(e,0,u,r.getColumnCount(),void 0,!0,!1)?(_=a?r.b3(2):A,C.onBeforeAddRemoveRows(c,e,_),t||(0,g.clearSpillValuesOnAddRemove)(l,e,u,!1,!0,s),M(r,e,u,!1,!0),[c,_].forEach(function(n){n&&n.deleteRows(e,u)}),m.deleteRows(w,e,u)):n.canDelete=!1:"setRowCount"===i?(d.suspend(),_=r.b3(2),e<u?(c.gF(e+1,0,u-e,r.getColumnCount()),_.gF(e+1,0,u-e,r.getColumnCount())):(c.gF(u+1,0,e-u,r.getColumnCount()),_.gF(u+1,0,e-u,r.getColumnCount())),d.AMt(i),d.resume(!1)):"setColumnCount"===i?(d.suspend(),p=r.b3(1),f<o?(c.gF(0,f+1,r.getRowCount(),o-f),p.gF(0,f+1,r.getRowCount(),o-f)):(c.gF(0,o+1,r.getRowCount(),f-o),p.gF(0,o+1,r.getRowCount(),f-o)),d.AMt(i),d.resume(!1)):"deleteRows"===i?(d.suspend(),_=a?r.b3(2):A,C.onAfterAddRemoveRows(c,e,u,!1,t,_),d.resume(!1),v&&v.push({type:"deleteRows",row:e,rowCount:u,sheetArea:s}),h&&h.removeHeadInfo(e,u,!0)):"addingColumns"===i?r.mT(0,f,r.getRowCount(),0,void 0,!1,!0)?(p=a?r.b3(1):A,C.onBeforeAddRemoveColumns(c,f,p),t||(0,g.clearSpillValuesOnAddRemove)(l,f,o,!0,!1,s),M(r,f,o,!0,!1),[c,p].forEach(function(n){n&&n.addColumns(f,o)}),m.addColumns(w,e,u)):n.canAdd=!1:"addColumns"===i?(d.suspend(),p=a?r.b3(1):A,C.onAfterAddRemoveColumns(c,f,o,!0,t,p),d.resume(!1),v&&v.push({type:"addColumns",col:f,colCount:o}),h&&h.addHeadInfo(f,o,!1)):"deletingColumns"===i?r.mT(0,f,r.getRowCount(),o,void 0,!1,!0)?(p=a?r.b3(1):A,C.onBeforeAddRemoveColumns(c,f,p),t||(0,g.clearSpillValuesOnAddRemove)(l,f,o,!1,!1,s),M(r,f,o,!1,!1),[c,p].forEach(function(n){n&&n.deleteColumns(f,o)}),m.deleteColumns(w,e,u)):n.canDelete=!1:"deleteColumns"===i&&(d.suspend(),p=a?r.b3(1):A,C.onAfterAddRemoveColumns(c,f,o,!1,t,p),d.resume(!1),v&&v.push({type:"deleteColumns",col:f,colCount:o,sheetArea:s}),h)&&h.removeHeadInfo(f,o,!1))},t.IMt=function(n,t,r,i){var e,u,f,o,s,e=r.type,u=this;if(i){if("addRows"===e)r.changeType="addingRows",u.TMt(r),r.changeType="addRows",u.TMt(r);else if("deleteRows"===e)r.changeType="deletingRows",u.TMt(r),r.changeType="deleteRows",u.TMt(r);else if("addColumns"===e)r.changeType="addingColumns",u.TMt(r),r.changeType="addColumns",u.TMt(r);else if("deleteColumns"===e)r.changeType="deletingColumns",u.TMt(r),r.changeType="deleteColumns",u.TMt(r);else if("customName"===e)f=n.parse(u,r.newFormula,0,0),r.nameInfo.SB(f);else if("condition"===e){for(o=[],s=0;s<r.newFormulas.length;s++)f=n.parse(u,r.newFormulas[s],0,0),o.push(f);r.condition.setExpressions(o)}}else if("addRows"===e)r.changeType="deletingRows",u.TMt(r,!0),r.changeType="deleteRows",u.TMt(r,!0);else if("deleteRows"===e)r.changeType="addingRows",u.TMt(r,!0),r.changeType="addRows",u.TMt(r,!0);else if("addColumns"===e)r.changeType="deletingColumns",u.TMt(r,!0),r.changeType="deleteColumns",u.TMt(r,!0);else if("deleteColumns"===e)r.changeType="addingColumns",u.TMt(r,!0),r.changeType="addColumns",u.TMt(r,!0);else if("customName"===e)f=n.parse(u,r.formula,0,0),r.nameInfo.SB(f);else if("condition"===e){for(o=[],s=0;s<r.formulas.length;s++)f=n.parse(u,r.formulas[s],0,0),o.push(f);r.condition.setExpressions(o)}},t.xMt=function(n,t,r){var i=r.type,e=this;"addRows"===i?(r.changeType="deletingRows",e.TMt(r,!0),r.changeType="deleteRows",e.TMt(r,!0)):"deleteRows"===i?(r.changeType="addingRows",e.TMt(r,!0),r.changeType="addRows",e.TMt(r,!0)):"addColumns"===i?(r.changeType="deletingColumns",e.TMt(r,!0),r.changeType="deleteColumns",e.TMt(r,!0)):"deleteColumns"===i?(r.changeType="addingColumns",e.TMt(r,!0),r.changeType="addColumns",e.TMt(r,!0)):"customName"===i?r.nameInfo.SB(r.expr):"condition"===i&&r.condition.setExpressions(r.expressions)},t.NMt=function(n,t){var r,i,e,u,f,r=this,i=I(r),e=r.b3();if(i.suspend(),t)for(u=0;u<n.length;u++)(f=n[u]).type?r.IMt(i,e,f,t):f.newValue&&r.setFormula(f[0],f[1],f.formula);else for(u=n.length-1;0<=u;u--)(f=n[u]).type?r.IMt(i,e,f,t):f.newValue||r.setFormula(f[0],f[1],f.formula);i.resume(!1)},t.xj=function(n){var t,t,r,i,e,u,f,o,s,a,c,h,l,v,t=n[n.length-1],t=t&&t.sheetArea,r=j(t)||t===g.SheetArea.viewport,i=I(this),e=this.b3(t);for(i.suspend();n.length;){if(f=(u=n.pop())[0],o=u[1],s=e.pB(f,o),c=[],a=r&&this.Ut.getDynamicArrayInfo(f,o))for(h=a.row;h<a.row+a.rowCount;h++)for(c[h]=[],l=a.col;l<a.col+a.colCount;l++)c[h][l]=this.getValue(h,l);if(u.type?this.xMt(i,e,u):e.kMt.apply(e,u),(v=r&&e&&e.usedRange)&&(D(v,u[0],u[1],s,u[2]),a))for(h=a.row;h<a.row+a.rowCount;h++)for(l=a.col;l<a.col+a.colCount;l++)h===u[0]&&l===u[1]||D(v,h,l,c[h][l],u[2])}i.resume(!1)},t.getReferenceRange=function(n){var t,r,i,e,u,f,n,o,t=this.Uw(),r=this.getCalcService(),i=r.parse(t,n,0,0),f=i.baseTable;return i&&f&&n===f.name()?(e=f.range(),u=f.Mf&&f.Mf.name()):(n=r.MX.evaluateExpression(i,t.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof N.CalcReference&&(u=n.getSource().getName(),0<n.getRangeCount())&&(e=(0,g.Ec)(n.getRow(o=0),n.getColumn(0),n.getRowCount(0),n.getColumnCount(0))),{sheetName:u,range:e}},t.dL=function(n,t,r){var i,e,e,i=this,e="string"==typeof r&&i.parent&&i.parent.xO(r);return e&&-1!==n&&-1!==t?(e=e.getExpression(),(W(i,r)?X:(0,w.evaluateExpression))(i,e,n,t)):A},t.TL=function(n,t,r){var i,e,u,f,u,o,s,a,c,i=this,e=!!i.NMi,u=i.getCell(n=-1===n?0:n,t=-1===t?0:t,3),f=(0,w.rangeToFormula)(u,n,t,3);if(0<=(u="="===(u=r.trim()).charAt(0)&&0<=u.indexOf("@")&&!U(u)?u.replace(/@/g,f):u).indexOf("{{")&&0<=u.indexOf("}}")){for(""===(o=u.split(/{{|}}/))[0]&&o.shift(),""===o[o.length-1]&&o.pop(),s=0;s<o.length;s++)-1===o[s].indexOf("=")?o[s]='"'+o[s]+'"':(!e||!U(o[s]))&&(0<=o[s].indexOf("@")&&(o[s]=o[s].replace(/@/g,f)),(a=(0,w.evaluateFormula)(i,o[s]))instanceof N.CalcError)?o[s]='"'+a.toString()+'"':o[s]=o[s].replace(/=/g,"");u="=CONCAT("+o.join(",")+")"}(c=i.parent).xO(r)||c.pp(c.bp,r,u,n,t,!0,"",i.NMi)},t.NO=function(n,t,r,i){var e=this;return(W(e,n)?X:(0,w.evaluateExpression))(e,t,r,i)},n.hMt=M,n.XB=Cn,n.QB=L,g.Worksheet.ch("calc",{priority:1e3,init:nn,dispose:function(n){var t,r,r,r,t=this;!1!==n.clearCache&&(t.qgt=k,t.A3=k,t.T3=k,t.Lp=k,(r=t.oMt)&&(!0===n.isSheetDestroy?r.DMt():r._Mt(),t.oMt=k),(r=t.rMt)&&(!0===n.isSheetDestroy?r.DMt():r._Mt(),t.rMt=k),r=t.iMt)&&(!0===n.isSheetDestroy?r.DMt():r._Mt(),t.iMt=k)},attach:function(n){var t=this;n instanceof g.Workbook?t.SMt(n.Lp):t.SMt()},onLayoutChanged:function(n){this.op().isAdjustSuspended()||this.TMt(n)},toJson:function(n,t){var o,r,i,s,r,a,e,u,f,c,o=this,r=o.Amt;g.GC$.isEmptyObject(r)||(n.customFunctions=r),i=t&&t.newWorkSheetName,s=[],r=o.getCustomNames(),a=I(o),e=o.b3(),u=e.rT,r&&a&&(!j(i)&&e&&u&&(u.Wbt=i),m(r,function(n,t){var r,i,e,u,t,f,r,r=t.getName(),i=t.getRow(),e=t.getColumn(),u=t.getExpression(),t=t.getComment();u&&(r={name:r,formula:f=a.unparse(o.Uw(),u,i,e,!1,!0,!0),row:i,col:e},t&&(r.comment=t),s.push(r))}),0<s.length&&(n.names=s),delete u.Wbt),(f=t&&t.ignoreFormula)||(c=[o.oMt,o.iMt,o.rMt],[n.data,n.colHeaderData,n.rowHeaderData].forEach(function(n,t){pn(c,t,n,u,i)}),o.Xbt&&0<o.Xbt.nextIndex&&(n.sharedFormulas=o.Xbt))},fromJson:function(n,t,r,i){var e,u,e=this,u;r&&r.incrementalLoading||(e.clearCustomFunctions(),e.clearCustomNames()),i&&(e.nameFunctionsFromJSON(n,t,r),e.formulaFromJSON(n,t,r))},wh:function(n,t,o){var s,r,i,a,c,r,h,e,u,l,f,v,f,e,d,s=this,r=s.Amt;g.GC$.isEmptyObject(r)||(n.lossless.customFunctions=r),i=o&&o.newWorkSheetName,a=[],c=[],r=s.getCustomNames(),h=I(s),e=s.b3(),u=e.rT,l={},s.parent&&(f=s.parent.yC,l=f&&f.getUsedCustomNames()||{}),r&&h&&!s.NMi&&(!j(i)&&e&&u&&(u.Wbt=i),v=!o||!1!==o.includeUnusedNames,m(r,function(n,t){var r,i,e,u,t,f,r,t,r=t.getName(),i=t.getRow(),e=t.getColumn(),u=t.getExpression(),t=t.getComment();r.toUpperCase()!==_&&u&&(v||l[r])&&(r={name:r,comment:t,formula:f=y((0,w.encodeNameFormula)(h.unparse(s.Uw(),u,i,e,!1,!0,!0)))},o&&o.includeCalcModelCache&&(t=(0,C.exprToJSON)(u),a.push(t),r.e=a.length-1),c.push(r))}),0<c.length&&(n.lossless.definedNames=c),0<a.length&&(n.lossless.nExpr=a),delete u.Wbt),(f=o&&!1===o.includeFormulas)||((e=s.oMt)&&(u=e.rT,j(i)||(u.Wbt=i),e.wh(n,o),delete u.Wbt),d=[s.iMt,s.rMt],n.lossless&&[n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach(function(n,t){pn(d,t,n,u,i)})),!f&&g.Util.ko(o)&&(o&&o.includeCalcModelCache&&(n.lossless.tree=(0,C.mbt)(s.b3())),u=s.Uw(),n.lossless.referenceSheetNames=u&&u.getReferenceSheetNames(),tn(s,n.lossless))},yh:function(n,t,r,i){var e,u,f,o,s,a,c,e=this,u=e.parent,o=g.Util.wo(r,e.parent&&e.parent.v2),s=r&&!r.fullRecalc,a=e.Uw();e.suspendPaint(),u&&u.Lp&&((f=u.Lp).suspend(),f.lb=s),(c=g.Util.Mo(r))||(e.clearCustomFunctions(),e.clearCustomNames()),o&&(a.G3=!0,e.nameFunctionFromSJSFormat(n,t,r),e.formulaFromSJSFormat(n,t,r,i),i?cn(u,e,n,a,t,r):r.incrementLoadTask.addTask(cn,[u,e,n,a,t,r])),i?gn(f,r,a,o,s,e):r.incrementLoadTask.addTask(function(n,t,r,i,e,u){gn(n,t,r,i,e,u)},[f,r,a,o,s,e])},setName:function(n){var t,r,i;wn(this),(i=(r=I(t=this.b3())).MX.asyncManager).changeSourceName(n.oldName,n.newName)},beforeSetName:function(){this.b8&&(this.parent||this).xyt()}}),g.Y8.ch("calc",{isInvalidFormula:function(t){var n,r,n=k,r=A;try{t.allowDynamicArray&&(j(w.SheetParserContext.wbt)&&(w.SheetParserContext.wbt=new g.Worksheet),(n=w.SheetParserContext.wbt).getCalcService())&&(r=n.getCalcService().allowDynamicArray,n.getCalcService().allowDynamicArray=!0),(0,w.formulaToExpression)(n,t.value)}catch(n){t.isInvalid=!0}finally{j(n)||j(r)||!n.getCalcService()||n.getCalcService().allowDynamicArray===r||(n.getCalcService().allowDynamicArray=r)}}})},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets}},i={},n=e("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CalcEngine=n}();