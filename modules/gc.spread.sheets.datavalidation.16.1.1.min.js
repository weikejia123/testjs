/*!
 * 
 * SpreadJS Library 16.1.1
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var i,r,t,n,e;function o(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t](n,n.exports,o)),n.exports}i={"./dist/plugins/validation/datavalidation-event.js":function(r,t,n){var t,i,T,U,q,R,Q,Y,N,W,J,P,X,G,Z,H,K,_,z,$,tt,nt,it,rt,et,ot,at,ut,st,ft,ct,lt,ht,dt;Object.defineProperty(t,"__esModule",{value:!0}),t=n("Core"),i=n("Common"),T=n("CalcEngine"),U=n("./dist/plugins/validation/datavalidation.js"),q=i.Common.lt.ht,R=i.Common.ct,Q=i.Common.zf,Y=t.mt,N=t.Ec,W=Y.pi(),J=Y.Tt,P=t.GC$,X=Y.En,G=Y.yt,Z=Y.vi,H=document,K=Math.max,_=Math.min,z="position",$="absolute",tt="border",nt="padding",it="box-shadow",rt="font",et="background-color",ot="top",at="left",ut="z-index",st="outline",ft="auto",ct="white",lt="none",ht="size",dt="gcUIElement",P.extend(t.nk.prototype,{PA:function(n,i){var r,e,t,o,a,u,s,f,c,l,h,u,a,t,u,a,d,v,g,A,m,p,b,w,C,O,M,k,t,u,a,t,s,u,t,s,B,y,V,s,D,S,j,F,L,L,a,F,x,E,s,j;function I(t,n){if(t&&t[n])return"function"==typeof t[n]?t[n]():t[n]}if((t=(e=(r=this).Mf)&&e.parent)&&(o=e.G1())&&((a=t.getActiveSheet())||(u=t.getActiveSheetTab())&&(a=u.Mf),a)&&e.name()===a.name()&&(s=e.getDataValidator(n,i))&&(f=e.getCellRect(n,i),!r.Ek(f))&&(c=t.j2(),l=t.getHost(),h=Y.gi(l),I(s,"showInputMessage")&&I(s,"inputMessage")&&(t=(u=Q.Vi)((a=Q.j0)(I(s,"inputTitle")),"\n","<br/>"),u=u(a(I(s,"inputMessage")),"\n","<br/>"),a=X("span"),P(a).css(z,$).css(tt,"1px #C0C0C0 solid").css(nt,"3px 8px 3px 8px").css(et,"#FFFFFF").css(it,"1px 2px 5px rgba(0,0,0,0.4)").css(rt,"normal normal normal 12px/normal Arial").width(ft).height(ft).css(ot,f.y+f.height+5).css(at,f.x+f.width/2).css(ut,h).html("<b>"+t+"</b><br/>"+u).attr(dt,"gcValidationInputMessage").appendTo(c),e.KD=a),s)&&3===I(s,"type")&&I(s,"inCellDropdown")&&I(s,"condition")){for(d=I(s,"condition").getValidListImp(e,n,i),v=I(s,"condition").KJ(),g=d.length,A=X("select"),m=e.getText(n,i),p=-1,b=H.createDocumentFragment(),w=new RegExp(String.fromCharCode(32),"g"),C=String.fromCharCode(160),O=0;O<g;O++)M=d[O].text,q(M)||T&&M instanceof T.CalcError||(p<0&&M===m&&(p=O),M instanceof Date&&(M=R.Pe(M,"M/d/yyyy h:mm:ss")),(k=X("option")).value=M,k.text=M.replace(w,C),b.appendChild(k));A.appendChild(b),A.selectedIndex=0<p?p:0,t=e.getActualStyle(n,i),u=e.Dn,a=t&&t.font?t.font:u.Nn(),1<e.zoom()&&(a=u._n(a)),(t=e.Ut.getSpans(N(n,i,s=1,1)))&&0<t.length&&t[0]&&(s=t[0].colCount),u=i+s-1==e.getColumnCount()-1,t=e.Gt(n),s=e.parent&&e.parent.options.useTouchLayout,t=_(s?50:15,t),y=J.safari&&(W.ipad||W.iphone),V=W.android,F=j=S=D=s=void 0,F=y?(s=f.width+3,D=f.height+3,S=f.y-1.5,j=f.x-1.5,ct):(s=K(f.width+(u?0:t),e.defaults.colWidth),D=8<g?140:ft,S=f.y+f.height,j=(L=f.x+f.width+(u?0:t)-s)<e.uw().left?f.x:L,""),L=P(A).css(st,lt).css(z,$).css(rt,G(a)).css(ut,h).css(et,F).width(s).height(D).css(at,j).attr(dt,"gcValidationSelect").appendTo(c).attr(ht,2<g?g:2).hide().bind("click",function(){V||(r.jk(A,n,i,d,v),y&&P(e.a6t).show())}).bind("keydown",function(t){13!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey?27!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||P(A).hide():r.jk(A,n,i,d,v),y&&P(e.a6t).show()}).bind("change",function(){V&&r.jk(A,n,i,d,v)}),a=P(l).height(),D=L.outerHeight()+1,y||(a<D+S&&D<S?S=f.y-D:(F=l.getBoundingClientRect(),(s=(x=window.innerHeight)-((E=F.y)+S))<D&&L.height(s))),L.css(ot,S),y&&L.bind("blur",function(){r.jk(A,n,i,d,v),P(e.a6t).show()}),e.gf=A,(j=X("input")).type="image",j.src=(0,U.Hrt)(),j.alt="v",P(j).css(z,$).width(t).height(t).css(ot,f.y+f.height-(t+3)).css(at,f.x+f.width-(u?t:0)).css(ut,h).css(et,ct).css(tt,"1px solid gray").attr(dt,"gcValidationButton").appendTo(c).bind("click",function(t){e.isEditing()&&!e.endEdit()||(P(e.gf).toggle().focus(),y&&P(e.a6t).toggle(),Z(t))}),e.a6t=j}}})},"./dist/plugins/validation/datavalidation.js":function(V,t,n){var a,D,i,v,n,r,c,U,S,j,F,L,e,h,d,x,o,q,s,g,E,n,r,R,Q,Y,N,W,I,l,J,P,X,G,B,Z,T,H,K,_,z,$,A,m,p,tt,u,n,nt,it,rt,et,ot,at,ut,st,ft,n,f,ct,lt,ht,dt,vt,b,w,gt,n,n,w,w,w,w,w;function At(t){if(x(t))return 0;if("number"==typeof t)return t;if("string"==typeof t){var n=parseFloat(t);if(!isNaN(n)&&n.toString()===t)return n}return g}function mt(t){var n,i,r,e,o;if(t instanceof Date)return t;if("string"!=typeof t)return"number"==typeof t&&!isNaN(t)&&(n=a.Common.ct.Y0(t))||g;if(!(n=a.Common.ct.yU(t)))if(isNaN(t)){if(a.Common.ct.u6t(t))return g;if(n=new Date(t),isNaN(n.valueOf()))return g;try{if(i=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,e=(r=a.Common.zf).s6t(a.Common.zf.cJ(t.replace(/[ \n]/g,"")," ")," "),(o=i.exec(e))&&4===o.length&&(-1===o.indexOf(n.getFullYear().toString())||-1===o.indexOf(n.getMonth().toString())||-1===o.indexOf(n.getDate().toString())))return g}catch(t){return g}}else if(!(n=a.Common.ct.Y0(parseFloat(t))))return g;return n}function pt(t){return!x(t)&&t instanceof Date?q(t):t}function bt(t,n){var i,r,e;if(!x(t))return 1===t||2===t?i=Ot(n.operator,n.value1,n.value2,1===t):3===t?n.value?i=jt(n.value):n.formula&&(i=St(n.formula)):4===t||5===t?(r=n.value1,e=n.value2,r&&"/OADate("===r.substr(0,8)&&(r=tt.dJ(r)),e&&"/OADate("===e.substr(0,8)&&(e=tt.dJ(e)),i=(5===t?yt:kt)(n.operator,r,e)):6===t?i=Vt(n.operator,n.value1,n.value2):7===t&&void 0!==n.formula&&(i=Dt(n.formula)),i?i.condition():void 0}function wt(t,n,i,r,e,o){var a,u,s,f,c,l,h,d,o,o,s,f,u,v,d,n,r,i,e,e,l,a;return t.intersect(n,i,r,e)?(a=t.rowCount,u=t.colCount,s=p(0,t.row),f=p(0,t.col),h=l=c=!1,n=p(0,n),i=p(0,i),d=(o=o||[-1,-1])[0],o=o[1],-1===a&&(a=d-s,l=!0),-1===u&&(u=o-f,c=!0),-1===e&&(e=o-i,h=!0),s=(o=s)+a-1,u=(f=f)+u-1,d=(v=n)+(r=-1===r?d-n:r)-1,r=(n=i)+e-1,i=[],-1!==o&&-1!==f&&-1!==v&&-1!==n&&(0<n-f&&(e=A(o,f,l?-1:a,n-f),i.push(e)),0<u-r&&(e=A(o,1+r,l?-1:a,u-r),i.push(e)),0<v-o&&(l=A(o,p(n,f),v-o,c&&h?-1:m(r,u)-p(n,f)+1),i.push(l)),0<s-d)&&(a=A(1+d,p(n,f),s-d,c&&h?-1:m(r,u)-p(n,f)+1),i.push(a)),i.c6t=!0,i):[t]}function C(t,n){var n;if(!x(t))return"string"==typeof t&&(t=G(t)),t=3===n||!(t=4!==n&&5!==n||(n=parseFloat(t),isNaN(n))?t:mt(t))||t instanceof Date?t:J(t)}function O(t){var n=this;n.id=O.f6t,O.f6t++,n.l6t=o(rt),t&&(n.condition(t),n.condition().ignoreBlank(n.ignoreBlank())),n._S=[]}function Ct(){return"data:image/png;base64,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"}function M(t){return e&&t&&"="===t[0]}function Ot(t,n,i,r){var e,o,a,u,n,s,f,i,e=g,o=g,a=g,u=g;return M(n)?e=d(n,"="):o=n,M(i)?a=d(i,"="):u=i,n=g,6===t&&((s=h(1,3,o,e)).integerValue(r),(f=h(1,5,u,a)).integerValue(r),n=h(0,1,g,g,g,g,g,s,f)),7===t&&((s=h(1,4,o,e)).integerValue(r),(f=h(1,2,u,a)).integerValue(r),n=h(0,0,g,g,g,g,g,s,f)),0<=t&&t<=5&&(n=h(1,t,o,e)).integerValue(r),(i=new b(n)).type(r?1:2),i.comparisonOperator(t),i}function Mt(t,n,i,r,e){var o,a,u,s,n,f,c,l,i,o=g,a=g,u=g,s=g;if(M(n)?o=d(n,"="):a=n,M(i)?u=d(i,"="):s=i,n=g,6===t&&(f=h(r,5,a,o),c=h(r,3,s,u),n=h(0,1,g,g,g,g,g,f,c)),7===t&&(f=h(r,2,a,o),c=h(r,4,s,u),n=h(0,0,g,g,g,g,g,f,c)),0<=t&&t<=5){switch(t){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}n=h(r,l,a,o)}return(i=new b(n)).type(e),i.comparisonOperator(t),i}function kt(t,n,i){return Mt(t,n,i,5,4)}function yt(t,n,i){return Mt(t,n,i,13,5)}function Vt(t,n,i){var r,e,o,a,n,u,s,i,r=g,e=g,o=g,a=g;return M(n)?r=d(n,"="):e=n,M(i)?o=d(i,"="):a=i,n=g,6===t&&(u=h(7,3,e,r),s=h(7,5,a,o),n=h(0,1,g,g,g,g,g,u,s)),7===t&&(u=h(7,4,e,r),s=h(7,2,a,o),n=h(0,0,g,g,g,g,g,u,s)),0<=t&&t<=5&&(n=h(7,t,e,r)),(i=new b(n)).type(6),i.comparisonOperator(t),i}function Dt(t){var t;return e?((t=new b(h(4,g,g,d(t,"="),4))).type(7),t):g}function St(t){var t;return e?((t=new b(i.Condition.fromFormula(t))).type(3),t):g}function jt(t){var t=new b(i.Condition.fromSource(t));return t.type(3),t}function Ft(t){return this.JS(t)}function Lt(t,n){if(t&&n&&n.length)return n.map(Ft.bind(t))}function xt(t,n,i){var r,e,o,r=t.rowCount,e=t.colCount,o=A(t.row,t.col,r,e);return 0===t.row&&r===n&&(o.row=-1),0===t.col&&e===i&&(o.col=-1),o}function Et(t,n){var i=t.getRowCount(),r=t.getColumnCount();return n.map(function(t){return xt(t,i,r)})}function It(t,n){var i,t,i=t.cellCache;return i||(t.cellCache=i={}),(t=i[n])||(i[n]=t={}),t}function Bt(e,t,n,o,a,u,s){var f,c,l,h,d,i,r,v,g,A,m,p,b,w,C,f=o.h6t,c=e.row,l=e.col,h=e.rowCount,d=e.colCount,i=c+h,r=l+d;if(t<=i-1&&(h=t-c),n<=r-1&&(d=n-l),i===t)for(v=function(t,n){var i,r,i,i=f.colCache;i||(f.colCache=i={}),(r=i[n])||(i[n]=r={}),(i=r.dv)&&i!==a&&i.FX(e,o),r.dv=a,r.cacheStartRowIndex=c,(x(r.cacheRowCount)||!0===s&&a.smt().some(function(t){return t.intersect(u,n,1,1)}))&&(r.cacheRowCount=h)},g=0,A=l;g<d;g++,A++)v(g,A);else if(r===n)for(m=function(t,n){var i,r,i,i=f.rowCache;i||(f.rowCache=i={}),(r=i[n])||(i[n]=r={}),(i=r.dv)&&i!==a&&i.FX(e,o),r.dv=a,r.cacheStartColIndex=l,(x(r.cacheColCount)||!1===s&&a.smt().some(function(t){return t.intersect(n,u,1,1)}))&&(r.cacheColCount=d)},p=0,b=c;p<h;p++,b++)m(p,b);else for(p=0,b=c;p<h;p++,b++)for(w=It(f,b),g=0,A=l;g<d;g++,A++)(C=w[A])&&C!==a&&C.FX(e,o),w[A]=a}function Tt(t,n){var i,r,e,o,a,u,s,f,c,l,h,d,v,g,A,m,p,b,g,A,w,C,O,M,k,y,O,M,V,D,S,j,i=n.h6t,r=t.row,e=t.col,o=t.rowCount,a=t.colCount,u=n.eJ,s=u.getRowCount(),f=u.getColumnCount(),c=i.colCache,l=i.rowCache,h=i.cellCache;if(c)for(d=e;d<e+a;d++)if(g=(v=c[d])&&v.cacheStartRowIndex,A=v&&v.cacheRowCount,v&&g<=r&&r<g+A){if(m=!1,r<s){for(p=g;p<=r;p++)b=It(i,p),p<r&&(b[d]=v.dv);(A=r+o)-(g=v.cacheStartRowIndex)===v.cacheRowCount?c[d]=E:(v.cacheStartRowIndex=A,v.cacheRowCount-=A-g),m=!0}else r+o===s&&(m=!(c[d]=E));m&&(w=v.dv)&&w.FX(t,n)}if(l)for(C=r;C<r+o;C++)if(O=(b=l[C])&&b.cacheStartColIndex,M=b&&b.cacheColCount,b&&O<=e&&e<O+M){if(m=!1,e<f){for(k=O;k<=e;k++)y=It(i,C),k<e&&(y[k]=b.dv);(M=e+a)-(O=b.cacheStartColIndex)===b.cacheColCount?l[C]=E:(b.cacheStartColIndex=M,b.cacheColCount-=M-O),m=!0}else e+a===f&&(m=!(l[C]=E));m&&(w=b.dv)&&w.FX(t,n)}if(h)for(C=0,V=r,D=o;C<D;C++,V++)if(b=h[V])for(d=0,S=e,j=a;d<j;d++,S++)(w=b[S])&&w.FX(t,n),b[S]=E}function Ut(t){switch(t){case"none":return f.anyValue;case"whole":return f.wholeNumber;case"decimal":return f.decimalValues;case"list":return f.list;case"date":return f.date;case"time":return f.time;case"textLength":return f.textLength;case"custom":return f.custom}}function qt(t){var n,i,r,n=[];if(t)for(i in t)(r=t[i])&&n.push(r);return n}function k(t){this.eJ=t,this.YB={},this.h6t={},this.d6t=[]}function Rt(t){return t="string"==typeof t?'"'+t+'"':t}function Qt(t){var n=t.D5;return x(n)?(n=t.expected(),Rt(W(n))):n}function Yt(t){var n,i,r;return x(t)?g:0===(n=t.conType())?Nt(t):1===n||7===n?(r=t.formula(),{firstFormula:r=x(r)?t.expected():r}):4===n?{firstFormula:x(t.formula())?t.expected():t.formula()}:12===n||5===n||13===n?{firstFormula:Qt(t)}:{firstFormula:g}}function Nt(t){var n,i;return x(t)?g:(i=n=g,{firstFormula:n=t.item1()?(0===t.item1().conType()?Nt:Yt)(t.item1()).firstFormula:n,secondFormula:i=t.item2()?(0===t.item2.conType?Nt:Yt)(t.item2()).firstFormula:i})}function Wt(t){var n,n,n=typeof t;return"string"==n||"number"==n?Y(t.toString()):x(t)||x((n=t).item1)?"":Wt(n.item1)}function y(t,n){var i,n;if(!x(t))return i=t,n=+(i=n&&M(t)?t.substr(1):i),isNaN(n)?t:n}function Jt(t){var n=t.row,i=t.col,r=t.rowCount,t=t.colCount;return-1===n&&-1===i?i=0:(-1!==n&&-1!==r&&n+r>D.MAX_ROW_COUNT&&(r=D.MAX_ROW_COUNT-n),-1!==i&&-1!==t&&i+t>D.MAX_COLUMN_COUNT&&(t=D.MAX_COLUMN_COUNT-i)),A(n,i,r,t)}function Pt(t){var t=t.map(Jt);return v.rangesToFormula(t,0,0,15,!1).split(", ").join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.createListValidator=t.createFormulaListValidator=t.createFormulaValidator=t.createTextLengthValidator=t.createTimeValidator=t.createDateValidator=t.createNumberValidator=t.kf=t.Hrt=t.DefaultDataValidator=t.HighlightPosition=t.HighlightType=t.ErrorStyle=t.DataValidationResult=t.CriteriaType=void 0,a=n("Common"),D=n("Core"),i=n("ConditionalFormatting"),v=n("SheetsCalc"),n=n("CalcEngine"),r=a.Common.ct,c=D.UsedRangeUtil.vh,U=D.UsedRangeUtil.hh,S=D.XFileConstants.Au,j=D.XFileConstants.Ou,F=D.XFileConstants.Ru,L="1",e=!!n,h=i.aJ,d=a.Common.zf.cJ,x=a.Common.lt.ht,o=a.Common.lt.tv,q=r.o0,s=D.GC$,g=null,E=void 0,r=(n=D.mt).p0,R=n.T1,Q=n.G0,Y=n.t1,N=n.e1,W=n.i1,I=n.vo,l=n.n1,J=n.g1,P=n.b1,X=n.p1,G=D.Util.mr,B=D.Util.addXLFNPrefix,Z=D.Util.pr,T=n.xr,H=n.C1,K=n.Lue,_=n.c1,z=D.range_parser.Dc,$=D.range_parser.Oc,A=D.Ec,m=Math.min,p=Math.max,tt=a.Common.ct,u=".validator",rt={type:0,color:n="red"},et={type:nt=1,color:n,position:1},ot={type:2,color:n,position:it=5,image:null},(n=at=at||{})[n.none=0]="none",n[n.whole=1]="whole",n[n.decimal=2]="decimal",n[n.list=3]="list",n[n.date=4]="date",n[n.time=5]="time",n[n.textLength=6]="textLength",n[n.custom=7]="custom",(n=ut=ut||{})[n.stop=0]="stop",n[n.warning=1]="warning",n[n.information=2]="information",st={0:"equal",1:"notEqual",2:"greaterThan",4:"lessThan",3:"greaterThanOrEqual",5:"lessThanOrEqual",6:"between",7:"notBetween"},ft={equal:0,notEqual:1,greaterThan:2,greaterThanOrEqual:3,lessThan:4,lessThanOrEqual:5,between:6,notBetween:7},n=window,(w=f=t.CriteriaType||(t.CriteriaType={}))[w.anyValue=0]="anyValue",w[w.wholeNumber=1]="wholeNumber",w[w.decimalValues=2]="decimalValues",w[w.list=3]="list",w[w.date=4]="date",w[w.time=5]="time",w[w.textLength=6]="textLength",w[w.custom=7]="custom",(w=ct=t.DataValidationResult||(t.DataValidationResult={}))[w.forceApply=0]="forceApply",w[w.discard=1]="discard",w[w.retry=2]="retry",(w=lt=t.ErrorStyle||(t.ErrorStyle={}))[w.stop=0]="stop",w[w.warning=1]="warning",w[w.information=2]="information",(w=ht=t.HighlightType||(t.HighlightType={}))[w.circle=0]="circle",w[w.dogEar=1]="dogEar",w[w.icon=2]="icon",(w=dt=t.HighlightPosition||(t.HighlightPosition={}))[w.topLeft=0]="topLeft",w[w.topRight=1]="topRight",w[w.bottomRight=2]="bottomRight",w[w.bottomLeft=3]="bottomLeft",w[w.outsideLeft=4]="outsideLeft",w[w.outsideRight=5]="outsideRight",vt=["errorStyle","ignoreBlank","preciseCompareDate","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],O.prototype.value1=function(t,n){var i,i,t,i=this.condition(),i=i&&i.item1()?i.item1():i;return i?(t=i.formula(t,n))&&0<t.length?"="+d(s.trim(t.toString()),"="):i.expected():g},O.prototype.value2=function(t,n){var i,i,t,i=this.condition(),i=i&&i.item2()?i.item2():i;return i?(t=i.formula(t,n))&&0<t.length?"="+d(s.trim(t.toString()),"="):i.expected():g},O.prototype.isValid=function(t,n,i,r,e){var o,a,u,s,f,e,o=this,a=o.condition(),u=x(e)||!0===e;if(a){if(o.ignoreBlank()&&(x(r)||""===r))return!0;if(f=void 0,!x(s=r))switch(o.type()){case 0:return!0;case 2:case 1:f=u?At(r):r,x(f)||(s=f);break;case 4:case 5:f=u?mt(r):r,x(f)||(s=f)}t&&(t.EJ=!0),e=void 0;try{e=a.evaluate(t,n,i,s,s)}catch(t){e=!0}finally{t&&(t.EJ=!1)}return e}return!0},O.prototype.reset=function(){var t=this;t.errorStyle(0),t.ignoreBlank(!0),t.preciseCompareDate(!1),t.inCellDropdown(!0),t.showInputMessage(!0),t.showErrorMessage(!0),t.inputTitle(""),t.errorTitle(""),t.inputMessage(""),t.errorMessage(""),t.comparisonOperator(6),t.type(0),t.condition(g),t._S.length=0},O.prototype.getValidList=function(t,n,i){var r=this.condition();return r!==g&&3===this.type()&&12===r.conType()?r.getValidList(t,n,i):g},O.prototype.highlightStyle=function(t){var n,i,r,e,n=this;if(0===arguments.length)return n.l6t;if(!x(t)){if(n.l6t.type!==t.type)switch(i=t.type){case 1:n.l6t=o(et);break;case 2:n.l6t=o(ot);break;default:n.l6t=o(rt)}for(e in r=n.l6t)r.hasOwnProperty(e)&&t.hasOwnProperty(e)&&(r[e]=t[e]);return n.Mf&&n.Mf.repaint(),n}},O.prototype.toJSON=function(i){var r,e,t,r=this,e={};return vt.forEach(function(t){var n=r[t]();r[t].isDefault(n)||(e[t]=n&&n.toJSON?n.toJSON(i):n)}),t=r._S.map(Jt),e.ranges=v.rangesToFormula(t,0,0,15,!1),e.highlightStyle=JSON.stringify(r.l6t),s.isEmptyObject(e)?E:e},O.prototype.fromJSON=function(e,o,a){var u,t,n,i,t;e&&!s.isEmptyObject(e)&&(u=this,e.ranges&&(u._S=v.formulaToRanges(a,e.ranges,0,0,!0)[0].ranges),e.highlightStyle&&(u.l6t=JSON.parse(e.highlightStyle)),vt.forEach(function(t){var n,i,r,n=e[t];R(n)&&("condition"===t?((i=h()).fromJSON(e.condition,a,o),u.condition(i,!1),(r=i.ranges())&&r.length?u._S=r:i.ranges(u._S),i.context(a)):u[t](n,!1))}),t=e.validatorInfo)&&(n=a.Lp.useR1C1,i=bt(e.type,t),t=t.operator,i&&(i.ranges(u._S),i.ignoreBlank(u.ignoreBlank()),i.context(a),n&&Q(i),u.condition(i)),x(t)||u.comparisonOperator(t))},O.prototype.clone=function(t){var n,n;return this.ZB?((n=this.condition())&&n.initExpression(),this):((n=new O).fromJSON(this.toJSON(t),!1,t||this.Mf),n._S=[],n)},O.prototype.context=function(t){var n;return t&&(this.DJ=t,n=this.condition())&&(n.ranges(this._S),n.context(t)),this.DJ},O.prototype.v6t=function(t){var n,i;if(t){for(n=this._S,i=0;i<n.length;i++)if(n[i].containsRange(t))return;n.push(t)}},O.prototype.FX=function(t,n){var i,r,e,o,a,u,s,f,t,c,i=this,r=i._S;t&&r.length&&(e=t.row,o=t.col,a=t.rowCount,u=t.colCount,f=!(s=[]),t=i.Mf,c=t&&[t.getRowCount(),t.getColumnCount()],r.forEach(function(t){var t=wt(t,e,o,a,u,c);t.c6t&&(f=!0),s.push(t)}),i._S=[].concat.apply([],s),f)&&n.m6t(i)},O.prototype.smt=function(){return this._S},O.prototype.XJ=function(){var t=this;t.condition()&&t.condition().initExpression()},O.prototype.g6t=function(t){this.condition()&&this.condition().ranges(t)},O.prototype.qJ=function(t,n,i){var r,e,o,a,u,s,f,c,l,s,h,d,v,r=this,e=!1;for(r.XJ(),a=0,u=(o=r._S).length;a<u;a++)f=(s=o[a]).row,c=s.rowCount,l=s.col,s=s.colCount,h=f===t.row&&c===t.rowCount&&t.col<=l&&s<=t.colCount,d=f===n.row&&c===n.rowCount&&n.col<=l&&s<=n.colCount,(v=h||d)&&(o[a]=A(f,l,c+i,s),e=!0);return e&&r.g6t(o),e},O.prototype.JO=function(t,n,i,r){var e,o,a,u,s,f,c;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),e=0;e<this._S.length;e++)if(a=(o=this._S[e]).row,i&&0<i.length){for(u=!1,s=0,f=i.length;s<f;s++)if((c=i[s])&&(!0!==r||c.containsRange(o))){if(c.row===a&&c.row+c.rowCount-n===a+o.rowCount&&a===t){o.rowCount+=n,u=!0;break}t<=a&&(o.row+=n)}if(u)break}else t<=a?o.row+=n:t<=a+o.rowCount&&(o.rowCount+=n);this.condition()&&this.condition().ranges(this._S)}},O.prototype.xP=function(e,o){var a;e<0||o<=0||(this.condition()&&this.condition().initExpression(),a=[],this._S.forEach(function(t){var n,i,r,n=t.row,i=t.rowCount;e<n?((r=e+o-n)<=0?n-=o:(n-=r,t.rowCount-=r),n<0&&(t.rowCount+=n,n=0),t.row=n):n<=e&&e<n+i&&(t.rowCount-=m(o,n+i-e)),(0<t.rowCount||-1===t.row&&-1===t.rowCount)&&a.push(t)}),this._S=a,this.condition()&&this.condition().ranges(this._S))},O.prototype.qO=function(t,n,i){var r,e,o,a,u,s,f,c;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),r=0;r<this._S.length;r++){if(e=this._S[r],i&&0<i.length){for(a=o=!1,u=0,s=i.length;u<s;u++)if((f=i[u])&&!f.containsRange(e))o=!0;else if(f&&f.col===e.col&&f.col+f.colCount-n===e.col+e.colCount&&f.col===t){e.colCount+=n,a=!0;break}if(o)continue;if(a)break}t<=(c=e.col)?e.col+=n:t<=c+e.colCount&&(e.colCount+=n)}this.condition()&&this.condition().ranges(this._S)}},O.prototype.NP=function(e,o){var a;e<0||o<=0||(this.condition()&&this.condition().initExpression(),a=[],this._S.forEach(function(t){var n,i,r,n=t.col,i=t.colCount;e<n?((r=e+o-n)<=0?n-=o:(n-=r,t.colCount-=r),n<0&&(t.colCount+=n,n=0),t.col=n):n<=e&&e<n+i&&(t.colCount-=m(o,n+i-e)),(0<t.colCount||-1===t.col&&-1===t.colCount)&&a.push(t)}),this._S=a,this.condition()&&this.condition().ranges(this._S))},O.prototype.rv=function(t,n,i,r){var e,o,a,u,o,a,s,f,c,i,a,e=this;i?((o=T(t,"sqref"))&&(a=v.formulaToRanges(n,o.c_[0],0,0,!0)[0].ranges),e._S=a):e._S=v.formulaToRanges(n,t.sqref,0,0,!0)[0].ranges,u=Ut(t.type),o=ft[t.operator],x(u)||e.type(u),x(o)&&(o=6),e.comparisonOperator(o),t.allowBlank===L?e.ignoreBlank(!0):e.ignoreBlank(!1),x(t.error)||e.errorMessage(l(t.error)),x(t.errorTitle)||e.errorTitle(l(t.errorTitle)),x(t.errorStyle)||e.errorStyle(lt[t.errorStyle]),x(t.prompt)||e.inputMessage(l(t.prompt)),t.showDropDown===L&&e.inCellDropdown(!1),x(t.promptTitle)||e.inputTitle(l(t.promptTitle)),t.showErrorMessage!==L&&e.showErrorMessage(!1),t.showInputMessage!==L&&e.showInputMessage(!1),(a=t.c_)&&0<a.length&&(i?a.forEach(function(t){var n;t&&(n=T(t,"f"),c=l(n&&n.c_[0]),"formula1"===t.n_&&(s=C(c,u)),"formula2"===t.n_)&&(f=C(c,u))}):a.forEach(function(t){t&&(c=l(_(t)),"formula1"===t.n_&&(s=C(c,u)),"formula2"===t.n_)&&(f=C(c,u))})),x(u)||(i=void 0,1===u||2===u?i=Ot(o,y(s,r),y(f,r),1===u):3===u?(c=s||f)&&(i='"'===c[0]&&'"'===c[c.length-1]?jt(X(c)):St(J(c))):4===u||5===u?i=(5===u?yt:kt)(o,s,f):6===u?i=Vt(o,y(s,r),y(f,r)):7===u&&void 0!==s&&(i=Dt(s)),i&&(a=i.condition())&&(a.ranges(e._S),a.ignoreBlank(e.ignoreBlank()),a.context(n),e.condition(a))),e.Mf=n,t.lossless&&t.lossless.highlightStyle&&(e.l6t=JSON.parse(t.lossless.highlightStyle))},O.f6t=1,b=O,t.DefaultDataValidator=b,w={errorStyle:r("errorStyle",0),ignoreBlank:r("ignoreBlank",!0,function(t){this.condition()&&this.condition().ignoreBlank(t)}),preciseCompareDate:r("preciseCompareDate",!1,function(t){this.condition()&&this.condition().preciseCompareDate(t)}),inCellDropdown:r("inCellDropdown",!0),showInputMessage:r("showInputMessage",!0),showErrorMessage:r("showErrorMessage",!0),inputTitle:r("inputTitle",""),errorTitle:r("errorTitle",""),inputMessage:r("inputMessage",""),errorMessage:r("errorMessage",""),comparisonOperator:r("comparisonOperator",6),condition:r("condition",g),type:r("type",0)},s.extend(b.prototype,w),t.Hrt=Ct,t.kf=M,t.createNumberValidator=Ot,t.createDateValidator=kt,t.createTimeValidator=yt,t.createTextLengthValidator=Vt,t.createFormulaValidator=Dt,t.createFormulaListValidator=St,t.createListValidator=jt,s.extend(D.Worksheet.prototype,{getDataValidator:function(t,n,i){var t=this.hG(t,n,i);return t?t[0]:E},hG:function(t,n,i){return 3===(i=x(i)?3:i)?this.b8.p6t(t,n):E},setDataValidator:function(t,n,i,r,e,o){var a,u,s,f,i,r,a=this,u=a.b8;arguments.length<5&&(e=i,o=r,i=-1===t?-1:1,r=-1===n?-1:1),3===(o=x(o)?3:o)&&(s=a.getDataValidator(t,n,o),(f=1===i&&1===r)&&s===e||(a.Ut.b6t(),i=A(t,n,i,r),u.y6t(i),e&&u.w6t(e,i),a.Ut.b6t(!0),r="validator",f&&(a.Rj(r,t,n,o,s,e),a.ki(D.Events.WorksheetDataChanged,{type:"dataValidation"}),-1!==t&&-1===n?a.dj(t,o,r,e,s):-1===t&&-1!==n&&a.vj(n,o,r,e,s)),a.zw()))},isValid:function(t,n,i,r){var e,o,e=this;try{if(e.Ubt=t,e.Hbt=n,e.zbt=i,e.Gbt=!0,o=e.getDataValidator(t,n))return o.isValid(e,t,n,i,r)}finally{e.Ubt=-1,e.Hbt=-1,e.zbt=g,e.Gbt=!1}return!0},G1:function(){var t,n,i,n,n,t=this;return!(t.M6t||(t.M6t=!0,(n=t.KD)&&((i=n.parentNode)&&i.removeChild(n),t.KD=g),(n=t.a6t)&&(s(n).unbind("click"),(i=n.parentNode)&&i.removeChild(n),t.a6t=g),(n=t.gf)&&(s(n).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(i=n.parentNode)&&i.removeChild(n),t.gf=g),t.M6t=!1))},xyt:function(){var t,n,i,r,e,o,a,t=this,n=[],i=t.b8,r=i&&i.YB;if(r)for(e in r)(a=(o=r[e])&&o.condition())&&a.getExpressions&&0<a.getExpressions().length&&n.push({validator:o,sheet:t});return n}}),s.extend(D.Workbook.prototype,{xyt:function(){var n,t,i,n=[],t,i;return this.sheets.forEach(function(t){var t=t.xyt();t&&t.length&&t.forEach(function(t){n.push(t)})}),n}}),s.extend(D.CellRange.prototype,{validator:function(t){var n,i,r,e,o,a,u,n=this,i=n.sheet,r=n.sheetArea,e=n.row,o=n.col,a=n.rowCount,u=n.colCount;return 0===arguments.length?i.getDataValidator(e,o,r):(i.setDataValidator(e,o,a,u,t,r),n)}}),k.prototype.getUsedRange=function(){var t,n,i,r,e,o,a,u,s,f,t,n=this.p6t(),i={};if(n)for(r=void 0,e=0,o=n;e<o.length;e++)for(u=0,s=r=(a=o[e]).smt();u<s.length;u++)f=s[u],c(i,U(f));return i},k.prototype.L0=function(){this.eJ=g},k.prototype.GJ=function(t){return Lt(this.eJ,t)},k.prototype.OX=function(t){return Et(this.eJ,t)},k.prototype.C8=function(t,n,i){var r,e,o,a,r=this,e=r.YB;if(x(n)?r.h6t={}:r.h6t.cellCache={},e)for(o in e)(a=e[o])&&(t&&delete a.C6t,r.fE(a,!0,n,i));r.S6t()},k.prototype.m6t=function(t){var n=this.d6t;-1===n.indexOf(t)&&n.push(t)},k.prototype.fE=function(n,t,i,r){var e=this,o=e.GJ(n.smt()),a=e.eJ,u=a.getRowCount(),s=a.getColumnCount();o&&(e.d6t.length=0,o.forEach(function(t){Bt(t,u,s,e,n,i,r)}),t||e.S6t())},k.prototype.RX=function(t){var n=this,t=n.GJ(t.smt());n.d6t.length=0,t.forEach(function(t){Tt(t,n)}),n.S6t()},k.prototype.BX=function(t){var n=this;t&&Tt(n.eJ.JS(t),n),n.S6t()},k.prototype.S6t=function(){var t,n,t=this.d6t;t.length&&(n=this.YB,t.forEach(function(t){t.smt().length?t.condition()&&t.condition().ranges(t.smt()):(delete n[t.id],delete t.Mf)}),t.length=0)},k.prototype.w6t=function(t,n){var i=this,r=i.eJ;if(n&&((t=t.Mf&&r!==t.Mf?t.clone(r):t).Mf=r,t.v6t(n)),r)return t.context(r),i.YB[t.id]=t,i.fE(t),t},k.prototype.y6t=function(t){var n,i;t&&(i=(n=this).eJ,n.BX(t),i.zw())},k.prototype.d5=function(){var t=this,n;t.eJ&&(t.YB={},t.C8())},k.prototype.p6t=function(t,i){var n,r,e,n,o,r,r,r,r,r,n=this,r=n.YB;return 0===arguments.length||(e=[],n=n.h6t,i===E&&(i=-1),-1===(t=t===E?-1:t)&&-1===i)?qt(r):((r=(r=n.colCache)&&r[i])&&(t>=r.cacheStartRowIndex&&t<r.cacheStartRowIndex+r.cacheRowCount||-1===t&&0===r.cacheStartRowIndex)?e.push(r.dv):(r=(r=n.rowCache)&&r[t])&&(i>=r.cacheStartColIndex&&i<r.cacheStartColIndex+r.cacheColCount||-1===i&&0===r.cacheStartColIndex)?e.push(r.dv):(r=n.cellCache)&&(-1!==t&&-1!==i?(o=r[t])&&o[i]&&e.push(o[i]):-1===t?s.each(r,function(t,n){var n=n[i];n&&-1===e.indexOf(n)&&e.push(n)}):(o=r[t])&&s.each(o,function(t,n){n&&-1===e.indexOf(n)&&e.push(n)})),e)},k.prototype.qJ=function(t,n,i){var r,e,o,a,u,s,f,r=this,e,o=r.eJ.Ut,a=r.YB,u=!1;if(!x(a)){for(s in o.b6t(),a)(f=a[s])&&f.qJ(t,n,i)&&(u=!0);u&&r.C8()}},k.prototype.$J=function(t,n,i,r,e){var o,a,u,s,o=this,a=o.YB;if(a)for(u in a)(s=a[u])&&(i?s.JO(t,n,r,e):s.qO(t,n,r));o.C8(E,t,i)},k.prototype.JO=function(t,n,i,r){this.$J(t,n,!0,i,r)},k.prototype.qO=function(t,n,i){this.$J(t,n,!1,i)},k.prototype.tX=function(t,n,i){var r,e,o,a,r=this,e=r.YB;if(e)for(o in e)(a=e[o])&&(i?a.xP(t,n):a.NP(t,n),0===a._S.length)&&(e[o]=E);r.C8()},k.prototype.xP=function(t,n){this.tX(t,n,!0)},k.prototype.NP=function(t,n){this.tX(t,n,!1)},k.prototype.toJSON=function(t){var n,i,r,e,n=this.YB,i=[];for(r in n)(e=n[r])&&i.push(e.toJSON(t));return i},k.prototype.fromJSON=function(t,i,r){var e=this,o=e.eJ;e.YB={},t&&t.length&&(t.forEach(function(t){var n=new b;n.fromJSON(t,i,r),n.Mf=o,e.YB[n.id]=n}),e.C8())},k.prototype.y8=function(t,n,i){this.eJ.setDataValidator(t,n,i)},gt=k,s.extend(D.Y8.prototype,{b6t:function(t){var n,i,r,e,o,a,u,n=this,i=n.G8;if(i&&(t||!i.originalValidators)){for(o in e=[],r=n.b8.YB)(a=r[o])&&(u=a._S.map(function(t){return A(t.row,t.col,t.rowCount,t.colCount)}),e.push({validator:a,ranges:u}));t?i.currentValidators=e:i.originalValidators=e}},T6t:function(t){var r,n,e;t&&(r=this.Mf,n=this.b8,e={},t.forEach(function(t){var n,i,n=t.validator;"Object"===n.constructor.name&&((i=new b).fromJSON(n,!1,r),n=i),n._S=t.ranges,n.condition()&&n.condition().ranges(n._S),e[n.id]=n}),n.YB=e,n.C8(!1))},ATt:function(t,n,i,r){this.b6t(),this.b8.JO(t,n,i,r),this.b6t(!0)},A6t:function(t,n){this.b6t(),this.b8.xP(t,n),this.b6t(!0)},NTt:function(t,n,i){this.b6t(),this.b8.qO(t,n,i),this.b6t(!0)},kTt:function(t,n){this.b6t(),this.b8.NP(t,n),this.b6t(!0)},I6t:function(t){this.b6t(),this.b8.BX(t),this.b6t(!0)},x6t:function(){this.b6t(),this.b8.C8(),this.b6t(!0)}}),D.Y8.ch("validator",{init:function(){this.b8=new gt(this.Mf)},applyChanges:function(t){var n,t,t,n=t.changes,t=t.isUndo;n&&(t=t?n.originalValidators:n.currentValidators)&&this.T6t(t)},undo:function(t){var t=t.originalValidators;t&&this.T6t(t)},dispose:function(t){var n;!1!==(t&&t.clearCache)&&this.b8&&(this.b8.L0(),this.b8=g)}}),D.Worksheet.ch("validator",{getUsedRange:function(t){var n,i,r;t.type&D.UsedRangeType.dataValidation&&(r=(i=(n=this).b8).getUsedRange(),c(t.range,r))},init:function(){var i=this;i.b8=i.Ut.b8,i._3(D.Events.FloatingElementSelected+u),i.D3(D.Events.FloatingElementSelected+u,function(t,n){"worksheet"!==n.type&&i.G1()})},dispose:function(t){var n=this;n.G1(),t.clearCache&&n.b8.d5(),!1!==t.clearCache&&n._3(D.Events.FloatingElementSelected+u)},onLayoutChanged:function(t){var n,i,r,e,o,a,u,s,f,n=t.changeType,i=t.row,r=t.rowCount,e=t.col,o=t.colCount,a=t.sheetArea,u=x(a)||3===a,s=this.Ut,f=this.tables;"addRows"===n&&u?s.ATt(i,r,f&&f.AJ(i,-1,r,-1,!0)):"deleteRows"===n&&u?s.A6t(i,r):"addColumns"===n&&u?s.NTt(e,o,f&&f.AJ(-1,e,-1,o,!1)):"deleteColumns"===n&&u?s.kTt(e,o):"clear"===n?3===a&&2==(2&t.type)&&s.I6t(A(i,e,r,o)):"setColumnCount"!==n&&"setRowCount"!==n||3!==a&&1!==a||s.x6t()},toJson:function(t,n){var i,n,n,i=this.b8,n=n&&n.ignoreStyle;i&&!n&&(n=i.toJSON(this))&&n.length&&(t.validations=n)},fromJson:function(t,n,i){var i,i,i=i&&i.ignoreStyle;t&&t.validations&&!i&&(i=t.validations,this.b8.fromJSON(i,n,this))},wh:function(t,n,i){var r,e,o,a,u,i,s,f,c,l,h,d,v,g,A,m,p,b,w,C,O,M,k,g,A,m,p,b,w,C,O,y,V,r=this,e=r.b8,o=i&&!1===i.includeStyles,a=i&&i.fileType===D.OpenSaveFileType.excel;if(!o&&e&&!r.NMi){for(l in u=e.YB,s=(i={n_:j,c_:[]}).c_,f=0,c=[],u)if((h=u[l])&&h._S&&0<h._S.length){if(f++,v=!(d={n_:F}),g=h.comparisonOperator(),A=h.ignoreBlank(),m=h.errorMessage(),p=h.errorTitle(),b=h.errorStyle(),w=h.inputMessage(),C=h.inCellDropdown(),O=h.inputTitle(),M=h.showErrorMessage(),k=h.showInputMessage(),6!==g&&(d.operator=st[g]),!1!==A&&(d.allowBlank=L),m&&(d.error=I(Z(m))),p&&(d.errorTitle=I(p)),0!==b&&(d.errorStyle=ut[b]),w&&(d.prompt=I(Z(w))),!1===C&&(d.showDropDown=L),O&&(d.promptTitle=I(O)),!1!==M&&(d.showErrorMessage=L),!1!==k&&(d.showInputMessage=L),g=h.condition(),A=h._S,d.sqref=Pt(A),g){if(m=h.type(),d.type=at[m],b=(p=Yt(g)).firstFormula,w=p.secondFormula,a&&(H(b)||H(w)))return;d.c_=[],C=r.name(),O=r.parent&&r.parent.r4(),N(b,C,O)||N(w,C,O)?(d.n_=F,x(b)||d.c_.push({n_:"formula1",c_:[{n_:"f",c_:[I(B(b))]}]}),x(w)||d.c_.push({n_:"formula2",c_:[{n_:"f",c_:[I(B(w))]}]}),d.c_.push({n_:"sqref",c_:[$(A)]}),v=!0):(x(b)||(4===m||5===m?d.c_.push({n_:"formula1",c_:[pt(b)+""]}):d.c_.push({n_:"formula1",c_:[I(B(b))]})),x(w)||(4===m||5===m?d.c_.push({n_:"formula2",c_:[pt(w)+""]}):d.c_.push({n_:"formula2",c_:[I(B(w))]})))}h.l6t&&(d.lossless={highlightStyle:JSON.stringify(h.l6t)}),(v?c:s).push(d)}0<s.length&&(i.count=f,t.c_.push(i)),0<c.length&&(y=T(t,S)).c_.push(V={n_:"ext",r_:[1,9],c_:[{n_:j,c_:c,r_:[2],count:c.length}]})}},yh:function(t,n,i){var r,e,o,a,u,i,s,f,c,l,i,t,h,d,r=this,e=r.b8,o=e.YB,a;if(!(i&&!1===i.includeStyles)&&e&&v){if(u=D.Util.ko(i),(s=(i=T(t,j))&&i.c_)&&0<s.length)for(f=s.length-1;0<=f;f--)c=s[f],(l=new b).rv(c,r,E,u),o[l.id]=l;if(i=T(t,S),(t=K(i,"dataValidations"))&&t.c_&&0<t.c_.length)for(f=(h=t.c_).length-1;0<=f;f--)d=h[f],(l=new b).rv(d,r,!0,u),o[l.id]=l;e.C8()}}}),D.Style.ch("validator",{fromJson:function(t){var n;"validator"===t.p&&((n=new b).fromJSON(t.v,t.noSchema,t.context),this.validator=n,t.r=!0)}}),n.Vc.wf.push(function(t,n){!n&&t.G1&&t.G1()})},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine},ConditionalFormatting:function(t){t.exports=GC.Spread.Sheets.ConditionalFormatting}},r={},n=t={},Object.defineProperty(n,"__esModule",{value:!0}),n.createListValidator=n.createFormulaListValidator=n.createFormulaValidator=n.createTextLengthValidator=n.createTimeValidator=n.createDateValidator=n.createNumberValidator=n.kf=n.Hrt=n.HighlightPosition=n.HighlightType=n.DefaultDataValidator=n.ErrorStyle=n.DataValidationResult=n.CriteriaType=void 0,o("./dist/plugins/validation/datavalidation-event.js"),e=o("./dist/plugins/validation/datavalidation.js"),Object.defineProperty(n,"CriteriaType",{enumerable:!0,get:function(){return e.CriteriaType}}),Object.defineProperty(n,"DataValidationResult",{enumerable:!0,get:function(){return e.DataValidationResult}}),Object.defineProperty(n,"ErrorStyle",{enumerable:!0,get:function(){return e.ErrorStyle}}),Object.defineProperty(n,"DefaultDataValidator",{enumerable:!0,get:function(){return e.DefaultDataValidator}}),Object.defineProperty(n,"HighlightType",{enumerable:!0,get:function(){return e.HighlightType}}),Object.defineProperty(n,"HighlightPosition",{enumerable:!0,get:function(){return e.HighlightPosition}}),Object.defineProperty(n,"Hrt",{enumerable:!0,get:function(){return e.Hrt}}),Object.defineProperty(n,"kf",{enumerable:!0,get:function(){return e.kf}}),Object.defineProperty(n,"createNumberValidator",{enumerable:!0,get:function(){return e.createNumberValidator}}),Object.defineProperty(n,"createDateValidator",{enumerable:!0,get:function(){return e.createDateValidator}}),Object.defineProperty(n,"createTimeValidator",{enumerable:!0,get:function(){return e.createTimeValidator}}),Object.defineProperty(n,"createTextLengthValidator",{enumerable:!0,get:function(){return e.createTextLengthValidator}}),Object.defineProperty(n,"createFormulaValidator",{enumerable:!0,get:function(){return e.createFormulaValidator}}),Object.defineProperty(n,"createFormulaListValidator",{enumerable:!0,get:function(){return e.createFormulaListValidator}}),Object.defineProperty(n,"createListValidator",{enumerable:!0,get:function(){return e.createListValidator}}),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).DataValidation=t}();