/*!
 * 
 * SpreadJS Library 16.1.1
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var i,e,t;function r(t){var n,n,n=e[t];return void 0!==n||(n=e[t]={exports:{}},i[t].call(n.exports,n,n.exports,r)),n.exports}i={"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(t,n,i){var e,r,o,u,a,e=this&&this.__createBinding||(Object.create?function(t,n,i,e){void 0===e&&(e=i);var r=Object.getOwnPropertyDescriptor(n,i);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,e,r)}:function(t,n,i,e){t[e=void 0===e?i:e]=n[i]}),r=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),n.findControl=void 0,o=i("Core"),r(i("./dist/plugins/formulaTextbox/formulatextbox.js"),n),r(i("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),n),i("./dist/plugins/formulaTextbox/formulatextbox-event.js"),i("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),i("./dist/plugins/formulaTextbox/formulatextbox-render.js"),u=i("./dist/plugins/formulaTextbox/formulatextbox.js"),n.findControl=a=function(t){return"string"==typeof t&&(t=document.getElementById(t)),(0,o.GC$)(t).data(u.CONST_FORMULATEXTBOX)}},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(t,n,i){var v,g,d,I,e,r;function o(t){var n,i,n=v.mt.En("textarea"),i;return(0,v.GC$)(n).css({display:"none"}),(0,v.GC$)(t).append(n),n}function u(){var t=this;t.bZ=-1,t.mvt=-1,t._text="",t.gvt=-1,t.Mf=null,t.XD=!1,t.pvt=-1,t.bvt=null,t.Vv=null,t.yvt=null}function a(){}Object.defineProperty(n,"__esModule",{value:!0}),n.wvt=n.Mvt=void 0,v=i("Core"),g=i("./dist/plugins/formulaTextbox/formulatextbox.js"),d=null,I=void 0,n.Mvt=o,u.prototype.d5=function(){var t=this;t.Cvt(),t.bZ=-1,t.mvt=-1,t._text="",t.gvt=-1,t.XD=!1,t.pvt=-1,t.Mf=null,t.Vv=null,t.yvt=null},u.prototype.Cvt=function(){var t,n,i,t=this;t.Mf.xT||(n=t.Mf.getCellType(t.bZ,t.mvt),i={sheet:t.Mf,row:t.bZ,col:t.mvt,sheetArea:3},t.bvt&&t.bvt.firstChild&&n.deactivateEditor(t.bvt.firstChild.firstChild,i)),(0,v.GC$)(t.bvt).remove(),t.bvt=null},u.prototype.Svt=function(t){var n,i,e,n=this,i=t.il;i&&(e=t.vA,n._text=i.text(),n.bZ=e?e.row:t.getActiveRowIndex(),n.mvt=e?e.col:t.getActiveColumnIndex(),n.nT=e?e.sheetArea:v.SheetArea.viewport,n.gvt=i.caret(),n.XD=i.XD,n.pvt=i.Tvt(),n.rl=i.rl,n.Avt=i.Avt,n.Ivt=i.Ivt,n.Mf=t,n.Vv=t.parent,n.yvt=t.rt.it())},u.prototype._6=function(t){var n=this;t.il&&n.Mf&&(n._text=t.il.text(),n.gvt=t.il.caret(),n.XD=t.il.XD,n.pvt=t.il.Tvt())},u.prototype.xvt=function(t){var n,t,n=this,t=t.il;t&&(t.rl=n.rl,t.Avt=n.Avt,t.Ivt=n.Ivt,t.text(n._text),t.caret(n.gvt),n.XD)&&(t.Nvt(),t.Tvt(n.pvt))},u.prototype.kvt=function(t){var n,i,e,r,n=t.oldSheet,i=this,e=n&&n.il;if(e)if(e.close(),(!i.Mf||i.Mf.xT)&&e.Dvt()||i.Avt!==e.Avt){i.Svt(n),r=n.getValue(i.bZ,i.mvt,i.nT),n.suspendEvent();try{if(!n.endEdit(!0))return}finally{n.resumeEvent()}n.setValue(i.bZ,i.mvt,r,i.nT,!0),n.Di=1,t.needTriggerSheetChange=!1}else i._text&&(i._6(n),e.destroy(),n.il=d,t.needTriggerSheetChange=!1)},u.prototype._vt=function(t){var n,t,i,e,e,r,e,r,n=t.oldSheet,t=t.newSheet,i=this;if(t&&!t.xT){if(i.bvt&&""===i._text&&(n&&n.cR(),i.d5()),i._text&&i.Mf===t)t.Di=0,t.Zg(),t.suspendEvent(),i.rl?(e=o(t.parent.Ti),(0,g.Evt)(t,e,d,t.ui,t.ci,3),t.Di=2,t.Dn.ID()):(r=e=void 0,i.nT===v.SheetArea.rowHeader?r=-(e=1):i.nT===v.SheetArea.colHeader&&(e=-1,r=1),t.f6(t.Dg(),i.bZ,i.mvt,e,r,!1)),t.resumeEvent(),i.xvt(t),i.GG(t,i.bZ,i.mvt,i.nT),n&&n.cR(),i.d5();else if(i._text&&!i.bvt){if(t.Di=1,n&&(n.Di=1),i.jvt(t),!i.Mf||i.Mf.xT)return;t.e4()}else if(i._text&&i.Mf!==t){if(t.Di=1,n&&(n.Di=1,n.cR()),i.jvt(t),!i.Mf||i.Mf.xT)return;t.e4()}(e=i.Mf)&&(r=t.il)&&(r.U6=e!==t)}},u.prototype.jvt=function(t){var n,i,e,r,o,u,a,s,f,c,l,c,l,h,n=this,i=n.Mf;i&&!i.xT&&(e=n.bZ,r=n.mvt,o=n.nT,u=i.getCellType(e,r,o),a={sheet:i,row:e,col:r,sheetArea:o,canvasOffset:this.yvt},(s=u.isImeAware(a))||o!==v.SheetArea.viewport)&&(t.Di=1,f=u.jn(a),n.bvt&&n.Cvt(),l=c=void 0,n.nT===v.SheetArea.rowHeader?l=-(c=1):n.nT===v.SheetArea.colHeader&&(c=-1,l=1),n.bvt=f,(0,v.GC$)(f).css("position","absolute"),(c=i.getCellRect(e,r,c,l)).width===I&&(c.width=0),c.height===I&&(c.height=0),(0,v.GC$)(f).attr("id","across"),l=i.getActualStyle(e,r,o),u.On(f,l,c,a),(h=n.Vv&&n.Vv.getHost()||document.body).insertBefore(f,d),n.rl&&(0,v.GC$)(f).css({display:"none"}),(0,g.Evt)(t,u.getEditingElement(),!0,t.ui,t.ci,3),f.firstChild&&!n.rl&&u.focus(f.firstChild.firstChild),n.xvt(t),u.Rn(f,l,c,a))},u.prototype.GG=function(t,n,i,e){var r,o,u,a,s,f,r,o,c;e===v.SheetArea.rowHeader?o=-1:e===v.SheetArea.colHeader&&(r=-1),u=t.getCellType(n,i,e),a=t.li,s=t.Fi(),f=t.getActualStyle(n,i,e),r=t.getCellRect(n,i,r,o),o=!1,e===v.SheetArea.rowHeader?o=r.x>=s.x&&r.y>=s.y+s.qC&&r.x+r.width<=s.Py&&r.y+r.height<=s.Ay+s.Iy:e===v.SheetArea.colHeader?o=r.x>=s.x+s.XC&&r.y>=s.y&&r.x+r.width<=s.Hy+s.zy&&r.y+r.height<=s.Cy:e===v.SheetArea.viewport&&(o=r.x>=s.b6&&r.y>=s.T6&&r.x+r.width<=s.Hy+s.zy&&r.y+r.height<=s.Ay+s.Iy),r&&0<r.width&&0<r.height&&o&&a&&a.parentNode&&u.Rn(a.parentNode.parentNode,f,r,c={sheet:t,row:n,col:i,sheetArea:e})},e=u,a.Ovt=function(t,n){(a.Rvt=a.Rvt?a.Rvt:new e).kvt(n)},a.Bvt=function(t,n){(a.Rvt=a.Rvt?a.Rvt:new e)._vt(n)},n.wvt=a},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(t,n,i){var x,n,A,r,o,m,u;function C(t){var n,n,i,n=t.il,i=t.rt,n=n.XD?i.Lvt:i.Lvt={anchorRow:t.ui,anchorCol:t.ci,leadingRow:t.qA,leadingCol:t.hR};return n}function a(t,n,i,e,r){var o,u,u,u,a,s,f,c,a,s,n,l,h,v,u,g,d,I,p,l,h,I,p,l,o=t.il,u=t.parent,u=u&&u.options;if(o&&o.Dvt()&&u&&u.allowUserEditFormula&&u.enableFormulaTextbox){switch(a=(u=C(t)).anchorRow,s=u.anchorCol,f=u.leadingRow,c=u.leadingCol,m(e)&&(e=a),m(r)&&(r=s),a=t.rt,n){case 3:v=t.sI(e,r,i,f);break;case 4:v=t.uI(e,r,i,f);break;case 1:v=t.lR(e,r,i,c);break;case 2:v=t.gR(e,r,i,c);break;case 5:v=t.yR();break;case 6:v=t.bR()}v&&(s=v.row,n=v.col,l=v.leadingCellRow||s,h=v.leadingCellCol||n,t.dR(s,n))&&(u.anchorRow=s,u.anchorCol=n,u.leadingRow=l,u.leadingCol=h,u=t.pivotTables&&t.pivotTables.findPivotTable(l,h),g=o.shift,d=o.ctrl,p=(I=u&&u.getPivotInfoImp(l,h,!1,!0))&&I.area,!o.Ivt&&u&&I&&4===p?(o.Fvt=new x.Range(l,h,1,1),l=I.valueFieldName,h=I.rowInfos,I=I.colInfos,(h||I)&&(p=t.rt.Pvt(p,l,h,I,u.position()))&&(o.Gvt(p,g,!d,!0),o.rb=!1)):(delete o.Fvt,(l=(0,A.Uvt)(a.Mf,(0,x.Ec)(s,n,1,1)))&&o.Gvt(l,!1,!0)),0<=s)&&0<=n&&t.OA(s,n)}}function e(t,n){var i;return!!t&&2!==t.Di&&((i=t.il)&&i.Dvt()?a(t,n,!1):(t=i?u.Hvt(t):t).G5(n,!1),!0)}function s(t,n,i,e){var r;return!!t&&2!==t.Di&&((r=t.il)&&r.Dvt()?a(t,n,!1,i,e):(t=r?u.Hvt(t):t).G5(n,!1,i,e),!0)}function f(t,n,i){var e,r,r,r,o,u,o,a,a,t,a,e=t.il,r=t.parent,r=r&&r.options;e&&e.Dvt()&&r&&r.allowUserEditFormula&&r.enableFormulaTextbox&&(r=t.rt,u=(o=C(t)).anchorRow,o=o.anchorCol,a=e.XD?(a=e.zvt(),(0,A.Vvt)(t,a.text)):(0,x.Ec)(u,o,1,1))&&(t=t.HR(a,n,i,u,o),a=(0,A.Uvt)(r.Mf,t))&&e.Gvt(a,!0,!1)}function c(t,n,i){if(t){if(2===t.Di)return!1;var e=t.il;if(e&&e.Dvt())f(t,n,i);else{if(!(t=e?u.Hvt(t):t).endEdit())return!1;t.HA(n,i)}return!0}return!1}function l(){}Object.defineProperty(n,"__esModule",{value:!0}),x=i("Core"),n=i("Common"),A=i("./dist/plugins/formulaTextbox/formulatextbox.js"),r=i("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),o=void 0,m=n.Common.lt.ht,x.Commands.B5=e,x.Commands.UA=s,x.Commands.L5=c,l.YA=function(t){return l.Hvt(t)},l.ZA=function(t){return l.Hvt(t)},l.WA=function(t){return l.Hvt(t)},l.Hvt=function(t){var t,n,t=t,n=r.wvt.Rvt;return n&&n._text&&n.Mf&&(t=n.Mf,l.Yvt(t)),t},l.Yvt=function(t,n){var i,e;void 0===n&&(n=!0),i=t.parent,(e=r.wvt.Rvt)&&e._text&&i.e3(t,n)},l.KA=function(t,n,i){var e,r,o,n,e=!1,r=t.il;return r&&r.Dvt()?((o=C(t)).anchorRow=n,o.leadingRow=n,(n=(0,A.Uvt)(t,(0,x.Ec)(o.anchorRow,o.anchorCol,1,1)))&&r.Gvt(n,!1,!0),t.$A(i),e=!0):r&&(t=l.Hvt(t)),{sheet:t,r:e}},l.eI=function(t,n,i){var e,r,o,n,e=!1,r=t.il;return r&&r.Dvt()?((o=C(t)).anchorRow=n,o.leadingRow=n,(n=(0,A.Uvt)(t,(0,x.Ec)(o.anchorRow,o.anchorCol,1,1)))&&r.Gvt(n,!1,!0),t.$A(i),e=!0):r&&(t=l.Hvt(t)),{sheet:t,r:e}},l.Zvt=function(t,n){var i,n,e,r,o,i=!1,n=n?5:6,e=t.il,r=t.ui,o=t.ci;return e&&e.Dvt()?(e.XD||(t.rt.Lvt={anchorRow:r,anchorCol:o,leadingRow:t.qA,leadingCol:t.hR}),a(t,n,!1,r,o),i=!0):e&&(t=l.Hvt(t)),{sheet:t,r:i}},l.iI=function(t){return l.Zvt(t,!0)},l.rI=function(t){return l.Zvt(t,!1)},l.oI=function(t){return l.Hvt(t)},l.aI=function(t){return l.Hvt(t)},l.cI=function(t){var n,i,e,n,n=r.wvt.Rvt;if(n&&n._text&&n.Mf&&(t=n.Mf,i=n.bZ,e=n.mvt,l.Yvt(t,!1),(0,A.Wvt)(t),n.rl||t.t4(i,e,o,o,1),t.isEditing()))return n=t.getValue(i,e,3),!!t.ol(!0,void 0,void 0,!0)&&(t.setValue(i,e,n,3,!0),!0)},u=l,x.Commands.VA=u},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(t,n,i){var T,M,v,w,x,n,j,i,A,y,m,C;function D(t,n,i,e){var r,t,r,o,u,a,s,f,r=t.il,t=t.Ut,r=r.Qvt(),o=T.SheetArea.viewport;return r===T.SheetArea.colHeader&&e===T.SheetArea.colHeader?n<(u=t.getFreeAreaRowCount(T.SheetArea.colHeader))&&(o=T.SheetArea.colHeader):r===T.SheetArea.rowHeader&&e===T.SheetArea.rowHeader&&i<(s=t.getFreeAreaColumnCount(T.SheetArea.rowHeader))&&(o=T.SheetArea.rowHeader),o}function R(t,n,i,e,r,o,u,a){var s=t.xA(n,i,n,i,u,a),s=(0,T.Ec)(s.row,s.col,1,1);return s=o&&0<=e?t.xA(n,i,e,r,u,a):s}Object.defineProperty(n,"__esModule",{value:!0}),T=i("Core"),M=i("CalcEngine"),v=i("SheetsCalc"),w=i("./dist/plugins/formulaTextbox/formulatextbox.js"),x=i("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),n=i("Common"),j=n.Common.lt.ht,i=T.GC$.extend,A=null,y=void 0,m=Math.max,C=Math.min,i(T.nk.prototype,{Kvt:function(t){var n,i,e,r,r,o,u,a,s,f,c,l,h,v,g,d,I,p,x,A,m,C,b,o,s,u,f,i,c,r,o,s,n=this,i=n.Mf,e=i.il,r=i.parent,r=r&&0!==r.options.pivotAreaReference;e&&(n.Jvt(),o=i.frozenRowCount(),u=i.frozenColumnCount(),(a=e.XD)&&n.Lvt||(n.Lvt={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),s=i.getRowCount(),f=i.getColumnCount(),c=t.hitTestType,l=t.row,h=t.col,v=n.shift,g=n.ctrl,e&&e.Xvt&&(e.Xvt===T.SelectionUnit.row?c=2:e.Xvt===T.SelectionUnit.column&&(c=1)),I=(d=n.Lvt).anchorRow,p=d.anchorCol,A=x=-1,C=D(i,l,h,c),0===c?(x=o?i.N9():i.Tb,A=u?i.k9():i.Ab,m=(0,T.Ec)(-1,-1,-1,-1),e.Gvt((0,w.Uvt)(i,m),v,!g,y,C),n.rb=!0):1===c?(C===T.SheetArea.viewport?(x=o?i.N9():i.Tb,m=i.xA(0,A=h,s-1,h,!0),v&&0<=p&&(m=i.xA(0,h,s-1,p,!0)),m=(0,T.Ec)(-1,m.col,-1,m.colCount)):C===T.SheetArea.colHeader&&(m=R(i,x=l,A=h,I,p,v,!0,C)),(b=t.tableSelectInfo&&t.tableSelectInfo.tableSelection)?n.kse(b,m,l,h,I,p,v,g,C):e.Gvt((0,w.Uvt)(i,m,y,C),v,!g,y,C),n.rb=!0):2===c?(x=l,A=u?i.k9():i.Ab,m=i.xA(l,0,l,f-1,!0),v&&0<=I&&(m=i.xA(l,0,I,f-1,!0)),m=(0,T.Ec)(m.row,-1,m.rowCount,-1),e.Gvt((0,w.Uvt)(i,m),v,!g,y,C),n.rb=!0):3===c&&(A=h,(x=l)!==y)&&h!==y&&(o=t.row,s=t.col,i=(f=(u=t.pivotTableInfo)&&u.getPivotInfoImp(o,s,!1,!0))&&f.area,b=t.tableSelectInfo&&t.tableSelectInfo.tableSelection,!(r&&M.Functions.findGlobalFunction("GETPIVOTDATA")&&!e.Ivt&&u&&f&&4===i)||(e.Fvt=new T.Range(o,s,1,1),c=f.valueFieldName,r=f.rowInfos,o=f.colInfos,j(c))||!r&&!o?n.kse(b,m,l,h,I,p,v,g,C):(s=n.Pvt(i,c,r,o,u.position()))&&(e.Gvt(s,v,!g,!0,C),n.rb=!0,n.LD=!0)),n.Wk=n.rb,v&&a||(d.anchorRow=x,d.anchorCol=A,d.leadingRow=x,d.leadingCol=A,d.sheetArea=C),n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok())},kse:function(t,n,i,e,r,o,u,a,s){var f,c,l,f=this,c=f.Mf,l=c.il;delete l.Fvt,n=t||R(c,i,e,r,o,u,!0,s),l.Gvt((0,w.Uvt)(c,n,y,s),u,!a,y,s),f.rb=!0},Pvt:function(t,n,i,e,r){var o,u,t,a,s,f,r,f,c,r,l,h,u,o,u=this.Mf;if(4===t)return a=t=void 0,f=r.row,r=r.col,f=(s="",T.Ec)(f,r,1,1),t=(0,w.Uvt)(u,f,!0),c=[],r=[],r=Array.isArray(i)&&Array.isArray(e)?i.concat(e):Array.isArray(i)&&i||Array.isArray(e)&&e,l=/\"/g,h='""',r&&r.forEach(function(t){"number"==typeof t.fieldName?c.push(t.fieldName):c.push('"'+t.fieldName.replace(l,h)+'"'),"number"==typeof t.itemName?c.push(t.itemName):c.push('"'+t.itemName.replace(l,h)+'"')}),s=c.join(","),u='GETPIVOTDATA("'+(a=n.replace(l,h))+'",'+t,""!==s&&(u+=","+s),u+")"},qvt:function(t){var n,i,e,r,n=!1,i=x.wvt.Rvt;if(i&&i.bvt)if(e=i.Mf,(r=t.il)&&e.setFormula(i.bZ,i.mvt,r.text()),e!==t){if(T.Commands.VA.Yvt(e),!e.endEdit())return;n=!0}else r&&(r.destroy(),t.il=A),i.d5();return n},Qk:function(){var t,n,i,e,i,e,t=this,n=this.$vt(),i=t.Rk,e=t.Lvt;i&&t.rb&&(i=i.Bk,e=e.sheetArea,n&&n.Xvt&&(n.Xvt===T.SelectionUnit.row?i=2:n.Xvt===T.SelectionUnit.column&&(i=1)),i===T.SheetArea.viewport||e===T.SheetArea.colHeader||e===T.SheetArea.rowHeader?t.tmt():2===i?t.nmt():1===i&&t.emt())},tmt:function(){var t,n,i,e,n,r,o,u,r,o,i,t=this,n=t.Lvt,i=n.anchorRow,e=n.anchorCol,n=n.sheetArea,r=t.Q9(y,n,!0),o=t.K9(y,n,!0);0<=i&&0<=e&&0<=r&&0<=o&&(r=(u=t.Mf).xA(r,o,i,e,!0,n),o=(0,w.Uvt)(u,r,y,n))&&(i=u.il,t.LD?r.equals(i.Fvt)||(delete i.Fvt,i.Gvt(o,!0,!0)):i.Gvt(o,!0,!1)),t.a9()},nmt:function(){var t,n,i,e,i,n,r,t=this,n=t.Lvt.anchorRow,i=t.Q9();0<=n&&0<=i&&(i=(e=t.Mf).xA(i,0,n,e.getColumnCount()-1,!0),i=(0,T.Ec)(i.row,-1,i.rowCount,-1),n=(0,w.Uvt)(e,i))&&(r=e.il).Gvt(n,!0,!1),t.a9()},emt:function(){var t,n,i,e,i,n,r,t=this,n=t.Lvt.anchorCol,i=t.K9();0<=n&&0<=i&&(i=(e=t.Mf).xA(0,i,e.getRowCount()-1,n,!0),i=(0,T.Ec)(-1,i.col,-1,i.colCount),n=(0,w.Uvt)(e,i))&&(r=e.il).Gvt(n,!0,!1),t.a9()},_D:function(){var t=this;t.l9(),t.Rk=A,t.rb=!1,t.Wk=!1},Mk:function(t){var n,i,e,r,e,r,o,r,i,u,a,u,a,n=this,i=n.Mf,e=n.$vt(),r=t.formulaRangeHitInfo;r&&r.inBorder&&e&&(e.XD&&e.qD(),e.close(),r=(e=r.paramRange)&&e.text,o=j(e.sheetArea)?T.SheetArea.viewport:e.sheetArea,r)&&(r=(0,w.Vvt)(i,r))&&(n.Jvt(),i=i.JS(r,o),u=t.row,a=t.col,(u=u<i.row?i.row:u)>=i.row+i.rowCount&&(u=i.row+i.rowCount-1),(a=a<i.col?i.col:a)>=i.col+i.colCount&&(a=i.col+i.colCount-1),u=u-i.row,a=a-i.col,n.rb=!0,n.Kk=!0,n.imt={paramRange:e,fromRange:r,rowOffset:u,colOffset:a,sheetArea:o},n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok())},Jk:function(){var t,n,i,e,r,o,u,a,s,f,c,l,s,f,l,h,v,g,o,d,I,I,d,I,h,p,t=this;t.rb&&t.Kk&&(i=(n=t.imt).sheetArea,e=t.Q9(y,i,!0),r=t.K9(y,i,!0),0<=e&&0<=r&&(o=n.fromRange,u=n.rowOffset,a=n.colOffset,s=n.toRow,f=n.toCol,l=r,e!==s||l!==f)&&(n.toRow=e,n.toCol=l,f=(s=t.Mf).getRowCount(i),l=s.getColumnCount(i),h=o.row,v=o.col,g=o.rowCount,o=o.colCount,(I=(d=s.Ut).getFreeAreaRowCount(i))<f&&(f=I),(I=d.getFreeAreaColumnCount(i))<l&&(l=I),d=h<0?-1:m(0,C(f-g,e-u)),I=v<0?-1:m(0,C(l-o,r-a)),h=(0,w.Uvt)(s,(0,T.Ec)(d,I,g,o),y,i))&&(p=t.$vt()).rmt(n.paramRange.index,h,!0),t.a9())},ED:function(){var t,t,t=this;t.l9(),t.rb=!1,t.Kk=!1,t.imt=A,(t=t.$vt()).onRangeMoved&&t.onRangeMoved()},Ck:function(t){var n,i,e,r,e,o,u,i,o,a,u,s,f,c,l,n=this,i=n.Mf,e=n.$vt(),r=t.formulaRangeHitInfo;if(r&&e&&(e.XD&&e.qD(),o=(e=r.paramRange)&&e.text,e)&&o&&(u=(0,w.Vvt)(i,o))){if(n.Jvt(),i=u.row,o=u.row<0?-1:u.row+u.rowCount-1,a=u.col,u=u.col<0?-1:u.col+u.colCount-1,r.inTopLeft)s=o,f=u,c=i,l=a;else if(r.inTopRight)s=o,f=a,c=i,l=u;else if(r.inBottomLeft)s=i,f=u,c=o,l=a;else{if(!r.inBottomRight)return;s=i,f=a,c=o,l=u}n.rb=!0,n.Xk=!0,n.omt={paramRange:e,anchorRow:s,anchorCol:f,toRow:c,toCol:l,sheetArea:t.hitTestType},n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok()}},Ik:function(t,n){var i=t.il;return!(i&&i.qMi||(i&&i.Dvt()?(this.Kvt(n),0):!this.qvt(t)))},qk:function(){var t,n,i,e,r,o,u,a,s,e,r,a,s,i,o,u,f,c,o,e,u,r,s,t=this;t.rb&&t.Xk&&(n=t.omt,i=T.SheetArea.viewport,n&&!j(n.sheetArea)&&(i=n.sheetArea),e=t.Q9(y,i,!0),r=t.K9(y,i,!0),0<=e&&0<=r&&(o=n.anchorRow,u=n.anchorCol,a=n.toRow,s=n.toCol,r=r,(e=e)!==a||r!==s)&&(n.toRow=e,n.toCol=r,s=(a=t.Mf).getRowCount(i),i=a.getColumnCount(i),u=u<0?i-1:u,f=C(o=o<0?s-1:o,e),c=C(u,r),o=m(o,e)-f+1,e=m(u,r)-c+1,u=t.$vt(),(0===f&&o===s||u&&u.Xvt===T.SelectionUnit.column)&&(o=f=-1),(0===c&&e===i||u&&u.Xvt===T.SelectionUnit.row)&&(e=c=-1),r=n.paramRange,s=(0,w.Uvt)(a,(0,T.Ec)(f,c,o,e),y,r.sheetArea))&&u.rmt(r.index,s,!0),t.a9())},jD:function(){var t,t,n,t=this;t.l9(),t.rb=!1,t.Xk=!1,t.omt=A,(t=t.$vt()).rl&&-(t.umt=1)!==(n=t.text().lastIndexOf(",",t.caret()))&&(t.umt=n+1),t.onRangeResized&&t.onRangeResized()},ZL:function(t,n,i){var e,r,o,u,a,s,f,c,l,h,l,v,v,g,d,I,p,l,e=this.Mf,r=this.$vt(),o=r&&r.smt();if(o&&0!==o.length&&r.cmt&&(u=t.rowViewportIndex,a=t.colViewportIndex,s=t.hitTestType,!this.yD(u,a,n,i)))for(h=o.length-1;0<=h;h--)if(l=(f=o[h]).sheetArea,!1!==f.allowDrag&&(j(l)||l===s)&&!((v=x.wvt.Rvt)&&v._text||(c=(0,w.Vvt)(e,f.text),j(c)))){if(j(l)&&(l=T.SheetArea.viewport),(v=e.Ut.findSpan(c.row,c.col,l))&&v.containsRange(c)&&(c=v),d=(l=e.getRangeRect(u,a,c)).x-2,I=l.x+l.width+1-(g=5),p=l.y-2,l=l.y+l.height+1-5,5+d<=n&&n<I&&(1+p<=i&&i<=3+p||1+l<=i&&i<=3+l))return{paramRange:f,inBorder:!0};if(5+p<=i&&i<l&&(1+d<=n&&n<=3+d||1+I<=n&&n<=3+I))return{paramRange:f,inBorder:!0};if(I<=n&&n<5+I&&l<=i&&i<5+l)return{paramRange:f,inBottomRight:!0};if(d<=n&&n<5+d&&l<=i&&i<5+l)return{paramRange:f,inBottomLeft:!0};if(I<=n&&n<5+I&&p<=i&&i<5+p)return{paramRange:f,inTopRight:!0};if(d<=n&&n<5+d&&p<=i&&i<5+p)return{paramRange:f,inTopLeft:!0}}return A},$vt:function(){var t=this.Mf;return t.il||t.mnn},hI:function(){var t,n,i,e,r,o,o,u,a,s,f,c,l,n,h,o,t=this,n=t.Mf,i=n.il;if(i)if(e=n.ui,r=n.ci,o=(o=n.parent)&&1===o.options.referenceStyle,u=new v.SheetParserContext(n,o,(0,M.eV)(e,r)),a=new M.Parser,i.XD)for(c=i.fmt(),l=0;l<c.length;l++){s=c[l];try{f=a.parse(u,s.text)}catch(t){f=A}f&&1===f.type&&(t.lmt(f,e,r,!0,!0),i.rmt(s.index,a.unparse(u,f)))}else if(s=i.zvt()){try{f=a.parse(u,s.text)}catch(t){f=A}f&&1===f.type&&(f.isFullColumn||f.isFullRow?(t.lmt(f,e,r,!0,!0),i.rmt(s.index,a.unparse(u,f))):f.hmt()?(t.dmt(f,e,r),i.rmt(s.index,a.unparse(u,f))):(n=s.textOffset+s.text.lastIndexOf(":"),(h=i.caret()<=n)?(t.lmt(f,e,r,!0,!1),o=a.unparse(u,f),i.rmt(s.index,o),i.caret(s.textOffset+o.lastIndexOf(":"))):(t.lmt(f,e,r,!1,!0),i.rmt(s.index,a.unparse(u,f)))))}},lmt:function(t,n,i,e,r){var o,u,e,o,o=t.rowRelative,u=t.columnRelative;e&&(o&&u?(t.rowRelative=!1,t.columnRelative=!1,t.row+=n,t.column+=i):!o&&u?(t.rowRelative=!0,t.columnRelative=!1,t.row-=n,t.column+=i):(t.columnRelative=!0,t.column-=i)),e=t.endRowRelative,o=t.endColumnRelative,r&&(e&&o?(t.endRowRelative=!1,t.endColumnRelative=!1,t.endRow+=n,t.endColumn+=i):!e&&o?(t.endRowRelative=!0,t.endColumnRelative=!1,t.endRow-=n,t.endColumn+=i):(t.endColumnRelative=!0,t.endColumn-=i))},dmt:function(t,n,i){var e=t.rowRelative,r=t.columnRelative;e&&r?(t.rowRelative=!1,t.columnRelative=!1,t.row+=n,t.column+=i):!e&&r?(t.rowRelative=!0,t.columnRelative=!1,t.row-=n,t.column+=i):(t.columnRelative=!0,t.column-=i)},Jvt:function(){var t,n,i,t,n=this.Mf.il;n&&(i=n.Ti)&&n.vmt(i)&&n.mmt()}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(t,n,i){var P,L,U,Z,n,F;function c(t,n,i,e,r,o){var u,a,s,f,c,l,h,v,g,d,I,p,x,A,m,C,b,T,m,M,w,j,j,m,y,y,D,R,N,B,k,E,S,O,G,u=t.Mf,a=u.rt,s=u.C6(i,e),f=o&&o.smt(),c=f&&f.length;if(!(c<=0)&&(l=t.uO(i,e,r))){for(n.save(),n.rect(l.x,l.y,l.width,l.height),n.clip(),n.beginPath(),h=[],v=a.isFormulaRangeHovering,g=a.AD,d=a.Kk,I=a.imt,p=a.Xk,x=a.omt,M=0;M<c;M++)if(("number"!=typeof(m=(A=f[M]).sheetArea)||m===s)&&(m=A.text,C=A.ranges&&0<A.ranges.length?A.ranges:[(0,U.Vvt)(u,m)])){if((w=Z.wvt.Rvt)&&w.Mf&&void 0!==m)if(F.OS(m,"!")){if(j=F.gmt(m,"!"),u.name()!==j&&"'"+u.name()+"'"!==j)continue}else if(j=F.gmt(m,"["),m=u.tables,y=(y=u.NMi)&&y._gi===P.SheetType.tableSheet&&y.name()===j,!(u.getCustomNames()[j]||m&&m.findByName(j)||y))continue;for(b=t.fO(i,e,C,l),D=0;D<b.length;D++)(R=b[D])&&0<R.width&&0<R.height&&(T=o.pmt(M),o.bmt(A)||A.isPivotClickCell?(v&&g.paramRange.index===M&&(n.beginPath(),n.lineWidth=2,n.strokeStyle=T,n.rect(R.x+1,R.y+1,R.width-3,R.height-3),n.stroke()),t.wO(n,R,T)):(v&&g.paramRange.index===M||d&&I.paramRange.index===M||p&&x.paramRange.index===M?(n.beginPath(),n.lineWidth=2,n.strokeStyle=T,n.rect(R.x+1,R.y+1,R.width-3,R.height-3)):(n.beginPath(),n.lineWidth=2,n.strokeStyle=T,n.rect(R.x,R.y,R.width-1,R.height-1)),n.stroke()),o.ymt(A)&&((N=L.Common.ft._(T)).a=.1,n.beginPath(),n.fillStyle=L.Common.ft.j(N),n.fillRect(R.x+1,R.y+1,R.width-3,R.height-3)),h.push({rect:R,color:T,allowDrag:A.allowDrag}))}if(0<h.length&&o.cmt)for(B=h.length,M=0;M<B;M++)R=h[M].rect,T=h[M].color,E=R.x-2,S=R.x+R.width+1-(k=5),O=R.y-2,G=R.y+R.height+1-5,!1===h[M].allowDrag||(w=Z.wvt.Rvt)&&w._text||(n.beginPath(),n.fillStyle=T,n.fillRect(E,O,5,5),n.fillRect(S,O,5,5),n.fillRect(E,G,5,5),n.fillRect(S,G,5,5));n.beginPath(),n.restore()}}Object.defineProperty(n,"__esModule",{value:!0}),P=i("Core"),L=i("Common"),U=i("./dist/plugins/formulaTextbox/formulatextbox.js"),Z=i("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),n=P.GC$.extend,F=L.Common.zf,n(P.g7.prototype,{ID:function(){var t,n,n,i,t=this,n=t.Mf;0<n.My||(n=n.Fi(),i=t.J(),t.FA(n.x,n.y,n.width,n.height),t.jy(i))}}),P.Worksheet.ch("formulatextboxrender",{paintAdornment:function(t){var n,i,e,r,o,u,a,s,f,n=this,i=t.ctx,e=t.clipRect,r=n.Dn,o=n.Fi(),f=n.rt.$vt();if(f)for(a=-1;a<=2;a++)for(s=-1;s<=2;s++)-1===a&&-1===s||(u=-1===a?o.L1(s):-1===s?o.B1(a):o.c9(a,s))&&0!==u.width&&0!==u.height&&c(r,i,a,s,e,f)}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(n,a,t){var p,h,v,x,g,A,s,f,L,t,u,l,c,d,I,m,i,C,b,r,T,M,w,o,j,y,D,R,U,e,Z,F,z,N,B,E,Y,Q,W,_,V,X,K,H,J,q,$,S,O,tt,nt,t,it,et,rt;function ot(t,n){for(var i,e,i=0,e=0;e<t.length;e++)t[e]===n&&i++;return i}function ut(){var i=[];return x.GC$.each(p.sR().wmt,function(t,n){p.Functions.Mmt[t]&&(n.name=t,i.push(n))}),i}function at(t){var i=[],e;return x.GC$.each(t,function(t,n){(e=n.description())&&(e.name=t,i.push(e))}),i}function st(t,n,i){if(t){var e=!1,r=!1;if(1===n.rowCount){if(t.hasHeadersRow()&&n.row===t.startRow())return 1;if(t.hasTotalsRow()&&n.row===t.endRow())return 1;if(n.row===i&&n.col>=t.startColumn()&&n.col+n.colCount<=t.startColumn()+t.dataRange().colCount)return 1}else t.hasHeadersRow()&&n.row===t.startRow()&&(n.rowCount===t.dataRange().rowCount+1&&(e=!0),t.hasTotalsRow())&&n.rowCount===t.dataRange().rowCount+1+1&&(e=!0),n.row===t.dataRange().row&&(n.rowCount===t.dataRange().rowCount&&(e=!0),t.hasTotalsRow())&&n.rowCount===t.dataRange().rowCount+1&&(e=!0);return n.col+n.colCount<=t.startColumn()+t.dataRange().colCount&&(r=!0),e&&r}}function ft(t){return t.replace(/'/g,"''")}function ct(t){var t=t.name();return h.Cmt(t.split(""),!1)?t:"'"+ft(t)+"'"}function G(t){var n,n,n=p.getMapping()&&p.getMapping().builtInFunctionsMapping,n=n&&n[t]&&n[t].alias||t;return d.j0(n)}function lt(t,n,i){var i;return i?(i=new RegExp(tt,"g"),t.replace(i,"")===n.replace(i,"")):t===n}function ht(t,n,i,e){var r,o,u,a,u,s,s,f,c,c,i,r,l;return void 0===e&&(e=x.SheetArea.viewport),n?(r=t.il,a=(u=(o=g.wvt.Rvt)&&o.Mf||t).ui,u=u.ci,s=(s=t.parent)&&1===s.options.referenceStyle,f=15,(t.il&&t.il.Ivt||i)&&(f=0),n.row<0&&n.col<0&&(n=new x.Range(0,-1,t.getRowCount(),-1)),c=(c=t.tables)&&c.find(n.row,n.col),(o&&o.Ivt||i)&&(f=0),r&&!r.rl&&st(c,n,a)?(o&&o._text&&o.Mf!==t&&(u=-1),h.rangeToFormulaWithStructReference(t,n,a,u,f,s,c)):(i=t.NMi,!c&&e===x.SheetArea.viewport&&i&&i._gi===x.SheetType.tableSheet?dt(t,n.col,n.colCount,c=i):(r=h.rangeToFormula(n,a,u,f,s),o&&o._text||t.il&&t.il.rl&&t.il.Smt?(l=ct(t))+"!"+r:r))):A}function vt(t){for(var n,i,e,r,o,u,n=[],i=0,e="";e!==A;)e=t.getColumnName(i),o=void 0,t.Mf.NMi&&(o=t.FDi(i))&&(r=i),i++,e!==A&&n.push({name:e,description:"",isGroupColumn:o});return u={columns:n},m(r)||(u.groupInfo={rightGroupColumnIndex:r}),u}function gt(t){return t&&"["===t[0]&&"]"===t[t.length-1]}function dt(t,n,i,e){var r,o,r,e,r,r,i,n,r=vt(e),o=r.columns,r=r.groupInfo,e=e.name();if(-1===n&&(n=0),-1===i&&(i=o.length),r){if(r=r.rightGroupColumnIndex,1===i&&n<=r)return"";if(1<i&&n<=r){if(n+i<=r+1)return"";i-=r-n+1,n=r+1}}return 1===i?"".concat(e,"[").concat(o[n].name,"]"):1<i?(r=n+i-1,gt(i=o[n].name)||(i="[".concat(i,"]")),gt(n=o[r].name)||(n="[".concat(n,"]")),"".concat(e,"[").concat(i,":").concat(n,"]")):""}function It(i,t,n,e,r,o){var u,a,n,t,s,f,c,u=i.parent,a=u&&u.options;(t&&a&&a.allowUserEditFormula&&a.enableFormulaTextbox||n)&&(i.il&&i.il.destroy(),i.il=new rt(t,null,u),n=i.il.text(),t=i.getFormulaInformation(e,r,o),n[0]!==nt||t&&t.hasFormula||n===nt||a.allowInvalidFormula||i.il.text(n="'"+n),s=i.il,f=i.rt,c=i.Dn,s.bind("AppendStarted",function(){s.close();var t=i.Di;1!==t&&(i.Di=1,i._i(t,1))}),s.bind("AppendEnded",function(){c.ID()}),s.bind(D,function(t,n){var n;i.xT||(n&&n.type!==T&&(f.By(n),n=i.getCellType(e,r,o),i.ki(x.Events.EditChange,{sheet:i,sheetName:i.name(),row:e,col:r,editingText:n.getEditorValue(i.li)})),c.ID(),i.ki(x.Events.FormulaTextBoxTextChanged,{sheet:i,sheetName:i.name(),text:s.text(),sheetArea:o}))}),s.bind("CaretChanged",function(){c.ID(),i.ki(x.Events.FormulaTextBoxCaretChanged,{sheet:i,sheetName:i.name(),caret:s.caret()})}),s.add(ut()),s.add(at(p.Functions.Tmt)),s.add(at(i.Amt).concat(at(u.Amt))),c.ID())}function pt(t){t.il&&(t.il.destroy(),t.il=A,t.Dn.ID());var n=t.parent&&t.parent.h6;c.activeElement===(n&&n.Ti)&&t.rt.aA()}function xt(t,n){var i,i,e,i;if(n){e=(i=(i=g.wvt.Rvt)&&i.Mf||t).ui,i=i.ci;try{return h.formulaToRange(t,n,e,i)}catch(t){}}return A}function At(t,n){var t,i,e,i,e,r,i,t,o,e,o,t=(0,x.GC$)(t);return t.attr("contenteditable","false"),i=u("table"),(0,x.GC$)(i).css("border-spacing","0"),(0,x.GC$)(i).css("width","100%"),t.append(i),e=u("tbody"),i.appendChild(e),i=document.createElement("tr"),e.appendChild(i),e=document.createElement("td"),(0,x.GC$)(e).css("padding-right","0px"),i.appendChild(e),r=document.createElement("td"),(0,x.GC$)(r).css("width","23px"),(0,x.GC$)(r).css("padding-right","0px"),i.appendChild(r),i=t.width()-(0,x.GC$)(r).width(),t=u("div"),o=u("div"),(0,x.GC$)(o).width(i),(0,x.GC$)(o).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),o.appendChild(t),e.appendChild(o),e=u("div"),r.appendChild(e),(0,x.GC$)(t).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),(0,x.GC$)(t).width(i),(0,x.GC$)(t).attr("contenteditable","true"),(0,x.GC$)(t).attr("spellcheck","false"),(o=(0,x.GC$)(e)).css({display:"block",float:"right",width:"23px",height:"23px",background:H,"background-repeat":"no-repeat"}),o.bind("click",function(){n.Imt?(n.Vv.ki("RangeSelectEnding",n),n.endSelectMode()):n.startSelectMode()}),{contentDiv:t,button:e}}function mt(t){for(var n,i,n=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE","MAP","REDUCE","SCAN","MAKEARRAY","BYROW","BYCOL","TEXTSPLIT","HSTACK","VSTACK","TOROW","TOCOL","WRAPROWS","WRAPCOLS","TAKE","DROP","EXPAND","CHOOSEROWS","CHOOSECOLS"],i=0;i<n.length;i++)if(t===n[i])return 1}function k(t,n,i){var e,r,n,n,o,u,e=this,r=t;if(e.rl=!1,e.Ivt=!1,e.xmt=!0,e.Smt=!0,e.Nmt=[],e.kmt=[],e.Dmt=[],e.U6=!1,n&&n.rangeSelectMode&&(!0===n.absoluteReference&&(e.Ivt=!0),!1===n.needSheetName&&(e.Smt=!1),!1===n.acrossSheet&&(e.xmt=!1),e.Xvt=n.selectionUnit,e.rl=!0,e.Imt=!1,e._mt=!1,r=(n=At(e.Emt=t,e)).contentDiv,e.jmt=n.button,e.Omt=t,e.Avt=et,et++),e.cmt=!0,e.Hc(i&&i.getHost()||c.body),r&&e.Rmt(r),i&&(e.Bmt=!0,e.Lmt(i),e.Vv._3(x.Events.FormulaTextboxActiveSheetChanging+j,g.wvt.Ovt),e.Vv.D3(x.Events.FormulaTextboxActiveSheetChanging+j,g.wvt.Ovt),e.Vv._3(x.Events.FormulaTextboxActiveSheetChanged+j,g.wvt.Bvt),e.Vv.D3(x.Events.FormulaTextboxActiveSheetChanged+j,g.wvt.Bvt),e.Vv._3(x.Events.FormulaTextBoxUpdatePosition+w,void 0),e.Vv.D3(x.Events.FormulaTextBoxUpdatePosition+w,function(t,n){e.u_()})),n=e.text(),e.Fmt=e.Ost(n),o=e.vmt(r)){e.Pmt(e.Fmt);try{(u=l.getSelection()).selectAllChildren(r),0<u.rangeCount&&u.collapseToEnd()}catch(t){}(0,x.GC$)(e.Ti).data(S,n)}(0,x.GC$)(t).data(a.CONST_FORMULATEXTBOX,e)}function Ct(){var t,n,i,n,t=l.getSelection();0<t.rangeCount&&(n=t.getRangeAt(0),(i=c.createElement("span")).innerHTML="<br/>\u200b",n.insertNode(i),(n=c.createRange()).setStartAfter(i),n.setEndAfter(i),n.collapse(!1),t.removeAllRanges(),t.addRange(n))}function P(t){return"gcAttachedFormulaTextBox"===t.target.getAttribute("gcuielement")}Object.defineProperty(a,"__esModule",{value:!0}),a.FormulaTextBox=a.Vvt=a.Wvt=a.Evt=a.Uvt=a.CONST_FORMULATEXTBOX=void 0,p=t("CalcEngine"),h=t("SheetsCalc"),v=t("Common"),x=t("Core"),g=t("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),A=null,s=void 0,f=Math.max,L=Math.min,t=x.GC$.extend,u=x.mt.En,l=window,c=document,d=v.Common.zf,I=x.mt.vi,m=v.Common.lt.ht,i=x.mt.Tt,C=i.msie&&parseInt(i.version,10)<10,b=d.Gmt,a.CONST_FORMULATEXTBOX="formulatextbox",r="gcUIElement",T="input",M="\xa0",w=".gcFormulaTextBoxInternal",o=".gcFormulaTextBox",j=".gcFormulaTextBoxAcrossSheetInternal",y=".gcsj-func-ac-row",D="TextChanged",R="CaretChanged",U="AppendStarted",e="AppendEnded",F=37,z=39,N=38,B=40,E=9,Y=13,Q=33,W=34,_=35,V=36,X=27,K=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],H='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',J='url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',q="background",$="background-repeat",S="text-before",O="caret-before",tt="\u200b",nt="=",a.Uvt=ht,x.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",x.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",x.Events.FormulaTextBoxUpdatePosition="FormulaTextBoxUpdatePosition",l.Vc.wf.push(function(t,n){var i,n,i=g.wvt;!n&&t.endEdit&&i&&(n=i.Rvt)&&n.bvt&&t.il&&(t.il&&t.il.destroy(),t.il=A,n.rl||n.d5())}),a.Evt=It,a.Wvt=pt,a.Vvt=xt,t(x.Hv.prototype,{C2:function(t){return!(t&&t.il&&t.il.Dvt())},D2:function(t){return!t||!t.il||!!t.il.xmt}}),x.Worksheet.ch(a.CONST_FORMULATEXTBOX,{startEdit:function(t){t.preventFormulaTextBox||It(this,t.element,s,t.row,t.col,t.sheetArea)},endEdit:function(){pt(this)},preProcessKeyDown:function(t){var n,n,n=this.il;(n&&n.$D(t.e)||(n=this.parent&&this.parent.h6)&&n.$D(t.e,t.c))&&(t.r=!0)}}),t=x.Hv.prototype,it=t.O2,x.Hv.ch(a.CONST_FORMULATEXTBOX,{preProcessMouseDbClick:function(t){var n,n,n,i,n=(0,x.jf)(this.Vv),n=n?n.il:void 0,n=n&&n.Dvt(),i=g.wvt.Rvt;n?t.r=!1:i&&i.bvt&&i.d5()}}),t.O2=function(){var t=(0,x.jf)(this.Vv),t=t&&t.il,n=g.wvt.Rvt,n=n&&n._text;return it.call(this)&&!n&&!t},et=1,k.prototype.Umt=function(t){var n,i,e,i,t,r,o,n=this;n.Hmt(),n.FD(),n._mt=!0,i=(0,g.Mvt)(n.Vv.Ti),(e=n.zmt())&&(e.suspendPaint(),It(e,i,!0,e.ui,e.ci,3),(i=e.il).rl=!0,i.Avt=n.Avt,i.Ivt=n.Ivt,i.Smt=n.Smt,i.Xvt=n.Xvt,i.xmt=n.xmt,t&&(n.text(t),n.caret(t.length)),t=n.text(),(r=n.caret())<=0&&(r=t.length),n.focus(),n.caret(r),n.XD=!0,-(n.umt=1)!==(o=t.lastIndexOf(",",r))&&(n.umt=o+1),t||(n.text("="),t="=",n.caret(1),r=1),"="!==t[0]&&(t="="+t,r++),i.text(t),i.caret(r),i.XD=n.XD,i.umt=n.umt,e.resumePaint())},k.prototype.startSelectMode=function(t){var t,n,t=t;t&&0!==t.indexOf("=")&&(t="="+t),(n=this).rl=!0,n.Imt=!0,(0,x.GC$)(n.jmt).css([q,$],[J,"no-repeat"]),n.Umt(t)},k.prototype.endSelectMode=function(){this.Imt=!1,this.Vmt(),(0,x.GC$)(this.jmt).css([q,$],[H,"no-repeat"])},k.prototype.Vmt=function(){var t=this.zmt();t&&(t.ol(!0,s,!0),t.repaint())},k.prototype.Ak=function(t){t&&(this.Dmt=[t])},k.prototype.Gce=function(){this.Dmt=A},k.prototype.Ymt=function(){return this.Dmt},k.prototype.destroy=function(){var t=this;t.Imt&&t.Vmt(),t.Dmt=A,t.XD=!1,t.umt=-1,t.Zmt(),t.Wmt(),t.Qmt(),(0,x.GC$)(t.Kmt).remove(),(0,x.GC$)(t.Jmt).remove(),(0,x.GC$)(t.F0).remove()},k.prototype.bind=function(t,n,i){var e=this.Ti;e&&t&&(t=t.split(/\s+/).join(o+" "),(0,x.GC$)(e).bind(t+o,n,i))},k.prototype.unbind=function(t,n){var i=this.Ti;i&&t&&(t=t.split(/\s+/).join(o+" "),(0,x.GC$)(i).unbind(t+o,n))},k.prototype.unbindAll=function(){var t=this.Ti;t&&(0,x.GC$)(t).unbind(o)},k.prototype.caret=function(t){var n,i,e,r,n=this,i=n.Ti;if(i){if(e=c.activeElement===i,r=(0,x.GC$)(i),0===arguments.length)return e?n.Xmt(i).end:r.data(O);t!==n.caret()&&(e?(n.qmt(i,t),r.data(O,n.Xmt(i).end)):r.data(O,t),n.ki(R,{}))}},k.prototype.Xmt=function(t){var n,i,e,n,n,r,n=this,i=-1,e=-1;return n.$mt(t)?(i=t.selectionStart,e=t.selectionEnd):n.vmt(t)&&0<(n=l.getSelection()).rangeCount&&((r=(n=n.getRangeAt(0)).cloneRange()).selectNodeContents(t),r.setEnd(n.endContainer,n.endOffset),e=r.toString().length,(r=n.cloneRange()).selectNodeContents(t),r.setEnd(n.startContainer,n.startOffset),i=r.toString().length,r.detach()),{start:i,end:e}},k.prototype.qmt=function(t,n){var i,n,e,i,r,i=this;i.$mt(t)?t.setSelectionRange(n,n):i.vmt(t)&&(i=this.tgt(t,n))&&(n=l.getSelection(),e=c.createRange(),(r=i.node)&&1===r.childNodes.length?e.setStart(r.firstChild,i.offset):r.lastChild&&r.lastChild.length&&e.setStart(r.lastChild,r.lastChild.length),e.collapse(!0),n.removeAllRanges(),n.addRange(e),this.rl)&&(t.parentElement.scrollTop=t.parentElement.scrollHeight)},k.prototype.text=function(t){var n,i,e,e,r,o,u,a,u,u,e,r,n=this,i=n.Ti,e=n.zmt();if(!i)return"";if(!e||e.xT)return i.innerHTML="";if(e=n.$mt(i),r=n.vmt(i),o=n.ffe(i),0===arguments.length){if(u="",e)u=i.value;else if(r){if(0<(a=i.getElementsByClassName("gcsj-func-gray-formula")).length)return"";0<=(u=(u=C?x.mt.oi(i):i.innerText).replace(/\r\n?/g,"\n")).indexOf(M)&&(u=x.mt.yi(u,M," "))}else o&&0<=(u=(u=C?x.mt.oi(i):i.innerText).replace(/\r\n?/g,"\n")).indexOf(M)&&(u=x.mt.yi(u,M," "));return u}(t=null==t?"":t)!==n.text()&&(u=n.ngt(t),n.Fmt=u?n.Ost(u):n.Ost(t),e?i.value=t:r?(u=n.egt(n.Fmt,t),n.Pmt(u),n.caret(t.length)):o?i.innerHTML=t:i.value=t,e={},(r=g.wvt.Rvt)&&r._text&&(e={sheet:r.Mf,editor:r.bvt&&r.bvt.firstChild.firstChild,canvasOffset:r.yvt}),n.ki(D,e)),n.igt&&n.rgt()},k.prototype.I6=function(){var t=this;(0,x.GC$)(t.Ti).data(S,t.text())},k.prototype.autoComplete=function(t){if(0===arguments.length)return this.ogt;this.ogt=t},k.prototype.showHelp=function(t){if(0===arguments.length)return this.agt;this.agt=t},k.prototype.add=function(t){var n,i;if(t)if(x.GC$.isArray(t))for(n=t.length,i=0;i<n;i++)this.ZP(t[i]);else this.ZP(t)},k.prototype.ZP=function(t){var n,i,e,r,o,n=t&&b(G(t.name));if(n){for(e=(i=this.ugt).length,r=0;r<e;r++){if((o=b(i[r].name))===n)return;if(n<o)break}i.splice(r,0,t)}},k.prototype.remove=function(t){var n,i,e;if(t)for(t=b(t),i=(n=this.ugt).length,e=0;e<i;e++)if(b(n[e].name)===t){n.splice(e,1);break}},k.prototype.workbook=function(t){var n=this;if(0===arguments.length)return n.Vv;t===A?n.rl&&n.Vmt():(n.Lmt(t),n.sgt())},k.prototype.Lmt=function(t){var n,i;t&&((n=this).Vv&&n.Wmt(),i=n.Ti)&&(n.Vv=t)},k.prototype.smt=function(){var t,n,i,e,r,o,u,a,s,f,t=[],n=this.Fmt,i=n&&n.length,o=0,u=0;if(0<i)for(a=0;a<i;a++)r=(e=n[a]).text,11===e.type&&(s={textOffset:o,text:r,ranges:e.ranges,index:u,allowDrag:e.allowDrag},"number"==typeof e.sheetArea&&(s.sheetArea=e.sheetArea),t.push(s),u++),o+=r.length;return(f=this.Fvt)&&t.push({ranges:[f],index:u,allowDrag:!1,isPivotClickCell:!0}),t},k.prototype.zvt=function(){var t,n,i,e,r,o,u,t=this.Ti,n=this.smt();if(t&&n&&0<n.length)for(i=this.caret(),e=n.length,o=r=void 0,u=0;u<e;u++){if((o=(r=n[u]).textOffset)<=i&&i<=o+r.text.length)return r;if(i<=o)break}return A},k.prototype.ymt=function(t){var n,i,t;return!!t&&(n=this.caret(),i=t.text,(t=t.textOffset)<=n)&&n<=t+i.length},k.prototype.pmt=function(t){var n,i,e,r,o,u,a,s,f,n=this.smt(),i=n.length;if(t<0||i<=t)return"";for(e=[],u=o=0;u<i;u++){for(r=n[u],a=!1,s=0;s<e.length;s++)if(r.text&&e[s].text.replace(/\s+/g,"").toUpperCase()===r.text.replace(/\s+/g,"").toUpperCase()){a=!0;break}if(a){if(t===u){o=s;break}}else if(e.push(r),t===u){o=e.length-1;break}}return K[o%K.length]},k.prototype.Dvt=function(){var t,n,t;return!!this.XD||!!this.rl||!!(0,x.Df)(this.text())||!!(t=this.cgt(this.caret()))&&(n=t.type,t=t.text,1===n||8===n||7===n&&"%"!==t||5===n||9===n||15===n)},k.prototype.bmt=function(t){var n,i,n;return!(!t||!this.XD)&&(n=this.umt,i=this.caret(),n<=(n=t.textOffset))&&n<i},k.prototype.fmt=function(){var t,n,i,e,r,t=[],n=this.smt(),i=n.length;if(0<i)for(r=0;r<i;r++)e=n[r],this.bmt(e)&&t.push(e);return t},k.prototype.Gvt=function(t,n,i,e,r){var o,u,u,a,s,f,i,n,n,c,i,e,a;if(void 0===r&&(r=x.SheetArea.viewport),u=(o=this).Ti,t&&u){if(!o.XD){if(!o.Dvt())return;o.XD=!(n=!1),o.umt=o.caret(),o.ki(U,{})}u=o.umt,a=o.text(),s=o.caret(),a||(a="=",s=u=o.umt=1),f=s,i&&(n=!1,a=a.substr(0,u)+(s<0?"":a.substr(s)),o.Fmt=o.Ost(a),f=s=u),i=o.cgt(s),n?(n=(n=a.substr(0,s)).substr(0,n.length-i.text.length)).length>=u&&(i.text=t,f=n.length+t.length):(n=o.Fmt,c=v.Common.Uf.hD(n,i),i=o.rl&&1<n.length&&c===n.length-1&&11===i.type,e?(t=u<s||i?a+this.fgt()+t:a.slice(0,s)+t+a.slice(s),o.Fmt=o.Ost(t)):u<s||i?(n.splice(c+1,0,{text:this.fgt(),type:8}),n.splice(c+2,0,{text:t,type:11,sheetArea:r}),t=","+t):n.splice(c+1,0,{text:t,type:11,sheetArea:r}),f=s+t.length),o.lgt(),e={},(a=g.wvt.Rvt)&&a._text&&(e={sheet:a.Mf,editor:a.bvt&&a.bvt.firstChild.firstChild,canvasOffset:a.yvt}),o.ki(D,e),o.caret(f)}},k.prototype.qD=function(){var t=this;t.XD&&(t.XD=!1,t.umt=-1,t.ki(e,{}))},k.prototype.Nvt=function(){this.XD=!0,this.umt=this.caret()},k.prototype.Tvt=function(t){return void 0!==t&&(this.umt=t),this.umt},k.prototype.rmt=function(t,n,i){var e,r,o,u,a,s,f,c,l,e=this,r=e.Ti;if(r&&!(t<0)&&n){for(o="",u=!1,s=(a=e.Fmt)&&a.length,l=c=0;l<s;l++){if(11===(f=a[l]).type&&c++===t){a[l]={text:n,type:11,sheetArea:f.sheetArea},u=!0;break}o+=f.text}u&&(e.lgt(),e.ki(D,{}),i?e.caret(e.text().length):e.caret(o.length+n.length))}},k.prototype.sgt=function(){var t,n,n,t=this;t.Vv&&(n=t.Ti,t.Vv)&&n&&(n.setAttribute(r,"gcAttachedFormulaTextBox"),t.rl||(t.Vv.h6=t),t.Vv.D3(x.Events.FormulaTextboxEditStarted+w,t,t.hgt),t.Vv.D3(x.Events.FormulaTextboxEnterCell+w,t,t.dgt),t.Vv.D3(x.Events.FormulaTextboxEditEnded+w,t,t.vgt),t.Vv.D3(x.Events.FormulaTextboxActiveSheetChanged+w,t,t.mgt),t.Vv.D3(x.Events.FormulaTextboxRangeChanged+w,t,t.ggt),t.Vv.D3(x.Events.FormulaTextBoxTextChanged+w,t,t.pgt),t.Vv.D3(x.Events.FormulaTextBoxCaretChanged+w,t,t.bgt),t.Vv.D3(x.Events.ValueChanged+w,t,t.ygt),(n=(0,x.jf)(t.Vv))&&!t.rl&&t.text(t.wgt(n,n.ui,n.ci)),t.D3(D,t,t.Mgt),t.D3(R,t,t.Cgt))},k.prototype.refresh=function(t){var n,i,n,n=this.Vv,i=this;n&&(n=(0,x.jf)(n))&&!i.rl&&(i.rb=!!t||i.rb,i.text(i.wgt(n,n.ui,n.ci)),i.rb=!1)},k.prototype.Wmt=function(){var t=this,n=t.Vv;!t.Bmt&&n&&(t.rl||(n.h6=null,n._3(x.Events.FormulaTextboxEditStarted+w,t.hgt),n._3(x.Events.FormulaTextboxEnterCell+w,t.dgt),n._3(x.Events.FormulaTextboxEditEnded+w,t.vgt),n._3(x.Events.FormulaTextboxActiveSheetChanged+w,t.mgt),n._3(x.Events.FormulaTextboxRangeChanged+w,t.ggt),n._3(x.Events.FormulaTextBoxTextChanged+w,t.pgt),n._3(x.Events.FormulaTextBoxCaretChanged+w,t.bgt),n._3(x.Events.ValueChanged+w,t.ygt),t._3(D,t.Mgt),t._3(R,t.Cgt)),t.text("")),t.Vv=null},k.prototype.Hmt=function(){var t,n,n,t=this;t.rb||(t.rb=!0,(n=(n=this.Vv)&&(0,x.jf)(n))&&!n.isEditing()?(t.rl||n.f6(null,n.ui,n.ci,null,null,!1,null),t.Sgt=!0):n&&1===n.Di?(n.Di=2,n._i(1,2)):t.Sgt=!1,t.rb=!1,t.Tgt)||t.w6()},k.prototype.Agt=function(){var t=this,n=t.Ti,i=t.Igt;n.insertBefore(i,n.firstChild),i.innerText=t.igt},k.prototype.xgt=function(t,n){var i;t&&this.Ngt!==n&&(this.Ngt=n,t.style.display=n?"":"none")},k.prototype.rgt=function(){var t,n,i,e,t=this,n=t.Ti,i;t.vmt(n)?((e=t.Igt)||((e=t.Igt=u("span")).className="gcsj-func-gray-formula"),t.xgt(e,!0),t.Agt()):n.placeholder=t.igt},k.prototype.kgt=function(){var t,n,i,t=this;t.igt&&(t.igt="",n=t.Ti,(i=t.vmt(n))?t.xgt(t.Igt,!1):n&&(n.placeholder=""))},k.prototype.FD=function(){var t,n,n,i,e,r,o,u,e,t=this,n=t.Vv,n=n&&(0,x.jf)(n);n&&(i=n.il,t.Sgt&&i&&(e=i.text(),lt(r=t.text(),e,!0)||(o=t.caret(),u=n.getFormulaInformation(n.getActiveRowIndex(),n.getActiveColumnIndex(),3),t.text(e),u.isArrayFormula&&(o>=r.length&&(o-=1),o=f(0,o-1)),t.caret(o))),t.Sgt&&i||t.rl)&&2!==(e=n.Di)&&(n.Di=2,n._i(e,2))},k.prototype.wgt=function(t,n,i){var e,r,r,o,o,u,e="";if(t){if(r=(r=t.parent)&&r.options,(o=t.getFormulaInformation(n,i,3))&&o.hasFormula){if(e="="+o.formulaWithCulture,o.isDynamicArray)return this.igt=e,"";this.igt="",o.isArrayFormula&&(e="{"+e+"}")}else o=t.getActualStyle(n,i),e="string"==typeof(u=t.getValue(n,i))&&(o.quotePrefix||0<u.length&&"="===u[0]&&r&&r.allowUserEditFormula&&!r.allowInvalidFormula)?"'"+u:x.mt.mi(o,u,t,{sheet:t,row:n,col:i,sheetArea:3})||"";this.kgt()}return e},k.prototype.mgt=function(t,n){var t,i,e,t=t.data;t.rb||(i=n.newSheet,t.rl)||(t.rb=!0,t.close(),n&&i&&t.text(t.wgt(i,i.ui,i.ci)),t.rb=!1)},k.prototype.hgt=function(t,n){var t,i,i,i,t=t.data;t.rb||(i=(i=(i=t.Vv)&&(0,x.jf)(i))&&i.il)&&t.rl===i.rl&&t.Avt===i.Avt&&n.sheetArea!==x.SheetArea.colHeader&&n.sheetArea!==x.SheetArea.rowHeader&&(t.kgt(),t.rb=!0,t.text(i.text()),t.rb=!1)},k.prototype.dgt=function(t,n){var t,i,e,t=t.data;t.rl||t.rb||(t.rb=!0,n&&(t.text(t.wgt(n.sheet,n.row,n.col)),t.Ti)&&(i=t.$mt(t.Ti),e=t.ffe(t.Ti),n.readonly?i?t.Ti.disabled=!0:e&&(t.Ti.contentEditable="false"):i?t.Ti.disabled=!1:e&&(t.Ti.contentEditable="true")),t.rb=!1)},k.prototype.ggt=function(t,n){var t,i,e,r,o,n,t=t.data;t.rb||t.rl||(t.rb=!0,n&&(i=n.sheet,e=n.row,r=n.col,o=n.rowCount,n=n.colCount,new x.Range(e,r,o,n).contains(i.ui,i.ci))&&t.text(t.wgt(i,i.ui,i.ci)),t.rb=!1)},k.prototype.vgt=function(t,n){var t,i,t=t.data;t.rl&&t.Imt&&t._mt?n.ignore=!0:t.rb||n.sheetArea!==x.SheetArea.colHeader&&n.sheetArea!==x.SheetArea.rowHeader&&(t.rb=!0,t.close(),(i=g.wvt.Rvt)&&i._6(n.sheet),n&&n.sheet.il&&!n.sheet.il.rl&&!t.rl&&t.text(t.wgt(n.sheet,n.row,n.col)),t.rb=!1)},k.prototype.ygt=function(t,n){var i,e,i=n.sheet,e=i&&i.parent&&i.parent.h6;e&&e.Dgt()===n.row&&e._gt()===n.col&&e.zmt()===i&&t.data instanceof k&&(n.text=i.getText(n.row,n.col),t.data.pgt(t,n))},k.prototype.pgt=function(t,n){var t,i,t=t.data;t.rb||n.sheet.il&&(t.rl!==n.sheet.il.rl||t.Avt!==n.sheet.il.Avt)||n.sheetArea===x.SheetArea.colHeader||n.sheetArea===x.SheetArea.rowHeader||(t.rb=!0,n&&(i=t.caret(),t.text(n.text),t.caret(i)),t.rb=!1)},k.prototype.bgt=function(t,n){var t=t.data;t.rb||n.sheet.il&&(t.rl!==n.sheet.il.rl||t.Avt!==n.sheet.il.Avt)||(t.rb=!0,n&&t.caret(n.caret),t.rb=!1)},k.prototype.Mgt=function(t){var t,n,n,i,e,r,o,u,r,t=t.data;if(!t.rb&&(n=(n=t.Vv)&&(0,x.jf)(n))){if(n.isEditing()||(t.Hmt(),t.focus()),t.rb=!0,i=n.ui,e=n.ci,r=n.il,o=n.getCellType(i,e),r){if(t.rl!==r.rl||t.Avt!==r.Avt)return;u=r.caret(),r.text(t.text()),r.caret(u)}else r={sheet:n,row:i,col:e,sheetArea:3},o.setEditorValue(n.li,t.text(),r);t.rb=!1}},k.prototype.Cgt=function(t){var t,n,n,n,t=t.data;t.rb||(n=(n=t.Vv)&&(0,x.jf)(n))&&n.isEditing()&&((n=n.il)&&(t.rl!==n.rl||t.Avt!==n.Avt)||(t.rb=!0,n&&(n.caret(t.caret()),t.w6()),t.rb=!1))},k.prototype.Hc=function(t){var n,i,e,e,n=this;n.Egt=!1,n.jgt=!1,n.XD=!1,n.umt=-1,n.ugt=[],n.ogt=!0,n.agt=!0,n.Ogt=!0,(i=u("div")).className="gcsj-func-ac-popup",i.style.display="none",i.setAttribute(r,"gcFuncACPopup"),t.insertBefore(i,A),n.Kmt=i,n.Tgt=!1,(e=u("div")).className="gcsj-func-help-popup",e.style.display="none",e.setAttribute(r,"gcFuncHelpPopup"),t.insertBefore(e,A),n.Jmt=e,(n.Rgt=!1,x.GC$)(i).bind("mouseover",function(){n.Ogt=!1}).bind("mouseout",function(){n.Ogt=!0}),(0,x.GC$)(e).bind("mouseover",function(){n.Ogt=!1}).bind("mouseout",function(){n.Ogt=!0}),(0,x.GC$)(i).bind("scroll",function(){n.Bgt&&clearTimeout(n.Bgt),n.Bgt=l.setTimeout(function(){n.Ti&&n.Ti.focus()},100)}),(e=u("div")).style.display="none",e.setAttribute(r,"gcFuncHelpDiv"),t.insertBefore(e,A),n.F0=e,n.Vv=null,n.rb=!1,n.Sgt=!1,n.Bmt=!1},k.prototype.Rmt=function(t){var f,c,n;t&&(c=(f=this).vmt(t),f.$mt(t)||c)&&(n=(0,x.GC$)(t),f.Ti&&f.Zmt(),f.Ti=t,i&&(i.msie||i.chrome)?c||C||i.chrome?(f.D3("focus",function(){n.data(S,f.text())}),f.D3("click",function(){n.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(t){f.D3(t,function(){f.Lgt()})})):f.D3(T,function(){f.Fgt()}):f.D3(T,function(){var t;c&&(t=f.Ti.lastChild,i.chrome)&&t&&"BR"===t.tagName&&f.Ti.removeChild(t),f.Fgt()}),f.D3("keydown",function(t){var n,i,e,r,o,u,a,s,a,a,s,n=t.ctrlKey,i=t.shiftKey,e=t.altKey,r=t.metaKey,o,u=t.keyCode;n||i||e||r||!f.Tgt||(u===B?(f.Pgt(1),I(t)):u===N?(f.Pgt(-1),I(t)):u===E&&(f.Ggt(),I(t))),u===X&&f.close(),f.Ugt(t),s=(a=(0,x.jf)(f.Vv))&&a.rt.Pi(t),f.rl&&s&&(a=a.il)&&a.XD&&a.qD(),c&&(s?(8===u?P(t)&&x.di.processBackspaceAndLeftArrowKeyEvent(t,!0):46===u&&P(t)&&x.di.processDeleteAndRightArrowKeyEvent(t,!0),f.mmt()):13===u&&(n||e)?(P(t)&&Ct(),f.mmt(!0)):37===u?P(t)&&x.di.processBackspaceAndLeftArrowKeyEvent(t,!1):39===u&&P(t)&&x.di.processDeleteAndRightArrowKeyEvent(t,!1),c)&&n&&(90===u||89===u)&&I(t),a=f.text(),x.mt.Qf()&&c&&r&&(s=void 0,90===u)&&(i?(s=f.kmt.pop())&&(f.text(s),f.Nmt.push(a)):(s=f.Nmt.pop()||"",f.text(s),f.kmt.push(a)),t.preventDefault(),t.stopPropagation())}),f.D3("keyup",function(t){var n,i,e,t;f.Ugt(t),n=f.text(),c&&(i=void 0,e=t.keyCode,(t=t.ctrlKey)&&90===e?(i=f.Nmt.pop()||"",f.text(i),f.kmt.push(n)):t&&89===e&&(i=f.kmt.pop())&&(f.text(i),f.Nmt.push(n)))}),f.D3("focus",function(t){var n;i&&i.mozilla&&!f.Ti.innerText&&(f.Ti.innerText=""),f.Ugt(t),f.rl&&f.Imt&&(f._mt=!0,f.Umt())}),f.D3("blur",function(){f.Ogt&&f.close(),f.rl&&(f.Vmt(),f._mt=!1)}),f.D3("mousedown",function(){f._mt=!0,f.Ngt&&(f.kgt(),f.Hgt=!0),f.Hmt()}),f.D3("mouseup",function(){var t,n;f.Hgt&&(f.Hgt=!1,(t=f.Ti)!==(n=l.getSelection()).anchorNode)&&n.selectAllChildren(t),f.FD()}),f.D3("click",function(t){var n,n,n;f.XD&&f.qD(),(n=(n=(n=f.Vv)&&(0,x.jf)(n))&&n.il)&&n.XD&&!n.rl&&n.qD(),f.Ugt(t)}),f.D3("compositionstart",function(){f.Egt=!0}),f.D3("compositionend",function(){f.Egt=!1,(i.edge||i.chrome||i.msie)&&f.Lgt()}))},k.prototype.Zmt=function(){var t,n,n,t=this,n=t.Ti;n&&((n=(0,x.GC$)(n)).removeData(S),n.removeData(O),n.removeAttr(r),n.data(a.CONST_FORMULATEXTBOX)&&n.data(a.CONST_FORMULATEXTBOX,A),t.E3(),t.unbindAll(),t.rl&&((0,x.GC$)(t.Emt).empty(),t.Emt=A),t.Ti=A)},k.prototype.Lgt=function(){var t=this,n=(0,x.GC$)(t.Ti),i=t.text();n.data(S)!==i&&(t.Egt||n.data(S,i),t.Fgt())},k.prototype.Ugt=function(t){var n;i&&i.msie?setTimeout(function(t,n){return function(){t.zgt(t,n)}}(this,t),10):this.zgt(this,t)},k.prototype.zgt=function(t,n){var i,e,i,n,e,i,n,i=n.keyCode,e=i===F||i===z||i===V||i===_||i===W||i===Q||i===E||i===Y;t.ogt||(e=e||i===N||i===B),i=void 0!==n.button,(e||i)&&(n=t.Ti,e=(0,x.GC$)(n),(i=t.Xmt(n)).start===i.end)&&(n=i.end,e.data(O)!==n)&&(e.data(O,n),t.ki(R,{}),t.w6())},k.prototype.Dgt=function(){var t,n,t,t=this.zmt();return t?(n=t.ui,(t=t.vA)?t.row:n):s},k.prototype._gt=function(){var t,n,t,t=this.zmt();return t?(n=t.ui,(t=t.vA)?t.col:n):s},k.prototype.Qvt=function(){var t,n,t,t=this.zmt();return t?(n=x.SheetArea.viewport,(t=t.vA)?t.sheetArea:n):s},k.prototype.zmt=function(){if(this.Vv)return(0,x.jf)(this.Vv)},k.prototype.parseInternal=function(t,n,i,e,r){var o,u,a,a;return void 0===r&&(r=x.SheetArea.viewport),o=this,u=[],(0,x.kf)(t)&&ot(t,'"')%2!=1?(a=new p.Parser,a=h.Vgt(a,t,n,i,e,!0,s,s,r),u=o.Ygt(a,t)):u.push({text:t,type:17}),u},k.prototype.Ost=function(t){return this.parseInternal(t,this.zmt(),this.Dgt(),this._gt(),this.Qvt())},k.prototype.Fgt=function(){var t,n,i,e,r,t=this,n=t.text();"\n"!==n&&0<=n.indexOf("\n")?t.ki(D,{type:T}):(i=t.Ti,e=(0,x.GC$)(i),t.jgt=!0,t.Fmt=t.Ost(n),t.vmt(i)?t.Egt||("\n"===n?(e.empty(),t.ki(D,{type:T})):(r=t.caret(),t.Pmt(t.Fmt),t.ki(D,{type:T}),t.caret(r))):t.ki(D,{type:T}),r=t.caret(),e.data(O)!==r&&(e.data(O,r),t.ki(R,{})),t.Zgt(),t.Tgt||t.w6())},k.prototype.Wgt=function(){return v.Common.CultureManager.Fe().NumberFormat},k.prototype.Qgt=function(){var t=this.Wgt();return t&&t.arrayGroupSeperator||";"},k.prototype.Kgt=function(){var t=this.Wgt();return t&&t.arrayListSeparator||","},k.prototype.fgt=function(){var t=this.Wgt();return t&&t.listSeparator||","},k.prototype.Jgt=function(){var t=this.Wgt();return t&&t.numberDecimalSeparator||"."},k.prototype.Ygt=function(t,n){for(var i,e,r,o,u,a,s,f,c,l,h,h,i=[],e=[],r=n&&"="!==n[0],o=this.Qgt(),u=this.Kgt(),a=!1,s=0;s<t.length;s++)0<s&&s<t.length-1&&";"===t[s-1].text&&","===t[s].text&&"ARRAYROW"===t[s+1].text||(f=t[s],c=this.Xgt(f,e),l=f.text,2===c?i.push({text:l,type:c}):a&&8===c&&","===l?i.push({text:u,type:9}):a&&8===c&&";"===l?i.push({text:o,type:10}):8===c?i.push({text:l,type:c}):3===c?("ARRAY"===l&&(a=!0),i.push({text:"{",type:3})):4===c?"ARRAY"===l||"}"===l?(a=!1,i.push({text:"}",type:4})):i.push({text:l,type:4}):6===c?i.push({text:")",type:c}):13===c?i.push({text:v.Common.st.Ge(l),type:c,ranges:f.ranges,allowDrag:f.canDrag}):1===c&&r||null!==c&&(11===c&&t[s+1]&&"#"===t[s+1].text&&f.ranges&&0<f.ranges.length&&(h=new p.CalcReference(this.zmt().qgt,f.ranges).getSpillRef())&&h.$gt&&(s++,f.ranges=h.$gt,l+="#"),h={text:l,type:c,ranges:f.ranges,allowDrag:f.canDrag},11===c&&(h.sheetArea=f.sheetArea),i.push(h)));return i},k.prototype.Xgt=function(t,n){var i,e,r,t,r,i=t.type,e=t.subType,r=t.text,t=t.value;if(1===i){if(1===e)return"ARRAY"===r||"ARRAYROW"===r?(n.push(3),3):(n.push(5),"@"===t||"("===t.trim()?5:2);if(2===e){if(")"===t.trim())return 6;if(0<n.length){if(3===(r=n[n.length-1]))return n.pop(),4;if(5===r)return n.pop(),6}}if("="===t.trim())return 1}else if(3===i){if(0===e)return 8}else{if(5===i||6===i||4===i)return 7;if(0===i)return 7===e||0===e||12===e?11:5===e?12:4===e?13:3!==e&&6===e?16:14;if(7===i)return 15;if(8===i);}return 17},k.prototype.lgt=function(){for(var t,n,i,e,r,o,t=this,n=t.Ti,i=t.Fmt,e="",r=i&&i.length,o=0;o<r;o++)e+=i[o].text;t.$mt(n)?n.value=e:t.vmt(n)&&t.Pmt(i)},k.prototype.$mt=function(t){var t=t&&t.tagName;return"TEXTAREA"===t||"INPUT"===t},k.prototype.vmt=function(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable},k.prototype.ffe=function(t){return t&&"DIV"===t.tagName},k.prototype.t2t=function(t){return"gcEditingInput"===(0,x.GC$)(t).attr(r)},k.prototype.D3=function(t,n,i){var e=this.Ti;e&&t&&(t=t.split(/\s+/).join(w+" "),(0,x.GC$)(e).bind(t+w,n,i))},k.prototype._3=function(t,n){var i=this.Ti;i&&t&&(t=t.split(/\s+/).join(w+" "),(0,x.GC$)(i).unbind(t+w,n))},k.prototype.E3=function(){var t=this.Ti;t&&(0,x.GC$)(t).unbind(w)},k.prototype.ki=function(t,n){var i=this.Ti;i&&(0,x.GC$)(i).trigger(t,n)},k.prototype.cgt=function(t){var n,i,e,r,o;if(!(t<=0)&&0<(i=(n=this.Fmt)&&n.length))for(r=void(e=0),o=0;o<i;o++)if(t<=(e+=(r=n[o]).text.length))return r;return A},k.prototype.n2t=function(){var t,n,i,e,r,o,t=this.Vv;if(t&&(n=(0,x.jf)(t))&&(i=n.getCalcService().allowDynamicArray,e=n.il)){for(o=(r=[].concat(e.ugt)).length-1;0<=o;o--)!i&&r[o]&&mt(r[o].name)?r.splice(o,1):r[o].isFunc=!0;return r.concat(this.e2t(t,n)).concat(this.i2t(t.sheets)).concat(this.r2t(t))}return this.ugt},k.prototype.e2t=function(t,n){var i,n,n,i=[],n=n.getCustomNames();return n&&x.GC$.each(n,function(t,n){i.push({name:n.Zc,description:n.TZ})}),(n=t.getCustomNames())&&x.GC$.each(n,function(t,n){i.push({name:n.Zc,description:n.TZ})}),i},k.prototype.i2t=function(t){var e=[];return t.forEach(function(t){var t,n,i,t=t.tables;if(t&&(n=t.all()))for(i=0;i<n.length;i++)e.push({name:n[i].name(),description:p.sR().Fbx_TableName_Description+n[i].name()})}),e},k.prototype.r2t=function(t){for(var n,i,e,n=[],i=t.mp,e=0;e<i.length;e++)n.push({name:i[e].name(),description:p.sR().Fbx_TableSheetName_Description+i[e].name()});return n},k.prototype.o2t=function(t,n){var i,e,r,o;for(t=b(t),d.OS(t,"[")&&(t=t.substr(t.lastIndexOf("[")+1),t=d.Vi(t,"@","")),i=[],e=n&&n.length,o=0;o<e;o++)r=n[o],0===b(G(r.name)).indexOf(t)&&i.push(r);return i},k.prototype.a2t=function(){var t,n,i,e,r,o,t=this.caret();if(!(t<=0)&&0<(i=(n=this.Fmt)&&n.length))for(r=void(e=0),o=0;o<i;o++){if(e+(r=n[o]).text.length>=t)return r.text.substring(0,t-e);e+=r.text.length}return""},k.prototype.u2t=function(){for(var t,n,i,e,r,o,u,a,s,f,c,l,h,v,t=this.caret(),n=this.Fmt,i=n&&n.length,e=[],r=0,u=0;u<i;u++){if(o=n[u],e.push(o),6===o.type)for(a=0;0<e.length;)if(6===(s=e.pop()).type&&a++,5===s.type&&a--,0===a){0<e.length&&(s=e[e.length-1])&&2===s.type&&e.pop();break}if(t<=(r+=o.text.length))break}if(0<e.length)for(f=0;0<e.length;)if(8===(o=e.pop()).type)f++;else if(2===o.type){for(c=b(o.text),h=(l=this.n2t())&&l.length,v=void 0,u=0;u<h;u++)if(v=l[u],b(G(v.name))===c)return{func:v,activeParamterIndex:f,isFunc:v.isFunc};break}return A},k.prototype.Zgt=function(){var n,t,i,e,r,o,u,a,e,s,f,n=this,t=n.s2t(),i;if(n.ogt&&(0,x.kf)(n.text())&&t&&0<t.length&&!n.XD&&!n.Egt&&!n.rl){for(n.c2t(),e=n.Kmt,8<t.length?(e.style.height="204px",e.style.overflowY="scroll"):(e.style.height="auto",e.style.overflowY=""),r="",o=t.length,u=void 0,a=0;a<o;a++)r+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(u=t[a]).isFunc+">"+G(u.name)+"</div><div class='gcsj-func-ac-row-description'>"+(u.description||"")+"</div></div>";(e=(0,x.GC$)(n.Kmt)).html(r).show(),n.Tgt=!0,0<(s=e.find(y)).length&&(f="gcsj-ac-row-active",(0,x.GC$)(s[0]).addClass(f),s.bind("mouseover",function(){s.removeClass(f),(0,x.GC$)(this).addClass(f)}),s.bind("click",function(){n.Ggt()}),n.Ngi)&&s.bind("mousedown",function(t){n.Ggt(),I(t)}),n.u_()}else n.f2t()},k.prototype.Qmt=function(){var t,n,t=this,n=(0,x.GC$)(t.Kmt).find(y);n&&(n.unbind("mouseover"),n.unbind("click"),t.Ngi)&&n.unbind("mousedown")},k.prototype.s2t=function(){var t,n,i,e,r,n,r,o,u,a,s,f,n,t=this,n=t.cgt(t.caret()),i=n&&n.text,e=[],r=t.Fmt.indexOf(n);if(n&&14===n.type)return e;if(n=this._getTable(r),0<(r=t.h2t(r,n)).length){if(o=[],!n.Mf.NMi)for(s in u=JSON.parse(JSON.stringify(p.sR().d2t)),a=p.getMapping()&&p.getMapping().tableFunctionsMapping,u)(f=a&&a[u[s].name])&&(u[s].name=f),o.push(u[s]);if(e=e.concat(r).concat(o),d.dT(i,"[")||d.dT(i,"[@"))return e}else e=this.n2t();return n=[],n=(i=t.a2t())?t.o2t(i,e):n},k.prototype._getTable=function(t){var n,i,e,n,t,n,e,n=this.Fmt;return!(t<0||!n||t>=n.length)&&(e=(i=this.Vv)&&(0,x.jf)(i),m(t)&&(t=n.length),e)?(n=n[t],t=d.gmt(n.text,"["),e=(n=e.tables)&&n.findByName(t),m(e)?i.Efe(t):e):null},k.prototype.h2t=function(t,n){var i=[];return i=m(n)?i:vt(n).columns},k.prototype.f2t=function(){(0,x.GC$)(this.Kmt).hide(),this.Tgt=!1},k.prototype.Pgt=function(t){var n,i,e,r,o,u,a,s,n=(0,x.GC$)(this.Kmt).find(y),i=n.length;if(0!==i){if(e="gcsj-ac-row-active",r=0,t)for(o=0;o<i;o++)if((0,x.GC$)(n[o]).hasClass(e)){r=o+t;break}u=(0,x.GC$)(this.Kmt).scrollTop(),n.removeClass(e),(a=0)<i&&(a=n[0].offsetHeight),r=f(r,0),s=n[r=L(r,i-1)],(0,x.GC$)(s).addClass(e),s.offsetTop+s.offsetHeight>(0,x.GC$)(this.Kmt).scrollTop()+(0,x.GC$)(this.Kmt).height()?(0,x.GC$)(this.Kmt).scrollTop((0,x.GC$)(this.Kmt).scrollTop()+a):s.offsetTop<(0,x.GC$)(this.Kmt).scrollTop()?(0,x.GC$)(this.Kmt).scrollTop(s.offsetTop):(0,x.GC$)(this.Kmt).scrollTop(u)}},k.prototype.Ggt=function(){var t,n,i,n,e,r,o,u,a,s,f,c,l,h,v,v,l,c,v,t=this,n=(0,x.GC$)(t.Kmt).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),i=n.text(),n="true"===n.attr("isFunc");if(i){for(e=t.caret(),o=(r=t.Fmt)&&r.length,s=a=u=0,f=A;s<o&&!(e<=u+(a=(f=r[s]).text.length));)s++,u+=a;c=e-u,l=f.text,v=h=0,d.OS(l,"[")?-1===(h=l.lastIndexOf("[",c-1))?(h=l.indexOf("["),f.text=-1===h?i:i+l.substr(h),h=0):("@"===l.charAt(++h)&&(h+=1),-1===(v=l.indexOf("]",c))&&(v=l.length),f.text=l.substring(0,h)+i+l.substr(v)):(f.text=i,(v=l.substr(c))&&1<(l=t.Ost("="+v)).length&&r.splice(s+1,0,l[1])),f.type=n?2:11,v=r[c=s+1],!n||v&&5===v.type||r.splice(c,0,{text:"(",type:5}),t.f2t(),t.Ti.focus(),t.lgt(),t.caret(u+i.length+h+(n?1:0)),t.w6(),t.Fmt=t.Ost(t.text()),t.ki(D,{})}},k.prototype.w6=function(){var t,n,i,e,r,o,u,a,s,f,c,l,h,v,g,d,I,n,t=this;if(t.Tgt&&t.f2t(),(n=t.u2t())===A||!0!==n.isFunc)t.c2t();else if(i=t.fgt(),(e=t.agt&&(0,x.kf)(t.text())&&n&&!t.XD&&!t.Egt)&&!t.rl){for(u=(o=(r=n.func).parameters)&&o.length,a=L(u-1,n.activeParamterIndex),s=void 0,f="",c=0;c<u;c++)l=(s=o[c]).name,s.repeatable&&(l+=i+"..."),s.optional&&(l="["+l+"]"),h=c===u-1?"":i+" ",f+=l=c===a?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+l+"</span>"+h:"<span class='gcsj-func-help-paramter'>"+l+"</span>"+h;n=(v="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+G(r.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+f+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>")+(I="<div class='gcsj-func-help-body'>"+(d="<div class='gcsj-func-help-section-content'>"+(g="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+p.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(r.description||"")+"</div></div>")+"</div>")+"</div>"),(0,x.GC$)(t.Jmt).html(n).show(),t.Rgt=!0,t.u_()}else t.c2t()},k.prototype.c2t=function(){(0,x.GC$)(this.Jmt).hide(),this.Rgt=!1},k.prototype.close=function(){this.f2t(),this.c2t()},k.prototype.$D=function(t,n){var i,e,r,o,u,t;return!this.XD&&(i=t.ctrlKey||t.shiftKey||t.altKey||t.metaKey,e=t.keyCode,r=t.ctrlKey,o=t.altKey,u=t.metaKey,t=t.srcElement||t.target,!this.Ngi&&t&&n&&n.isEditing&&"gcAttachedFormulaTextBox"===t.getAttribute("gcUIElement")?67===e&&(r||u)&&!o||88===e&&(r||u)&&!o:this.Tgt&&!i&&(e===B||e===N||e===E))},k.prototype.u_=function(){var t,n,i,n,e,r,t,o,o,e,i,r,u,a,t,s,i,t=this,n=A;t.Tgt?n=t.Kmt:t.Rgt&&(n=t.Jmt),n&&(i=(0,x.GC$)(t.Ti),n=(0,x.GC$)(n),e=i.parent(),r=i.outerHeight(),t.t2t(t.Ti)&&(r=(e=e.parent()).outerHeight()),t=e.css("top"),o=parseFloat(t),isNaN(o)||(t=o),o=e.css("left"),"auto"===t&&(t=i.offset().top,o=i.offset().left),e=t+r,i=(0,x.GC$)(c.body).outerHeight(),r=(0,x.GC$)(c.body).outerWidth(!0),u=n.outerHeight(),a=n[0].offsetWidth,i<(s=e+u)&&0<=(i=t-u)&&(e=i),r<(t=parseFloat(o))+a+2&&(t-=t+a+2-r),n.css("top",e).css("left",t))},k.prototype.focus=function(){(0,x.GC$)(this.Ti).focus()},k.prototype.Pmt=function(t){for(var n,i,e,r,o,u,a,s,f,n=this,i="",e="",r=t&&t.length,o=0,a=0;a<r;a++)s="",11===(u=t[a]).type&&(s=" style='color: "+n.pmt(o)+"'",o++),n.F0.innerText=u.text,i+="<span"+s+" class='gcsj-func-color-text'>"+n.F0.innerHTML+"</span>",e+=u.text;if(e||n.text())if(f=n.Ti,i)f.innerHTML="<span class='gcsj-func-color-content'>"+i+"</span>";else for(;f.firstChild;)f.removeChild(f.firstChild)},k.prototype.tgt=function(t,n){var i,e,r,o,u,i=(0,x.GC$)(t).find(".gcsj-func-color-content .gcsj-func-color-text"),e=i.length;for(n=f(0,n),u=0;u<e;u++)if((n-=(o=(r=i[u]).innerText).length)<=0)return{node:r,offset:o.length+n};return o?{node:r,offset:o.length}:A},k.prototype.y6=function(t,n){var i,e,r,i=l.getSelection(),e=this.Ti.children[0],r=document.createRange();r.setStart(e,t),r.setEnd(e,n),i.removeAllRanges(),i.addRange(r)},k.prototype.mmt=function(t){var n,i,i,e,n=this,i=n.Ti,i=n.vmt(i),e=n.text();i&&e&&(e=t?e.substr(0,e.length-2):e,n.Nmt.push(e))},k.prototype.egt=function(t,n){var i,e,r,o,u,a,s,f;if(n)for(o=n.length,u=r=e=i=0;u<t.length;u++){for(a=t[u].text;e<o;e++)if((s=n[e].toUpperCase())===(f=a[r]?a[r].toUpperCase():void 0))r+=1;else{if("\n"!==s)break;e+1<o&&n[e+1]===tt&&(e+=1)}t[u].text=n.substring(i,e),i=e,r=0}return t},k.prototype.ngt=function(t){var n,i,e,r,o;if("="===t[0]&&-1!==t.indexOf("\n")){for(i=t.length,e=!(n=[]),r=0;r<i;r++)(e='"'===(o=t[r])?!e:e)||"\n"!==o?n.push(o):r+1<i&&t[r+1]===tt&&(r+=1);return n.join("")}},rt=k,a.FormulaTextBox=rt},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine}},e={},t=r("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).FormulaTextBox=t}();