/*!
 * 
 * SpreadJS Library 16.1.1
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;(()=>{var n,e,t;function i(t){var r,r,r=e[t];return void 0!==r||(r=e[t]={exports:{}},n[t](r,r.exports,i)),r.exports}n={"./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js":t=>{var u;!function(){"use strict";var n,e,t,r,i;function o(t){var r,r,r=e[t];return void 0!==r||(r=e[t]={exports:{}},n[t].call(r.exports,r,r.exports,o)),r.exports}n={"./src/common/common.entry.ts":function(t,r,n){var e,i,o,u,a,s,f,y,c,m,M,h,e=this&&this.__createBinding||(Object.create?function(t,r,n,e){void 0===e&&(e=n);var i=Object.getOwnPropertyDescriptor(r,n);i&&("get"in i?r.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return r[n]}}),Object.defineProperty(t,e,i)}:function(t,r,n,e){t[e=void 0===e?n:e]=r[n]}),i=this&&this.__exportStar||function(t,r){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||e(r,t,n)};Object.defineProperty(r,"__esModule",{value:!0}),r.B3=r.rbush=r.CultureManager=r.CultureInfo=r.zf=r.$T=r.st=r.ct=r.Uf=r.lt=r.ft=void 0,o=n("./src/common/util/colorhelper.ts"),Object.defineProperty(r,"ft",{enumerable:!0,get:function(){return o.ft}}),u=n("./src/common/util/types.ts"),Object.defineProperty(r,"lt",{enumerable:!0,get:function(){return u.lt}}),a=n("./src/common/util/arrayhelper.ts"),Object.defineProperty(r,"Uf",{enumerable:!0,get:function(){return a.Uf}}),s=n("./src/common/util/datetimehelper.ts"),Object.defineProperty(r,"ct",{enumerable:!0,get:function(){return s.ct}}),Object.defineProperty(r,"B3",{enumerable:!0,get:function(){return s.getSR}}),f=n("./src/common/util/numberhelper.ts"),Object.defineProperty(r,"st",{enumerable:!0,get:function(){return f.st}}),y=n("./src/common/util/regexhelper.ts"),Object.defineProperty(r,"$T",{enumerable:!0,get:function(){return y.$T}}),c=n("./src/common/util/stringhelper.ts"),Object.defineProperty(r,"zf",{enumerable:!0,get:function(){return c.zf}}),m=n("./src/common/util/rbush.ts"),Object.defineProperty(r,"rbush",{enumerable:!0,get:function(){return m.rbush}}),M=n("./src/common/util/common.ts"),Object.defineProperty(r,"HandleExcelSpecialDate",{set:function(t){M.HandleExcelSpecialDate=t},get:function(){return M.HandleExcelSpecialDate}}),i(n("./src/common/util/common.ts"),r),h=n("./src/common/culture/cultureInfo.ts"),Object.defineProperty(r,"CultureInfo",{enumerable:!0,get:function(){return h.CultureInfo}}),Object.defineProperty(r,"CultureManager",{enumerable:!0,get:function(){return h.CultureManager}}),i(n("./src/common/util/functionhelper.ts"),r)},"./src/common/culture/cultureInfo.ts":function(E,t,r){var n,e,a,u,i,f,o,s,y,e,c,r,m,M,h,d,j,r,e,l,n,v,F,p,g,R,b,e,_,w,D,H;function N(t){return t.split("\xa0").join(" ").toUpperCase()}function $(t){for(var r,n,e,r=[],n=0,e=t.length;n<e;n++)r[n]=N(t[n]);return r}function S(t,r,n){var t=N(t),r=r.indexOf(t);return r=-1===r?n.indexOf(t):r}function I(t){if(t){var t=t.charCodeAt(0);if(11904<=t&&t<12032||8208<=t&&t<8252||12288<=t&&t<40960||43360<=t&&t<43392||44032<=t&&t<55215||63744<=t&&t<64256||65280<=t&&t<65535)return!0}return!1}function P(t,r,n){var e;return" "===t||n&&"\u3000"===t?0:(e=n&&n(t),r.lineBreakingForbidStart&&-1!==r.lineBreakingForbidStart.indexOf(t)?!n||e?7:6:r.lineBreakingForbidEnd&&-1!==r.lineBreakingForbidEnd.indexOf(t)?!n||e?5:4:e?2:r.lineBreakingChar&&-1!==r.lineBreakingChar.indexOf(t)?3:1)}function x(t,r,n){var e,i,o,u,a,s;if(!t)return[];for(e=[t[0]],o=P(t[i=0],r,n),u=1;u<t.length;u++)a=P(t[u],r,n),h[s=o+""+a]&&e[++i]===f&&(e[i]=""),e[i]+=t[u],o=a;return e}function k(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"\xa4",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"\u2030",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1,this.LocalNumberFormat={},this.displayName="",this.predefinedFormats={},this.TimelineDateOrder=[M.quarterOrMonth,M.date,M.year],this.TimelineDateSuffix={year:"",quarter:"",month:"",date:""},this.TextFormat={lineBreakingChar:[" ","-"]}}function C(){}function A(){var t,r,t=_.call(this)||this;return T.call(t,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),T.call(t,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!(r=["MMM yyyy","MMMM yyyy"]),r]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" H:mm:ss",t.name=function(){return"en-US"},t.displayName="English (United States)",t.id=1033,t.predefinedFormats={Accounting:'_([$$-409]* #,##0.00_);_([$$-409]* (#,##0.00);_([$$-409]* "-"??_);_(@_)',Comma:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',Currency:["[$$-409]#,##0","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);([$$-409]#,##0)","[$$-409]#,##0_);[Red]([$$-409]#,##0)"],Date:["m/d/yyyy","[$-409]dddd, mmmm dd, yyyy","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmm d, yyyy;@","[$-409]m/d/yy h:mm AM/PM;@","m/d/yy h:mm;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@","m/d/yyyy;@","[$-409]d-mmm-yyyy;@"],Time:["[$-409]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@","mm:ss.0;@","[h]:mm:ss;@","[$-409]m/d/yy h:mm AM/PM;@","m/d/yy h:mm;@"],Special:{"Zip Code":"00000","Zip Code + 4":"00000-0000","Phone Number":"[<=9999999]###-####;(###) ###-####","Social Security Number":"000-00-0000"}},t}function B(){var t,r,n,e,i,e,t=w.call(this)||this,r,n;return T.call(t,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"\xa5",!1,"NaN (\u975e\u6570\u5024)","-\u221e",1,1,"+\u221e",{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u3007","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\u62fe","\u5104","\u9621","\u767e","\u62fe","\u842c","\u9621","\u767e","\u62fe",""],numbers:["\u3007","\u58f1","\u5f10","\u53c2","\u56db","\u4f0d","\u516d","\u4e03","\u516b","\u4e5d"]},3:{letters:o,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},{Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u5104",Trillions:"\u5146"}]),T.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],e=["1","2","3","4","5","6","7","8","9","10","11","12",""],e,"\u5348\u524d",!(e=["yyyy\u5e74M\u6708d\u65e5","yyyy\u5e74M\u6708dd\u65e5","yyyy\u5e74MM\u6708d\u65e5","yyyy\u5e74MM\u6708dd\u65e5"]),["\u65e5\u66dc\u65e5","\u6708\u66dc\u65e5","\u706b\u66dc\u65e5","\u6c34\u66dc\u65e5","\u6728\u66dc\u65e5","\u91d1\u66dc\u65e5","\u571f\u66dc\u65e5"],"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",i=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],i,"\u897f\u66a6 (\u65e5\u672c\u8a9e)","\u5348\u5f8c","yyyy/MM/dd",["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",e,"ggge/mmmm/d\u65e5"]),t.DateTimeFormat.eras=!0,t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.QPt=['gggee"\u5e74"MM"\u6708"dd"\u65e5','gggee"\u5e74"M"\u6708"d"\u65e5','ge"\u5e74"M"\u6708"d"\u65e5','ggge"\u5e74"M"\u6708"d"\u65e5','ggee"\u5e74"M"\u6708"d"\u65e5','gge"\u5e74"M"\u6708"d"\u65e5'],t.name=function(){return"ja-JP"},t.id=1041,t.displayName="Japanese (Japan)",t.isJCKCulture=!0,t.predefinedFormats={Accounting:'_-[$\xa5-411]* #,##0.00_-;-[$\xa5-411]* #,##0.00_-;_-[$\xa5-411]* "-"??_-;_-@_-',Comma:'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"??_-;_-@_-',Currency:["[$\xa5-411]#,##0","[$\xa5-411]#,##0;[Red][$\xa5-411]#,##0","[$\xa5-411]#,##0;-[$\xa5-411]#,##0","[$\xa5-411]#,##0;[Red]-[$\xa5-411]#,##0"],Date:["yyyy/mm/dd","[$-411]dddd, mmmm dd, yyyy",'yyyy"\u5e74"m"\u6708"d"\u65e5";@','yyyy"\u5e74"m"\u6708";@','m"\u6708"d"\u65e5";@',"yyyy/m/d;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@"],Time:["[$-411]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@",'h"\u6642"mm"\u5206";@','h"\u6642"mm"\u5206"ss"\u79d2";@'],Special:{"\u90f5\u4fbf\u756a\u53f7":"[<=999]000;[<=9999]000-00;000-0000","\u96fb\u8a71\u756a\u53f7\uff08\u6771\u4eac)":"[<=99999999]####-####;(00) ####-####","\u6b63\u8ca0\u8a18\u53f7 \uff08+ = \u25b3; - = \u25b2)":'"\u25b3" #,##0;"\u25b2" #,##0',"\u6f22\u6570\u5b57\uff08\u5341\u4e8c\u4e07\u4e09\u5343\u56db\u767e\uff09":"[DBNum1][$-411]General","\u5927\u5b57 (\u58f1\u62fe\u5f10\u842c\u53c2\u9621\u56db\u767e)":"[DBNum2][$-411]General","\u5168\u89d2 (\uff11\uff12\uff13\uff14\uff15)":"[DBNum3][$-411]0","\u5168\u89d2 \u6841\u533a\u5207\u308a\uff08\uff11\uff12,\uff13\uff14\uff15\uff09":"[DBNum3][$-411]#,##0"}},t.TimelineDateOrder=[M.year,M.quarterOrMonth,M.date],t.TimelineDateSuffix={year:"\u5e74",quarter:"",month:"\u6708",date:"\u65e5"},t}function L(){var t,r,n,e,i,e,t=D.call(this)||this,r,n;return T.call(t,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"\xa5",!1,"\u975e\u6570\u5b57","\u8d1f\u65e0\u7a77\u5927",1,1,"\u6b63\u65e0\u7a77\u5927",{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u25cb","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u4edf","\u4f70","\u62fe","\u4ebf","\u4edf","\u4f70","\u62fe","\u4e07","\u4edf","\u4f70","\u62fe",""],numbers:["\u96f6","\u58f9","\u8d30","\u53c1","\u8086","\u4f0d","\u9646","\u67d2","\u634c","\u7396"]},3:{letters:o,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},{Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u4ebf",Trillions:"\u5146"}]),T.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters"],[["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],e=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],e,"\u4e0a\u5348",!(e=["yyyy\u5e74M\u6708","M\u6708d\u65e5","yyyy\u5e74M\u6708d\u65e5","h\u65f6mm\u5206","h\u65f6mm\u5206ss\u79d2"]),["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],1,"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",i=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],i,"\u516c\u5386","\u4e0b\u5348","yyyy/M/d",["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",e]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.name=function(){return"zh-cn"},t.id=2052,t.displayName="Chinese (China)",t.isJCKCulture=!0,t.localeCompare=function(t,r){return t.localeCompare(r,"zh")},t.predefinedFormats={Accounting:'_ [$\xa5-804]* #,##0.00_ ;_ [$\xa5-804]* -#,##0.00_ ;_ [$\xa5-804]* "-"??_ ;_ @_ ',Comma:'_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_ ',Currency:["[$\xa5-804]#,##0","[$\xa5-804]#,##0;[Red][$\xa5-804]#,##0","[$\xa5-804]#,##0;[$\xa5-804]-#,##0","[$\xa5-804]#,##0;[Red][$\xa5-804]-#,##0"],Date:["yyyy/m/d","[$-804]dddd, mmmm dd, yyyy","yyyy-mm-dd;@",'[DBNum1][$-804]yyyy"\u5e74"m"\u6708"d"\u65e5";@','[DBNum1][$-804]yyyy"\u5e74"m"\u6708";@','[DBNum1][$-804]m"\u6708"d"\u65e5";@',"[$-409]yyyy/m/d h:mm AM/PM;@",'yyyy"\u5e74"m"\u6708"d"\u65e5";@','yyyy"\u5e74"m"\u6708";@','m"\u6708"d"\u65e5";@',"mm/dd/yy;@","m/d/yy;@","yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]m","[$-409]m-d;@"],Time:["[$-804]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@",'h"\u65f6"mm"\u5206";@','h"\u65f6"mm"\u5206"ss"\u79d2";@','[$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@','[$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2";@','[DBNum1][$-804]h"\u65f6"mm"\u5206";@','[DBNum1][$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@'],Special:{"\u90ae\u653f\u7f16\u7801":"000000","\u4e2d\u6587\u5c0f\u5199\u5b57\u6bcd":"[DBNum1][$-804]General","\u4e2d\u6587\u5927\u5199\u5b57\u6bcd":"[DBNum2][$-804]General"}},t.TimelineDateOrder=[M.year,M.quarterOrMonth,M.date],t.TimelineDateSuffix={year:"\u5e74",quarter:"",month:"",date:"\u65e5"},t.TextFormat={lineBreakingChar:[" ","\u3000","-"],lineBreakingForbidStart:["!","%",")",",",".",":",";","?","]","}","\uff01","\uff05","\uff09","\uff0c","\uff0e","\uff1a","\uff1b","\uff1f","\uff3d","\uff5d"],lineBreakingForbidEnd:["(","[","{","\uff08","\uff3b","\uff5b"],lineBreakingStrategy:function(t,r){return x(t,r,I)}},t}function G(){var t,r,n,e,e,t=H.call(this)||this,r,n;return T.call(t,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"\u20a9",!1,{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\uf9d1","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\uf973","\u5104","\u9621","\u767e","\uf973","\u842c","\u9621","\u767e","\uf973",""],numbers:["\uf9b2","\u58f9","\u8cb3","\uf96b","\u56db","\u4f0d","\uf9d1","\u4e03","\u516b","\u4e5d"]},3:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]},4:{letters:["\uc870","\ucc9c","\ubc31","\uc2ed","\uc5b5","\ucc9c","\ubc31","\uc2ed","\ub9cc","\ucc9c","\ubc31","\uc2ed",""],numbers:["\u25cb","\uc77c","\uc774","\uc0bc","\uc0ac","\uc624","\uc721","\uce60","\ud314","\uad6c"]}},{Hundreds:"\ubc31",Thousands:"\ucc9c",Millions:"\ubc31\ub9cc",Billions:"10\uc5b5",Trillions:"\uc870"}]),T.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],e=["1","2","3","4","5","6","7","8","9","10","11","12",""],e,"\uc624\uc804",!(e=["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4",""]),["\uc77c\uc694\uc77c","\uc6d4\uc694\uc77c","\ud654\uc694\uc77c","\uc218\uc694\uc77c","\ubaa9\uc694\uc77c","\uae08\uc694\uc77c","\ud1a0\uc694\uc77c"],1,"yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd h:mm:ss","yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd","h:mm:ss","M'\uc6d4' d'\uc77c'",e,e,"\uc11c\uae30","\uc624\ud6c4","yyyy-MM-dd",["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],"tt h:mm","yyyy'\ub144' M'\uc6d4'","yyyy\ub144/mmmm/d\uc77c"]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.name=function(){return"ko-kr"},t.id=1042,t.displayName="Korean (Korea)",t.isJCKCulture=!0,t.predefinedFormats={Accounting:'_-[$\u20a9-412]* #,##0.00_-;-[$\u20a9-412]* #,##0.00_-;_-[$\u20a9-412]* "-"??_-;_-@_-',Comma:'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"??_-;_-@_-',Currency:["[$\u20a9-412]#,##0","[$\u20a9-412]#,##0;[Red][$\u20a9-412]#,##0","[$\u20a9-412]#,##0;-[$\u20a9-412]#,##0","[$\u20a9-412]#,##0;[Red]-[$\u20a9-412]#,##0"],Date:["yyyy-mm-dd",'yyyy"\ub144" m"\uc6d4" d"\uc77c" dddd',"yyyy-mm-dd;@",'yyyy"\ub144" m"\uc6d4" d"\uc77c";@','yy"\u5e74" m"\u6708" d"\u65e5";@','yyyy"\ub144" m"\uc6d4";@','m"\uc6d4" d"\uc77c";@',"yy-m-d;@","yy-m-d h:mm;@",'m"\u6708"d"\u65e5";@',"[$-412]yy-m-d AM/PM h:mm;@","yy/m/d;@","yyyy/m/d h:mm;@","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]m","[$-409]m-d;@"],Time:["[$-412]h:mm:ss AM/PM","h:mm;@","h:mm:ss;@","[$-412]AM/PM h:mm;@","[$-412]AM/PM h:mm:ss;@","[$-409]h:mm AM/PM;@","[$-409]h:mm:ss AM/PM;@",'yyyy"-"m"-"d h:mm;@','[$-412]yyyy"-"m"-"d AM/PM h:mm;@','[$-409]yyyy"-"m"-"d h:mm AM/PM;@','h"\uc2dc" mm"\ubd84";@','h"\uc2dc" mm"\ubd84" ss"\ucd08";@','[$-412]AM/PM h"\uc2dc" mm"\ubd84";@','[$-412]AM/PM h"\uc2dc" mm"\ubd84" ss"\ucd08";@'],Special:{"\uc6b0\ud3b8 \ubc88\ud638":"000-000","\uc804\ud654 \ubc88\ud638 (\uad6d\ubc88 4\uc790\ub9ac)":"[<=999999]####-####;(0##) ####-####","\uc804\ud654 \ubc88\ud638 (\uad6d\ubc88 3\uc790\ub9ac)":"[<=9999999]###-####;(0##) ###-####","\uc8fc\ubbfc\ub4f1\ub85d\ubc88\ud638":"000000-0000000","\uc22b\uc790(\ud55c\uc790)":"[DBNum1][$-412]General","\uc22b\uc790(\ud55c\uc790-\uac16\uc740\uc790)":"[DBNum2][$-412]General","\uc22b\uc790(\ud55c\uae00)":"[DBNum4][$-412]General"}},t.TimelineDateOrder=[M.year,M.quarterOrMonth,M.date],t.TimelineDateSuffix={year:"\ub144",quarter:"",month:"\uc6d4",date:"\uc77c"},t}function T(t,r,n){for(var e,i,o,u,e=this,o=0,u=r.length;o<u;o++)i=r[o],e[t][i]=n[o]}function z(t,r){var n;"object"==typeof document&&("function"!=typeof CustomEvent?(n=document.createEvent("CustomEvent")).initCustomEvent("cultureChanged",!1,!1,void 0):n=new CustomEvent("cultureChanged",{}),n.cultureInfo=t,i.gcCultureInfo=t,i.gcCultureObj=r,document.dispatchEvent(n))}function O(){this.KPt=1,this.JPt={}}n=this&&this.__extends||(b=function(t,r){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,r){t.__proto__=r}:function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}))(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}b(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CultureManager=t.XPt=t.CultureInfo=t.TimelineDateOrder=void 0,e=r("./src/common/util/types.ts"),a=r("./src/common/util/common.ts"),u=r("./src/common/util/arrayhelper.ts"),i="undefined"!=typeof window?window:r.g,f=void 0,o=null,s=e.lt.y0,y=e.lt.Dh,r=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],m=(e=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"]).concat(c=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"]),s(e,function(t,n){s(c,function(t,r){t<c.length-4&&m.push(n+" "+r)})}),m=m.concat(r),s(r,function(t,n){s(c,function(t,r){t<c.length-4&&m.push(n+" "+r)})}),(e=M=t.TimelineDateOrder||(t.TimelineDateOrder={}))[e.year=1]="year",e[e.quarterOrMonth=2]="quarterOrMonth",e[e.date=3]="date",h={"00":1,"01":1,"02":1,"03":1,"04":1,"05":1,"06":1,"07":1,12:1,15:1,21:1,22:1,23:1,24:1,25:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1,62:1,65:1,71:1,72:1,73:1,74:1,75:1},k.prototype.lse=function(t){var r;return this.TextFormat&&this.TextFormat.lineBreakingStrategy?(r={lineBreakingChar:this.TextFormat.lineBreakingChar,lineBreakingForbidEnd:this.TextFormat.lineBreakingForbidEnd,lineBreakingForbidStart:this.TextFormat.lineBreakingForbidStart},this.TextFormat.lineBreakingStrategy(t,r)):x(t,this.TextFormat||{lineBreakingChar:[" ","-"]})},k.prototype.qPt=function(){var t,r,r,n;return this.$Pt||(r=(r=[r=(t=this.DateTimeFormat).shortDatePattern.replace(/m/g,"M"),r+" h:mm",r+" h:mm:ss",r+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"]).concat(m),1041===this.id&&(n=t.eraFormatter,r=(r=r.concat(this.QPt)).concat(n)),r=r.concat(t.preselectedFormatters),this.$Pt=r),this.$Pt},k.prototype.tGt=function(t){var r=this;return r.nGt||(r.nGt=$(r.DateTimeFormat.monthNames),r.eGt=$(r.DateTimeFormat.monthGenitiveNames)),S(t,r.nGt,r.eGt)},k.prototype.iGt=function(t){var r=this;return r.rGt||(r.rGt=$(r.DateTimeFormat.abbreviatedMonthNames),r.oGt=$(r.DateTimeFormat.abbreviatedMonthGenitiveNames)),S(t,r.rGt,r.oGt)},k.prototype.aGt=function(t){var r=this;return r.uGt||(r.uGt=$(r.DateTimeFormat.dayNames)),r.uGt.indexOf(N(t))},k.prototype.sGt=function(t){var r=this;return r.cGt||(r.cGt=$(r.DateTimeFormat.abbreviatedDayNames)),r.cGt.indexOf(N(t))},d=k,t.CultureInfo=d,C.fGt=function(t){return t>=C.lGt()&&t<=C.hGt()},C.dGt=function(){var t,r,n,t=d.eras;if(t===f)return this.vGt;for(r=[],n=0;n<t.length;n++)r[n]=new Date(t[n].startDate.replace(/-/g,"/"));return r},C.mGt=function(t){var r,n,e,i,o;switch(t){case"g":r="symbol",n=C.gGt;break;case"gg":r="abbreviation",n=C.pGt;break;case"ggg":r="name",n=C.DEt;break;default:return[]}if(i=[],(e=d.eras)===f)return n;for(o=0;o<e.length;o++)i[o]=e[o][r];return i},C.hGt=function(){var t,t,t=d.eras;return t!==f&&0<t.length?((t=new Date(t[t.length-1].startDate.replace(/-/g,"/"))).setFullYear(t.getFullYear()+99),t):this.bGt},C.lGt=function(){var t=d.eras;return t!==f&&0<t.length?new Date(t[0].startDate.replace(/-/g,"/")):this.yGt},C.wGt=function(){var t=d.eras;return t!==f?t.length:this.MGt},C.CGt=function(){var t,r,n,e,i,t=d.eras;if(t===f)return this.SGt;for(r=[],n=1;n<t.length;n++)e=new Date(t[n-1].startDate.replace(/-/g,"/")),i=new Date(t[n].startDate.replace(/-/g,"/")),r[n-1]=i.getFullYear()-e.getFullYear()+1;return r[n-1]=99,r},C.TGt=function(t){var r,n,e,r={AGt:-1,IGt:-1};if(!C.fGt(t)){if(!(t>C.hGt()))return r;t=C.hGt()}for(n=0;n<C.wGt();n++)if(t<(e=n+1!==C.wGt()?C.dGt()[n+1]:C.xGt(C.hGt(),1))){r.AGt=n,r.IGt=t.getFullYear()-C.dGt()[n].getFullYear()+1;break}return r},C.xGt=function(t,r){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+r),new Date(t.valueOf())},C.NGt=function(t,r){var n;return C.dGt()[t].getFullYear()+r-1},C.kGt=function(t,r){var n,e;for(r=r.toUpperCase(),n=C.mGt(t),e=0;e<n.length;e++)if(n[e]===r)return e;return-1},C.DGt=function(t,r,n){var e,r,i,e,e,i,e=C,r=e.TGt(r),i=r.AGt;if(0<=i&&0<(e=e.mGt(t)).length)return e[i];if(0<=(e=r.IGt)){if("1"===(i=e.toString())&&n)return i="\u5143";if("ee"===t)return i=1===i.length?"0"+i:i;if("e"===t)return i}return""},C.vGt=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],C.MGt=5,C.SGt=[45,15,64,31,99],C.bGt=new Date(2117,11,31,23,59,59),C.yGt=new Date(1868,8,8),C._Gt=["1,m","2,t","3,s","4,h","5,r"],C.EGt=[0,1,2,3,0,1,2,3],C.DEt=["\u660e\u6cbb","\u5927\u6b63","\u662d\u548c","\u5e73\u6210","\u4ee4\u548c"],C.gGt=["M","T","S","H","R"],C.pGt=["\u660e","\u5927","\u662d","\u5e73","\u4ee4"],C.jGt=99,C.eraExcelFormatter="[$-ja-JP-x-gannen]",C.eraInternalFormatter="[$-411]",t.XPt=C,n(A,_=d),r=A,n(B,w=d),e=B,n(L,D=d),l=L,n(G,H=d),n=G,v={invariant:new d,"en-us":new r,"ja-jp":new e,"zh-cn":new l,"ko-kr":new n},F={},p=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6","ls7","ls8"],g=["wmk1","wmk2"],O.instance=function(){return this.OGt||(this.OGt=new this)},O.prototype.culture=function(t){if(0===arguments.length)return O.RGt;t&&O.RGt!==t&&(O.RGt=t.toLowerCase(),this.KPt++,z(O.RGt,O.OGt.getCultureInfo()))},O.prototype.addCultureInfo=function(t,r,n){var e,i,o,u,e;if(r&&r instanceof d){if(e=r.NumberFormat&&r.NumberFormat.numberDecimalSeparator,i=r.NumberFormat.arrayListSeparator,o=r.NumberFormat.arrayGroupSeparator,e===r.NumberFormat.listSeparator||o===i)throw(u=new a.ResourceManager(a.SR)).getResource().Exp_Separator;v[t.toLowerCase()]=r}n&&"object"==typeof n&&(e=t.toLowerCase(),F[e]=y(!0,{},n),this.KPt++)},O.prototype.getCultureInfoDict=function(){return v},O.prototype.getCultureInfo=function(t){var r,n,e;if(0===arguments.length)return v[O.RGt];for(e in"string"==typeof t&&(t=t.toLowerCase()),n=o,r=v)if(e===t||r[e].id!==f&&r[e].id===t){n=r[e];break}return n},O.prototype.getLanguage=function(t){var t;return"string"==typeof t?(t=t.toLowerCase(),F[t]):o},O.prototype.getResources=function(t){var r,r,r=this.culture().toLowerCase();return"string"==typeof(t=t!==o&&t!==f?t:r)&&(r=t.toLowerCase(),this.JPt[r])?this.BGt(this.JPt[r]):o},O.prototype.BGt=function(t){var r,n,e,i,o,t,r,r="PivotTables",n="Sheets",e="CalcEngine",i="Functions",o="TableFunctions",t=y(!0,{},t);return t[r]&&this.LGt(t[r],g),t[n]&&this.LGt(t[n],p),(r=t[e])&&(t[i]=r.wmt,t[o]=r.d2t,delete r.wmt,delete r.d2t),t},O.prototype.LGt=function(t,r){for(var n,e,i,n=0,e=r;n<e.length;n++)delete t[i=e[n]]},O.prototype.FGt=function(t,r,n){var e,i,o,e=F[t.toLowerCase()];for(i in r)u.Uf.OS(p,i)||null!==(o=this.PGt(e,i,n))&&"string"==typeof o&&"string"==typeof r[i]&&(r[i]=o);r.wmt&&e.Functions&&this.GGt(e.Functions,r.wmt),r.d2t&&e.TableFunctions&&y(!0,r.d2t,e.TableFunctions)},O.prototype.PGt=function(t,r,n){var e,i;if(t.hasOwnProperty(r))return t[r];if(n&&(e=t[n])&&"object"==typeof e&&e.hasOwnProperty(r))return e[r];for(i in t)if((e=t[i])&&"object"==typeof e&&e.hasOwnProperty(r))return e[r];return null},O.prototype.GGt=function(t,r){var n,e,i,o,u,a,s,f,n={};for(e in r)if(t.hasOwnProperty(e))for(s in i=r[e],o=t[e],u=i.parameters,a=o.parameters,i.description=o.description,u)a.hasOwnProperty(s)&&"string"==typeof(f=a[s])&&(u[s].name=f);return n},O.prototype.Fe=function(t){var t=this.getCultureInfo(t),t;return t=(t=t||v[O.RGt])||new d},O.prototype.xat=function(t,r){var n,t,e,n,t=(this.getCultureInfo(t)||this.getCultureInfo("en-US")).DateTimeFormat,e=t.filterDialogDateFormatter;return e=0<=r.indexOf("g")||0<=r.indexOf("e")?t.EraFilterDialogDateFormatter||e:e},O.RGt="en-us",t.CultureManager=O.instance()},"./src/common/util/arrayhelper.ts":function(t,r){var i,o,n;function u(t,r){var n,e;for(n in r)r.hasOwnProperty(n)&&(e=r[n],Array.isArray(e)?(t[n]=[],u(t[n],r[n])):e!==i&&"object"==typeof e?(t[n]={},u(t[n],r[n])):t[n]=r[n])}function e(){}Object.defineProperty(r,"__esModule",{value:!0}),r.Uf=void 0,i=null,o=void 0,e.Eit=function(t,r,n){t.splice(r,0,n)},e.ZP=function(t,r){t.push(r)},e.OS=function(t,r){return-1<t.indexOf(r)},e.VP=function(t,r){var r=t.indexOf(r);-1<r&&t.splice(r,1)},e.UGt=function(t,r){return t.slice(0,r).concat(t.slice(r+1))},e.hD=function(t,r,n){return t.indexOf(r,n)},e.d5=function(t,r,n){if(!(r<0))for(var e=0;e<n&&r+e<t.length;e++)t[r+e]=i},e.N2t=function(t,r){for(var n,e,e=n=(r=r<0?-1:r)+1;e<t.length;e++)if(t[e]!==o&&t[e]!==i)return e;return-1},e.tR=function(t){return t&&t.length},e.Gf=function(t){var r=[];return u(r,t),r},r.Uf=e},"./src/common/util/colorhelper.ts":function(t,r,n){var n,o,s,f,u,y,e,i,a;function c(t,r,n){return n<0&&(n+=240),240<n&&(n-=240),n<40?t+((r-t)*n+20)/40:n<120?r:n<160?t+((r-t)*(160-n)+20)/40:t}function m(t,r,n){var e,i,o,u,a;return 0===n?e=i=o=y(255*r/240+"",10):(a=u=void 0,e=M(u=2*r-(a=r<=120?y((r*(240+n)+120)/240+""):r+n-y((r*n+120)/240+"")),a,t+80),i=M(u,a,t),o=M(u,a,t-80)),{a:255,r:e,g:i,b:o}}function M(t,r,n){return s(y((255*c(t,r,n)+120)/240+""),255)}function h(t){var r,n,e,t,i,o,u,o,u,a,t,r=this,n=t.r,e=t.g,t=t.b,i=f(f(n,e),t),o=s(s(n,e),t),u=i+o;r.HGt=y((240*u+255)/510+"",10),0==(o=i-o)?(r.zGt=0,r.wv=160):(r.HGt<=120?r.zGt=y((240*o+u/2)/u+"",10):r.zGt=y((240*o+(510-u)/2)/(510-u)+"",10),u=(40*(i-n)+o/2)/o,a=(40*(i-e)+o/2)/o,t=(40*(i-t)+o/2)/o,r.wv=y(n===i?t-a+"":e===i?80+u-t+"":160+a-u+"",10),r.wv<0&&(r.wv+=240),240<r.wv&&(r.wv-=240))}function d(t){var r,n,r,r;return/^#[A-Fa-f0-9]+$/.test(t)?(r=t.replace(/^#/,""),n=r.length,(r=(r=r.split(3===n?/(.)/:/(..)/)).filter(Boolean).map(function(t){return 3===n?parseInt(t+t,16):parseInt(t,16)}))[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),[r[0],r[1],r[2],1]):null!==(r=i.exec(t))?[r[1],r[2],r[3],1]:null}function l(){}Object.defineProperty(r,"__esModule",{value:!0}),r.ft=void 0,n=n("./src/common/util/numberhelper.ts"),o=n.st.VGt,s=Math.min,f=Math.max,u=Math.abs,y=parseInt,h.prototype.YGt=function(t){var r,n,e,r=this,n=r.HGt,e=r.ZGt(r.HGt,500,!0);return m(r.wv,n+(e-n)*t,r.zGt)},h.prototype.ZGt=function(t,r,n){if(0!==r){if(n)return 0<r?(t*(1e3-r)+241*r)/1e3:t*(r+1e3)/1e3;240<(t=(t+=240*r/1e3)<0?0:t)&&(t=240)}return t},e=h,i=/rgb[a]?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*(\d{0,1}))?\)/,l.j=function(t){var r,n,e,i,r=t.a,n=t.r,e=t.g,i=t.b;return 3===arguments.length&&(r=255,n=t,e=arguments[1],i=arguments[2]),4===arguments.length&&(r=t,n=arguments[1],e=arguments[2],i=arguments[3]),255===r?"#"+o(n,!0,2)+o(e,!0,2)+o(i,!0,2):"rgba("+n+","+e+","+i+","+r+")"},l.Tv=function(t,r){return t.stops||t.type?JSON.stringify(t)===JSON.stringify(r):t.a===r.a&&t.r===r.r&&t.g===r.g&&t.b===r.b},l.rp=function(t){return(299*t.r+587*t.g+114*t.b)/1e3},l.Km=function(t,r){var n,e,i,t,o,n=255-u(t.r-r.r),e=255-u(t.g-r.g),i=255-u(t.b-r.b),t=u(t.a-r.a);return!!(.9<=(o=((n/=255)+(e/=255)+(i/=255))/3)&&t<=.05)},l.Uv=function(t){var r,n,e,r=255^t.r,n=255^t.g,e=255^t.b;return l.j(t.a,r,n,e)},l.WGt=function(t){var r,n,n;return"object"!=typeof document?d(t):((r=l.xf)||(n=document.createElement("canvas"))&&n.getContext&&(r=l.xf=n.getContext("2d",{willReadFrequently:!0})),r?(r.clearRect(1,1,1,1),r.fillStyle=t,r.fillRect(1,1,1,1),(n=r.getImageData(1,1,1,1))?n.data:null):t)},l._=function(t){var r,n,e,i,t;return t instanceof l||null!==t&&"object"==typeof t?t:(i=e=n=r=0,t&&(t=l.WGt(t))&&(n=t[0],e=t[1],i=t[2],r=t[3]),{a:r,r:n,g:e,b:i})},l.Cv=function(t,r){var t,r;return 0===r?t:(t=new e(t),r=y((0<r?(240-t.HGt)*r:t.HGt*r)+"",10),l.QGt(t.wv,t.HGt+r,t.zGt))},l.YGt=function(t,r){var t,n,t,t=l._(t),n,t=new e(t).YGt(r);return l.j(t)},l.Dz=c,l.QGt=m,r.ft=l},"./src/common/util/common.ts":function(t,r,n){var i,e,n,o,u;function a(t,r){this.res=t,this.KGt=r,this.JPt=i.CultureManager.JPt,this.cachedResource=this.JGt(t,!0),this.XGt(this.cachedResource,r),this.KPt=0}function s(t,r,n,e){var i,o,u,a,s;if(t&&0<=n&&n<r){for(i=[],u=o=void 0,u=n;u<r;u++)void 0!==t[u]&&i.push(u);for(o=i.length,u=0;u<o;u++)s=t[a=i[o-u-1]],t[a]=null,t[Math.floor(a)+e]=s}}function f(t,r,n,e){var i,o,u,a,s,f;if(t&&0<=n&&n<r){for(i=[],u=n+e,a=o=void 0,a=n;a<r;a++)void 0!==t[a]&&(n<=a&&a<u?t[a]=null:u<=a&&i.push(a));for(o=i.length,a=0;a<o;a++)f=t[s=i[a]],t[s]=null,t[Math.floor(s)-e]=f}}function y(t,r){return t.hasOwnProperty(r)}function c(t,r){return t instanceof r}Object.defineProperty(r,"__esModule",{value:!0}),r.ut=r.kh=r.X8=r.J8=r.ResourceManager=r.SR=void 0,i=n("./src/common/culture/cultureInfo.ts"),e=n("./src/common/util/util.res.en.ts"),n=n("./src/common/util/types.ts"),r.SR={en:e},o=n.lt.Dh,a.prototype.getResource=function(){var t=this.JGt(this.res,!this.cachedResource);return t&&(this.cachedResource=t),this.XGt(this.cachedResource,this.KGt),this.cachedResource},a.prototype.XGt=function(t,r){var n,e;r&&(e=(n=i.CultureManager.culture()).toLowerCase(),this.JPt[e]=this.JPt[e]||{},this.JPt[e][r]=t,i.CultureManager.JPt=this.JPt)},a.prototype.JGt=function(t,r){var n,e,r,e,n=i.CultureManager.culture();return t&&n?(e=i.CultureManager.KPt,this.KPt!==e||r?(this.KPt=e,i.CultureManager.getLanguage(n)?(r=o(!0,{},t.en),i.CultureManager.FGt(n,r,this.KGt),r):(e=n.substr(0,2).toLowerCase(),t.hasOwnProperty(e)?t[e]:t.en)):void 0):{}},r.ResourceManager=a,r.J8=s,r.X8=f,r.kh=y,r.ut=c},"./src/common/util/datetimehelper.ts":function(t,k,r){var n,$,M,C,r,u,A,S,P,x,e,T,O,r,o,i;function E(t,r){if(n.HandleExcelSpecialDate)return n.HandleExcelSpecialDate.apply(null,[t,r]);switch(r){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();default:return}}function j(t,r,n,e){var i,o,u,a,s,f,y,c,m,M,h,d,l,v,F,p,g,b,g,_,w,D,H,N,$,S,i=n.DateTimeFormat,o=i.Calendar.convert;if(!r||!r.length)return n&&n.name.length?o?j(t,i.fullDateTimePattern,n):t.toLocaleString():t.toString();function P(){return y||c||(y=m.test(r),c=!0),y}function x(t,r){return d?d[r]:E(t,r)}for(u=i.eras,s="",m=/([^d]|^)(d|dd)([^d]|$)/g,M=0,h=B(),!(a="s"===r)&&o&&(d=o.fromGregorian(t)),v=l=-2,F={y4:""},p=0;g=h.lastIndex,b=h.exec(r),g=r.slice(g,b?b.index:r.length),F.y4="",M+=R(g,F),s+=F.y4,b;p++)if(M%2==1)s+=b[0];else switch(_=x(t,0),w=t.getDay(),D=t.getHours(),H=t.getMinutes(),N=t.getSeconds(),$=t.getMilliseconds(),S=t.getTimezoneOffset(),b[0]){case"dddd":s+=i.dayNames[w];break;case"ddd":s+=i.abbreviatedDayNames[w];break;case"dd":y=!0,s+=A(x(t,2),2);break;case"d":y=!0,s+=x(t,2);break;case"MMMM":s+=(i.monthGenitiveNames&&P()?i.monthGenitiveNames:i.monthNames)[x(t,1)];break;case"MMM":s+=(i.abbreviatedMonthGenitiveNames&&P()?i.abbreviatedMonthGenitiveNames:i.abbreviatedMonthNames)[x(t,1)];break;case"MM":s+=A(x(t,1)+1,2);break;case"M":s+=x(t,1)+1;break;case"yyyy":case"yyy":s+=0<=l?C.XPt.DGt("ee",t,e):A(d?d[0]:_,4);break;case"yy":s+=0<=l?C.XPt.DGt("ee",t,e):A((d?d[0]:_)%100,2);break;case"y":s+=0<=l?C.XPt.DGt("e",t,e):((d?d[0]:_)%100).toString();break;case"hh":s+=A(f=0===(f=D%12)?12:f,2);break;case"h":s+=f=0===(f=D%12)?12:f;break;case"HH":s+=A(D,2);break;case"H":s+=D.toString();break;case"mm":s+=A(H,2);break;case"m":s+=H.toString();break;case"ss":s+=A(N,2);break;case"s":s+=N.toString();break;case"tt":s+=D<12?i.amDesignator:i.pmDesignator;break;case"t":s+=(D<12?i.amDesignator:i.pmDesignator).charAt(0);break;case"f":case"0":s+=A($,3).charAt(0);break;case"ff":case"00":s+=A($,3).substr(0,2);break;case"fff":case"000":s+=A($,3);break;case"z":s+=((f=S/60)<=0?"+":"-")+T(O(f));break;case"zz":s+=((f=S/60)<=0?"+":"-")+A(T(O(f)),2);break;case"zzz":s+=((f=S/60)<=0?"+":"-")+A(T(O(f)),2)+":"+A(O(S%60),2);break;case"g":case"gg":case"ggg":u&&(l=(l===p-1||(s+=C.XPt.DGt(b[0],t,e)),p));break;case"e":case"ee":u?v=(v===p-1||(s+=C.XPt.DGt(b[0],t,e)),p):s+=A(d?d[0]:_,4);break;case"/":s+=i.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[m]":case"[ss]":case"[s]":s+=b[0];break;default:throw new Error((0,k.getSR)().Exp_InvalidDateFormat)}return s.toString()}function R(t,r){for(var n,e,i,o,u,n=0,e=x,i=0,o=t.length;i<o;i++)switch(u=t.charAt(i)){case'"':e?r.y4+="'":n++,e=x;break;case"\\":e&&(r.y4+="\\"),e=!e;break;default:r.y4+=u,e=x}return n}function I(t,r){var n,e,n,n=new Date,e;return t.DateTimeFormat.eras&&r<100&&(r+=(n=C.XPt.TGt(n).IGt)-n%100)>t.DateTimeFormat.Calendar.TwoDigitYearMax&&(r-=100),r}function B(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g}function L(t,r,n){var e,i,o,u,a,s,f,y,c,m,m;if(t.qGt){if(t.qGt[r])return t.qGt[r]}else t.qGt={};for(e=(e=(e=r).replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),i="^",o={y4:""},u=[],s=a=0,f=B();(y=f.exec(e))!==S;)if(o.y4="",c=e.slice(a,y.index),a=f.lastIndex,s+=R(c,o),i+=o.y4,s%2==1)i+=y[0];else{switch(y[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":i+="(\\D+)";break;case"tt":case"t":i+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":i+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":i+=n?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":i+="(\\d{2}|\\d{4})";break;case"fff":case"000":i+="(\\d{3})";break;case"ff":case"00":i+="(\\d{2})";break;case"f":case"0":i+="(\\d)";break;case"zzz":i+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":i+="([+-]?\\d\\d?)";break;case"/":i+="/"===t.dateSeparator?"(\\/)":"([\\/\\"+t.dateSeparator+"])";break;default:throw new Error((0,k.getSR)().Exp_InvalidDateFormat)}M.Uf.ZP(u,y[0])}return o.y4="",R(e.slice(a),o),m={$Gt:m=(i=i+o.y4+"$").toString().replace(/\s+/g,"\\s+"),QMt:u,tUt:new RegExp(m)},t.qGt[r]=m}function a(t){var t=t.getTimezoneOffset();return t=-402===(t=-507===(t=-321===(t=-485===t?-485-43/60:t)?-321-10/60:t)?-507-52/60:t)?-402-4/60:t}function s(){}Object.defineProperty(k,"__esModule",{value:!0}),k.ct=k.getSR=void 0,n=r("./src/common/util/common.ts"),$=r("./src/common/util/stringhelper.ts"),M=r("./src/common/util/arrayhelper.ts"),C=r("./src/common/culture/cultureInfo.ts"),r=r("./src/common/util/types.ts"),u=r.lt.ht,A=$.zf.B9t,S=null,P=parseInt,e=!(x=!1),T=Math.floor,O=Math.abs,r=new n.ResourceManager(n.SR,"Common"),k.getSR=r.getResource.bind(r),o={},s.L9t=function(t,r,n,e){return j(t,r,n=n||C.CultureManager.Fe(),e)},s.Pe=function(t,r,n){return j(t,r,n||C.CultureManager.Fe())},s.Mjt=function(t,r,n){var e,i,o,o,u,a=x,u=n;for(u.slice(1).forEach(function(t){t&&(a=!0)}),i=(u=a?u:u.concat(r.qPt())).length,e=1;e<i;e++)if((o=u[e])&&(a=!0,o=s.nUt(t,o,r)))return o;return S},s.yU=function(t,r,n){var e,i;return(r||n||void 0===(i=o[t]))&&(e=r?[t,r]:[t],i=s.Mjt(t,n||C.CultureManager.Fe(),e),r||n||(o[t]=i)),i&&new Date(i)},s.Z6t=function(t,r){return s.Mjt(t,C.CultureManager.Fe("invariant"),[t,r])},s.nUt=function(t,r,n){var e,i,r,o,u,a,s,f,y,c,m,M,h,d,l,v,F,p,g,b,_,w,w,D,D,r,t,H,N,r;if(t=t.trim(),(o=(r=L(e=n.DateTimeFormat,r,i=1041===n.id)).tUt.exec(t))===S)return S;for(u=r.QMt,v=c=y=f=s=a=S,p=F=x,g=l=d=h=m=0,b=u.length;g<b;g++)if(_=o[g+1])switch(u[g]){case"dd":case"d":if((y=P(_,10))<1||31<y)return S;break;case"MMMM":if((f=n.tGt(_))<0||11<f)return S;break;case"MMM":if((f=n.iGt(_))<0||11<f)return S;break;case"M":case"MM":case"%M":if((f=P(_,10)-1)<0||11<f)return S;break;case"e":case"ee":if((s=i&&"\u5143"===_?1:I(n,P(_,10)))<0||9999<s)return S;break;case"y":case"yy":case"yyy":case"yyyy":if((s=P(_,10))<0||9999<s)return S;break;case"h":case"hh":case"H":case"HH":if((m=P(_,10))<0)return S;break;case"m":case"mm":if((h=P(_,10))<0||59<h)return S;break;case"s":case"ss":if((d=P(_,10))<0||59<d)return S;break;case"tt":case"t":if(F=(w=_.toUpperCase())===e.pmDesignator.toUpperCase(),p=w===e.amDesignator.toUpperCase(),F||p)break;return S;case"f":case"0":if((l=100*P(_,10))<0||999<l)return S;break;case"ff":case"00":if((l=10*P(_,10))<0||999<l)return S;break;case"fff":case"000":if((l=P(_,10))<0||999<l)return S;break;case"dddd":if((c=n.aGt(_))<0||6<c)return S;break;case"ddd":if((c=n.sGt(_))<0||6<c)return S;break;case"zzz":if(2!==(w=_.split(/:/)).length)return S;if((M=P(w[0],10))<-12||13<M)return S;if((D=P(w[1],10))<0||59<D)return S;v=60*M+($.zf.fJ(_,"-")?-D:D);break;case"z":case"zz":if((M=P(_,10))<-12||13<M)return S;v=60*M;break;case"g":case"gg":case"ggg":if(!(D=_)||!e.eras)return S;if((a=C.XPt.kGt(u[g],D))<0)return S}if(t=(r=/^(\d|\d\d|\d\d\d):/.test(t))?new Date(1899,11,30):new Date,(N=e.Calendar.convert)&&(H=N.fromGregorian(t)),N||(H=[t.getFullYear(),t.getMonth(),t.getDate()]),s===S?s=H[0]:s<100&&(e.eras&&a!==S?s=C.XPt.NGt(a||0,s):s+=30<=s?1900:2e3),f===S&&(f=H[1]),y===S&&(y=r?H[2]:1),N){if((t=N.toGregorian(s,f,y))===S)return S}else{if(t.setFullYear(s,f,y),t.getDate()!==y)return S;if(c!==S&&t.getDay()!==c)return S}return F&&m<12?m+=12:p&&12===m&&(m=0),t.setHours(m,h,d,l),v!==S&&(r=t.getMinutes()-(v+t.getTimezoneOffset()),t.setHours(t.getHours()+r/60,r%60)),t},s.Y0=function(t){var r,n,e,r,t,e,i,o,u,t,r=t-25569,n,e=0<=r?1:-1,r=a(new Date(864e5*r)),t=(864e5*t*1440+e-3181192704e6+864e5*r)/1440,e=new Date(t),i=0<=r?1:-1,o,u=a(new Date(t+36e5*i));if(60<=O(r-u))if(t=new Date(t+60*(u-r)*1e3),u<r){if(-1==i||u===a(e))return t=999===t.getMilliseconds()?new Date(t.valueOf()+1):t}else if(r<u&&(1==i||u===a(e)))return t=999===t.getMilliseconds()?new Date(t.valueOf()+1):t;return e=999===e.getMilliseconds()?new Date(e.valueOf()+1):e},s.dJ=function(t){var t;if("/OADate("===t.substr(0,8))return t=parseFloat(t.substr(8,t.length-10)),s.Y0(t)},s.Q0=function(t){return"/OADate("+s.o0(t)+")/"},s.o0=function(t){var r;return u(t)?0:(r=a(t="number"==typeof t?new Date(t):t),(1440*t.getTime()+3181192704e6-864e5*r)/124416e6)},s.iPt=function(t){var r,n,e,i,o,r=S,n=!0;if(u(t)?r=s.Y0(0):t instanceof Date?r=new Date(t.valueOf()):"string"==typeof t?((e=s.yU(t))||(isNaN(t)?!s.u6t(t)&&(e=new Date(t),isNaN(e.valueOf())&&(n=x),!(o=(i=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/).exec(t.replace(/ |\n/g,"").trim()))||4!==o.length||-1!==o.indexOf(e.getFullYear().toString())&&-1!==o.indexOf((e.getMonth()+1).toString())&&-1!==o.indexOf(e.getDate().toString()))||(n=x):(e=s.Y0(parseFloat(t)))||(n=x)),r=e):"number"==typeof t?r=s.Y0(t):n=x,n)return r;throw(0,k.getSR)().Exp_InvalidCast},s.u6t=function(t){var r,e,n,i,o,r=C.CultureManager.Fe().DateTimeFormat,e=s.eUt,n=function(r,t){var n=0;return t.forEach(function(t){t&&-1<r.indexOf(t)&&n++}),1<n},i=function(t,r){var t,n;return!!(t&&-1<t.indexOf(" "))&&2<=(n=(t=t.split(" ")).length)&&r.indexOf(t[n-2])<=-1&&!isNaN(t[n-1])},o=function(r){var n=!1;return e.forEach(function(t){-1<r.indexOf(t)&&(n=!0)}),n};return n(t,r.monthNames)||n(t,r.abbreviatedMonthNames)||n(t,r.dayNames)||n(t,r.abbreviatedDayNames)||i(t,r.monthNames.concat(r.abbreviatedMonthNames))||o(t)},s.W0=function(t){return t&&(t.constructor===Date||t.getUTCDate&&t.setFullYear)},s.eUt=["@","#","!","`","^","$","*","(",")","&"],k.ct=s},"./src/common/util/functionhelper.ts":function(t,r){var G,z,K;function f(t){return t}function y(t,r,n,e,i,o,u,a,s,E,f){var y,c,m,M,h,d,l,v,F,p,g,b,_,w,D,H,N,$,S,j,R,I,B,P,x,k,C,A,L,T,O,N=n[z],$=n[K],S=r[z],j=r[K],R=e[z],I=e[K],B=1===$,P=1===j;if(S===N&&j===$){for(l=N*$,y=A=C=k=x=0;y<N;y++)for(c=0;c<$;c++){if(M=o(n[y][c]),h=o(r[y][c]),t&&(G(M)||G(h)))return s;x+=M,k+=M*M,C+=h=E(h),A+=M*h}for(L=l*A-x*C,d=i?L/(l*k-x*x):A/k,v=i?(C*k-x*A)/(l*k-x*x):0,F=[],y=0;y<R;y++)for(F[y]=[],c=0;c<I;c++){if(M=o(e[y][c]),t&&G(M))return s;F[y][c]=0==L?r[0][0]:f(d*M+v)}return u?new u(F):F}if(P&&S===N||1===S&&j===$){for(M=[],h=[],D=$+1,H=$+2,y=0;y<N;y++){if(v=o(g=P?r[y][0]:r[0][y]),t&&G(v))return s;h[y]=B?E(v):v}for(y=0;y<N;y++)for(M[y]=[],c=0;c<$;c++){if(v=o(n[y][c]),t&&G(v))return s;M[y][c]=v}for(T=[],d=0;d<D;d++)for(T[d]=[],l=0;l<H;l++)T[d][l]=0;for(m=0;m<N;m++)for(T[0][D]+=h[m],y=0;y<$;y++)for(T[0][g=y+1]+=M[m][y],T[g][0]=T[0][g],T[g][D]+=M[m][y]*h[m],c=y;c<$;c++)T[_=c+1][g]+=M[m][y]*M[m][c],T[g][_]=T[_][g];for(T[0][0]=N,p=O=i?0:1;p<D;p++){if(t){if(0===T[p][p]){for(w=!1,c=p+1;!w&&c<D;c++)if(0!==T[c][p]){for(m=0;m<H;m++)_=T[p][m],T[p][m]=T[c][m],T[c][m]=_;w=!0}if(!w)return a}}else{for(y=p;y<D&&0===T[y][p];)y++;if(D<=y)return a;for(b=O;b<H;b++)g=T[p][b],T[p][b]=T[y][b],T[y][b]=g}for(g=1/T[p][p],b=O;b<H;b++)T[p][b]*=g;for(y=O;y<D;y++)if(y!==p)for(g=-T[y][p],b=0;b<H;b++)T[y][b]+=g*T[p][b];i||(T[0][D]=0)}for(F=[],P||(F[0]=[]),y=0;y<R;y++){for(P&&(F[y]=[]),g=T[0][D],c=0;c<$;c++){if(v=o(P?e[y][c]:e[c][y]),t&&G(v))return s;g+=T[c+1][D]*v}P?F[y][0]=f(g):F[0][y]=f(g)}return u?new u(F):F}return a}function n(t,r,n,e,i,o,u,a){return y(!0,t,r,n,e,i,o,a,u,f,f)}function e(t,r,n,e,i,o,u){for(var a,s,a=0;a<t[z];a++)for(s=0;s<t[K];s++)if(t[a][s]<=0)return o;return y(!1,t,r,n,e,f,i,u,null,Math.log,Math.exp)}Object.defineProperty(r,"__esModule",{value:!0}),r.iit=r.eit=void 0,G=isNaN,z="rowCount",K="colCount",r.eit=n,r.iit=e},"./src/common/util/numberhelper.ts":function(E,t,r){var n,e,i,f,o,y,N,c,v,u,m,M,F,$,a,p,s,g,h,d,l,S,b,r,_,H,P,x,w,D,k;function j(t,r,n,e){return r&&0!==r.length&&"i"!==r?R(t,r,n.NumberFormat,e):n&&0<n.name.length?t.toLocaleString():t.toString()}function R(t,r,n,e){var i;return X(t,B(r),n,e)}function C(t,r){for(var n,e,t,i,r,o,u,i,o,u,n=a(p(t)),e={iUt:1,rUt:0};10<=n;)n/=10,e.iUt++;return i=(t=t.toString()).search(/e/gi),r=t.indexOf(r),-1!==i?(u=S(t,0,i),i=S(t,i+1),o=0,-1!==r&&(o=S(u,r+1).length),u=M(i),e.rUt=o=(o=o-u)<0?0:o):(o=0,-1!==r&&(o=S(t,r+1).length),e.rUt=o),e}function I(t){for(var r,n,e,r={oUt:t.charAt(0),aUt:0,tUt:0},n="",e=1;e<t.length;e++)if("+"===(n=t.charAt(e)))r.aUt=1;else{if("-"!==n){if("0"!==n)throw new Error(_().Exp_InvalidExponentFormat);r.tUt=t.length-e;break}r.aUt=-1}return r}function B(t){for(var r,n,e,i,o,u,a,s,f,y,c,m,M,h,d,l,r={uUt:v,sUt:v,rCt:F,fxt:0,d0:0,cUt:0,fUt:v},n="",e=F,i=F,o=F,u=F,a=F,s=F,y=v,c=[],m=0;m<t.length;m++){if(f=t.charAt(m),e)n+=f,'"'===f&&(c.push(n),n="",e=F);else if(i){if("E"===y||"e"===y){if(!(0<=["+","-","0"].indexOf(f))){i=F,m--;continue}n+=f}else if("+"===y||"-"===y){if("0"!==f){i=F,m--;continue}n+=f}else if("0"===y){if("0"!==f){i=F,a||(a=$,r.fUt=I(n)),m--;continue}n+=f}}else if("*"!==y&&"_"!==y&&"\\"!==y||""===n)if("*"===f||"_"===f||"\\"===f)s=F,""!==n&&(c.push(n),n=""),n+=f;else if("'"===f)s=F,""!==n&&(c.push(n),n=""),c.push(f);else if('"'===f)s=F,e=$,""!==n&&(c.push(n),n=""),n+=f;else if(0<=D.indexOf(f))s=$,D.indexOf(y)<0&&""!==n&&(c.push(n),n=""),n+=f;else if("."!==f||o)if("%"===f)s=F,r.d0++,""!==n&&(c.push(n),n=""),c.push(f);else if("\u2030"===f)s=F,r.cUt++,""!==n&&(c.push(n),n=""),c.push(f);else if(","===f)if(s){for(M=void 0,""!==n&&(c.push(n),n=""),h=$,d="",l=m+1;l<t.length;l++)if(M=t.charAt(l),'"'===d)'"'===M&&(d="");else if("\\"===d||"_"===d)d="";else{if(0<=D.indexOf(M)){h=F;break}if("."===M||";"===M)break;d=M}h?r.fxt++:o||(M=t.charAt(m+1))&&0<=D.indexOf(M)&&(u=$)}else n+=f;else"E"===f||"e"===f?(s=F,i=$,""!==n&&(c.push(n),n="")):(s=F,0<=D.indexOf(y)&&""!==n&&(c.push(n),n="")),n+=f;else""!==n&&(c.push(n),n=""),r.uUt=c,c=[],o=$,s=F;else n+=f,c.push(n),n="";y=f}return""!==n&&(i&&!a&&(r.fUt=I(n)),c.push(n)),u&&(r.rCt=$),o?r.sUt=c:r.uUt=c,r}function L(t,r,n,e){for(var i,o,u,a,s,f,y,c,m,M,i=r[0],o=1,u=0,a=F,s=t.length,f=0;f<s;f++)if("number"===(y=t[f].type)){for(c="",M=(m=t[f].value).length-1;0<=M;){if(!(1<=i&&i<=9||0===i&&o===r.length))throw new Error(_().Exp_InvalidNumberGroupSize);/\d/gi.test(m[M])?(a&&(c&&t.push({type:"number",value:c}),t.push({type:"groupSeparator",value:n}),c="",a=F),u++):u=0,c=m[M]+c,u===i&&0<i&&(a=$,u=0,o<r.length)&&(i=r[o],o++),M--}c&&t.push({type:y,value:c})}else"fillingChar"===y&&(e.infillIndex=t.length-s),t.push({type:y,value:t[f].value});t.splice(0,s)}function G(t,r,n,e,i,o){var u,u,a,s,a,u=Q(t,-r),u=(a=(u=(t=u=isFinite(u)?u:t).toString()).split(/e/i))[0],s=1<a.length?m(a[1],10):0;return u=(a=u.split("."))[0],a=1<a.length?a[1]:"",0<s?(u+=(a=c(a,s)).slice(0,s),a=S(a,s)):s<0&&(s=-s,a=(u=t<0?o+N(u.replace(o,""),1+s):N(u,1+s)).slice(-s,u.length)+a,u=u.slice(0,-s)),u+(a=0<r?i+(a=a.length>r?a.slice(0,r):c(a,r)):"")}function z(t,r,n,e){var t=t;return 0<r&&(t=O(t*s(100,r),15)),0<n&&(t=O(t*s(1e3,n),15)),t=0<e?O(t/s(1e3,e),15):t}function K(t){var r,n,e,r=v;if(t)for(r="",n=0;n<t.length;n++)e=t[n],/^(0|#|\?)+/g.test(e)&&(r+=e);return r}function J(t,r){var n,e,n=16777216,e;return t===r||p(t-r)<p(t)/(n*n)||(t=O(t,15),r=O(r,15),p(t-r)<p(t)/(n*n))}function W(t,r,n){var e,i,o,u,n,a,t,e={value:t,exponentValue:0},i,o=C(t,".").iUt,u=p(t),n=n?n.length:1;if(1<=u)n<o?(e.value=t/s(10,o-=n),e.exponentValue=o):e.exponentValue=0,-1===r.aUt&&(r.aUt=0);else if(u<1&&0<u){for(r.aUt=-1,a=s(10,n);10*u<a&&!J(10*u,a);)u*=10,e.exponentValue++;t=s(10,e.exponentValue),e.value*=h<t?0:t}return e}function V(t,r,n,e,i,o,u,a){var s,f,y,c,m,M,a,h,d,l,v,F,p,g,b,_,w,D,H,s=a.numberGroupSizes,f=a.numberGroupSeparator,y=a.negativeSign,c=a.percentSymbol,m=a.perMilleSymbol,M=e.fUt,a=S(r,0,1);for(r=0===(h=1===(r=a===y?S(r,1):r).length&&"0"===r?0:r.length)?"":r,d=0,l="",v=t.length-1;0<=v;v--)if(F="",p=t[v],/^(0|#|\?)+/g.test(p)){if(l!==n){for(g=p.length,b=h-d-1;0<=b&&0<g;b--)F=(_=r.charAt(b))+F,g--,d++;for(w=g-1;0<=w;w--)d++,"0"===(D=p[w])?F=D+F:"?"===D&&(""!==F&&(o.push({type:"number",value:F}),F=""),o.push({type:"numberPlaceholder",value:D}));""!==(F=(l=p+l)===n&&d<h?r.substr(0,h-d)+F:F)&&o.push({type:"number",value:F})}}else e.fUt&&!u.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(p)?(u.replaceExponent=$,H="",H=(H=(H+=M.oUt)+x[M.aUt])+N(i.toString(),M.tUt),o.push({type:"exponent",value:H})):"_"===p[0]?o.push({type:"placeholder",value:p[1]}):"*"===p[0]?u.hasInfilling||(o.push({type:"fillingChar",value:p[1]}),u.hasInfilling=!0,u.infillIndex=o.length-1):"\\"===p[0]?2===p.length&&o.push({type:"text",value:p[1]}):'"'===p[0]&&'"'===p[p.length-1]?2<p.length&&o.push({type:"text",value:p.substr(1,p.length-2)}):p===c?o.push({type:"percent",value:p}):p===m?o.push({type:"permille",value:p}):k[p]?o.push({type:"currency",value:p}):o.push({type:"text",value:p});a===y&&n&&o.push({type:"text",value:a}),e.rCt===$&&L(o,s,f,u),o.reverse(),u.infillIndex=o.length-1-u.infillIndex}function U(t,r,n,e,i,o,u,a,s){var f,y,c,s,m,M,h,d,l,v,F,p,g,b,_,w,D,f=s.numberDecimalSeparator,y=s.percentSymbol,c=s.perMilleSymbol,s=r.indexOf(f),m=i.fUt;for((0<s||e!==H||n!==P)&&u.push({type:"decimalSeparator",value:f}),M=-1!==s?r.substring(s+1):"",d="",l=h=0;l<t.length;l++)if(v=t[l],/^(0|#|\?)+/g.test(v)){if(F="",d!==n){for(p=v.length,g=0,b=h;0<p&&0<M.length-h;)F+=M.charAt(b),p--,h++,g++,b++;for(_=g;0<p;)w=v[_],_++,h++,p--,"0"===w?F+=w:"?"===w&&(""!==F&&(u.push({type:"number",value:F}),F=""),u.push({type:"numberPlaceholder",value:w}));""!==F&&u.push({type:"number",value:F}),d+=v}}else m&&!a.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(v)?(a.replaceExponent=$,D="",D=(D=(D+=m.oUt)+x[m.aUt])+N(o.toString(),m.tUt),u.push({type:"exponent",value:D})):"_"===v[0]?u.push({type:"placeholder",value:v[1]}):"*"===v[0]?(u.push({type:"fillingChar",value:v[1]}),a.hasInfilling&&u.splice(a.infillIndex,1),a.hasInfilling=!0,a.infillIndex=u.length-1):"\\"===v[0]?2===v.length&&u.push({type:"text",value:v[1]}):'"'===v[0]&&'"'===v[v.length-1]?2<v.length&&u.push({type:"text",value:v.substr(1,v.length-2)}):v===y?u.push({type:"percent",value:v}):v===c?u.push({type:"permille",value:v}):k[v]?u.push({type:"currency",value:v}):u.push({type:"text",value:v})}function Y(t,r){var n,e,n=t,e;return n=-1!==t.indexOf(r)?t.replace(/0+$/,""):n}function X(t,r,n,e){var i,o,u,a,s,f,f,y,c,m,M,h,d,t,y,c,l,i=[];return t=z(t,r.d0,r.cUt,r.fxt),o=r.uUt,u=r.sUt,(o||u)&&(a=K(o),s=(s=K(u))||"",r.fUt&&(t=(f=W(t,r.fUt,a)).value,f=f.exponentValue),y=C(t,"."),1<p(t)&&15<y.iUt+y.rUt&&(t=O(t,15)),c=n.numberGroupSizes,m=n.numberGroupSeparator,M=n.numberDecimalSeparator,h=n.negativeSign,t=G(t,d=g(y.rUt,s.length),c,m,M,h),""===(t=e?t:Y(t,M))?i.push({type:"text",value:(o?o.join(""):"")+(u?u.join(""):"")}):(y={hasInfilling:F,infillIndex:-1,replaceExponent:F},"10"!==(c=t.split(M)[0])||isNaN(f)||(c="1",f+=(l=r&&r.fUt&&-1===r.fUt.aUt)?-1:1),o&&V(o,c,a,r,f,i,y,n),"0"!==c&&""===a&&u&&i.push({type:"number",value:c}),u&&U(u,t,s,a,r,f,i,y,n))),i}function q(t,r){var r,n,e,i,o,t,u,n,a,o,e,n,u,s,e,i,n;return(t=y(t)?"":f.zf.s6t(t,"")).match(/^[+-]?infinity$/i)?M(t):t.match(/^0x[a-f0-9]+$/i)?m(t,10):(i=(e=A(t,r=r.NumberFormat,n=r.numberNegativePattern))[0],o=e[1],""===i&&1!==n&&(i=(e=A(t,r,1))[0],o=e[1]),""===i&&(i="+"),t=(n=(n=(o=o[0]===r.currencySymbol?S(o,1):o).indexOf("e"))<0?o.indexOf("E"):n)<0?(u=o,v):(u=S(o,0,n),S(o,n+1)),o=(e=u.indexOf("."))<0?(a=u,v):(a=S(u,0,e),S(u,e+".".length)),a=a.split(",").join(""),u=i+(a=","!==(n=",".replace(/\u00A0/g," "))?a.split(n).join(""):a),o!==v&&(u+="."+o),(s=u[u.length-1])===r.percentSymbol&&(u=S(u,0,u.length-1),-1===(e=(u=f.zf.s6t(u,"")).indexOf("."))&&(e=u.length),i="",u=i=(i=(i=i+S(u,0,e-2)+".")+S(u,e-2,2))+S(u,e+1)),t!==v&&(""===(n=A(t,r,1))[0]&&(n[0]="+"),u+="e"+n[0]+n[1]),u.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?M(u):NaN)}function A(t,r,n){var e,r,e=r.negativeSign,r=r.positiveSign;if(4!==n&&2!==n||(e=" "+e,r=" "+r),4===n||3===n){if(f.zf.dT(t,e))return["-",S(t,0,t.length-e.length)];if(f.zf.dT(t,r))return["+",S(t,0,t.length-r.length)]}else if(2===n||1===n){if(f.zf.fJ(t,e))return["-",S(t,e.length)];if(f.zf.fJ(t,r))return["+",S(t,r.length)]}else{if(0!==n)throw new Error("");if(f.zf.fJ(t,"(")&&f.zf.dT(t,")"))return["-",S(t,1,t.length-2)]}return["",t]}function Z(t,r,n){if(0!==p(a(t)-t))throw new Error(_().Exp_BadFormatSpecifier);var t=(0<=t?t:w+t+1).toString(16),t=r?t.toLowerCase():t.toUpperCase();return!y(n)&&t.length<n?N(t,n):t}function Q(t,r){var n,e;return t=+t,r=+r,isNaN(t)||r%1!=0?NaN:(t=(n=t<0)?-t:t,typeof r===u||0===r?(t=Math.round(t),n?-t:t):(e=t.toString().split("e"),t=Math.round(+(e[0]+"e"+(e[1]?+e[1]-r:-r))),+((e=(t=n?-t:t).toString().split("e"))[0]+"e"+(e[1]?+e[1]+r:r))))}function T(t){var r=o.CultureManager.Fe().NumberFormat;return r="string"==typeof t?o.CultureManager.Fe(t).NumberFormat:r}function tt(t){var r,n,e,i,r="";if(Array.isArray(t)&&0<t.length)for(n=0;n<t.length;n++)e=t[n].type,i=t[n].value,"placeholder"===e?r+=" ":"fillingChar"!==e&&(r+="numberPlaceholder"===e?" ":i);return r}function O(t,r){return t="number"==typeof t&&t.toString().length>=r?+t.toPrecision(r):t}Object.defineProperty(t,"__esModule",{value:!0}),t.st=void 0,n=r("./src/common/util/common.ts"),e=r("./src/common/util/types.ts"),i=r("./src/common/util/regexhelper.ts"),f=r("./src/common/util/stringhelper.ts"),o=r("./src/common/culture/cultureInfo.ts"),y=e.lt.ht,N=f.zf.B9t,c=f.zf.lUt,v=null,u=void 0,m=parseInt,M=parseFloat,$=!(F=!1),a=Math.floor,p=Math.abs,s=Math.pow,g=Math.min,h=Number.MAX_VALUE,d="#dot#",l="#group#",S=function(t,r,n){return t.substr(r,n)},b=function(t){return i.$T.qT(t)},r=new n.ResourceManager(n.SR),_=r.getResource.bind(r),H="##################0",P="################",x={1:"+",0:"","-1":"-"},w=4294967295,D=["0","#","?"],k={"\xa4":"\xa4",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH\u20b5":"GH\u20b5","\u1265\u122d":"\u1265\u122d","\u0631.\u0633.\u200f":"\u0631.\u0633.\u200f",XDR:"XDR","\u062f.\u0625.\u200f":"\u062f.\u0625.\u200f","\u062f.\u0628.\u200f":"\u062f.\u0628.\u200f","\u062f.\u062c.\u200f":"\u062f.\u062c.\u200f","\u062c.\u0645.\u200f":"\u062c.\u0645.\u200f","\u20aa":"\u20aa","\u062f.\u0639.\u200f":"\u062f.\u0639.\u200f","\u062f.\u0627.\u200f":"\u062f.\u0627.\u200f","\u0641.\u062c.\u0642.\u200f":"\u0641.\u062c.\u0642.\u200f","\u062f.\u0643.\u200f":"\u062f.\u0643.\u200f","\u0644.\u0644.\u200f":"\u0644.\u0644.\u200f","\u062f.\u0644.\u200f":"\u062f.\u0644.\u200f","\u062f.\u0645.\u200f":"\u062f.\u0645.\u200f","\u0623.\u0645.\u200f":"\u0623.\u0645.\u200f","\u0631.\u0639.\u200f":"\u0631.\u0639.\u200f","\u0631.\u0642.\u200f":"\u0631.\u0642.\u200f","\u062c.\u0633.":"\u062c.\u0633.",S:"S","\xa3":"\xa3","\u0644.\u0633.\u200f":"\u0644.\u0633.\u200f","\u062f.\u062a.\u200f":"\u062f.\u062a.\u200f","\u0631.\u064a.\u200f":"\u0631.\u064a.\u200f","\u20b9":"\u20b9",TSh:"TSh","\u20ac":"\u20ac","\u20bc":"\u20bc","\u20bd":"\u20bd",K:"K","\u043b\u0432.":"\u043b\u0432.","\u20a6":"\u20a6",CFA:"CFA","\u09f3":"\u09f3","\xa5":"\xa5",KM:"KM","\u041a\u041c":"\u041a\u041c",USh:"USh","K\u010d":"K\u010d","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","\u0783.":"\u0783.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","\u20b1":"\u20b1",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","\u20a1":"\u20a1",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","\u20b2":"\u20b2","Bs.":"Bs.","\u0631\u064a\u0627\u0644":"\u0631\u064a\u0627\u0644",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","\u058f":"\u058f",ISK:"ISK","\u20be":"\u20be","\u200b":"\u200b","\u20b8":"\u20b8","\u17db":"\u17db","\u20a9":"\u20a9","\u0441\u043e\u043c":"\u0441\u043e\u043c",Kz:"Kz","\u20ad":"\u20ad",MTn:"MTn","\u0434\u0435\u043d":"\u0434\u0435\u043d","\u20ae":"\u20ae","\u0930\u0941":"\u0930\u0941","Afl.":"Afl.","\u07d6\u07d5.":"\u07d6\u07d5.","\u0440\u0443\u0431.":"\u0440\u0443\u0431.","z\u0142":"z\u0142","\u060b":"\u060b",R$:"R$",Db:"Db",RON:"RON","\u20b4":"\u20b4",MAD:"MAD","\u0dbb\u0dd4.":"\u0dbb\u0dd4.","Lek\xeb":"Lek\xeb",den:"den",RSD:"RSD","\u0434\u0438\u043d.":"\u0434\u0438\u043d.","\u0720.\u0723.\u200f":"\u0720.\u0723.\u200f","Rs.":"Rs.","\u0441\u043c\u043d":"\u0441\u043c\u043d","\u0e3f":"\u0e3f","m.":"m.","\u20ba":"\u20ba","\u2d37\u2d54":"\u2d37\u2d54","so\u02bbm":"so\u02bbm","\u0441\u045e\u043c":"\u0441\u045e\u043c","\u20ab":"\u20ab",HK$:"HK$",MOP:"MOP",NT$:"NT$"},t.st={yU:function(t){return q(t,o.CultureManager.Fe())},Z6t:function(t){return q(t,o.CultureManager.Fe("invariant"))},L9t:function(t,r,n,e){return j(t,r,n=n||o.CultureManager.Fe(),e)},Ge:function(t,r){var r,n,r;return t="string"==typeof t&&(n=(r=T(r)).numberDecimalSeparator,r=r.numberGroupSeparator,"."!==n&&(t=t.replace(b("[.]"),d)),","!==r&&(t=t.replace(b("[,]"),l)),"."!==n&&(t=t.replace(b(d),n)),","!==r)?t.replace(b(l),r):t},Jf:function(t,r){var r,n,r;return t="string"==typeof t&&(n=(r=T(r)).numberDecimalSeparator,r=r.numberGroupSeparator,"."!==n&&(t=t.replace(b("["+n+"]"),d)),","!==r&&(t=t.replace(b("["+r+"]"),l)),"."!==n&&(t=t.replace(b(d),".")),","!==r)?t.replace(b(l),","):t},hUt:function(t,r){var r,n,r;return!("string"==typeof t&&(n=(r=T(r)).numberDecimalSeparator,r=r.numberGroupSeparator,"."!==n&&"."!==r&&0<=t.indexOf(".")||","!==n&&","!==r&&0<=t.indexOf(",")))},dUt:function(t,r){return M(this.Jf(t,r))},VGt:Z,v0:B,vUt:X,mUt:tt,gUt:H,pUt:P,E8:O}},"./src/common/util/rbush.ts":function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.rbush=void 0;var o=Math.max,u=Math.min,m=Number.POSITIVE_INFINITY;function n(t,r){this.bUt=o(4,t||9),this.yUt=o(2,Math.ceil(.4*this.bUt)),r&&this.wUt(r),this.clear()}function y(t,r,n){if(!n)return r.indexOf(t);for(var e=0;e<r.length;e++)if(n(t,r[e]))return e;return-1}function a(t,r){c(t,0,t.children.length,r,t)}function c(t,r,n,e,i){(i=i||g(null)).minX=m,i.minY=m,i.maxX=-m,i.maxY=-m;for(var o=r,u=void 0;o<n;o++)u=t.children[o],M(i,t.leaf?e(u):u);return i}function M(t,r){t.minX=u(t.minX,r.minX),t.minY=u(t.minY,r.minY),t.maxX=o(t.maxX,r.maxX),t.maxY=o(t.maxY,r.maxY)}function s(t,r){return t.minX-r.minX}function f(t,r){return t.minY-r.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function l(t,r){return(o(r.maxX,t.maxX)-u(r.minX,t.minX))*(o(r.maxY,t.maxY)-u(r.minY,t.minY))}function v(t,r){var n=o(t.minX,r.minX),e=o(t.minY,r.minY),i=u(t.maxX,r.maxX),t=u(t.maxY,r.maxY);return o(0,i-n)*o(0,t-e)}function F(t,r){return t.minX<=r.minX&&t.minY<=r.minY&&(0<=r.maxX&&r.maxX<=t.maxX||t.maxX<0)&&(0<=r.maxY&&r.maxY<=t.maxY||t.maxY<0)}function p(t,r){return(-1===t.minY||-1===r.minY||t.minY<=r.maxY&&r.minY<=t.maxY)&&(-1===t.minX||-1===r.minX||t.minX<=r.maxX&&r.minX<=t.maxX)}function g(t){return{children:t,height:1,leaf:!0,minX:m,minY:m,maxX:-m,maxY:-m}}(r.rbush=n).prototype={all:function(){return this.QP(this.data,[])},search:function(t){var r,n,e,i,o,u,a,s,r=this.data,n=[],e=this.toBBox;if(p(t,r))for(i=[];r;){for(o=0,u=r.children.length;o<u;o++)a=r.children[o],p(t,s=r.leaf?e(a):a)&&(r.leaf?n.push(a):F(t,s)?this.QP(a,n):i.push(a));r=i.pop()}return n},collides:function(t){var r,n,e,i,o,u,a,r=this.data,n=this.toBBox;if(p(t,r))for(e=[];r;){for(i=0,o=r.children.length;i<o;i++)if(u=r.children[i],p(t,a=r.leaf?n(u):u)){if(r.leaf||F(t,a))return!0;e.push(u)}r=e.pop()}return!1},insert:function(t){return t&&this.Eit(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,r){if(t)for(var n=this.data,e=this.toBBox(t),i=[],o=[],u,a,s,f;n||i.length;){if(n||(n=i.pop(),a=i[i.length-1],u=o.pop(),f=!0),n.leaf&&-1!==(s=y(t,n.children,r)))return n.children.splice(s,1),i.push(n),this.MUt(i),this;f||n.leaf||!F(n,e)?a?(u++,n=a.children[u],f=!1):n=null:(i.push(n),o.push(u),n=(a=n).children[u=0])}return this},toBBox:function(t){return t},compareMinX:s,compareMinY:f,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},QP:function(t,r){for(var n=[];t;)t.leaf?r.push.apply(r,t.children):n.push.apply(n,t.children),t=n.pop();return r},CUt:function(t,r,n,e){for(var i,o,u,a,s,f,y,c;e.push(r),!r.leaf&&e.length-1!==n;){for(y=c=m,i=0,o=r.children.length;i<o;i++)s=h(u=r.children[i]),(f=l(t,u)-s)<c?(c=f,y=s<y?s:y,a=u):f===c&&s<y&&(y=s,a=u);r=a||r.children[0]}return r},Eit:function(t,r,n){var e,n,i,e,e=this.toBBox,n=n?t:e(t),i=[],e=this.CUt(n,this.data,r,i);for(e.children.push(t),M(e,n);0<=r&&i[r].children.length>this.bUt;)this.SUt(i,r),r--;this.TUt(n,i,r)},SUt:function(t,r){var n,e,i,i,e,n=t[r],e=n.children.length,i=this.yUt;this.AUt(n,i,e),i=this.IUt(n,i,e),(e=g(n.children.splice(i,n.children.length-i))).height=n.height,e.leaf=n.leaf,a(n,this.toBBox),a(e,this.toBBox),r?t[r-1].children.push(e):this.xUt(n,e)},xUt:function(t,r){this.data=g([t,r]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},IUt:function(t,r,n){for(var e,i,o,u,i,a,s,f,a=s=m,e=r;e<=n-r;e++)u=v(i=c(t,0,e,this.toBBox),o=c(t,e,n,this.toBBox)),i=h(i)+h(o),u<a?(a=u,f=e,s=i<s?i:s):u===a&&i<s&&(s=i,f=e);return f},AUt:function(t,r,n){var e=t.leaf?this.compareMinX:s,i=t.leaf?this.compareMinY:f,o,u;this.NUt(t,r,n,e)<this.NUt(t,r,n,i)&&t.children.sort(e)},NUt:function(t,r,n,e){t.children.sort(e);for(var i=this.toBBox,o=c(t,0,r,i),u=c(t,n-r,n,i),a=d(o)+d(u),s,f,s=r;s<n-r;s++)f=t.children[s],M(o,t.leaf?i(f):f),a+=d(o);for(s=n-r-1;r<=s;s--)f=t.children[s],M(u,t.leaf?i(f):f),a+=d(u);return a},TUt:function(t,r,n){for(var e=n;0<=e;e--)M(r[e],t)},MUt:function(t){for(var r=t.length-1,n=void 0;0<=r;r--)0===t[r].children.length?0<r?(n=t[r-1].children).splice(n.indexOf(t[r]),1):this.clear():a(t[r],this.toBBox)},wUt:function(t){var r=["return a"," - b",";"];this.compareMinX=new Function("a","b",r.join(t[0])),this.compareMinY=new Function("a","b",r.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},"./src/common/util/regexhelper.ts":function(t,r,n){var i,e,o,u;function f(){}Object.defineProperty(r,"__esModule",{value:!0}),r.$T=void 0,i=n("./src/common/util/stringhelper.ts"),e=!0,o="empty",f.bue=function(t,r){var n;if(r&&f.yue[r]&&f.yue[r][t])n=f.yue[r][t];else try{null==r?(n=new RegExp(t),r=o):n=new RegExp(t,r),f.yue[r]||(f.yue[r]={}),f.yue[r][t]=n}catch(t){return null}return n.lastIndex=0,n},f.qT=function(t){var r=f.kUt[t],r;return(r=r||(f.kUt[t]=new RegExp(t,"g"))).lastIndex=0,r},f.OJ=function(t){var r=f.DUt[t],r;return(r=r||(f.DUt[t]=new RegExp(t,"gi"))).lastIndex=0,r},f.jJ=function(t,r,n){var e,i,o,u,a,s;if(f._Ut[t])return f.EUt[t];if(f.qT(e="[~?*]+").test(t)){for(i=[],o=t.split(""),a={".":!(u=void 0),"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0,"\\":!0},s=0;s<o.length;s++)"~"===(u=o[s])&&s<o.length-1?("*"===(u=o[++s])||"?"===u?i.push("\\"):r&&i.push("~"),i.push(u)):"?"===u?i.push("."):"*"===u?(i.push("[\\s\\S]"),i.push(n?"+":"*")):(a[u]&&i.push("\\"),i.push(u));return i.join("")}return null},f.tbt=function(t,r,n){var t=f.jJ(t,r,n),t;return t=t&&"^"+t+"$"},f.jUt=function(t,r){for(var n,e,n="#"+t+"0#",e=1;0<r.indexOf(n);)n=i.zf.qS(n,"#"+t+(e-1)+"#","#"+t+e+"#"),e++;return n},f.D9t=function(t){return t.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},f.kUt={},f.DUt={},f.yue={},f._Ut={},f.EUt={},r.$T=f},"./src/common/util/stringhelper.ts":function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.zf=void 0;var o=r("./src/common/util/regexhelper.ts");function u(t,r,n){return t.substr(r,n)}function a(t){return null==t}function e(t,r,n,e){var i,r;if(a(r))throw new Error;return""===r||!(r.length>t.length)&&(i=t,r=r,n&&(i=t.toLowerCase(),r=r.toLowerCase()),e(i,r))}i.zf={OS:function(t,r,n){return n&&(t=t.toLowerCase(),r=r.toLowerCase()),""===r||0<=t.indexOf(r)},hD:function(t,r,n){var n,e;return n?(n=t.toLowerCase(),e=r.toLowerCase(),n.indexOf(e)):t.indexOf(r)},cJ:function(t,r){if(!r)return t;for(var n=t;u(n,0,r.length)===r;)n=u(n,r.length);return n},s6t:function(t,r){if(!r)return t;for(var n=t;u(n,n.length-r.length,r.length)===r;)n=u(n,0,n.length-r.length);return n},Eit:function(t,r,n){var e,i;if(r<0||r>t.length||a(n))throw new Error;return(e=u(t,0,r))+n+(i=u(t,r,t.length-r))},VP:function(t,r,n){var e,i;if(a(n)&&(n=t.length-r),r<0||n<0||r+n>t.length)throw new Error;return(e=u(t,0,r))+(i=u(t,r+n,t.length-r-n))},fJ:function(t,r,n){return e(t,r,n=void 0===n?!1:n,function(t,r){return t.slice(0,r.length)===r})},dT:function(t,r,n){return e(t,r,n=void 0===n?!1:n,function(t,r){return t.slice(-r.length)===r})},Vi:function(t,r,n,e){if(r)return n=(""+n).replace(/\$/g,"$$$$"),t.replace(new RegExp(r,"g"+(e?"i":"")),n);throw new Error},OUt:function(t,r,n,e){return r=o.$T.D9t(r),i.zf.Vi(t,r,n,e)},gmt:function(t,r){var r=t.indexOf(r);return r<0||r>=t.length?t:u(t,0,r)},DU:function(t,r){for(var n=0,e=t.indexOf(r);0<=e;)n+=1,e=t.indexOf(r,e+1);return n},qS:function(t,r,n){return t.split(r).join(n)},I5:function(t,r){for(var n,e,i,n=t,e=0;e<r.length;e++)i=new RegExp("\\{"+e+"\\}","g"),n=n.replace(i,r[e]);return n},RUt:function(t,r,n){for(var e,i,e=t.toString(),i=e.length;i<r;i++)e=n?"0"+e:e+"0";return e},B9t:function(t,r){return i.zf.RUt(t,r,!0)},lUt:function(t,r){return i.zf.RUt(t,r,!1)},Dbt:function(t,r){return t===r||!t&&!r||t&&r&&t.toLowerCase()===r.toLowerCase()},Gmt:function(t){return t.toUpperCase()},j0:function(t){var r,n,r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=o.$T.qT("(?:&|<|>|\"|'|`)");return n.test(t)?t.replace(n,function(t){return r[t]}):t},dI:function(t){var r,n,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},n=o.$T.qT("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return n.test(t)?t.replace(n,function(t){return r[t]}):t},TY:function(t){var r;return t.replace(/javascript:/gi,"")}}},"./src/common/util/types.ts":function(t,c){Object.defineProperty(c,"__esModule",{value:!0}),c.lt=void 0,c.lt={BUt:null,y0:function(t,r){var n,e,i,o;if(c.lt.Gh(t))for(e=0,i=t.length;e<i&&!1!==(n=r.call(t[e],e,t[e]));e++);else for(o in t)if(t.hasOwnProperty(o)&&!1===(n=r.call(t[o],o,t[o])))break;return t},_h:function(t){return!t||"object"==typeof t&&0===Object.keys(t).length},Eh:function(t){return"function"===c.lt.Oh(t)},Nh:function(t){return Array.isArray?Array.isArray(t):"array"===c.lt.Oh(t)},jh:function(t){return c.lt.OMt(t)&&(t=parseFloat(t)),!isNaN(t)&&isFinite(t)},OMt:function(t){return"string"==typeof t},Oh:function(t){var r,n,e,i,o,u;if(null===t)return"null";if(!(r=c.lt.BUt))for(r=c.lt.BUt={},e=0,i=(n=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"]).length;e<i;e++)r["[object "+n[e]+"]"]=n[e].toLowerCase();return o=r.toString,"object"==(u=typeof t)||"function"==u?r[o.call(t)]||"object":u},Rh:function(t,r,n){var e,i;if(r){if(i=[].indexOf)return i.call(r,t,n);for(e=r.length,n=(n=c.lt.ht(n)?0:n)<0?Math.max(0,e+n):n;n<e;n++)if(n in r&&r[n]===t)return n}return-1},Bh:function(t,r){var n=r.length,e=t.length,i=0;if("number"==typeof n)for(;i<n;i++)t[e]=r[i],e++;else for(;void 0!==r[i];)t[e]=r[i],e++,i++;return t.length=e,t},Lh:function(t,r,n){var e,i,o,u,a,i=[];if(c.lt.Gh(t))for(o=0,u=t.length;o<u;o++)null!==(e=r(t[o],o,n))&&(i[i.length]=e);else for(a in a=void 0,t)t.hasOwnProperty(a)&&null!==(e=r(t[a],a,n))&&(i[i.length]=e);return i.concat([])},Dh:function(){for(var t,r,n,e,i,o,u,e,a,s,f,y,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(f=t.length,y=!(s=1),"boolean"==typeof(a=t[0]||{})&&(y=a,a=t[1]||{},s=2),"object"==typeof a||c.lt.Eh(a)||(a={}),f===s&&(a=this,--s);s<f;s++)if(!c.lt.ht(u=t[s]))for(o in u)n=a[o],a!==(i=u[o])&&(e=c.lt.Nh(i),y&&i&&(c.lt.Ph(i)||e)?(e=e?n&&c.lt.Nh(n)?n:[]:n&&c.lt.Ph(n)?n:{},a[o]=c.lt.Dh(y,e,i)):void 0!==i&&(a[o]=i));return a},Fh:function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n]);function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e},Uh:function(t){return null!==t&&t===t.window},Ph:function(t){var r,n;if(!t||"object"!==c.lt.Oh(t)||t.nodeType||c.lt.Uh(t))return!1;r={}.hasOwnProperty;try{if(t.constructor&&!r.call(t,"constructor")&&!r.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(n in t);return void 0===n||r.call(t,n)},Gh:function(t){var r,n;return!c.lt.ht(t)&&(r=t.length,n=c.lt.Oh(t),!c.lt.Uh(t))&&(!(1!==t.nodeType||!r)||"array"===n||"function"!==n&&(0===r||"number"==typeof r&&0<r&&r-1 in t))},Hh:function(t,r){var r=r||[];return null!==t&&(c.lt.Gh(Object(t))?c.lt.Bh(r,"string"==typeof t?[t]:t):[].push.call(r,t)),r},dt:null,ht:function(t){return null==t},q8:null,uJ:null,tv:function(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||c.lt.ht(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var r,n,e,r=t instanceof Object?new t.constructor:new t.constructor(t.valueOf());for(n in t)t.hasOwnProperty(n)&&(e=t[n],t.hasOwnProperty(n))&&r[n]!==e&&(r[n]="object"==typeof e?c.lt.tv(e):e);return r.toString=t.toString,r.valueOf=t.valueOf,r}}},"./src/common/util/util.res.en.ts":function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Exp_Separator=r.Exp_InvalidCast=r.Exp_InvalidNumberFormat=r.Exp_BadFormatSpecifier=r.Exp_InvalidNumberGroupSize=r.Exp_InvalidSemicolons=r.Exp_InvalidExponentFormat=r.Exp_InvalidDateFormat=void 0,r.Exp_InvalidDateFormat="Invalid date format pattern",r.Exp_InvalidExponentFormat="invalid exponent format",r.Exp_InvalidSemicolons="invalid format : too many semicolons",r.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",r.Exp_BadFormatSpecifier="Bad Format Specifier",r.Exp_InvalidNumberFormat="Invalid number format pattern",r.Exp_InvalidCast="InvalidCastException",r.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in culture info."},"./src/plugins/commands/commands.entry.ts":function(t,r,n){var e,i;Object.defineProperty(r,"__esModule",{value:!0}),r.UndoManager=r.CommandManager=r.Key=void 0,e=n("./src/plugins/commands/commands.ts"),Object.defineProperty(r,"Key",{enumerable:!0,get:function(){return e.Key}}),Object.defineProperty(r,"CommandManager",{enumerable:!0,get:function(){return e.CommandManager}}),i=n("./src/plugins/commands/undomanager.ts"),Object.defineProperty(r,"UndoManager",{enumerable:!0,get:function(){return i.UndoManager}})},"./src/plugins/commands/commands.ts":function(t,r){var u,s,n,e;function i(t,r,n){var e,i;this.jS=t,this.LUt=r,this.Zc=n,e=this,Object.defineProperty(e,"shortcutKey",{get:function(){return e.FUt},set:function(t){var r,r,n,r=e.FUt;r!==t&&((r=(i=e.jS.PUt)[r])&&0<=(n=r.indexOf(e))&&r.splice(n,1),e.FUt=t)&&((r=i[t])||(i[t]=r=[]),r.splice(0,0,e))}})}function o(t){this.DJ=t,this.aT={},this.GUt={},this.PUt={}}Object.defineProperty(r,"__esModule",{value:!0}),r.CommandManager=r.Key=void 0,(e=u=r.Key||(r.Key={}))[e.left=37]="left",e[e.right=39]="right",e[e.up=38]="up",e[e.down=40]="down",e[e.tab=9]="tab",e[e.enter=13]="enter",e[e.shift=16]="shift",e[e.ctrl=17]="ctrl",e[e.space=32]="space",e[e.altkey=18]="altkey",e[e.home=36]="home",e[e.end=35]="end",e[e.pup=33]="pup",e[e.pdn=34]="pdn",e[e.backspace=8]="backspace",e[e.del=46]="del",e[e.esc=27]="esc",e[e.a=65]="a",e[e.c=67]="c",e[e.v=86]="v",e[e.x=88]="x",e[e.z=90]="z",e[e.y=89]="y",i.prototype.canUndo=function(){var t;return this.LUt.canUndo},i.prototype.execute=function(t,r,n){var e,i,o,u,e=this,o=!0;e.LUt&&r&&e.LUt.canUndo&&e.jS.UUt({command:r,result:i,vM:n,actionType:n});try{o=!1!==(i=(u=e.LUt.execute||e.LUt)(t,r,1===n))}catch(t){o=!1}return r&&o&&e.jS.HUt({command:r,result:i,vM:n,actionType:n}),i},s=i,o.prototype.register=function(t,r,n,e,i,o,u){var a,r,a=this,r=new s(a,r,t);a[t]=r,n&&(r.shortcutKey=a.getShortcutKey(n,e,i,o,u))},o.prototype.getCommand=function(t){return this[t]},o.prototype.execute=function(t){var r=this[t.cmd];if(r)return r.execute(this.DJ,t,0)},o.prototype.setShortcutKey=function(t,r,n,e,i,o){var u,t,t,a,s,u=this;if(t)(t=u[t])&&(t.shortcutKey=u.getShortcutKey(r,n,e,i,o));else if(t=u.getShortcutKey(r,n,e,i,o),a=u.getCommands(t))for(s=a.length-1;0<=s;s--)a[s].shortcutKey=void 0},o.prototype.getShortcutKey=function(t,r,n,e,i){var o,o;if(t)return(o=(o="A".charCodeAt(0)<=t&&t<="Z".charCodeAt(0)?String.fromCharCode(t):u[t])||t)+(r?"+ctrl":"")+(n?"+shift":"")+(e?"+alt":"")+(i?"+window":"")},o.prototype.getCommands=function(t){return this.PUt[t]},o.prototype.addListener=function(t,r){this.aT[t]=r},o.prototype.removeListener=function(t){delete this.aT[t]},o.prototype.HUt=function(t){var r,n,r=this.aT;for(n in r)r.hasOwnProperty(n)&&r[n](t)},o.prototype.cM=function(t,r){this.GUt[t]=r},o.prototype.zUt=function(t){delete this.GUt[t]},o.prototype.UUt=function(t){var r,n,r=this.GUt;for(n in r)r.hasOwnProperty(n)&&r[n](t)},o.prototype.L0=function(){this.DJ=null},r.CommandManager=o},"./src/plugins/commands/undomanager.ts":function(t,r){var n;function e(t,r,n){var e=this;e.DJ=t,e.VUt=r=r<0?2147483647:r,e.Hw=n,e.Nmt=[],e.kmt=[],e.YUt=!1}Object.defineProperty(r,"__esModule",{value:!0}),r.UndoManager=void 0,e.prototype.dM=function(t,r){var n,e,i,o,n=this;if(t){if(1===r)n.kmt.push(t);else{if(e=n.VUt,i=n.Nmt.length,0<e&&e<=i)for(o=0;o<i-e+1;o++)n.Nmt.shift();n.Nmt.push(t),0===r&&(n.kmt=[])}n.YUt=!0}},e.prototype.canUndo=function(){return 0<this.Nmt.length},e.prototype.undo=function(){var t,r,n,e,i,t=this,r=t.Nmt,n=!0;if(t.Hw&&t.canUndo()){e=r[r.length-1];try{(i=t.DJ.commandManager()[e.cmd])&&(e.hM=!0,n=i.execute(t.DJ,e,1))}catch(t){n=!1}delete e.hM,!1!==n&&(r.pop(),t.YUt=!0,t.kmt.push(e))}return n},e.prototype.canRedo=function(){return 0<this.kmt.length},e.prototype.redo=function(){var t,r,n,e,i,t=this,r=t.kmt,n=!0;if(t.Hw&&t.canRedo()){e=r[r.length-1];try{(i=t.DJ.commandManager()[e.cmd])&&(e.hM=!0,n=i.execute(t.DJ,e,2))}catch(t){n=!1}delete e.hM,!1!==n&&(r.pop(),t.YUt=!0,t.Nmt.push(e))}return n},e.prototype.getRedoStack=function(){return this.kmt.slice()},e.prototype.getUndoStack=function(){return this.Nmt.slice()},e.prototype.maxSize=function(t){var r=this;return arguments.length<1?r.VUt:(0<=t&&(r.VUt=t),r)},e.prototype.clear=function(){this.Nmt=[],this.kmt=[]},e.prototype.aL=function(t){this.Nmt=this.Nmt.filter(t),this.kmt=this.kmt.filter(t)},e.prototype.L0=function(){this.DJ=null},e.prototype.setNewChangeStatus=function(t){this.YUt=t},e.prototype.getNewChangeStatus=function(){return this.YUt},r.UndoManager=e},"./src/plugins/formatter/formatter.entry.ts":function(t,r,n){var e,i,e=this&&this.__createBinding||(Object.create?function(t,r,n,e){void 0===e&&(e=n);var i=Object.getOwnPropertyDescriptor(r,n);i&&("get"in i?r.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return r[n]}}),Object.defineProperty(t,e,i)}:function(t,r,n,e){t[e=void 0===e?n:e]=r[n]}),i=this&&this.__exportStar||function(t,r){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||e(r,t,n)};Object.defineProperty(r,"__esModule",{value:!0}),i(n("./src/plugins/formatter/formatter.ts"),r)},"./src/plugins/formatter/formatter.res.en.ts":function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Exp_InvalidCast=r.Exp_ValueIllegal=r.Exp_TokenIllegal=r.Exp_DuplicatedDescriptor=r.Exp_ValueIsNull=r.Exp_FormatIllegal=r.Exp_InvalidBackslash=r.Exp_TokenIsNull=void 0,r.Exp_TokenIsNull="token is null",r.Exp_InvalidBackslash="the '\\' cannot be evaluated",r.Exp_FormatIllegal="format is illegal.",r.Exp_ValueIsNull="value is null",r.Exp_DuplicatedDescriptor="The type of descriptor was added.",r.Exp_TokenIllegal="token is illegal.",r.Exp_ValueIllegal="value is illegal.",r.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(d,t,r){var l,F,v,p,n,g,e,r,r,f,b,_,w,y,R,I,B,c,L,G,z,K,J,D,W,s,V,U,Y,X,q,H,N,a,$,m,Z,S,M,P,Q,tt,rt,nt,e,et,it,ot,ut,at,st,ft,yt,ct,mt,Mt,ht,dt;function i(t,r){var r,t,n,e;if(Pt.call(this,r),(r=this).Jq=t,n=O((t=r.Jq)[0],"$",!1),e=t.indexOf("-"),!(n&&-1<e))throw new Error(f().Exp_TokenIllegal);r.ZUt=A(t,1,e-1),0<(t=F.zf.VP(t,0,e+1)).length&&(r.Iat=parseInt(t,16))}function o(t,r){this.formatCached=t,this.cultureName=r,this.typeName=""}function lt(t,r){var e,n,i,o,u,a,s,i;for(Pt.call(this,r),e=this,a=0,s=(u=["<=","<>",">=",">","<","="]).length;a<s;a++)if(F.zf.fJ(t,n=u[a],!0)){i=F.zf.VP(t,0,n.length),i=parseFloat(i),H(i)||(o=i);break}if(o===b&&o===_)throw new Error(f().Exp_TokenIllegal);e.value=o,e.WUt=n,e.isMeetCondition=function(t){var r=e.WUt,n=e.value;switch(r){case"<=":return t<=n;case"<>":return t!==n;case">=":return n<=t;case">":return n<t;case"<":return t<n;case"=":return t===n}}}function x(t,r){Pt.call(this,r);var r=this;if(r.token=t,r.type=parseInt(F.zf.VP(t,0,"dbnum".length),10),r.type<0||4<r.type)throw new Error(f().Exp_TokenIllegal)}function k(t,r,n,e,i,o){St.call(this,r,n,e,o);var r=this;r.pU=r.QUt(Ht(t)),r.KUt=i,r.JUt=2,r.Hc()}function vt(t,r){var r,t,n;if(Pt.call(this,r),r=this,"h"===(t=m(t)[0]))n=3600;else if("m"===t)n=60;else{if("s"!==t)throw new Error(f().Exp_TokenIllegal);n=1}r.XUt=function(t){var t=t/1e3/n;return Math.abs(t-Math.round(t))<1e-6?Math.round(t):Math.floor(t)}}function Ft(t,r){var r,r;Pt.call(this,r),null!==(r=J.exec(t))&&(r=Number(r[1]),0<=--r)&&r<K.length&&(t=K[r]),this.foreColor=t}function C(t,r,n,e){var n,e,i,t,r,t;function o(t,r){var n,e,i,o,u,a,s,n=[],e='"';if(t!==b&&""!==t){for(i=!1,u=!(o=[]),a=0;a<t.length;a++)(s=t[a])!==e||i||(u=!u),i||u||s!==r?o.push(s):(n.push(o.join("")),o=[]),i="\\"===s&&!i;n.push(o.join(""))}return n}St.call(this,r,n,e),(n=this).qUt=!1,n.JUt=1,n.$Ut=_t(t),e=Ht(t),-1<(i=(e=_t(e=r?T(e,n.j9t.Nat,n.j9t.currencySymbol()):e)).indexOf("/"))&&(t=o(e,"/"))&&2===t.length&&(n.tHt=t[1],r=t[0])&&(-1<(t=r.lastIndexOf(" "))?(n.nHt=A(r,0,t),n.eHt=A(r,t+1,r.length-t-1)):n.eHt=r),n.iHt=e}function u(t,r,n,e){St.call(this,r,n,e),0<arguments.length?(u.rHt(t)||S(),this.$Ut=t):this.$Ut="General",this.JUt=0}function h(t,r,n,e){var i,n,i=this;St.call(i,r,n,e),n=Ht(t,!1),n=Dt(n=_t(n=r?T(n,i.j9t.Nat,i.j9t.currencySymbol()):n)),i.pU=n,i.JUt=3}function A(t,r,n){return t.substr(r,n)}function pt(t){return p.lt.ht(t)?"":"boolean"==typeof t?t?"TRUE":"FALSE":"string"==typeof t?t:t.toString()}function gt(t,r){if("\\"===t[r])throw new Error(f().Exp_InvalidBackslash);if(0<r-1&&r-1<t.length&&"\\"===t[r-1]){if(r-2<0)return 1;if(0<r-2&&r-2<t.length)return"\\"!==t[r-2]}}function bt(t){if(t)return"["+t+"]";throw new Error(f().Exp_TokenIsNull)}function _t(t){var r,n,e,i,o;if(t===_||t===b||""===t)return t;for(r="",e=!1,i=n=0;i<t.length;i++)'"'===(o=t[i])?(e=!e,r+=o):e?r+=o:"["===o?n++:"]"===o?--n<0&&(n=0):0===n&&(r+=o);return r.toString()}function wt(t){return t=T(t,"[",""),T(t,"]","")}function T(t,r,n){return!t||t===P.oHt||O(r,n,!0)?t:(r=r.replace(G,"\\$1"),t.replace(new RegExp(r,"g"),n))}function Dt(t){for(var r,n,e,i,o,r=t.length,n=!1,e="",i=0;i<r;i++)"\\"===(o=t.charAt(i))?(n=!n)&&"@"!==t.charAt(i+1)||(e+=o):(n=!1,e+=o);return e}function O(t,r,n){return n?m(t)===m(r):t===r}function Ht(t,r){var n,e,i,o;for(1===arguments.length&&(r=!0),n=!1,e="",i=0;i<t.length;i++){if('"'===(o=t[i]))n=!n;else if(!n&&!r&&"/"===o&&!gt(t,i))continue;e+=o}return e}function Nt(t){for(var r,n,e,i,o,r="",n=!1,e=0,i=t.length;e<i;e++)'"'===(o=t[e])&&(n=!n),"E"===o||n||(r+=m(o));return r}function $t(t,r){var n,e,i,o;if(t&&t!==P.oHt)for(e=Nt(n=Ht(t)),i=0;i<r.length;i++)if(0===(o=e.indexOf(r[i]))||0<o&&"_"!==e[o-1]&&"*"!==e[o-1])return!0;return!1}function St(t,r,n,e){this.j9t=t,this.aHt=r,this.cultureName=n,this.O9t=e}function Pt(t){this.Nat=t}function xt(t){var r,t,n,t=wt(t);return t&&t!==P.oHt&&(n=t[0],-1<["<",">","="].indexOf(n)?(r=et).Name="ConditionalFormatPart":F.zf.fJ(t,"DBNum",!0)?(r=it).Name="DBNumberFormatPart":O(t[0],"$",!1)&&-1<t.indexOf("-")?(r=nt).Name="LocaleIDFormatPart":Ct(t)?(r=ut).Name="ABSTimeFormatPart":t.indexOf("$")<0&&3<=t.length&&((r=at).Name="ColorFormatPart")),r}function kt(t,r){var n,t,n=!1,t=$t(t=t?t.toString():P.oHt,["general"])?ft:ot.a0(t)?ot:$t(t,["E+","E-","#",".",",","%","0","/","?"])||r?(n=!0,st):(n=!0,yt);return{uHt:n,uit:t}}function Ct(t){var r,n,e,r=m(t),n=r[0];if("h"===n||"m"===n||"s"===n){for(e=1;e<r.length;e++)if(n!==r[e])return;return 1}}function At(t,r,n){var t,n,t=t?t.cultureInfo():N(n);return(r<4||4===r&&("ko-kr"===n||"ko-kr"===t.name()))&&(n=t.NumberFormat.dbNumber)?n[r]:b}function Tt(t,r,n,e,i){var o,n,o=t;if(!q(e)&&r instanceof Date){if(!(n=At(n,e.type,i)))return t;o=e.sHt(o,n,!0),o=(o=(o=1===e.type?o.replace(new RegExp(I,"g"),B):o).replace("@"+y.cHt,v.ct.Pe(r,y.cHt))).replace("@"+y.fHt,v.ct.Pe(r,y.fHt)),o=e.sHt(o,n,!1)}return o}function Ot(t,r,n,e,i){var o,u,a,s,f,y,c;if(!q(e)&&(o=At(n,e.type,i),!q(o)))for(u=!1,a=void 0,s=N(i),f=void 0,y=0,c=t.length;y<c;y++)"decimalSeparator"===t[y].type&&(u=!0,t[y].value=e.sHt(t[y].value,o,r),a=t[y].value),"number"===t[y].type&&(t[y].value=u?e.sHt(a+t[y].value,o,r).slice(1):e.sHt(t[y].value,o,r),"ja-JP"===s.name())&&1<t[y].value.length&&("\u4e00\u5343"!==(f=t[y].value.substr(0,2))&&"\u4e00\u767e"!==f&&"\u4e00\u5341"!==f||(t[y].value=t[y].value.substr(1)));return t}function E(t,r){var n=this;0===arguments.length?(n.formatCached="General",n.E9t=new ft):n.Hc(t,r)}function j(t,r){var n,e,n=dt.call(this,t,r)||this,e=n;return e.lHt=!0,e.PropertyChanged=[],P.Ji(t)&&(t="General"),e.formatCached=t,e.cultureName=r,e.init(),n}function Et(t){for(var r,n,e,i,o,r=[],n=0,e=0,i=t.length,o=0;o<i;o++)"_"===t[o]?n++:(";"!==t[o]||0!==n&&n%2!=0||(r.push(t.substring(e,o)),e=o+1),n=0);return e<=i&&r.push(t.substring(e,i)),r}l=this&&this.__extends||(ht=function(t,r){return(ht=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,r){t.__proto__=r}:function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}))(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}ht(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralFormatter=t.Hf=t.FormatterBase=void 0,F=r("./src/common/util/stringhelper.ts"),v=r("./src/common/util/datetimehelper.ts"),p=r("./src/common/util/types.ts"),n=r("./src/common/util/numberhelper.ts"),g=r("./src/common/culture/cultureInfo.ts"),e=r("./src/common/util/common.ts"),r=r("./src/plugins/formatter/formatter.res.en.ts"),p.lt.Dh(e.SR.en,r),r=new e.ResourceManager(e.SR),f=r.getResource.bind(r),p.lt.dt=function(t,r){if(p.lt.ht(t))return"null"===r;if(r){if(r instanceof Function&&t instanceof r)return!0;if(typeof t===r)return!0;if("function"===r&&/^\s*\bfunction\b/.test(""+t))return!0;if(Object.prototype.toString.call(t).slice(8,-1).toLowerCase()===r.toLowerCase())return!0;if("DateTime"===r)return t instanceof Date;var t;if("TimeSpan"===r)return t instanceof Date&&0<=(t=v.ct.o0(t))&&t<1;"string"==typeof r&&"undefined number boolean string".indexOf(r)}return!1},p.lt.q8=function(t,r){return!!n.st.hUt(t,r)&&("string"!=typeof t||-1===t.search(/[\r\n\t]/g))&&(t=n.st.Jf(t,r),p.lt.dt(t,"number")||p.lt.dt(t,"DateTime")||p.lt.dt(t,"TimeSpan")||t&&!p.lt.dt(t,"boolean")&&!isNaN(t)&&!isNaN(parseFloat(t))&&!(2<=t.length&&"0"===t[0]&&"x"===t[1]))},p.lt.uJ=function(t){return p.lt.ht(t)||""===t?0:p.lt.dt(t,"number")?t:p.lt.dt(t,"string")&&!isNaN(t)?n.st.yU(t):p.lt.dt(t,"boolean")?t?1:0:p.lt.dt(t,"DateTime")?v.ct.o0(t):p.lt.dt(t,"TimeSpan")?Math.floor(v.ct.o0(t)):parseFloat(t)},b=null,_=void 0,w=Math.abs,y={fHt:"yy",hHt:"y",cHt:"yyyy",dHt:"m",vHt:"mm",mHt:"mmm",gHt:"mmmm",pHt:"mmmmm",bHt:"d",yHt:"dd",wHt:"aaa",MHt:"aaaa",CHt:"h",SHt:"hh",THt:"m",AHt:"mm",IHt:"s",xHt:"ss",IGt:"e",NHt:"AM/PM",kHt:"A/P",DHt:"@mmmmm",_Ht:new Date(1899,11,30,0,0,0,0)},R=[y.hHt,y.fHt,y.cHt,y.dHt,y.vHt,y.mHt,y.gHt,y.pHt,y.bHt,y.yHt,y.wHt,y.MHt,y.CHt,y.SHt,y.THt,y.AHt,y.IHt,y.xHt,"ggg","gg","g","ee","e"],I="\u4e00\u5341",B="\u5341",c={EHt:0,jHt:1,OHt:2,_text:3},L=[{EHt:0,jHt:0,OHt:0,_text:0},{EHt:0,jHt:1,OHt:0,_text:0},{EHt:0,jHt:1,OHt:2,_text:0},{EHt:0,jHt:1,OHt:2,_text:3}],G=new RegExp("([.+?*$^\\[\\](){}|/])","g"),z=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt","M/d/yyyy H:m:s","M-d-yyyy H:m:s","M/d/yyyy h:m:s tt","M-d-yyyy H:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],K=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#800000","#008000","#000080","#808000","#800080","#008080","#C0C0C0","#808080","#9999FF","#993366","#FFFFCC","#CCFFFF","#660066","#FF8080","#0066CC","#CCCCFF","#000080","#FF00FF","#FFFF00","#00FFFF","#800080","#800000","#008080","#0000FF","#00CCFF","#CCFFFF","#CCFFCC","#FFFF99","#99CCFF","#FF99CC","#CC99FF","#FFCC99","#3366FF","#33CCCC","#99CC00","#FFCC00","#FF9900","#FF6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"],J=new RegExp("color\\s*(\\d+)","i"),D=p.lt.dt,W=p.lt.Nh,s=n.st,V=s.gUt+"."+s.pUt,U=s.mUt,Y=s.L9t,X=s.E8,q=p.lt.ht,H=isNaN,N=function(t){return g.CultureManager.Fe(t)},a=function(t){return N(t).DateTimeFormat},$=function(t){return N(t).NumberFormat},m=function(t){return t&&t.toLowerCase()},Z=function(t){return t&&t.toUpperCase()},S=function(){throw new Error(f().Exp_FormatIllegal)},M=function(){return g.CultureManager.booleanMapping},P={oHt:"",I5:function(){for(var t,r,n,e,i,o,u,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===arguments.length)return b;for(i=n[0],o=1;o<arguments.length;o++)u=new RegExp("\\{"+(o-1)+"\\}","gm"),i=i.replace(u,arguments[o]);return i},Ji:function(t){return!t||t===P.oHt}},tt=function(t){var t=t.charCodeAt(0);return 48<=t&&t<=57},rt=function(t){var t=t.charCodeAt(0);return 9<=t&&t<=13||32===t||133===t||160===t},i.prototype.cultureInfo=function(){var t=this;return t.RHt||(t.RHt=N(t.Iat)),t.RHt},i.prototype.currencySymbol=function(){return this.ZUt?F.zf.Vi(this.ZUt,"\\.",'"."'):P.oHt},i.prototype.allowScience=function(){if(this.RHt)return!this.RHt.isJCKCulture},i.prototype.toString=function(){return this.Jq?bt(this.Jq):P.oHt},i.Name="LocaleIDFormatPart",nt=i,o.prototype.format=function(t){return b},o.prototype.parse=function(t){return b},o.prototype.formatString=function(t){return this.formatCached},o.prototype.toJSON=function(){var t,r,t={};for(r in this)this.hasOwnProperty(r)&&(t[r]=this[r]);return t},o.prototype.fromJSON=function(t){if(t)for(var r in t)t[r]!==_&&(this[r]=t[r])},t.FormatterBase=e=o,lt.prototype.toString=function(){return bt(this.WUt+this.value.toString())},et=lt,x.prototype.sHt=function(t,r,n){var e,i,o,u,a,s,f,y,c,m;if(!t||t===P.oHt)return t;for(a=!(u=o=-1),c=(i=e=t).length-1;0<=c;c--)m=i[c],!H(m)&&!O(m," ",!1)||O(m,".",!1)&&!a?(O(m,".",!1)&&(a=!0),-1===o&&(o=c),u=c):-1<u&&-1<o&&(s=A(i,u,o-u+1),f=parseFloat(s),H(f)||(y=x.numberString(s,r,n),e=F.zf.VP(e,u,o-u+1),e=F.zf.Eit(e,u,y)),a=!(u=o=-1));return-1<u&&-1<o&&(s=A(i,u,o-u+1),f=parseFloat(s),H(f)||(y=x.numberString(s,r,n),e=F.zf.VP(e,u,o-u+1),e=F.zf.Eit(e,u,y))),e},x.prototype.toString=function(){if(-1<this.type)return bt("DBNum"+this.type);throw new Error},x.numberString=function(t,r,n){var e,t,i,o,e=x.formatNumberString,t=t.split(".");if(t){if(1===t.length)return e(t[0],r.numbers,n?r.letters:b);if(2===t.length)return(i=e(t[0],r.numbers,n?r.letters:b))+"."+(o=e(t[1],r.numbers))}throw new Error(f().Exp_ValueIllegal)},x.formatNumberString=function(t,r,n){var e,i,o,u,a,s,f,y,c,m,M,h,d,l,v,F,p,g,e=t,i=0,u=0;if(2===arguments.length){for(a="";i<e.length;i++)o=A(e,i,1),a+=r[u=parseInt(o,10)];return a}if(3===arguments.length){if(!n)return x.formatNumberString(t,r);for(s=0,f="",y=e.length,c=!1,m=[];i<y;i++)-1<(M=n.length-1-i)?m.push(n[M].toString()):m.push(P.oHt);for(h=[],d=m.length-1;0<=d;d--)h[m.length-d-1]=m[d];for(m=h,l=!1,d=0;d<y;d++)o=A(e,d,1),u=parseInt(o,10),v=void 0,F=P.oHt,0<y-d-16?(v=r[u],l=!(F="")):d!==y-1&&d!==y-5&&d!==y-9&&d!==y-13?"0"===o?(F=v="",s+=1):s=(F=(v="0"!==o&&0!==s?r[0]+r[u]:r[u],m[d]),0):"0"!==o&&0!==s?(v=r[0]+r[u],F=m[d],s=0):"0"!==o&&0===s||l?(v=r[u],F=m[d],s=0,l=!1):("0"===o&&3<=s?F=v="":11<=y?v="":(v="",F=m[d]),s+=1),(p=v+F===P.oHt)||(c=!1),d!==y-13||c||(F=m[d],c=!0),d!==y-9||c||(F=m[d],c=!0),d===y-1&&(F=m[d],c=!0),f=f+v+F;return 0===(g=parseInt(t,10))?r[0]:f}},it=x,k.prototype.Hc=function(){var t,r,n,e,i,o,u,t=this,r={y4:t.pU},n;if(k.a0(r.y4)){if(e=t.BHt(r),i=a(this.cultureName).amDesignator&&a(this.cultureName).pmDesignator,t.hasJD=t.Vi(r.y4,y.pHt,'"'+y.DHt+'"',!0,!1,r,!1),t.Vi(r.y4,y.gHt,"MMMM",!0,!1,r,!1),t.Vi(r.y4,y.mHt,"MMM",!0,!1,r,!1),t.LHt(r.y4,r,"mm","MM"),t.LHt(r.y4,r,"m","M"),t.Vi(r.y4,y.wHt,"ddd",!0,!0,r,!0),t.Vi(r.y4,y.MHt,"dddd",!0,!0,r,!0),e&&i||(t.Vi(r.y4,y.CHt,"H",!0,!0,r,!1),t.Vi(r.y4,y.SHt,"HH",!0,!0,r,!1)),t.aHt&&(t.j9t||N(t.cultureName).NumberFormat.dbNumber)&&(t.FHt=t.FHt||t.Vi(r.y4,y.cHt,'"@'+y.cHt+'"',!0,!1,r,!0),t.FHt=t.FHt||t.Vi(r.y4,y.fHt,'"@'+y.fHt+'"',!0,!1,r,!0)),t.KUt)for(o=0;o<t.KUt.length;o++)u=t.KUt[o],t.Vi(r.y4,u.Nat,"@"+u.Nat,!0,!0,r,!0);t.PHt=r.y4}else S()},k.prototype.formatString=function(){return this.pU},k.prototype.format=function(r){var t,n,e,i,o,u,a,s,f,t=this,n=P.oHt,e=b;try{if((e=(e=v.ct.iPt(r))&&H(e.valueOf())?b:e)?r=e:n=r.toString(),e&&(n=v.ct.L9t(e,t.PHt,t.j9t&&t.j9t.cultureInfo()||N(t.cultureName),t.O9t),t.hasJD&&(i=N(t.cultureName).DateTimeFormat.monthNames[e.getMonth()],n=F.zf.Vi(n,y.DHt,A(i,0,1))),t.KUt))for(o=24*(v.ct.o0(e)-v.ct.o0(y._Ht))*60*60*1e3,u=0;u<t.KUt.length;u++)s=(a=t.KUt[u]).XUt(o),q(s)||(f=a.Nat.replace("[","\\[").replace("]","\\]"),n=F.zf.Vi(n,"@"+f,s))}catch(t){n=pt(r)}return Tt(n,r,t.j9t,t.aHt,t.cultureName)},k.prototype.parse=function(r){var t,r,n,n,e;if(!r||r===P.oHt)return b;if(t=this,"true"===(n=m(r=r)))return!0;if("false"===n)return!1;if(t.PHt&&(n=v.ct.nUt(r,t.PHt,N(t.cultureName))))return n;try{return(e=v.ct.iPt(r))&&!H(e)?e:(e=new Date(r),H(e.valueOf())?r:e)}catch(t){return r}},k.prototype.QUt=function(t){for(var r,n,e,i,o,u,r=t,n="",e=!1,i=0;i<r.length;i++)'"'===(o=r[i])?e=!e:e||"Y"!==o&&"D"!==o&&"S"!==o&&"E"!==o&&"G"!==o&&("M"!==o||O("A",u=r[i-1],!0)||O("P",u,!0))||(o=m(o)),n+=o;return n},k.prototype.BHt=function(t){var r,n,e,i,o,u,r=a(this.cultureName).amDesignator,n=a(this.cultureName).pmDesignator,e=[y.NHt];for(e.push(r&&n?r+"/"+n:y.NHt),e.push(y.kHt),i=["tt","tt","t"],o=t.y4,u=0;u<3;u++){if(F.zf.OS(o,i[u]))return!0;if(F.zf.OS(o,e[u],!0))return t.y4=F.zf.Vi(o,e[u],i[u],!0),!0}return!1},k.prototype.LHt=function(t,r,n,e){for(var i,o,u,a,s,f,i="",o=t.length,u=0,a=0;a<o;a++)if('"'===t[a]&&(u=(u+1)%2),"m"!==t[a]||u)i+=t[a];else{for(s="m";a+1<o&&"m"===t[a+1];)a++,s+="m";i+=s===n?e:s}f=new RegExp("".concat(e,"(?=[^yYdDhHmM]*[Ss])|").concat(e,"(?=.0)"),"g"),i=(i=i.replace(f,n)).split("").reverse().join(""),f=new RegExp("".concat(e,"(?=[^mM]*[Hh])"),"g"),i=(i=i.replace(f,n)).split("").reverse().join(""),r.y4=i},k.prototype.Vi=function(t,r,n,e,i,o,u){var a,s,f,y,c,m,M,h,d,l,v;if(e||i){for(a=[],s=!0,!k.hasDate(t)&&k.hasTime(t)&&(s=!1),f=!1,y=0;y<t.length;y++){if(c=t[y],k.hasTime(c)&&!f?s=!1:k.hasDate(c)&&!f&&(s=!0),e&&O(c,r[0],u)&&s||i&&O(c,r[0],u)&&!s){for(m=!0,M=0;M<r.length;M++)if(M+y>=t.length||!O(r[M],t[M+y],u)){m=!1;break}if(h=y+r.length-1,m&&1+h<t.length){for(d=t[h],l=-1,l=1+h;l<t.length&&O(d,t[l],u);l++);1+h<l&&(y=l,m=!1)}m&&!f&&a.splice(0,0,y)}'"'===c&&(f=!f)}if(o.y4=t,0<a.length){for(y=0;y<a.length;y++)o.y4=F.zf.VP(o.y4,v=a[y],r.length),o.y4=F.zf.Eit(o.y4,v,n);return!0}}return!1},k.hasTime=function(t){return-1<F.zf.hD(t,y.CHt[0],!0)||-1<F.zf.hD(t,y.IHt[0],!0)},k.hasDate=function(t){return-1<F.zf.hD(t,y.fHt[0],!0)||-1<F.zf.hD(t,y.bHt[0],!0)},k.a0=function(t,r){return $t(t,r||R)},ot=k,t.Hf=ot,vt.Name="ABSTimeFormatPart",ut=vt,Ft.prototype.toString=function(){return bt(this.foreColor)},Ft.Name="ColorFormatPart",at=Ft,C.prototype.formatString=function(){return this.$Ut},C.prototype.format=function(t){var r,n,t,e,i,o,u,a,s,f,y,c,m,m,m,M,h,h,d,l,l,h;return D(t,"boolean")?t.toString().toUpperCase():(r=this,n=p.lt.uJ(t),H(n)||!isFinite(n)||H(t)?"string"==typeof t?t:b:(t=N(r.cultureName),r.eHt&&r.tHt?(f={value:0},y={value:0},c={value:0},m=r.GHt(),C.getFraction(n,m,f,y,c)?(1<(m=C.getGCD(y.value,c.value))&&(y.value/=m,c.value/=m),r.nHt?(s="",1===c.value&&(f.value+=y.value,y.value=0,c.value=0),(m=U(Y(f.value,r.nHt,t)))&&"0"!==m&&(s=s+m+" "),0===f.value&&n<0&&(s+=t.NumberFormat.negativeSign),0===n&&(s+="0"),i=r.tHt,o=parseFloat(i),!H(o)&&0<o&&(0!==y.value&&0!==c.value&&(y.value*=o/c.value),c.value=o,i=i.replace(/^\d+/,C.toNumberPlaceholder(o)),a=(u=Math.ceil(y.value))-y.value,y.value=a<=.5&&0<=a?parseFloat(u.toString()):parseFloat((u-1).toString())),M=r.eHt,h=parseFloat(M),H(h)||0!==h||(h=M.length,(l=(d=y.value.toString()).length)<h?M=M.substr(0,h-(h-l)):h<l&&(d=d.substr(0,l-(l-h)),y.value=parseInt(d,10))),l=r.UHt(y.value,c.value,M,i,t),0===y.value&&(l=l.replace(/./g," "),""===m)?"0 "+l:""===(s+=l)?"0":s):(s="",h=f.value*c.value+y.value,i=r.tHt,0<(o=parseFloat(i))?(h*=o/c.value,c.value=o,s+=(h=(a=(u=Math.ceil(h))-h)<=.5&&0<=a?parseFloat(u.toString()):parseFloat((u-1).toString()))+"/"+c.value):s+=r.UHt(h,c.value,r.eHt,r.tHt,t),0===h?"0":s)):n.toString()):Ot(e=Y(n,r.iHt,t),r.qUt,r.j9t,r.aHt,r.cultureName)))},C.prototype.parse=function(t){var r,n,n,e,n,e,n,e,n,t,e,r=this;return t&&t!==P.oHt?!!("TRUE"===(n=Z(t))||n===M()&&M().boolean_true)||!("FALSE"===n||n===M()&&M().boolean_false)&&(n=r.eHt&&r.tHt,e=r.zHt(r.iHt).HHt,(n||e)&&0<(n=t.indexOf("/"))&&n<t.length-1&&(e=parseInt(t.substr(0,n),10),n=parseInt(t.substr(n+1),10),!isNaN(e))&&!isNaN(n)&&0!==n?e/n:(t=r.VHt(t),t=r.YHt(t),n=(e=r.zHt(t)).HHt,t=e.$6t,r.ZHt(t)&&(t=F.zf.OUt(t,$(r.cultureName).numberGroupSeparator,"",!1),e=s.dUt(t,r.cultureName),!H(e))&&isFinite(e)?n?X(e/100,15):e:b)):b},C.prototype.GHt=function(){var t,r,n,e,i,t,r=this.tHt,n=0;if(r)for(e=r.length,i=0;i<e&&r[i].match(/[#?\d]/);i++)n++;return n},C.prototype.ZHt=function(t){for(var r,n,e,i,o,u,a,r="",n=0,e=0,i=0,o=b,u=$(this.cultureName),a=t.length-1;-1<a;a--){if(t[a]===u.numberDecimalSeparator)n++,0<i&&(o=!1),r="";else if("e"===m(t[a])){if(e++,r="",a===t.length-1)return!1}else if(t[a]===u.numberGroupSeparator)o=3===r.length,i++,r="";else if("-"===t[a]||"+"===t[a]){if(0<a&&"e"!==m(t[a-1]))return!1}else{if(!tt(t[a]))return!1;if(r+=t[a],0===a&&0===parseInt(r,10)&&o)return!1}if(1<n||1<e||!1===o)return!1}return!0},C.prototype.VHt=function(t){for(var r,n,e,t,i,o,u,u,a,r=t,n=[],e=0;e<r.length;e++)tt(r[e])&&n.push(e);for(i=[(t=$(this.cultureName)).currencyDecimalSeparator,t.currencyGroupSeparator,t.currencySymbol,t.nanSymbol,t.negativeInfinitySymbol,t.negativeSign,t.numberDecimalSeparator,t.numberGroupSeparator,t.percentDecimalSeparator,t.percentGroupSeparator,t.percentSymbol,t.perMilleSymbol,t.positiveInfinitySymbol,t.positiveSign],o=r.length-1;-1<o;o--)if(u=r[o],rt(u)&&i.indexOf(u.toString())<=-1)(o<n[0]||n[n.length-1]<o)&&(r=F.zf.VP(r,o,1));else if(("-"===u||"+"===u)&&(u=0<o?r[o-1].toString():b,(a=["e","E","(",$(this.cultureName).currencySymbol]).indexOf(u)<0))break;return r},C.prototype.YHt=function(t){var r,n,r=$(this.cultureName).currencySymbol,n=F.zf.fJ(t,r)?F.zf.VP(t,0,r.length):t;return n.indexOf(r)<0?n:t},C.prototype.zHt=function(t){var r,n,e,r=$(this.cultureName).percentSymbol,n=!0,e=t;return F.zf.fJ(t,r)?e=F.zf.VP(t,0,r.length):F.zf.dT(t,r)?e=F.zf.VP(t,t.length-r.length,r.length):n=!1,{$6t:e,HHt:n=F.zf.OS(e,r)?!1:n}},C.prototype.UHt=function(t,r,n,e,i){var o,u,a,s,i,o,o=U(Y(t,n,i)),u,a,s=U(Y("0."+r,"#."+e,i,!0)),i=i&&i.NumberFormat&&i.NumberFormat.numberDecimalSeparator||".",o=o+"/"+s.substr(s.indexOf(i)+1);return""===n&&(o=t+o),""===e&&(o+=r),o},C.getGCD=function(t,r){var n,e,i;if(0===t)return w(r);if(0===r)return w(t);for(i=(n=Math.max(t,r))%(e=Math.min(t,r));0!==i;)i=(n=e)%(e=i);return w(e)},C.getFraction=function(t,r,n,e,i){var o,u,a,s,f,f,y,c,m,M,h,d,l,v,o=0,u=0,a=0,s=0,f=Math.ceil;for(0<t?o=1===(s=t-f(t)+1)?(s=0,t):f(t)-1:t<0&&(o=f(t),s=f(t)-t),f=Math.pow(10,r-1),(y=Math.pow(10,r)-1)<2&&(y=2),c=!1,m=0,M=f=f<2?2:f;M<=y&&(d=Math.round(h=M*s),v=w((l=d/M)-s),!((!c||v<w(m-s))&&(c=!0,m=l,u=d,a=M,v<1e-6)));M++);return n.value=o,e.value=u,i.value=a,c},C.toNumberPlaceholder=function(t){return t.toString().replace(/\d/g,"?")},st=C,u.rHt=function(t){for(var r,n,e,i,o,u,r="",n=!1,e=-1,i=t.length,o=0;o<i;o++)'"'===(u=t[o])?e=(n=!n)?o:-1:n||(r+=u);return 0<e&&(r+=t.substring(e,i)),!(0<=r.indexOf("0")||0<=r.indexOf("#")||0<=r.indexOf(".")||0<=r.indexOf("@"))},u.prototype.WHt=function(){var t,r,t=this;return t.QHt||(r=T(r=t.$Ut,"General",V),t.QHt=new st(r,t.j9t,t.aHt,t.cultureName),t.QHt.qUt=!0),t.QHt},u.prototype.KHt=function(){var t=this;return t.JHt||(t.JHt=new st("0.#####E+00",t.j9t,t.aHt,t.cultureName),t.JHt.qUt=!0),t.JHt},u.prototype.formatString=function(){return F.zf.Vi(this.$Ut,"@NumberFormat","General")},u.prototype.format=function(t){var r,n,e,i,r=this;if(p.lt.q8(t,r.cultureName)){if(n=!r.j9t||r.j9t.allowScience(),(e=p.lt.uJ(t))!==_&&e!==b)return(99999999999<w(e)&&n||w(e)<1e-11&&0!==e?r.KHt():r.WHt()).format(t)}else{if(D(t,"string"))return i=Dt(i=F.zf.Vi(r.formatString(),'"',"")),t;if(D(t,"boolean"))return t.toString().toUpperCase()}return""},u.prototype.parse=function(t){var r,n,e,e,i,o,u,a,i,s,r,a,o,u;return P.Ji(t)?b:"number"==typeof t?t:(r=!1,n=t.trim(),0<(e=F.zf.hD(n,"-",!1))&&!O(n.charAt(e-1),"E",!0)&&(r=!0),o=(i=(e=N(this.cultureName)).DateTimeFormat).dateSeparator,u=i.timeSeparator,a=i.monthNames,i=i.abbreviatedMonthNames,s=function(t,r){var n,e,i;if(!r||0===r.length)return!1;for(n=!1,e=0,i=r.length;e<i;e++)if(F.zf.OS(t,r[e],!0)){n=!0;break}return n},(r||F.zf.OS(n,o,!1)||F.zf.OS(n,u,!1)||F.zf.OS(n,"/",!1)||F.zf.OS(n,":",!1)||F.zf.OS(n,"-",!1)||F.zf.OS(n,"\u5e74",!1)||F.zf.OS(n,"\u6708",!1)||F.zf.OS(n,"\u65e5",!1)||s(n,a)||s(n,i)||"ja-JP"===e.name()&&0<=g.XPt.gGt.indexOf(n[0].toUpperCase())&&F.zf.OS(n,".",!1))&&(r=v.ct.yU(n))?r:((u="("===(n=(o="-"===n.charAt(0))?F.zf.VP(n,0,1):n).charAt(0)&&")"===n.charAt(n.length-1))&&(n=n.substring(1,n.length-1)),(a=this.WHt().parse(n))!==b&&a!==_?(u||o)&&D(a,"number")?-1*w(a):a:t))},ft=u,h.prototype.format=function(t,r){var n,e,i,o,n=this;try{return i=e=void 0,i=t instanceof Date?v.ct.o0(t).toString():pt(t),o=n.XHt(n.pU),e=n.qHt(i,o.formatTokens,t,o.hasAtPart,r)}catch(t){return""}},h.prototype.parse=function(t){return t||""},h.prototype.formatString=function(){return this.pU},h.prototype.XHt=function(t){for(var r,n,e,i,o,u,a,r=[],n=!1,e="",i=!1,u=b,a=0;a<t.length;a++)o=t.charAt(a),i?('"'!==o?e+=o:(r.push(e+=o),e="",i=!1),u=o):"*"!==u&&"_"!==u&&"\\"!==u||""===e?"*"===o||"_"===o||"\\"===o?(u=o,""!==e&&(r.push(e),e=""),e+=o):"@"===o?(u=o,""!==e&&(r.push(e),e=""),r.push(o),n=!0):'"'===o?(u=o,""!==e&&r.push(e),e=o,i=!0):(e+=o,u=o):(r.push(e+=o),e="");return""!==e&&r.push(e),{formatTokens:r,hasAtPart:n}},h.prototype.qHt=function(t,r,n,e,i){var o,u,a,s,o=[],u=!1;if("string"!=typeof n||e||i)for(a=r.length-1;0<=a;a--)"*"===(s=r[a])[0]?u||(u=!0,o.push({type:"fillingChar",value:s[1]})):"_"===s[0]?o.push({type:"placeholder",value:s[1]}):'"'===s[0]&&'"'===s[s.length-1]?2<=s.length&&o.push({type:"text",value:s.substr(1,s.length-2)}):"\\@"===s?o.push({type:"text",value:"@"}):"@"===s[0]?o.push({type:"text",value:t}):o.push({type:"text",value:s});else o.push({type:"text",value:n});return o.reverse()},yt=h,ct=function(){return{pattern:z,formatter:["d-mmm","mmm-yy",a().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",a().shortDatePattern+" h:mm",a().shortDatePattern+" h:mm:ss",a().shortDatePattern+" h:mm:ss.0"]}},E.prototype.Hc=function(t,r){var n,e,i,o,u,a,s,f,y,c,m,M,M,h,d,l,d;for(t!==b&&t!==_||S(),(e=this).formatCached=n=t,o=i="",s=a=u=!1,f=[],y=0;y<t.length;y++)'"'===(c=t[y])?(a=!a,o+=c):a?o+=c:"["===c?(u&&S(),o&&(i=i||"",i+=o),o=c.toString(),u=!0):"]"===c?(u||S(),o?(m=(o+=c).toString(),(M=xt(o.toString()))?"ABSTimeFormatPart"===M.Name?(f.push(new M(E.preProcessPart(m),m)),i+=o):m===g.XPt.eraExcelFormatter?(e.addPart(M,g.XPt.eraInternalFormatter),s=!0):e.addPart(M,m):(i+=M=E.partToNormalStr(m),n=T(t,m,M)),o=""):S(),u=!1):o+=c;o?u?S():i+=o:i=i||e.$Ht(),e.localeIDFormatPart&&(r=e.localeIDFormatPart.cultureInfo().name()),l=(d=kt(i,h=e.conditionalFormatPart)).uit,d=d.uHt?n:i,l?e.E9t=new l(d,e.localeIDFormatPart,e.dbNumberFormatPart,r,0<f.length?f:b,s):S()},E.prototype.$Ht=function(){var r,t,n,r=this,t="";return t=r.dbNumberFormatPart&&!(n=E.proNames.some(function(t){return"dbNumberFormatPart"!==t&&r[t]}))?"General":t},E.prototype.formatString=function(){for(var t,r,n,e,i,t=this,r="",n=0,e=E.proNames.length;n<e;n++)t[i=E.proNames[n]]&&(r+=t[i].toString());return r+=t.E9t.formatString()},E.prototype.addPart=function(t,r){for(var n,e,i,o,u,a,n=this,e=E.proNames,i=E.preProcessPart(r),o=0,u=e.length;o<u;o++)if(O(a=e[o],t.Name,!0)){if(n[a])throw new Error(f().Exp_DuplicatedDescriptor);n[a]=new t(i,r)}},E.prototype.format=function(t,r){return this.E9t.format(t,r)},E.prototype.parse=function(t){return this.E9t.parse(t)},E.checkFormatter=function(t){if(!t||t===P.oHt)throw new Error(f().Exp_TokenIllegal)},E.preProcessPart=function(t){E.checkFormatter(t);var t=wt(t);return E.checkFormatter(t),t},E.partToNormalStr=function(t){var t=E.preProcessPart(t);return'"'+(t="$"===t[0]?t.slice(1):t)+'"'},E.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],mt=E,l(j,dt=e),j.prototype.toJSON=function(){var t,r,t=this,r={formatCached:t.formatCached};return t.cultureName&&(r.customerCultureName=t.cultureName),"general"===m(t.formatCached)&&delete r.formatCached,r},j.prototype.hasFormattedColor=function(){var t,r,n,t=this;for(r in c)if(c.hasOwnProperty(r)&&(n=t.getFormatter(c[r]))&&n.colorFormatPart)return!0;return!1},j.prototype.formatString=function(t){var r,n,e,i,o,r=this;if(0===arguments.length){for(n=P.oHt,e=0,i=r.formatters.length;e<i;e++)n+=(o=r.formatters[e]).formatString(),e!==i-1&&(n+=";");return n}if(t)return r.formatters=b,r.formatCached=t,r.init(),r.tzt("formatString"),r;throw new Error(f().Exp_ValueIsNull)},j.prototype.getFormatter=function(t){var r=this;return r.formatters&&r.formatters[t]},j.prototype.getPreferredEditingFormatter=function(t){var r,n,e,r,r=a(this.cultureName),n=j.defFormatter;return D(t,"TimeSpan")?n(r.longTimePattern):D(t,"DateTime")?(e=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?"":" h:mm:ss",n(r.shortDatePattern+e)):p.lt.q8(t,this.cultureName)?1e20<=(r=p.lt.uJ(t))||r<=1e-17&&0<r||r<=-1e20||r<0&&-1e-17<=r?n("0.##E+00"):n(V):n("General")},j.prototype.getPreferredDisplayFormatter=function(t,r){var n,e,r,i,o,u,a,o,s,f,f,s,f,y,c,m,M,M,s,o,f,n,s,h,d,l,f,n=this,e=j.defFormatter;if((r=r||{value:b}).value=b,P.Ji(t))return new j;if(i=r.value=n.parse(r=t),D(i,"DateTime")||D(i,"TimeSpan")){for(u=(o=ct()).pattern,a=o.formatter,0<(f=(s=(o=N(n.cultureName)).DateTimeFormat).preselectedFormatters).length&&(u=u.concat([f]),a=a.concat([f[0]])),"ja-JP"===o.name()&&(u=u.concat([s.eraFormatter]),a=a.concat(["ge.M.d"]),f=o.QPt.filter(function(t){return"ggge"===t.substr(0,4)}),u=u.concat([f]),a=a.concat(['ggge"\u5e74"M"\u6708"d"\u65e5']),s=o.QPt.filter(function(t){return"gge"===t.substr(0,3)}),u=u.concat([s]),a=a.concat(['gge"\u5e74"M"\u6708"d"\u65e5']),f=o.QPt.filter(function(t){return"ge"===t.substr(0,2)}),u=u.concat([f]),a=a.concat(['ge"\u5e74"M"\u6708"d"\u65e5'])),y=0;y<u.length;y++)for(c=u[y],m=0;m<c.length;m++)if(M=c[m],(M=v.ct.yU(t,M))&&M-i==0)return new j(a[y])}else if(p.lt.q8(i,n.cultureName)){if(o=(s=$(n.cultureName)).currencySymbol,f=s.numberDecimalSeparator,n=s.percentSymbol,s=s.numberGroupSeparator,h="E",f=(l=(d=F.zf.OS)(r,f))?".00":"",r[0]===o)return e(P.I5("{0}#,##0{1};[Red]({0}#,##0{1})",o,f));if(d(r,h,!0))return e("0.00E+00");if(r[0].toString()===n||r[r.length-1].toString()===n)return e(P.I5("0{0}%",f));if(d(r,s))return e(P.I5("#,##0{0}",f))}return e("General")},j.prototype.format=function(r,t){var n,e,i,o,e,u,a;if(D(r,"boolean"))return(r=M()?r?M().boolean_true:M().boolean_false:r).toString().toUpperCase();if(i=0,o=(n=this).vn(r)){e=o.colorFormatPart,t&&e&&(t.conditionalForeColor=t.value=e.foreColor),(e=p.lt.q8(r,n.cultureName))&&(i=p.lt.uJ(r)),u=P.oHt;try{e&&o===n.getFormatter(c.jHt)&&0!==this.expressionNumber?(u=o.format(o.considerNegSymbol?i:w(i)))===b&&D(r,"string")&&(u=r):(u=o.value)===_&&(a=!n.lHt&&o===n.getFormatter(c._text),u=o.format(r,e||a)),t&&(t.content=W(u)?u:[{type:"text",value:u}]),W(u)&&(u=s.mUt(u))}catch(t){D(r,"string")&&(u=r.toString())}return u}return e&&i<0?"-".toString():!D(r,"string")&&(r===_||r===b)?P.oHt:r.toString()},j.prototype.parse=function(t){var r=this;return r.formatters&&0<r.formatters.length?r.formatters[0].parse(t):b},j.prototype.init=function(){var t,r,n,e,i,t=this,r=t.formatCached;for(P.Ji(r)&&S(),t.formatters=[],n=Et(r),t.lHt=1===n.length,(!n||n.length<1||4<n.length)&&S(),e=0;e<n.length;e++)-1!==n[e].indexOf("@")&&-1===n[e].indexOf("\\@")&&(e!==n.length-1?S():this.hasAt=!0),i=new mt(n[e],t.cultureName),t.formatters.push(i);t.getFormatter(c.EHt)||S(),this.nzt()},j.prototype.nzt=function(){this.expressionNumber=this.formatters.length-(this.hasAt?1:0);var t=(0===this.expressionNumber?1:this.expressionNumber)-1;c=p.lt.Dh({},L[t]),this.hasAt&&0!==this.expressionNumber&&(c._text=this.formatters.length-1)},j.prototype.vn=function(t){var r,n,e,i,i,o,t,u,a,s,f,y,r=this;if(r.nzt(),e=(n=r.getFormatter(c.EHt))&&n.conditionalFormatPart,i=r.getFormatter(c._text),e&&(c.OHt=2,this.hasAt||(c._text=3)),"string"==typeof t&&H(t))return i||(e?t:n);if(p.lt.q8(t,r.cultureName)||D(t,"boolean")){if(i=r.getFormatter(c.jHt),o=r.getFormatter(c.OHt),t=p.lt.uJ(t),u=e&&n.conditionalFormatPart.isMeetCondition(t),s=(a=i&&i.conditionalFormatPart)&&i.conditionalFormatPart.isMeetCondition(t),f=void 0,r.lHt||(e?u:0<t||0===t&&!o))f=n;else if(a?s:t<0)f=i;else if(o)f=o;else if(i){if(e&&a)return{value:y=t+""};f=i}return f&&(!e||a||f!==i||o||(f.considerNegSymbol=!0),e&&a&&f===i&&i.conditionalFormatPart&&i.conditionalFormatPart.isMeetCondition(1e-10)&&(f.considerNegSymbol=!0),this.expressionNumber<=1)&&(f.considerNegSymbol=!0),f}return b},j.prototype.tzt=function(t){var r,n,e,r=this;if(r.PropertyChanged)for(n=0;n<r.PropertyChanged.length;n++)"function"==typeof(e=r.PropertyChanged[n])&&e(r,t)},j.defFormatter=function(t){var r=j[t];return r||(r=new j(t),j[t]=r),r},t.GeneralFormatter=j},"./src/plugins/slicer/slicer.entry.ts":function(t,r,n){var e,i,e=this&&this.__createBinding||(Object.create?function(t,r,n,e){void 0===e&&(e=n);var i=Object.getOwnPropertyDescriptor(r,n);i&&("get"in i?r.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return r[n]}}),Object.defineProperty(t,e,i)}:function(t,r,n,e){t[e=void 0===e?n:e]=r[n]}),i=this&&this.__exportStar||function(t,r){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||e(r,t,n)};Object.defineProperty(r,"__esModule",{value:!0}),i(n("./src/plugins/slicer/slicer.ts"),r)},"./src/plugins/slicer/slicer.ts":function(t,r,n){var n,S,P,u,i,o,e,a,s,x,f,n,n;function v(t){return t&&t.text!==S}function y(){}function c(t,r){var n,e,t;if(t!==P&&t!==S){if(N(t)===u)r.value=t;else if(N(t)===o)r.value=t?1:0;else if(t instanceof Date)r.value=x.o0(t);else{if(N(t)!==i)return;if(0===k(t=t.trim()))return;if(n=!1,"%"===t.charAt(k(t)-1)&&(n=!0,t=t.substr(0,k(t)-1)),2<=k(t)&&"0"===t[0]&&"x"===t[1])return;if(e=Number(t).valueOf(),isNaN(e)||!isFinite(e)){if(t=new Date(t),isNaN(t))return;e=x.o0(t)}n&&(e/=100),r.value=e}return 1}}function F(t){var r,n,e,i,o,u,a,s,f,y,c,m,M,h,d,l,r=t.ezt;for(r||(t.izt=[],t.rzt=[]),n=r?t.ozt:t.izt,e=t.azt,i=t.uzt,o=r?t.szt:t.rzt,u=t.Mct,a=t.czt,s=t.fzt,f=k(t.data),c={},m=0;m<f;m++){for(M=!1,h=void 0,d=0;d<k(u)&&(h=u[d],r&&h===t.lzt||(i[h]?(H(c[l=t.columnNames[h]])&&(c[l]=t.getColumnIndex(l)),y=t.fue(c[l],m),M=!i[h][y]):e[h]&&(M=!e[h][m]),!M));d++);!M&&r&&(a?(H(c[l=t.columnNames[h]])&&(c[l]=t.getColumnIndex(l)),M=!a[y=t.fue(c[l],m)]):s&&(M=!s[m])),M||(n[m]=!0)}for(d=0;d<k(n);d++)n[d]&&o.push(d)}function h(t){return"string"==typeof t?t.toLowerCase():t instanceof Date?x.o0(t):t}function m(t){var r,n,e,r=t.hzt={};for(t.dzt=[],t.vzt=[],t.mzt=[],t.gzt=[],n=t.columnNames,e=0;e<k(n);e++)r[(n[e]+"").toUpperCase()]=e}function p(t,r){var n,e,i,o,u,a,s,f,y,c,c,m,m,M,n=t.dzt,e=t.vzt,i=t.pzt,o=t.mzt,u=t.gzt,a=t.data,s=u[r]=[];for(t.bzt=[],n[r]=[],e[r]=[],i[r]={},o[r]=[],f={},y=0;y<k(a);y++)c=v(c=a[y][r])?c.text.trim():c,n[r].push(c),(m=f[h(c)])?(m.list.push(y),s[y]=m.index):(m=[y],e[r].push(c),o[r].push(m),M=k(o[r])-1,i[r][c]=M,s[y]=M,f[h(c)]={list:m,index:M})}function M(t,r,n){var e,i,o,u,a,s,f,y,c,c,m,M,h,d,l,e=t.yzt,i=t.getColumnIndex(r),o=[];if(i&&(u=t.ezt?t.wzt:t.Mzt[i],a=t.izt,u)){for(e[i]||t.Czt(i),s=[],f=e[i],y=0;y<k(f);y++)c=v(c=t.data[y][i])?c.value:c,s[f[y]]=c;for(m=t.Szt[i],y=0;y<k(u);y++){for(M=u[y],h=!1,l=(d=t.Tzt(s,M)).start;l<=d.end;l++)if(a[m[l]]){h=!0;break}h!==n&&o.push(M)}}return o}function d(t,r){var n,e,i,o,u,a,n=[],e=t.getColumnIndex(r);if(0<=e){for(i=k(t.getData(r)),o=t.ezt?t.ozt:t.izt,u=0;u<i;u++)o[u]||(a=t.fue(e,u),-1===n.indexOf(a)&&n.push(a));return n}}function l(t,r){var n,e,i,o,u,a,s,f,y,c,n=[],e={},i=t.getColumnIndex(r);if(0<=i)for(o=t.czt||t.fzt,u=t.uzt[i]||t.azt[i],a=t.ezt&&i===t.lzt?o:u,f=k((s=!!t.azt[i])?t.getData(r):t.getExclusiveData(r)),y=0;y<f;y++)!a||a[y]||e[c=s?t.fue(i,y):y]||(e[c]=!0,n.push(c));return n}function g(t,r){for(var n,e,i,o,u,a,s,f,y,c,m,M,n={},e=t.columnNames,o=k(e),i=0;i<o;i++)if(e[i]!==r)for(u=l(t,e[i]),a=0;a<k(u);a++)for(s=t.getRowIndexes(e[i],u[a]),f=0;f<k(s);f++)n[s[f]]||(n[s[f]]=!0);for(y={},o=k(t.data),i=0;i<o;i++)c=t.getExclusiveRowIndex(r,i),n[i]||(y[c]=!0);for(m=k(t.getExclusiveData(r)),M=[],i=0;i<m;i++)y[i]||M.push(i);return M}function b(t,r,n,e){var i,r,o,u,a,s,s,f,y,c,i=t.getColumnIndex(r),r=t.yzt;for(r[i]||t.Czt(i),o=[],u=r[i],a=0;a<k(u);a++)s=v(s=t.data[a][i])?s.value:s,o[u[a]]=s;for(f=[],a=0;a<k(n);a++)for(y=t.Tzt(o,n[a]),c=0;c<k(u);c++)u[c]>=y.start&&u[c]<=y.end&&(f[c]=!0);e?(t.fzt=f,t.wzt=n):(t.Mzt[i]=n,t.azt[i]=f,delete t.uzt[i],delete t.Azt[i]),F(t)}function _(t,r,n,e){for(var r,i,o,r=t.getColumnIndex(r),i=[],o=0;o<k(n);o++)i[n[o]]=!0;e?t.czt=i:(t.uzt[r]=i,t.Azt[r]=n,delete t.Mzt[r],delete t.azt[r]),F(t)}function w(t,r){t.ezt=!1,t.czt=[],t.szt=[],t.ozt=[],t.fzt=[],r&&t.onFiltered()}function D(t,r){var n,e,n=this;for(n.hzt={},n.dzt=[],n.vzt=[],n.pzt=[],n.mzt=[],n.gzt=[],n.uzt=[],n.Azt=[],n.azt=[],n.Mzt=[],n.izt=[],n.rzt=[],n.Mct=[],n.szt=[],n.ozt=[],n.ezt=!1,n.aT=[],n.Upt=0,n.bzt=[],n.Szt=[],n.yzt=[],n.lue=0,n.Izt(t,r),e=0;e<k(n.data);e++)n.izt[e]=!0,n.rzt.push(e)}function H(t){return t===P||t===S}function N(t){return typeof t}function k(t){return t?t.length:0}Object.defineProperty(r,"__esModule",{value:!0}),r.GeneralSlicerData=r.xzt=r.SlicerAggregateType=r.FilteredOutDataType=void 0,n=n("./src/common/util/datetimehelper.ts"),S=void 0,P=null,u="number",i="string",o="boolean",e=n.ct.o0,(n=a=r.FilteredOutDataType||(r.FilteredOutDataType={}))[n.all=0]="all",n[n.byCurrentColumn=1]="byCurrentColumn",n[n.byOtherColumns=2]="byOtherColumns",(n=s=r.SlicerAggregateType||(r.SlicerAggregateType={}))[n.average=1]="average",n[n.count=2]="count",n[n.counta=3]="counta",n[n.max=4]="max",n[n.min=5]="min",n[n.product=6]="product",n[n.stdev=7]="stdev",n[n.stdevp=8]="stdevp",n[n.sum=9]="sum",n[n.vars=10]="vars",n[n.varp=11]="varp",y.o0=function(t){return e(t)},y.quickSort=function(t){for(var r,n,e,r=k(t),n=[],e=0;e<r;e++)n[e]={index:e,value:t[e]};return y.quickSortImp(n)},y.quickSortImp=function(t){var r,n,e,i,o,u,a,s,f,r=t.length;if(r<=1)return t;for(n=y,i=t[e=Math.floor(r*Math.random())],o=[],u=[],a=[],s=0;s<r;s++)(e===s?a:(f=n.sortCompare(t[s].value,i.value))<0?o:0<f?u:a).push(t[s]);return n.quickSortImp(o).concat(a,n.quickSortImp(u))},y.isEquals=function(t,r){return!(!H(t)&&""!==t||!H(r)&&""!==r)||(t instanceof Date&&r instanceof Date?t.valueOf()===r.valueOf():N(t)===i&&N(r)===i?t.toLowerCase()===r.toLowerCase():t===r)},y.isGreaterThan=function(t,r){var n=N(t),e=N(r);return n===o?t=t?1:0:t instanceof Date&&(t=y.o0(t)),e===o?r=r?1:0:r instanceof Date&&(r=y.o0(r)),n===e||n!==u&&e!==u?n===i&&e===i?t.toLowerCase()>r.toLowerCase():r<t:e===u},y.sortCompare=function(t,r){var n,e,i,o,n=y,e=-1,i=H(t)||""===t||N(t)===u&&isNaN(t),o=H(r)||""===r||N(r)===u&&isNaN(r);return i&&o?e=0:i?e=1:o?e=-1:n.isEquals(t,r)?e=0:n.isGreaterThan(t,r)&&(e=1),e},x=y,r.xzt=x,D.prototype.inPreview=function(){return this.ezt},D.prototype.Izt=function(t,r){var n=this;n.data=t,n.columnNames=r,m(n)},D.prototype.due=function(t){var r=this;r.vue&&0===r.lue&&(r.Nzt("onDataChanged",t),r.vue=!1)},D.prototype.mue=function(){this.lue++},D.prototype.gue=function(){var t=this;t.lue--,t.lue<=0&&(t.lue=0,t.due())},D.prototype.onDataChanged=function(t){for(var r,n,e,i,o,u,a,s,f,y,c,f,c,y,m,M,h,d,r=this,n=new Array(k(r.columnNames)),e=r.Azt,i=r.vzt,o=r.uzt,u=r.dzt,s={},a=0;a<k(t);a++)y=(f=t[a]).data,c=f.columnName,f=f.row,H(s[c])&&(s[c]=r.getColumnIndex(c)),c=s[c],f>=r.data.length&&r.onRowsAdded(f,1,!1),y=v(r.data[f][c]=y)?y.text:y,u[c]&&(u[c][f]=y),n[c]=!0;for(m=0;m<k(n);m++)if(n[m]){for(M=e[m],e[m]=M?[]:void 0,o[m]=M?[]:void 0,h=[],a=0;M&&a<k(M);a++)h.push(i[m][M[a]]);for(p(r,m),a=0;a<k(h);a++)d=r.pzt[m][h[a]],e[m].push(d),o[m][d]=!0}F(r),r.vue=!0,r.due(t)},D.prototype.Nzt=function(t){for(var r,n,e,i,o,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];for(e=this.aT||[],i=0;i<k(e);i++)(o=e[i])[t]&&o[t].apply(o,r)},D.prototype.onColumnNameChanged=function(t,r){var n,e,i,n=this,e=n.hzt,i=n.getColumnIndex(t);i<0||(n.columnNames[i]=r,delete e[t.toUpperCase()],e[r.toUpperCase()]=i,n.Nzt("onColumnNameChanged",t,r))},D.prototype.onRowsAdded=function(t,r,n){var e,i,o,u,a,s,f,y,c,m,M,h,d,l,v,F,p,g,b,_,w,D,H,N,$,e=this,i=k(e.columnNames),o=e.data,u=e.dzt,a=e.vzt,s=e.mzt,f=e.gzt,y=e.uzt,c=e.Azt,m=e.izt,M=e.rzt,h=e.Mct;for(e.bzt=[],d=0;d<r;d++)o.splice(t,0,new Array(i));for(l=0;l<i;l++){for(d=0;d<r;d++)u[l]&&u[l].splice(t,0,S);if(p=void 0,F=a[l]){for(g=P,b=0;b<k(F);b++){for(_=s[l][b],w=0;w<k(_);w++)_[w]>=t&&(_[w]+=r);x.isEquals(F[b],P)&&(g=_,p=b)}for(g||(g=[],F.push(P),p=k(F)-1,e.pzt[l][P]=p,s[l].push(g),y[l]&&-1===h.indexOf(l)&&(y[l][p]=!0,c[l].push(p))),D=t;D<t+r;D++)g.push(D);for(v=t;v<t+r;v++)f[l].splice(v,0,p)}}for(H=!0,d=0;d<k(h);d++)N=f[l=h[d]][t],!0!==y[l][N]&&(H=!1);for(d=0;d<k(M);d++)M[d]>=t&&(M[d]+=r);for(v=k(o)-1;t+r<=v;v--)m[v]=m[v-r];for($=0<k(h),v=t;v<t+r;v++)H&&M.push(v),m[v]=!$;n||e.Nzt("onRowsChanged",t,r,!0)},D.prototype.onRowsRemoved=function(t,r){this.kzt(t,r,!0)},D.prototype.kzt=function(t,r,n){var e,i,o,u,a,s,f,y,c,m,M,h,d,l,v,e=this,i=e.Azt,o=e.vzt,u=e.uzt,a=e.data,s=k(e.columnNames),f=e.dzt;for(a.splice(t,r),c=0;c<s;c++){if(f[c]&&f[c].splice(t,r),M=[],(m=i[c])&&n){for(y=0;y<k(m);y++){for(h=e.getRowIndexes(e.columnNames[c],m[y]),d=!0,l=0;l<k(h);l++)if(h[l]<t||h[l]>=t+r){d=!1;break}d||M.push(o[c][m[y]])}i[c]=[],u[c]=[]}if(p(e,c),m&&n)for(y=0;y<k(M);y++)v=e.pzt[c][M[y]],i[c].push(v),u[c][v]=!0}n&&F(e),e.Nzt("onRowsChanged",t,r,!1)},D.prototype.onColumnsRemoved=function(t,r){for(var n,e,i,o,u,a,s,f,y,c,m,M,h,n=this,e=n.data,i=[],o=n.Mct,u=t+r,a=t;a<u;a++)(s=n.columnNames[a])&&(f=a,i.push(s),-1!==o.indexOf(f))&&n.doUnfilter(s);for(y=n.uzt||n.azt,c=n.Azt||n.Mzt,m=n.hzt,a=0;a<k(e);a++)e[a].splice(t,r);for(M in n.bzt=[],n.columnNames.splice(t,r),n.dzt.splice(t,r),n.vzt.splice(t,r),n.pzt.splice(t,r),n.mzt.splice(t,r),n.gzt.splice(t,r),y.splice(t,r),c.splice(t,r),m)m[M]>=t+r&&(m[M]-=r);for(a=0;a<k(i);a++)delete m[(s=i[a]).toUpperCase()],t=n.getColumnIndex(s),-1!==(h=o.indexOf(t))&&o.splice(h,1),n.Nzt("onColumnRemoved",i[a])},D.prototype.Dzt=function(){return this.bzt},D.prototype._zt=function(){return this.Szt},D.prototype.Czt=function(t){var r,n,e,i,o,u,u,a,s,f,y,c,m,r=this,n=r.data;for(r.dzt[t]||p(r,t),e=k(n),i=[],o=0;o<e;o++)u=v(u=n[o][t])?u.value:u,i.push(u);for(a=x.quickSort(i),s=r.bzt[t]=[],f=r.Szt[t]=[],y=r.yzt[t]=[],c=0;c<k(a);c++)m=a[c],s.push(m.value),f.push(m.index),y[m.index]=c},D.prototype.getColumnIndex=function(t){var t=this.hzt[t.toUpperCase()];return void 0===t?-1:t},D.prototype.getFilteredRowIndexes=function(){var t=this;return t.ezt?t.szt:t.rzt},D.prototype.getFilteredOutRowIndexes=function(){for(var t,r,n,e,i,t=this,r=k(t.data),n=t.ezt?t.ozt:t.izt,e=[],i=0;i<r;i++)n[i]||e.push(i);return e},D.prototype.getData=function(t,r){var n,e,i,o,t,t,r,u,a,s,n=this,e=n.dzt,i=n.getColumnIndex(t);if(0<=i){if(r){for(n.bzt[i]||n.Czt(i),o=e[i],t=n.bzt[i],r=(t=n.Tzt(t,r)).start,u=t.end,a=[],s=r;s<=u;s++)a.push(o[n.Szt[i][s]]);return a}return e[i]||p(n,i),e[i]}return[]},D.prototype.aggregateData=function(t,r,n){var e,t,i,n,t,o,n,o,e,t,i,e=this,t=e.getColumnIndex(t);return t<0?S:(e.bzt[t]||e.Czt(t),o=k(t=e.bzt[t]),i=(n=e.Tzt(t,n)).start,n=n.end,5===r?o<=i?S:t[i]:4===r?n<0?S:t[n]:3===r?n<i?0:n-i+1:(e=(o=e.Ezt(t,r,i,n)).data1,t=o.data2,i=o.data3,1===r?e/=t:7===r||10===r?(e=(i*t-e*e)/(i*(i-1)),e=7===r?Math.sqrt(e):e):8!==r&&11!==r||(e=(i*t-e*e)/(i*i),e=8===r?Math.sqrt(e):e),e))},D.prototype.Ezt=function(t,r,n,e){for(var i,o,u,a,s,f,i=6===r?1:0,o=0,u=0,a=n;a<=e;a++)(s=t[a])===P&&s===S||c(s,f={value:P})&&(s=f.value,1===r?(i+=s,o++):2===r?i++:9===r?i+=s:6===r?i*=s:7!==r&&8!==r&&10!==r&&11!==r||(i+=s,o+=s*s,u++));return{data1:i,data2:o,data3:u}},D.prototype.Tzt=function(t,r){var n=k(t),e,i,o,u;if(r){if(r.min===-1/0)e=0;else for(o=0;o<n;o++)if(u=t[o],x.isEquals(r.min,u)||x.isGreaterThan(u,r.min)){e=o;break}if(e===S&&(e=n),i===1/0)i=n-1;else{for(o=n-1;0<=o;o--)if(u=t[o],x.isEquals(u,r.max)||x.isGreaterThan(r.max,u)){i=o;break}i===S&&(i=-1)}}else e=0,i=n-1;return{start:e,end:i}},D.prototype.getExclusiveData=function(t){var r=this,n=r.vzt,t=r.getColumnIndex(t);return 0<=t?(n[t]||p(r,t),n[t]):[]},D.prototype.getRowIndexes=function(t,r){var n=this,t=n.getColumnIndex(t);return 0<=t?(n.gzt[t]||p(n,t),n.mzt[t][r]):[]},D.prototype.getExclusiveRowIndex=function(t,r){var n=this,t=n.getColumnIndex(t);return n.fue(t,r)},D.prototype.fue=function(t,r){var n=this,e=n.gzt;return 0<=t?(e[t]||p(n,t),e[t][r]):-1},D.prototype.getFilteredIndexes=function(t){var r=[],n;return this.jzt(t,r,{}),r},D.prototype.jzt=function(t,r,n){for(var e,i,o,u,a,a,e=this,i=e.ezt?e.szt:e.rzt,o=e.getColumnIndex(t),u=0;u<k(i);u++)a=i[u],H(a=e.fue(o,a))||(n[a]?n[a]++:(n[a]=1,r.push(a)))},D.prototype.getFilteredRanges=function(t){return M(this,t,!1)},D.prototype.getFilteredOutRanges=function(t){return M(this,t,!0)},D.prototype.getFilteredOutIndexes=function(t,r){var n=this;return(0===r?d:1===r?l:g)(n,t)},D.prototype.attachListener=function(t){-1===this.aT.indexOf(t)&&this.aT.push(t)},D.prototype.detachListener=function(t){for(var r,n,r=this.aT||[],n=0;n<k(r);n++)if(r[n]===t){r.splice(n,1);break}},D.prototype.suspendFilteredEvents=function(){this.Upt++},D.prototype.resumeFilteredEvents=function(){var t=this;t.Upt--,0===t.Upt&&t.onFiltered()},D.prototype.doFilter=function(t,r,n){this.Ozt(t,r,n),this.onFiltered()},D.prototype.Ozt=function(t,r,n){var e,i,o,e=this,i=e.Mct,o=e.getColumnIndex(t);o<0||(n?(e.ezt=!0,e.lzt=o):e.ezt&&w(e,!1),i.indexOf(o)<0&&i.push(o),r.ranges?b(e,t,r.ranges,n):_(e,t,r.exclusiveRowIndexes,n))},D.prototype.clearPreview=function(){w(this,!0)},D.prototype.doUnfilter=function(t){this.Rzt(t),this.onFiltered()},D.prototype.Rzt=function(t){var r,t,t,r=this;r.ezt&&w(r,!1),(t=r.getColumnIndex(t))<0||(delete r.Mzt[t],delete r.azt[t],delete r.uzt[t],delete r.Azt[t],F(r),0<=(t=r.Mct.indexOf(t))&&r.Mct.splice(t,1))},D.prototype.onFiltered=function(){var t=this;0===t.Upt&&t.Nzt("onFiltered",{rowIndexes:t.getFilteredRowIndexes(),isPreview:t.ezt})},D.prototype.getListener=function(){return this.aT},r.GeneralSlicerData=D},"./src/plugins/sparkline/sparkline.entry.ts":function(t,r,n){var e,i,e=this&&this.__createBinding||(Object.create?function(t,r,n,e){void 0===e&&(e=n);var i=Object.getOwnPropertyDescriptor(r,n);i&&("get"in i?r.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return r[n]}}),Object.defineProperty(t,e,i)}:function(t,r,n,e){t[e=void 0===e?n:e]=r[n]}),i=this&&this.__exportStar||function(t,r){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||e(r,t,n)};Object.defineProperty(r,"__esModule",{value:!0}),i(n("./src/plugins/sparkline/sparkline.ts"),r)},"./src/plugins/sparkline/sparkline.ts":function(r,c,n){var e,i,m,M,et,W,h,d,it,R,T,rt,k,N,ot,ut,nt,C,G,at,z,E,st,ft,yt,ct,o,Ft,mt,pt,Mt,$,V,K,J,S,Y,l,I,B,X,q,Z,Q,A,tt,gt,bt,_t,O,j,P,wt,Dt,Ht,u,w,Nt,$t,v,F,p,g,b,St,D,Pt,xt,kt,Ct,At,Tt,Ot,_,a,s,f;function Et(t){this.x=t.x,this.y=t.y}function jt(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}function H(t,r){return{x:t,y:r}}function Rt(t,r,n,e){return{x:t,y:r,width:n,height:e}}function It(t,r){for(var n,e,i,o,u,n=t[0],e=n&&n.value?n.value:n,o=1,u=t.length;o<u;o++)i=(n=t[o])&&n.value?n.value:n,(r&&i<e||!r&&e<i)&&(e=i);return e}function L(t,r,n,e,i,o,u){o&&(t.strokeStyle=o),u&&(t.lineWidth=u),t.beginPath(),t.moveTo(r,n),t.lineTo(e,i),t.stroke()}function Bt(t,r,n,e,i,o,u){t.save(),o&&(t.strokeStyle=o),u&&(t.lineWidth=u),t.beginPath(),t.moveTo(r,n),t.lineTo(e,i),t.closePath(),t.stroke(),t.restore()}function Lt(t,r,n,e,i,o,u,a){var s,f,y,c,m,M,h,d,l;if(t.save(),s=[o,u],t.setLineDash)t.beginPath(),t.strokeStyle=a,t.setLineDash(s),t.stroke(),t.moveTo(r,n),t.lineTo(e,i);else for(t.beginPath(),t.lineWidth=1,t.strokeStyle=a,c=(e-r)/(f=G(C(e-r,2)+C(i-n,2))),m=(i-n)/f,h=M=0;M<f;)M+=d=ot(s[h%2],f-M),(l=++h%2)&&t.moveTo(r,n),r+=d*c,n+=d*m,l&&t.lineTo(r,n);t.stroke(),t.restore()}function ht(t,r,n,e,i,o,u,a,s,f,y,c){r?L(t,n,e,i,o,y,c):L(t,u,a,s,f,y,c)}function x(t,r,n,e,i,o,u,a){t.save(),u&&(t.fillStyle=u),t.textBaseline=a||Z,t.beginPath(),t.font=i,t.textAlign=o,t.fillText(e="string"==typeof e?e:e+"",r,n),t.restore()}function Gt(t){return m.ft.rp(h(t))<127.5?$:V}function dt(t,r,n,e,i,o,u,a){var s,f,y,c,a,s=a;return et(a)&&(s=i),a=u?(f=r+s+o,c=e-2*s,y=t+i,n-2*i):(f=t+s,c=n-2*s,y=r+i,e-2*i),{left:f,top:y,width:c,height:a}}function zt(t,r){for(var n,e,i,n=0,e=0,i=t.length;e<i;e++)n+=r&&!r(t[e])?0:t[e];return n}function Kt(t){return t*rt/180}function Jt(t,r,n,e){for(var i,o,u,a,s,i=[],u=0,a=0,s=t.length;u<s;u++)r?(r(t[u])?i[a]=n?n(t[u]):t[u]:i[a]=0,a++):(o=yt(t[u]),!ft(o)&&isFinite(o)&&(i[a]=o,a++));return e&&e(i),i}function lt(t,r,n,e,i,o){var u=nt(r+e),a=nt(n+i);r=nt(r),n=nt(n),e=nt(u-r),i=nt(a-n),t.beginPath(),t.fillStyle=o,t.fillRect(r,n,e,i),t.fill()}function Wt(t,r,n){return t=ot(t,r),t=ut(t,n)}function vt(t,r,n,e,i){t.save(),t.rect(r,n,e,i),t.clip()}function Vt(t,r){var n,e,i,o;return t&&r&&(n=ut(t.x+t.width,r.x+r.width),e=ut(t.y+t.height,r.y+r.height),i=ot(t.x,r.x),o=ot(t.y,r.y),n-i<=t.width+r.width)&&e-o<=t.height+r.height}function Ut(t,r,n,e,i,o){var u,a,s,f,y,c,m,M,h,d,l,v,F,p,g,u=n+i/2,a=e+o/2,s=5,f=ot(i,o)/2-5,y=-.5*rt,m=u+f*N(y),M=a+f*k(y),h=[],d=[];if(!(f<=0)){for(F=Yt(v=(l=Jt(r.values,function(t){return!et(t)&&!ft(t)&&isFinite(t)},function(t){return at(t)},function(t){1===t.length&&(t[1]=1-t[0])})).length,r.colors),p=zt(l),t.save(),g=0;g<v;g++)c=y+l[g]/p*2*rt,t.beginPath(),t.moveTo(u,a),t.lineTo(m,M),t.arc(u,a,f,y,c,!1),t.lineTo(u,a),t.fillStyle=F[g],t.fill(),h.push(m),d.push(M),m=u+f*N(y=c),M=a+f*k(y);for(g=0;g<v;g++)L(t,u,a,h[g],d[g],$);t.restore()}}function Yt(t,r){var n,e,i,o,u,a,s,f,n=[],e=r.length;if(t<=e)n=r.slice(0,t);else{for(0===e?(n.push("darkgray"),e=1):n=r.slice(0),i=[],u=t-e+1,a=o=void 0,a=0;a<e;a++)i[a]=h(n[a]);for(a=e;a<t;a++){for(s in o=i[a%e])o.hasOwnProperty(s)&&(f=o[s],o[s]=T(f-f/u*(a/e)));o.a=255,n[a]=m.ft.j(o)}}return n}function Xt(t){var r=f.call(this,H(t.x,t.y))||this;return r.value=t.value,r}function qt(t,r,n){return{x:t,y:r,value:n}}function Zt(n,t,r,e,i,o){var u,a,s,f,y,c,m,M,h,d,l,v,F,p,g,b,_,w,t,s,t,D,H,N,$,S,P,x,k,C,A,T;for(n.save(),u=t.points,a=t.mini,s=t.maxi,f=t.line1,y=t.line2,c=t.colorPositive,m=t.colorNegative,M=5,u=Jt(u,function(t){return!et(t)&&!ft(t)&&isFinite(t)}),c=et(c)?"#787878":c,m=et(m)?mt:m,t=It(u,!1),s=et(s)?t:s,d=ut(s,t),s=It(u,!0),a=et(a)?s:a,h=ot(a,s),l=(l=(d=d<0?0:d)<(l=0)?d:0)<(h=0<h?0:h)?h-1:l,v=u.length,t=dt(r,e,i,o,5),F=t.left,p=t.top,g=t.width,b=t.height,_=g/(v-1),D=[],P=p+(d-l)/(w=(d-h)/b),C=0;C<v;C++)H=u[C],x=F+_*C,k=p+(d-H)/w,0===C&&D.push(new xt(qt(x,P,l))),0<C&&H*u[C-1]<0&&($=D[D.length-1])&&(S=Qt($.x,$.y,x,k,P),D.push(new xt(qt(S,P,l)))),D.push(new xt(qt(x,k,H))),C===v-1&&D.push(new xt(qt(x,P,l)));for(n.beginPath(),A=0,T=D.length;A<T;A++)(N=D[A])&&(0===A?n.moveTo(N.x,N.y):n.lineTo(N.x,N.y),$=D[A-1],N.value===l)&&$&&(n.fillStyle=$.value>l?c:m,n.fill(),A!==T-1)&&(n.beginPath(),n.moveTo(N.x,N.y));function O(t){var t,r,t;t===it&&typeof t!==E||(t=Wt(t,d,h),t=nt(p+(r=0!=w?(d-t)/w:b/2))-.5,L(n,F,t,F+g,t,K))}O(f),O(y),n.restore()}function Qt(t,r,n,e,i){return((r-i)*n+(i-e)*t)/(r-e)}function tr(i,t,r,E,j,R){var n,e,I,B,L,G,o,u,a,s,f,y,z,c,K,m,M,J,W,h,d,l,v,F,p,g,b,_,V,U,Y,b,w,D,H,N,$,S,P,x,k,t,C,A,T,O,t,n,e,r,n=t.points1,e=t.points2,I=t.minX,B=t.maxX,L=t.minY,G=t.maxY,o=t.hLine,u=t.vLine,a=t.xMinZone,s=t.xMaxZone,f=t.yMinZone,y=t.yMaxZone,z=t.tags,c=t.drawSymbol,K=t.drawLines,m=t.color1,M=t.color2,J=t.dash,W=4,t=dt(r,E,j,R,5),C=t.left,A=t.top,T=t.width,O=t.height;if(n&&!(n.length<=0)&&!((h=ir(n)).length<=0||e&&0<e.length&&(d=ir(e)).length<=0)){for(vt(i,r,E,j,R),i.beginPath(),c=!!et(c)||c,m=et(m)?Ft:m,M=et(M)?mt:M,q(h,L,G,I,B),!et(a)&&!et(s)&&!et(f)&&!et(y)&&F<=a&&a<=p&&F<=s&&s<=p&&l<=f&&f<=v&&l<=y&&y<=v&&(t=ut(F,a),n=ot(p,s),e=ut(l,f),r=ot(v,y),lt(i,C+(t-F)*T/(p-F),A+(v-(r=r<=e?e+1:r))*O/(v-l),((n=n<=t?t+1:n)-t)*T/(p-F),(r-e)*O/(v-l),Mt)),S=$=-ct,x=P=ct,_=h.length,g=0;g<_-1;g++)X(h,g,m,Q),z&&(0===g&&(S<D&&($=w,S=D),D<x)&&(P=w,x=D),S<N&&($=H,S=N),N<x)&&(P=H,x=N);if(d&&0<d.length)for(q(d,l,v,F,p),_=d.length,g=0;g<_-1;g++)X(d,g,M,tt);z&&(Z($,S,mt),Z(P,x,"#0000FF")),!et(o)&&l<=o&&o<=v&&(k=nt(A+(v-o)*O/(v-l))-.5,er(i,C,k,C+T,k,mt)),!et(u)&&F<=u&&u<=p&&(k=nt(C+(u-F)*T/(p-F))-.5,er(i,k,A,k,A+O,mt)),i.restore()}function X(t,r,n,e){b=t[r],V=b.x,U=b.y,b=t[r+1],Y=b.x,b=b.y,w=C+(V-F)*T/(p-F),H=C+(Y-F)*T/(p-F),D=A+(v-U)*O/(v-l),N=A+(v-b)*O/(v-l),K&&er(i,w,D,H,N,n,J),c&&(0===r&&e(w,D),e(H,N))}function q(t,r,n,e,i){var o,t,o=rr(t,!0),t=rr(t,!1);l=et(L)?o.y:r,v=et(G)?t.y:n,F=et(I)?o.x:e,p=(p=et(B)?t.x:i)<=F?F+1:p,v=v<=l?l+1:v}function Z(t,r,n){i.beginPath(),i.arc(t-2,r-2,2,0,2*rt,!1),i.fillStyle=n,i.fill()}function Q(t,r){i.beginPath(),i.strokeStyle=m,i.arc(t-2,r-2,2,0,2*rt,!1),i.stroke()}function tt(t,r){i.beginPath(),i.strokeStyle=M,i.strokeRect(t-2,r-2,4,4)}}function rr(t,r){for(var n,e,i,o,u,a,n=r?1:-1,e=r?ot:ut,i=new D(H(n*ct,n*ct)),o=t.length,a=0;a<o;a++)u=t[a],i.x=e(i.x,u.x),i.y=e(i.y,u.y);return i}function nr(t,r,n,e){return n/e*(r-t)+t}function er(t,r,n,e,i,o,u){var a,s,f,y,c,m,M,h,d,l,v,F,p,g,b,_,w;if(u){for(a=G(C(e-r,2)+C(i-n,2)),f=6,y=2,c=4,l=d=h=M=void(s=0),l=r<=e?(h=e,d=M=r,n):(h=r,d=M=e,i),F=n-(v=(i-n)/(e-r))*r,(m=[]).push(new D(H(d,l))),p=[6,4,2,4];s<a;)for(g=0,b=p.length;g<b;g++)(s+=p[g])<=a&&(d=nr(M,h,s,a),m.push(new D(H(d,l=v*d+F))));for(_=0,w=m.length;_<w-1;_+=2)L(t,m[_].x,m[_].y,m[_+1].x,m[_+1].y,o)}else L(t,r,n,e,i,o)}function ir(t){var r,n,e,i,o,r=[],n=t.length;if(0<n)if(n<(e=t[0].length)){if(2<=n)for(i=0;i<e;i++)r.push(new D(H(t[0][i],t[1][i])))}else if(2<=e)for(o=0;o<n;o++)r.push(new D(H(t[o][0],t[o][1])));return r}function or(u,t,a,s,f,y){var r,n,e,i,o,c,m,M,h,d,l,v,F,p,g,b,_,t,l,w,D,H,w,N,$,F,S,P,e,p,i,M,x,k,C,r=t.measure,n=t.target,e=t.maxi,i=t.good,o=t.bad,c=t.forecast,m=t.tickUnit,M=t.colorScheme,h=t.vertical,d=5,l=t.measureColor,v=t.targetColor,F=t.maxiColor,p=t.goodColor,g=t.badColor,b=t.forecastColor,_=t.allowMeasureOverMaxi,t=t.barSize;if(!(et(e)||e<0)&&(et(t)||!(ft(t)||t<=0))){if(1<t&&(t=1),r=et(r)||r<0?0:r,i=et(i)||i<0?0:i,o=et(o)||o<0?0:o,n=et(n)?0:n,c=et(c)?0:c,m=et(m)?0:m,M=et(M)?"#A0A0A0":M,l=et(l)?"#252525":l,e<r&&!_&&(r=e,l=mt),e<i&&(i=e,l=mt),e<o&&(o=e,l=mt),e<n&&(n=0,l=mt),e<c&&(c=e,l=mt),w=dt(a,s,f,y,5,y-10,h),D=w.left,H=w.width,u.save(),w=et(t)?.2:(1-t)/2,N=et(t)?.6:t,$=_?ut(e,r):e,A(et(F)?W(M,1.66):F,e,$,w,N),A(et(p)?W(M,1.33):p,i,$,w,N),A(et(g)?M:g,o,$,w,N),F=.25*t/.6,A(l,r,$,S=et(t)?.375:(1-F)/2,P=et(t)?.25:F),0<c&&(e=D,H<(p=H*(c/$))&&(p=H),i=et(t)?3:3*t/.6,ht(u,h,a+.5*f,e,a+.5*f,e-p,e,s+.5*y,e+p,s+.5*y,et(b)?"#3690BF":b,i)),0<n&&(M=nt(D-(h?1:-1)*H*(n/$))-.5,ht(u,h,a+f*w,M,a+f*(1-w),M,M,s+y*w,M,s+y*(1-w),et(v)?mt:v,1)),0<m)for(x=T($/m),k=void 0,C=0;C<=x;C++)k=nt(D-H/$*m*(h?1:-1)*C)-.5,ht(u,h,a,k,a+.05*f,k,k,s+y,k,s+.95*y,pt,1);u.restore()}function A(t,r,n,e,i){var o,t,r;u.fillStyle=t,H<(t=H*(r/n))&&!_&&(t=H),r=new Pt(h?Rt(a+f*e,D-t,f*i,t):Rt(D,s+y*e,t,y*i)),u.fillRect(r.x,r.y,r.width,r.height)}}function ur(t,r,n,e,i,o){var u,a,s,f,y,c,m,M,r,h,r,h,d,l,v,F,p,g,b,_,w,D,H,N,$,N,S,P,x,k,C,u=r.spreadData,a=r.showAverage,s=r.scaleStart,f=r.scaleEnd,y=r.style,c=r.colorScheme,m=r.vertical,M=5,r=u.length;if(!(r<=0)){for(h=u[0].key,r=u[r-1].key,s=et(s)?h:s,f=et(f)?r:f,y=et(y)?4:y,c=et(c)?pt:c,d=(h=dt(n,e,i,o,5,o-10,m)).left,l=h.width,v=h.top,F=h.height,vt(t,n,e,i,o),t.beginPath(),t.strokeStyle=c,t.fillStyle=c,b=It(u,!(t.lineWidth=2)),w=0,D=u.length;w<D;w++)if(N=(H=u[w]).key,$=H.value,p=d+(m?-1:1)*l*(N-s)/(f-s),p=m?(p=ot(p,d),ut(p,d-l)):(p=ut(p,d),ot(p,d+l)),p=nt(p),1===y)ht(t,m,N=v+F/2-(_=(_=$/2*F/b)<.5?.5:_),p,S=v+F/2+_,p,p,N,p,S);else if(4===y)ht(t,m,v,p,v+(_=(_=$*F/b)<1?1:_),p,p,v+F,p,v+F-_);else if(6===y)ht(t,m,v,p,v+F,p,p,v,p,v+F);else for(P=2,x=1;x<=$;x++){switch(y){case 2:g=v+F/2-5-($/2-x)*F/b;break;case 3:g=v+F-5-(k=ar($,F,3,H.randomNumbers))[x-1];break;default:g=v+F-x*F/b}g=nt(g),t.beginPath(),t.fillRect(m?g:p,m?p:g,2,2)}a&&ht(t,m,v-5,p=d-(m?1:-1)*l*((C=sr(u))-s)/(f-s),v+F+5,p,p,v-5,p,v+F+5,mt),t.restore()}}function ar(t,r,n,e){for(var i,o,u,a,s,f,i=[],o=ut(100,10*t),u=0,a=[],s=0;i.length<t;)f=T(e[s]*r),s++,(o<u||fr(f,a))&&(i.push(f),a.push([f-n,f+n])),u++;return i}function sr(t){for(var r,n,e,i,o,r=0,n=0,e=0,i=t.length;e<i;e++)n+=(o=t[e]).value,r+=o.key*o.value;return 0===n?0:r/n}function fr(t,r){for(var n,e,i,n=0,e=r.length;n<e;n++)if((i=r[n])[0]<=t&&t<=i[1])return;return 1}function yr(i,t,r,n,e,o,u){var a,s,f,y,c,m,M,h,d,l,E,v,F,p,j,g,t,t,b,_,w,D,H,N,$,S,P,x,N,k,C,A,T,a=t.points,s=a&&a.length,f=t.colorRange,y=t.labelRange,c=t.maximum,m=t.targetRed,M=t.targetGreen,h=t.targetBlue,d=t.targetYellow,l=t.color,E=t.highlightPosition,v=t.vertical,F=t.textOrientation,p=t.textSize,j=5;if(!(et(a)||s<=0)){if(l=et(l)?pt:l,et(f)||f.length!==s||cr(f))for(f=[],g=0;g<s;g++)f.push(W(l,1+g/s));for(t=zt(a,function(t){return 0<t}),c=et(c)||c<t?t:c,F=et(F)?0:F,p=et(p)||p<=0?10:p,p=ft(p)?p:p*u.zoomFactor,t=dt(r,n,e,o,5,o-10,v),b=t.left,_=t.width,w=t.top,D=t.height,i.save(),H=b,k=0,C=s;k<C;k++)(N=a[k])<=0||(N=N/c*_,x=v?($=r+.15*e,P=.7*e,S=H-N,N):($=H,P=N,S=n+.15*o,.7*o),A=k+1===E?mt:f[k],i.save(),i.fillStyle=A,i.fillRect($,S,P,x),(T=y&&y[k])&&(i.save(),i.fillStyle=Gt(A),i.textBaseline=Q,i.textAlign=X,i.font=p+tt,i.rect($,S,P,x),i.clip(),1===F?(i.translate($+P/2,S),i.rotate(Math.PI/2),i.fillText(T,x/2,0)):i.fillText(T,$+P/2,S+x/2),i.restore()),H+=(v?-1:1)*N,i.restore());O(Y,m,function(t){return 0<t}),O(J,M),O(K,h),O("yellow",d),i.restore()}function O(t,r,n){var e,n;r!==it&&r!==R&&(r=c<r?c:r,!n||n(r))&&(n=(r=r<0?0:r)/c*_,v?(e=nt(b-n)-.5,L(i,w,e,w+D,e,t)):(e=nt(b+n)-.5,L(i,e,w,e,w+D,t)))}}function cr(t){for(var r=0,n=t.length;r<n;r++)if(et(t[r]))return 1}function mr(t,r,n,e,i,o){L(t,y(r),y(n),y(e),y(i),et(o)?V:o,1)}function Mr(n,e,i,t,r){var t,o,u,a,s,f,t=.4*t;switch(e=y(e),i=y(i),n.beginPath(),n.moveTo(e,i),o=t/2,u=G(3)*t/2,a=t/G(3),r){case 0:s=[-o,0,o],f=[u,a,u];break;case 2:s=[-o,0,o],f=[-u,-a,-u];break;case 3:s=[u,a,u],f=[-o,0,o];break;case 1:s=[-u,-a,-u],f=[-o,0,o];break;default:s=[],f=[]}s.forEach(function(t,r){n.lineTo(y(e+t),y(i+f[r]))}),n.lineTo(e,i),n.closePath(),n.fillStyle=$,n.fill()}function hr(t,r,n,e,i,o,u){var a,s,f,y,n,c,m,M,h,d,l,v,F,p,a,y,g,n,F,n,n,t,b,a=n.value,s=n.colorScheme,f=n.axisVisible,y=n.barHeight,n=n.barWidth,c=5,m=5,M=!1,a=yt(a);if(!ft(a)){if(et(y=0===t?y:n))g=.7;else{if(ft(y)||y<=0)return;g=Math.min(1,y)}1<a?(a=1,M=!0):a<-1&&(a=-1,M=!0),s=et(s)?"grey":s,f=!!et(f)||f,r.save(),0===t?(n=o-10,F=u*g,F=0<=a?(M&&(h=new D(H(e+5+n-5,i+u/2))),d=new Pt(Rt(e+5,i+u*(1-g)/2,n*a,F)),l=new D(H(e+5,i+1)),v=new D(H(e+5,i+u)),1):(n=at(n*a),M&&(h=new D(H(e+5+5,i+u/2))),d=new Pt(Rt(e+o-5-n,i+u*(1-g)/2,n,F)),l=new D(H(e+o-5,i+1)),v=new D(H(e+o-5,i+u)),3),p=et(y)?u:u*g):1===t&&(n=u-10,t=o*g,v=0<=a?(d=new Pt(Rt(e+(1-g)/2*o,i+u-5-(b=n*a),t,b)),M&&(h=new D(H(e+o/2,i+u-5-b+5)),F=0),l=new D(H(e+1,i+u-5)),new D(H(e+o,i+u-5))):(a=at(a),d=new Pt(Rt(e+(1-g)/2*o,i+5,t,n*a)),M&&(h=new D(H(e+o/2,i+5+n-5)),F=2),l=new D(H(e+1,i+5)),new D(H(e+o,i+5))),p=et(y)?o:o*g),r.beginPath(),d&&(lt(r,d.x,d.y,d.width,d.height,s),vt(r,d.x,d.y,d.width,d.height)),h&&Mr(r,h.x,h.y,p,F),r.restore(),f&&l&&mr(r,l.x,l.y,v.x,v.y),r.restore()}}function y(t){return nt(t)-.5}function dr(t,r,n,e,i,o){hr(0,t,r,n,e,i,o)}function lr(t,r,n,e,i,o){hr(1,t,r,n,e,i,o)}function vr(p,t,g,b,_,w,r){var n,e,i,o,u,a,D,s,f,H,N,y,c,m,$,S,n,E,P,x,j,M,h,k,r,t,d,d,d,t,C,A,c,c,l,v,F,s,n=t.variance,e=t.reference,i=t.mini,o=t.maxi,u=t.mark,a=t.tickUnit,D=t.legend,s=t.colorPositive,f=t.colorNegative,H=t.vertical,E=.5,P=.25,j=5,M=mt,h=Ft,k=13*r.zoomFactor,r=yt(n);if(!(ft(r)||(f=et(f)?Y:f,s=et(s)?J:s,a=et(a)?0:a,o=et(o)?1:o,i=et(i)?-1:i,(n=!et(e))||(e=0),m=H?(N=b+w-5,y=w-10,c=_-20,-1):(N=g+5,y=_-10,c=w-20,1),D&&(t=yt(t.variance),ft(t)||(d=(d=t.toString()).substr(d.indexOf(".")+1).length,$=2<=d?(100*t).toFixed(d-2)+"%":(100*t).toFixed(0)+"%")),o<r&&(r=o,x=!0),r<i&&(r=i,x=!0),e=Wt(e,o,i),x&&(S=Wt(c,60,15)),t=y/(d=at(o-i)),C=N+m*at(i-e)*t,(A=at(r-e)*t)>at(d)*t&&(A=at(d+i)*t),c=N+m*y,H&&C<c)||!H&&c<C)){if(vt(p,g,b,_,w),e<r?T(s,0,5-y,y-5,0,1,b-C,Z,q,C-g-_,I,B,-1,at(o-r)*t):(A>at(d)*t&&(A=at(d+i)*t,C=N),T(f,1,-5,5,2,3,C-b-w,q,Z,g-C,B,I,1,at(i-r)*t)),n&&(c=N+m*(Math.abs(i-e)*t),O(g,c,g+_,c,c,b,c,b+w)),0<a)for(p.beginPath(),l=d/a,v=0;v<=l;v++)O(g,F=N+y/l*v*m,g+.1*_,F,F,b+.9*w,F,b+w,h,h);!et(u)&&i<=u&&u<=o&&(p.beginPath(),s=N-(H?1:-1)*at(i-u)*t,O(g,s,g+.33*_,s,s,b+.66*w,s,b+w,M,M),p.fill()),p.restore()}function T(t,r,n,e,i,o,u,a,s,f,y,c,m,M){var h,d,l,v,F,r;H?lt(p,h=g+P*_,d=0===r?C-A:C,l=.5*_,v=A,t):lt(p,h=0===r?C:C-A,d=b+P*w,l=A,v=.5*w,t),x&&(vt(p,h,d,l,v),H?Mr(p,g+_/2,N+n,S,i):Mr(p,N+e,b+w/2,S,o),p.restore()),D&&(F=void 0,r=0,x&&(r=.4*S*G(3)/2+5+2),p.save(),p.beginPath(),p.font=k+tt,p.fillStyle=V,H?(p.textAlign=X,R(F=k+A+u,M,t,a,s,h,d,l,v,H),p.fillText($,g+_/2,C+m*(A-r))):(p.textBaseline=Q,R(F=p.measureText($).width+A+f,M,t,y,c,h,d,l,v,H),p.fillText($,C+m*(r-A),b+w/2)),p.restore())}function R(t,r,n,e,i,o,u,a,s,f){f?p.textBaseline=e:p.textAlign=e,0<t&&r<A&&(p.rect(o,u,a,s),p.clip(),f?p.textBaseline=i:p.textAlign=i,p.fillStyle=Gt(n))}function O(t,r,n,e,i,o,u,a,s,f){H?mr(p,t,r,n,e,s):mr(p,i,o,u,a,f)}}function Fr(f,t,E,j,R,r){var n,e,I,i,o,u,a,s,y,c,B,m,M,h,d,i,o,u,a,l,v,F,p,g,L,E,j,R,r,G,b,_,w,z,K,J,W,D,H,N,$,S,P,x,V,U,k,C,k,C,k,Y,i,o,a,X,q,Z,A,i,o,T,O,Q,a,t,t,tt,n=t.points,e=t.boxPlotClass,I=t.showAverage,i=t.scaleStart,o=t.scaleEnd,u=t.acceptableStart,a=t.acceptableEnd,s=t.style,y=t.colorScheme,c=t.vertical,B=5,m=It(n,!1),M=It(n,!0);if(!(et(n)||(n=Jt(n)).length<=0)){for((e=e===it||typeof e!==st?Ct:e.toLocaleLowerCase())!==Ct&&e!==kt&&e!==At&&e!==Tt&&e!==Ot&&(e=Ct),h=yt(i),h=ft(h)?M:h,d=yt(o),d=ft(d)?m:d,i=yt(u),o=yt(a),y!==it&&typeof y===st||(y="#D2D2D2"),(s===it||0!==s&&1!==s)&&(s=0),u=mt,M<h&&(y=u,h=M),d<m&&(y=u,d=m),vt(f,E,j,R,r),f.lineWidth=2,l=(a=dt(E,j,R,r,5,r-10,c)).left,v=a.width,F=a.top,p=a.height,g=c?-1:1,L=t.perc02,E=t.perc09,j=t.perc10,R=t.perc90,r=t.perc91,G=t.perc98,b=t.q1,z=M,K=m,W=J=1.5*(w=(_=t.q3)-b),D=t.stDev,H=zt(n)/ut(1,n.length),$=N=0,S=F+.1*p,P=.7*p,x=at(d-h),V=0,U=n.length;V<U;V++)(k=n[V])<b&&b-1.5*w<=k&&k-(b-1.5*w)<J&&(J=k-(b-1.5*w),z=k),_<k&&k<=_+1.5*w&&_+1.5*w-k<W&&(W=_+1.5*w-k,K=k),C=!1,N=l+v*((k-h)/x)*g,e===At&&(k<=b-1.5*w||_+1.5*w<=k)&&(C=!0,$=k<=b-3*w||_+3*w<=k?0:1),e===kt&&(k<=L||G<=k)&&(C=!0,$=1),e===Ot&&(k<=H-2*D||H+2*D<=k)&&(C=!0,$=k<=H-3*D||H+3*D<=k?0:1),k=Ft,C&&(1===s?1===$?nt(.2,.8,N,k):nt(.3,.7,N,k):((C=.1*p)<2&&(C=2),f.beginPath(),f.strokeStyle=k,k=F+.45*p,Y=N,f.arc(c?k:Y,c?Y:k,C/2,0,2*Math.PI),f.stroke()));switch((i<h||d<o)&&(y="#C0FF00"),i=ut(h,i),(o=ot(d,o))<i?y=u:i<o&&ht(f,c,a=F+.9*p,i=l+v*((i-h)/x)*g,a,o=l+v*((o-h)/x)*g,i,a,o,a,pt),q=at(l+v*((_-h)/x)*g-(X=l+v*((b-h)/x)*g)),A=l+v*(((Z=t.median)-h)/x)*g,e){case kt:T=L,O=G;break;case At:T=z,O=K;break;case Ot:q=at(l+v*((H+D-h)/x)*g-(X=l+v*((H-D-h)/x)*g)),A=l+v*((H-h)/x)*g,T=h<(Q=H-2*D)?Q:M,O=(Q=H+2*D)<d?Q:m,I=!1;break;default:T=M,O=m}i=l+v*((T-h)/x)*g,o=l+v*((O-h)/x)*g,a=Ft,1===s?rt("#F2F2F2",S,o,P,i-o,i,S,o-i,P):ht(f,c,t=F+.45*p,i,t,o,i,t,o,t,a),rt(y,S,X-q,P,q,X,S,q,P),ht(f,c,S,A,S+P,A,A,S,A,S+P,a),0===s&&(ht(f,c,S+.3*P,o,S+.7*P,o,o,S+.3*P,o,S+.7*P,a),ht(f,c,S+.3*P,i,S+.7*P,i,i,S+.3*P,i,S+.7*P,a)),e!==kt&&e!==Tt||(tt=t=void 0,O=e===kt?(T=E,r):(T=j,R),t=l+v*((T-h)/x)*g,nt(.3,.7,tt=l+v*((O-h)/x)*g,a),nt(.3,.7,t,a)),I&&nt(.2,.8,N=l+v*((H-h)/x)*g,u),f.restore()}function rt(t,r,n,e,i,o,u,a,s){c?lt(f,r,n,e,i,t):lt(f,o,u,a,s,t)}function nt(t,r,n,e){ht(f,c,S+P*t,n,S+P*r,n,n,S+P*t,n,S+P*r,e)}}function pr(t,r,n,e,i){r=nt(r),n=nt(n),r===(e=nt(e))&&(r=e-=.5),n===(i=nt(i))&&(n=i-=.5),t.moveTo(r,n),t.lineTo(e,i)}function U(t,r,n,e,i,o,u,a,s,f,y){t.beginPath(),t.strokeStyle=n,r?pr(t,e,i,o,u):pr(t,a,s,f,y),t.stroke()}function gr(t,r,n,e,i){t.rect(r,n,e,i),t.clip()}function br(t,r,n,e,i,o){var u,a,s,f,y,c,m,M,h,d,l,v,F,o,u=o.labelText,a=o.fontSize,s=o.startBox,f=o.endBox,y=o.boxColor,c=o.isInRightOrTopOfBox,m=o.fillStyle;t.save(),t.beginPath(),t.font=a+tt,l=1,m=et(m)?V:m,o.vertical?(v=X,c?0<(M=a+f-(s-n))&&s-f-n<f?(F=q,m=Gt(y),d=s-f+1,gr(t,r,s-f,e,f)):(F=Z,d=s-f-1):d=0<(M=a-(n+i-s))&&n+i-s<f?(gr(t,r,s-f,e,f),F=Z,m=Gt(y),s-1):(F=q,s+1),t.textAlign=v,t.textBaseline=F,t.fillStyle=m,t.fillText(u,r+e/2,d)):(F=Q,o=t.measureText(u),c?h=0<(M=o.width+f-(r+e-s))&&r+e-(s+f)<f?(gr(t,s,n,f,i),v=B,m=Gt(y),s+f-1):(v=I,s+f+1):0<(M=o.width-(s-r))&&s-r<f?(gr(t,s,n,f,i),h=s+1,v=I,m=Gt(y)):(v=B,h=s-1),t.textAlign=v,t.textBaseline=F,t.fillStyle=m,t.fillText(u,h,n+i/2)),t.restore()}function _r(t,r,n,e,i,o,E){var u,a,j,s,f,y,c,m,R,r,I,E,M,h,j,y,c,B,d,l,v,F,p,g,b,_,w,D,L,H,G,N,$,z,S,K,P,x,s,f,f,s,k,C,f,A,J,k,x,P,T,A,x,S,O,T,O,r,T,u=r.points,a=r.labels,j=r.pointIndex,s=r.minimum,f=r.maximum,y=r.colorPositive,c=r.colorNegative,m=r.vertical,R=r.itemTypeRange,r=r.colorTotal,I=5,E=13*E.zoomFactor;if(!et(u)&&!((M=u.length)<=0||(h=parseInt(j,10),ft(h))||h<=0||M<h)){for(a=et(a)?[]:a,c!==it&&typeof c===st||(c="#D6604D"),typeof r!==st&&(r=it),y=W(j=y=y!==it&&typeof y===st?y:"#8CBF64",1.3),B=W(c=c,1.3),d=1,g=[],D=_=b=p=F=v=l=0,L=M;D<L;D++)_=u[D],w=R[D],H=!1,G=1===d,(N=!et(w))&&(w===bt?_=at(_):w===gt?_=-at(_):w===_t?(H=!0,G?l=_:_=l):N=!1),g[d]=[],$=g[d],ft(_)?($[0]=0,$[1]=l,$[2]=0):($[0]=at(_),l=H?l:_+l,$[1]=0<_?v:l,$[2]=_),$[3]=d,F=ot(v,F),p=ut(v,p),((z=d===M)&&!N||H)&&(b=F<0?-F:0,$[1]=0<_?0:_),N&&H&&!G||(v=_+v,z&&N&&(F=ot(v,F),p=ut(v,p))),d++;S=!1,et(w)||(S=-1===(K=[gt,bt,_t]).indexOf(w)),(et(w)||S)&&(l-=_),s=yt(s),ft(s)||0<s||F<s?s=P=F:b=-(P=s),f=yt(f),ft(f)||f<0||f<p?x=p:(x=f,b=-s),s=(f=dt(n,e,i,o,5,o-10,m)).left,k=f.width,C=f.top,f=f.height,A=m?-1:1,k=k/(J=x-P),vt(t,n,e,i,o),t.beginPath(),t.lineWidth=1,P=(x=g[h])[2],T=R[h-1],A=s+A*(x[1]+b)*k,x=x[0]*k,O=T===_t,T=(et(T)||S)&&h===M||O,S=r&&T?r:1===h||T?0<=P?j:c:0<=P?y:B,m?lt(t,C,A-x,f,x,S):lt(t,A,C,x,f,S),m?(1!==h&&(h!==M?U(t,0<P,Mt,n,A,C+f,A,n,A-x,C+f,A-x):U(t,!0,Mt,n,O=s-(l+b)*k,C+f,O)),h!==M&&U(t,0<P,Mt,C,A-x,n+i,A-x,C,A,n+i,A)):(1!==h&&(h!==M?U(t,0<P,Mt,A,e,A,C+f,A+x,e,A+x,C+f):U(t,!0,Mt,r=s+(l+b)*k,e,r,C+f)),h!==M&&U(t,0<P,Mt,A+x,C,A+x,e+o,A,C,A,e+o)),T=a[h-1],0<a.length&&!et(T)&&""!==T&&br(t,n,e,i,o,{labelText:T,vertical:m,isInRightOrTopOfBox:0<P,fontSize:E,startBox:A,endBox:x,boxColor:S}),U(t,m,V,n,s-b*k,n+i,s-b*k,s+b*k,e,s+b*k,e+o),t.restore()}}function wr(n,t,e,i,o,u,r){var a,s,f,y,c,m,M,h,r,d,l,v,t,F,p,s,g,b,_,w,D,H,N,F,E,M,$,S,t,F,P,M,x,k,C,A,m,T,f,O,a=t.points,s=t.pointIndex,f=t.colorRange,y=t.target,c=t.target2,m=t.highlightPosition,M=t.label,h=t.vertical,r=13*r.zoomFactor,d=t.targetColor,l=t.target2Color,v=t.labelColor,t=t.barSize;if(!et(a)&&(et(t)||!(ft(t)||t<=0))&&(1<t&&(t=1),!((F=a.length)<=0||(p=parseInt(s,10),ft(p))||p<=0||F<p))){for(f=et(f)?[]:f,s=parseInt(M,10),s=ft(s)?0:s,g=1,_=[],w=b=0,D=a.length;w<D;w++)H=a[w],_[g]=[],N=_[g],H<0||ft(H)||et(H)?(N[0]=1===g?0:b,N[1]=0):(b+=H,N[0]=1===g?0:b-H,N[1]=H),g++;E=5,F=et(t)?5:h?o*(1-t)/2:u*(1-t)/2,M=dt(e,i,o,u,F,u-10,h,5),$=M.left,S=M.width,t=M.top,F=M.height,P=h?-1:1,M=S/b,vt(n,e,i,o,u),n.beginPath(),n.lineWidth=1,k=(x=_[p])[1],C=$+P*x[0]*M,A=x[1]*M,m=p===m?mt:0===f.length||typeof f[p-1]!==st?Ft:f[p-1],h?lt(n,t,C-A,F,A,m):lt(n,C,t,A,F,m),1===s?T=(x[0]+k)/b*1e3:2===s&&(T=k/b*1e3),f=nt(T)/10+"%",1!==s&&2!==s||!f||br(n,e,i,o,u,{labelText:f,vertical:h,isInRightOrTopOfBox:(x[0]+x[1])*M<S/2,fontSize:r,startBox:C,endBox:A,boxColor:m,fillStyle:v}),O=[et(d)?"#8CBF64":d,et(l)?"#EE5D5D":l],[y,c].forEach(function(t,r){var t,t,t=j(t),t=z($+P*S*t);U(n,h,O[r],e,t,e+o,t,t,i,t,i+u)}),n.restore()}function j(t){var t=yt(t),t;return t=1<(t=(t=ft(t)?0:t)<0?0:t)?1:t}}function Dr(t,r){switch(r){case 2:var n;return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function Hr(t,r,n){var r,n,e,i,o,r;return 1<(t=t<0?0:t)&&(t=1),r=h(r),n=h(n),e=r.a*(1-t)+n.a*t,i=r.r*(1-t)+n.r*t+"",o=r.g*(1-t)+n.g*t+"",r=r.b*(1-t)+n.b*t+"","rgba("+parseInt(i,10)+","+parseInt(o,10)+","+parseInt(r,10)+","+yt(e/255+"")+")"}function Nr(t,r,n){return t===r&&t===n?1:t<=r?0:n<=t?1:(t-r)/(n-r)}function $r(t,r,n,e,i,o){var u=(o+i)/2;return i<=e&&e<=u?Hr(Nr(e,i,u),t,r):Hr(Nr(e,u,o),r,n)}function Sr(t){var r=ct,n=-ct;return t.forEach(function(t){t!==it&&t!==R&&(t<r&&(r=t),n<t)&&(n=t)}),{min:r,max:n}}function Pr(t,n,e,i,o,u,a){var r,s,f;i?t.forEach(function(t,r){0!==t&&t!==it&&t!==R&&(n[e+r]=i[r]||n[e+r])}):(r=Sr(t),s=r.min,f=r.max,t.forEach(function(t,r){0!==t&&t!==it&&t!==R&&(n[e+r]=$r(o,u,a,t,s,f))}))}function xr(t,r,n,e,i,o){for(var u,a,s,f,y,c,m,M,h,d,l,v,F,p,g,b,_,w,D,u=r.year,a=r.month,s=r.values,f=r.emptyColor||"lightgray",y=r.startColor,c=r.middleColor,m=r.endColor,M="white",h=6,d=7,l=2,v=(i-14)/6,F=(o-16)/7,p=[],g=new Date(u,a-1,1).getDay(),b=0;b<42;b++)!(b<g)&&b<g+Dr(u,a)?p[b]=f:p[b]=M;for(Pr(s,p,g,r.colors,y,c,m),t.save(),t.rect(n,e,i,o),t.clip(),t.beginPath(),w=_=0;w<6;w++)for(D=0;D<7;D++)t.fillStyle=p[_],_++,t.fillRect(n+w*v+2*(w+1),e+D*F+2*(D+1),v,F);t.restore()}function kr(t){for(var r,n,e,i,r=t.getFullYear(),n=t.getMonth(),e=t.getDate(),i=1;i<n+1;i++)e+=Dr(r,i);return e}function Cr(t,r,n,e,i,o,u){for(var a,s,f,y,c,m,M,E,h,d,l,v,F,s,r,p,g,y,c,j,b,_,w,D,H,N,$,S,P,x,k,C,A,A,T,O,a=r.year,s=r.values,f=r.emptyColor||"lightgray",y=r.startColor,c=r.middleColor,m=r.endColor,M="white",E=7,h=parseInt(366/7+"",10)+2,d=[],l=new Date(a,0,1).getDay(),v=kr(new Date(a,11,31)),F=0;F<7*h;F++)d[F]=!(F<l)&&F<l+v?f:M;for(Pr(s,d,l,r.colors,y,c,m),t.save(),t.rect(n,e,i,o),t.clip(),p=n+(r=15*(s=u.zoomFactor)),g=e,y=i-r,c=o,t.save(),t.translate(n+r/2,g+c),t.rotate(-Math.PI/2),t.font=13*s+tt,t.fillStyle="black",t.textBaseline="middle",t.textAlign="center",t.fillText(a+"",c/2,0),t.restore(),b=(y-(j=2)*(h+1))/h,_=(c-16)/7,$=[],H=w=0;H<h;H++)for(D=0;D<7;D++)$[w]=N={x:p+H*b+2*(H+1),y:g+D*_+2*(D+1),w:b,h:_},t.fillStyle=d[w],w++,t.fillRect(N.x,N.y,N.w,N.h);for(S=[],P={},x=0;x<12;x++)P[x]=kr(new Date(a,x,1))-1+l;for(k=P[11]+Dr(a,12)-1,H=w=0;H<h;H++)for(D=0;D<7;D++)l<=w&&w<l+v&&(A=(C=new Date(a,0,w-l+1)).getMonth(),N=$[w],(A=P[A])<=w&&w<7+A&&S.push({x1:N.x,y1:N.y-1,x2:N.x,y2:N.y+N.h+1}),w!==A&&0!==C.getDay()||S.push({x1:N.x-1,y1:N.y,x2:N.x+N.w+1+(w===A?2:0),y2:N.y}),k-7<w&&w<=k&&S.push({x1:N.x+N.w,y1:N.y-1,x2:N.x+N.w,y2:N.y+N.h+1}),w!==k&&6!==C.getDay()||S.push({x1:N.x-1-(w===k?2:0),y1:N.y+N.h,x2:N.x+N.w+1,y2:N.y+N.h})),w++;for(t.strokeStyle="black",t.lineWidth=2,T=0;T<S.length;T++)O=S[T],t.beginPath(),t.moveTo(O.x1,O.y1),t.lineTo(O.x2,O.y2),t.stroke();t.restore()}function Ar(t){var r,n,e,i,o,u,a,s,f,y,r=Kt(t.minAngle-90),n=Kt(t.maxAngle-90),e=t.minValueOption.value,i=t.maxValueOption.value,o=t.ranges,u=l,a=(n-r)/(i-e),s=[];return 0<o.length&&o.forEach(function(t){f=t.start,y=t.end,s.push({start:a*(f-e)+r,end:a*(y-e)+r,color:t.color})}),s.unshift({start:r,end:n,color:u}),{paintRanges:s,fillColor:u,targetValueRadian:a*(t.targetValueOption.value-e)+r,currentValueRadian:a*(t.currentValueOption.value-e)+r,minValueRadian:r,maxValueRadian:n}}function Tr(t,r,n,e,i,o,u){var o,a,s,f,y,c,o,m,y,M,h,d,l,v,c,F,u,o=o.zoomFactor,a=t.currentValueOption.normalFontHeight*o,s=t.minValueOption.normalFontHeight*o,f=t.maxValueOption.normalFontHeight*o,y=t.minAngle,c=t.maxAngle,o=t.currentValueOption.normalFontWidth*o,m=90<at(y)||90<at(c),y=120<at(y)||120<at(c),c=b*ot(e,i);return u?(M=T(e/2*g),h=T(i*g),u=.03*(l=ot(M,d=m?h/2:h)),v={x:r+e/2,y:n+i/2+(m?0:l/2),outerRadius:l,innerRadius:l*t.radiusRatio,currentValuePoint:R,enoughShowCurrentLabel:!1,enoughShowTargetLabel:!0,enoughShowMinLabel:s<(F=(i-(m?2*l:l))/2),enoughShowMaxLabel:f<F,moreThanSemiCircle:m},m?y?2*a/3<F-u-ut(f,s)&&o<e-2*c&&(v.currentValuePoint={x:v.x,y:v.y+l+u+a/2+ut(f,s)},v.enoughShowCurrentLabel=!0):2*a/3<i/2-u&&o<e-2*c&&(v.currentValuePoint={x:v.x,y:v.y+2*u+a},v.enoughShowCurrentLabel=!0):a<F-u&&o<e-2*c&&(v.currentValuePoint={x:v.x,y:v.y+a},v.enoughShowCurrentLabel=!0)):(M=T(e/2*p),h=T(i*p),l=ot(M,d=m?h/2:h),v={x:r+e/2,y:n+i/2+(m?0:l/2),outerRadius:l,innerRadius:l*t.radiusRatio}),v}function Or(t,r,n,e){return{x:t+N(n)*e,y:r+k(n)*e}}function Er(t,r){return at(r.x-t.x)<.01?{x:r.x,y:r.y,textAlign:X}:r.x>t.x?{x:r.x+u,y:r.y,textAlign:I}:r.x<t.x?{x:r.x-u,y:r.y,textAlign:B}:{x:r.x,y:r.y,textAlign:I}}function jr(r,t,n,e,i,o,u){var a,s,n,e,f,y,u,c,m,M,h,d,h,l,h,h,s,v,F,p,g,b,_,w,D,H,u,_,b,p,u,v,_,g,b,F,w,p,a=u.zoomFactor,s=!!et(t.showLabel)||t.showLabel,n=Tr(t,n,e,i,o,u,s);if(!(n.outerRadius<=0))return e={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},f=n.innerRadius,y=n.outerRadius,u=n.currentValuePoint,c=n.moreThanSemiCircle,m={x:n.x,y:n.y},h=(M=Ar(t)).paintRanges,d=M.fillColor,r.save(),h.forEach(function(t){r.beginPath(),r.strokeStyle=$,r.moveTo(m.x,m.y),r.fillStyle=t.color||d,r.arc(m.x,m.y,y,t.start,t.end,!1),r.lineTo(m.x,m.y),r.closePath(),r.fill(),r.stroke(),r.beginPath(),r.fillStyle=$,r.strokeStyle=$,r.moveTo(m.x,m.y),r.arc(m.x,m.y,f,t.start-St,t.end+St,!1),r.lineTo(m.x,m.y),r.closePath(),r.fill(),r.stroke()}),r.beginPath(),r.moveTo(m.x,m.y),r.fillStyle=V,r.arc(m.x,m.y,y*O,0,2*rt,!1),r.fill(),h=Or(m.x,m.y,M.targetValueRadian,f),l=Or(m.x,m.y,M.targetValueRadian,y*P),Lt(r,h.x,h.y,l.x,l.y,Dt,Ht,S),h=Or(m.x,m.y,M.currentValueRadian,y*P),L(r,m.x,m.y,h.x,h.y,V,j*y),s&&(r.save(),r.beginPath(),r.textAlign=A,r.fillStyle=S,h=t.minValueOption.normalFontHeight*a,s=t.maxValueOption.normalFontHeight*a,v=t.minValueOption.normalFontWidth*a,F=t.maxValueOption.normalFontWidth*a,p=M.minValueRadian,g=M.maxValueRadian,b=t.currentValueOption.normalFontHeight*a,_=t.currentValueOption.normalFontWidth*a,H=D=w=void 0,n.enoughShowCurrentLabel&&(x(r,u.x,u.y,t.currentValueOption.label,t.currentValueOption.fontAfterZoom,X),e.showCurrentLabel=!0,w={x:u.x-_/2,y:u.y-b,width:_,height:b}),n.enoughShowMinLabel&&at(N(p)*y)+v<i/2-$t&&(u=Or(m.x,m.y,M.minValueRadian,y),Vt(D={x:(_=Er(m,u)).x-v,y:_.y,width:v,height:h},w)||(x(r,_.x,_.y+T(h),t.minValueOption.label,t.minValueOption.fontAfterZoom,B),e.showMinLabel=!0)),n.enoughShowMaxLabel&&at(N(g)*y)+F<i/2-$t&&(b=Or(m.x,m.y,M.maxValueRadian,y),Vt(H={x:(p=Er(m,b)).x,y:p.y,width:F,height:s},w)||(x(r,p.x,p.y+T(s),t.maxValueOption.label,t.maxValueOption.fontAfterZoom,I),e.showMaxLabel=!0)),n.enoughShowTargetLabel&&(u=t.targetValueOption.normalFontWidth*a,v=t.targetValueOption.normalFontHeight*a,_=t.targetValueOption.label,l=Or(m.x,m.y,M.targetValueRadian,g=y+3*v/2),b=Er(m,l),F=M.targetValueRadian,w=c?(o-2*g)/2+g:o-(o-y)/2,at(N(F)*g)+u<i/2-$t)&&at(k(F)*g)+v/2+$t/2<w&&(p=ut(h,s)/2,x(r,b.x,b.y-(rt<F?p:-p),_,t.targetValueOption.fontAfterZoom,b.textAlign),e.showTargetLabel=!0),r.restore()),r.restore(),e}function Rr(t,r,n,e,i,o){var o,u,a,s,f,y,c,m,M,t,h,d,o,r,o=o.zoomFactor,u=t.showLabel,a=t.minValueOption.normalFontHeight*o,s=t.maxValueOption.normalFontHeight*o,f=t.targetValueOption.normalFontHeight*o,y=t.currentValueOption.normalFontHeight*o,c=t.minValueOption.normalFontWidth*o,m=t.maxValueOption.normalFontWidth*o,M=t.targetValueOption.normalFontWidth*o,t=t.currentValueOption.normalFontWidth*o,o=.05*e,h=T(i*v),d=T(e*F),r={x:r+e*(1-F)/2,y:n+i*(v+(1-v)/2),graphWidth:d,graphHeight:h,targetValuePoint:R,currentValuePoint:R,minValuePoint:R,maxValuePoint:R};return u&&(a<(i-h)/2&&c<(e-d)/2-o&&(r.minValuePoint={x:r.x-c,y:r.y+a/3},r.enoughShowMinLabel=!0),s<(i-h)/2&&m<(e-d)/2-o&&(r.maxValuePoint={x:r.x-m,y:r.y-h+s/3},r.enoughShowMaxLabel=!0),(f<(i-h)/2||f/2<h)&&M<(e-d)/2-o-ut(c,m)&&(r.targetValuePoint={x:r.x-M-ut(c,m),y:R},r.enoughShowTargetLabel=!0),y<(i-h)/2||y/2<h)&&t<(e-d)/2-o&&(r.currentValuePoint={x:r.x+d+o,y:R},r.enoughShowCurrentLabel=!0),r}function Ir(t,r){var n,e,i,o,u,a,s,f,n=t.minValueOption.value,e=t.maxValueOption.value,i=t.ranges,o=l,u=r.graphHeight/(e-n),a=[];return 0<i.length&&i.forEach(function(t){s=t.start,f=t.end,a.push({start:r.y-u*(s-n),height:u*(f-s),color:t.color})}),a.unshift({start:r.y,height:r.graphHeight,color:o}),{paintRanges:a,fillColor:o,targetValueY:r.y-u*(t.targetValueOption.value-n),currentValueY:r.y-u*(t.currentValueOption.value-n)}}function Br(r,t,n,e,i,o,u){var a,s,f,y,c,m,n,M,i,u,h,d,l,v,F,t,p,g,b,_,w,a=u.zoomFactor,s=t.showLabel,f=t.minValueOption,y=t.maxValueOption,c=t.currentValueOption,m=t.targetValueOption,n=Rr(t,n,e,i,o,u),M=n.graphWidth,i=n.graphHeight;if(!(M<=0||i<=0))return u={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},h=n.currentValuePoint,d=n.targetValuePoint,l=n.minValuePoint,v=n.maxValuePoint,F={x:n.x,y:n.y},p=(t=Ir(t,n)).paintRanges,g=c.normalFontHeight*a,b=m.normalFontHeight*a,_=t.targetValueY,w=t.currentValueY,r.save(),p.forEach(function(t){lt(r,F.x,t.start,M,-t.height,t.color)}),Lt(r,F.x-(P-1)*M,_,F.x+M,_,Dt,Ht,S),L(r,F.x,w,F.x+M*P,w,V,wt*i),s&&(r.save(),r.beginPath(),n.enoughShowMinLabel&&(x(r,l.x,l.y,f.label,f.fontAfterZoom,I,S),u.showMinLabel=!0),n.enoughShowMaxLabel&&(x(r,v.x,v.y,y.label,y.fontAfterZoom,I,S),u.showMaxLabel=!0),n.enoughShowTargetLabel&&!(o<_-e+b/2||_-e-Nt<0)&&(x(r,d.x,t.targetValueY+m.normalFontHeight*a/3,m.label,m.fontAfterZoom,I,S),u.showTargetLabel=!0),n.enoughShowCurrentLabel&&!(o<w-e+g/2||w-e-Nt<0)&&(x(r,h.x,t.currentValueY+c.normalFontHeight*a/3,c.label,c.fontAfterZoom,I,S),u.showCurrentLabel=!0),r.restore()),r.restore(),u}function Lr(t,r,n,e,i,o){var o,u,a,s,f,y,c,m,M,t,h,d,o,r,o=o.zoomFactor,u=t.showLabel,a=t.minValueOption.normalFontHeight*o,s=t.maxValueOption.normalFontHeight*o,f=t.targetValueOption.normalFontHeight*o,y=t.currentValueOption.normalFontHeight*o,c=t.minValueOption.normalFontWidth*o,m=t.maxValueOption.normalFontWidth*o,M=t.currentValueOption.normalFontWidth*o,t=t.targetValueOption.normalFontWidth*o,o=.1*ot(e,i),h=T(i*F),d=T(e*v),r={x:r+e*(1-v)/2,y:n+i*(1-F)/2,graphWidth:d,graphHeight:h,targetValuePoint:R,currentValuePoint:R,minValuePoint:R,maxValuePoint:R};return u&&((M<3*(e-d)/4||M<d)&&y<(i-h)/2-$t&&(r.currentValuePoint={x:R,y:r.y-y/2},r.enoughShowCurrentLabel=!0),(t<3*(e-d)/4||t<d)&&f<(i-h)/2-ut(a,s)&&(r.targetValuePoint={x:R,y:r.y+h+ut(a,s)+f/4*3},r.enoughShowTargetLabel=!0),c<3*(e-d)/4&&a<(i-h)/2-o&&(r.minValuePoint={x:r.x-c/2,y:r.y+h+a},r.enoughShowMinLabel=!0),m<3*(e-d)/4)&&s<(i-h)/2-o&&(r.maxValuePoint={x:r.x+d-m/2,y:r.y+h+s},r.enoughShowMaxLabel=!0),r}function Gr(t,r){var n,e,i,o,u,a,s,f,n=t.minValueOption.value,e=t.maxValueOption.value,i=t.ranges,o=l,u=r.graphWidth/(e-n),a=[];return 0<i.length&&i.forEach(function(t){s=t.start,f=t.end,a.push({start:r.x+u*(s-n),width:u*(f-s),color:t.color||o})}),a.unshift({start:r.x,width:r.graphWidth,color:o}),{paintRanges:a,fillColor:o,targetValueX:r.x+u*(t.targetValueOption.value-n),currentValueX:r.x+u*(t.currentValueOption.value-n)}}function zr(r,t,n,e,i,o,u){var a,s,f,y,c,m,e,o,M,u,h,d,l,v,F,t,p,g,b,_,t,a=u.zoomFactor,s=t.showLabel,f=t.minValueOption,y=t.maxValueOption,c=t.currentValueOption,m=t.targetValueOption,e=Lr(t,n,e,i,o,u),o=e.graphWidth,M=e.graphHeight;if(!(o<=0||M<=0))return u={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},h=e.currentValuePoint,d=e.targetValuePoint,l=e.minValuePoint,v=e.maxValuePoint,F={x:e.x,y:e.y},p=(t=Gr(t,e)).paintRanges,g=c.normalFontWidth*a,b=m.normalFontWidth*a,_=t.targetValueX,t=t.currentValueX,r.save(),p.forEach(function(t){lt(r,t.start,F.y,t.width,M,t.color)}),Lt(r,_,F.y,_,F.y+M*P,Dt,Ht,S),Bt(r,t,F.y+M-1,t,F.y-M*(P-1)-1,V,o*wt),s&&(r.save(),e.enoughShowMinLabel&&(x(r,l.x,l.y,f.label,f.fontAfterZoom,I,S),u.showMinLabel=!0),e.enoughShowMaxLabel&&(x(r,v.x,v.y,y.label,y.fontAfterZoom,I,S),u.showMaxLabel=!0),e.enoughShowTargetLabel&&!(i<_-n+b/2+w||_-n-b/2-w<0)&&(x(r,_-m.normalFontWidth*a/2,d.y,m.label,m.fontAfterZoom,I,S),u.showTargetLabel=!0),e.enoughShowCurrentLabel&&!(i<t-n+g/2+w||t-n-g/2-w<0)&&(x(r,t-c.normalFontWidth*a/2,h.y,c.label,c.fontAfterZoom,I,S),u.showCurrentLabel=!0),r.restore()),r.restore(),u}function Kr(t,r,n,e,i,o,u){t.save(),t.rect(n,e,i,o),t.clip(),0===r.gaugeType?jr(t,r,n,e,i,o,u):1===r.gaugeType?Br(t,r,n,e,i,o,u):2===r.gaugeType&&zr(t,r,n,e,i,o,u),t.restore()}function Jr(t,r,n,e,i,o,u,a){var s,f,y,u,c,m,M,h,d,l,s=[],f=t.length,y=0,u=u.fontPixelSize;if(o&&(y=u+3),0!==f){for(c=e/f,m=t[0].value,M=1;M<f;M++)m=Math.max(m,t[M].value);for(h=0;h<f;h++)l=t[h].value/m*(i-y),s.push({x:r+h*c+c*(1-a)/2,textX:r+h*c,y:(d=n+i-y)-(l=l<0?0:l),width:c*a,textWidth:c,height:l,axis:t[h].axis})}return s}function Wr(t,r,n,e){t.save(),t.fillStyle=n;for(var i=0;i<r.length;i++)t.fillRect(r[i].x,r[i].y,r[i].width,r[i].height);t.restore()}function Vr(t,r,n,e){var i,o,u,a,s;for(t.save(),i=n.fontPixelSize,o=qr(n),t.textAlign="center",t.fillStyle=e,u=0;u<r.length;u++)s=a=void 0,a=r[u].x+r[u].width/2,s=r[u].y+r[u].height+5+i,t.save(),t.font=o,t.beginPath(),t.rect(r[u].textX,r[u].y+r[u].height+1,r[u].textWidth,i+3),t.clip(),t.textBaseline="bottom",t.fillText(r[u].axis,a,s),t.restore();t.restore()}function Ur(t,r,n,e){var i,o,u,a,s,o;if("none"!==e){for(t.save(),t.lineWidth=1,t.strokeStyle=e,t.beginPath(),i=0;i<r.length;i++)u=(o=r[i]).x,a=o.y,s=o.width,0===(o=o.height)||0===s||(L(t,u,a,u+s,a),L(t,u,a+o,u+s,a+o),r[i-1]&&r[i-1].height>=o&&1===n||L(t,u,a,u,a+o),r[i+1]&&r[i+1].height>o&&1===n)||L(t,u+s,a,u+s,a+o);t.stroke(),t.closePath(),t.restore()}}function Yr(t,r,n,e,i){var o,u,a,s,f,y,o=!1;for(t.save(),t.font=i,a=(n-6)/(u=r.length),s=0,f=r;s<f.length;s++)if(y=f[s],t.measureText(y.axis).width>a){o=!0;break}return t.restore(),o}function Xr(t,r,n,e,i,o,u){var a,s,f,y,c,m,M,r,h,n,e,a=r.barColor,s=r.values,f=r.paintLabel,y=r.barWidth,c=r.labelFontStyle,m=r.afterZoomFontStyle,M=r.edgeColor,r=r.labelColor;et(c)||(o<3*(h=m.fontPixelSize)||Yr(t,s,i,o,qr(m)))&&(f=!1),Wr(t,e=Jr(s,n+3,e+3,i-6,o-6,f=f&&et(c)&&(n=Math.floor(12<=o/3?12:Math.floor(o/3)),m.fontPixelSize=n,m.fontSize=n+"px",Yr(t,s,i,o,qr(m)))?!1:f,m,y),a,M),Ur(t,e,y,M),f&&Vr(t,e,m,r)}function qr(t){return"".concat(t.fontStyle," ").concat(t.fontWeight," ").concat(t.fontSize," ").concat(t.fontFamily)}function Zr(t,r,n,e,i,o,u){var n,e,i,o,a,s,f,y,r;t.save(),t.rect(n,e,i,o),t.clip(),n=r.clipX,e=r.clipY,i=r.clipWidth,o=r.clipHeight,a=r.paintX,s=r.paintY,f=r.paintWidth,y=r.paintHeight,r=r.img,0<i&&0<o&&0<f&&0<y&&t.drawImage(r,n,e,i,o,a,s,f,y),t.restore()}function Qr(t,r,n,e){this.X=t,this.Y=r,this.Width=n,this.Height=e,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height}function t(){this.Bzt=2,this.Lzt=o,this.Fzt=o,this.Pzt=ct,this.Gzt=-ct}e=this&&this.__extends||(s=function(t,r){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,r){t.__proto__=r}:function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}))(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}s(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),Object.defineProperty(c,"__esModule",{value:!0}),c.SparklineExRenders=c.SparklineRender=c.Uzt=c.Hzt=c.zzt=c.oCt=void 0,i=n("./src/common/util/types.ts"),m=n("./src/common/util/colorhelper.ts"),M=n("./src/common/util/arrayhelper.ts"),et=i.lt.ht,W=m.ft.YGt,h=m.ft._,d=M.Uf.hD,c.oCt={},it=null,R=void 0,T=Math.floor,rt=Math.PI,k=Math.sin,N=Math.cos,ot=Math.min,ut=Math.max,nt=Math.round,C=Math.pow,G=Math.sqrt,at=Math.abs,z=Math.ceil,E="undefined",st="string",ft=isNaN,yt=parseFloat,ct=Number.MAX_VALUE,o=new Date(""),Ft="#969696",mt="#CB0000",pt="#646464",Mt="#DCDCDC",$="white",V="black",K="blue",J="green",S="grey",Y="red",l="lightgrey",I="left",B="right",X="center",q="top",Z="bottom",Q="middle",A="start",tt="px Arial",gt="-",bt="+",_t="=",O=.05,j=.03,P=1.06,wt=.02,Dt=4,u=Ht=5,w=3,Nt=10,$t=8,v=.8,F=.25,p=.9,g=.7,b=.1,St=1/45*rt,Pt=jt,e(Xt,f=D=Et),xt=Xt,kt="7ns",Ct="5ns",At="tukey",Tt="bowley",Ot="sigma3",c.zzt=jr,c.Hzt=Br,c.Uzt=zr,_=Qr,t.prototype.paint=function(t,r,n,e,i,o){var u,a,s,f,u=this;u.options=r,u.setting=r.settings,a=r.values,s=r.dateValues,f=r.zoomFactor,t.save(),t.rect(n,e,i,o),t.clip(),t.beginPath(),0===r.sparklineType&&u.c6(t,n,e,i,o,a,s,f),u.Vzt(t,n,e,i,o,a,s,f),u.Yzt(t,n,e,i,o,a,s,f),t.restore()},t.prototype.Zzt=function(t){return 0===this.options.sparklineType?3+this.Wzt(t)+1:3},t.prototype.Qzt=function(t,r){var n,e,i,o,u,u,a,s,f,y,n=this.Kzt;if(!n)if(n=this.Kzt=[],e=t.length,this.options.displayDateAxis){for(u=r.length,a=[],(a=0<(u=ot(e,u))?r.slice(0,u):a).sort(function(t,r){return t===r?0:(t=t===c.oCt?0:t)-(r=r===c.oCt?0:r)}),s=a.length,y=f=void 0,i=0;i<s;i++)if(typeof(f=a[i])!==E&&f!==it){for(y=d(r,f);M.Uf.OS(n,y);)y=d(r,f,y+1);isNaN(f)||(o=t[y])!==R&&o!==it&&isNaN(o)&&o!==c.oCt||n.push(y)}}else for(i=0;i<e;i++)typeof(o=t[i])!==E&&o!==it&&isNaN(o)&&o!==c.oCt||n.push(i);return n},t.prototype.Sl=function(t,r){var r=r[t];return typeof r===E||r===it?1===this.setting.options.displayEmptyCellsAs&&(r=0):r===c.oCt&&(r=0),r},t.prototype.c6=function(t,r,n,e,i,o,u,a){var s,f,y,c,m,M,h,d,l,v,F,l,p,g,b,_,w,D,s=this,f=s.Qzt(o,u),M=f.length-1;for(M<0&&(M=0),h=s.setting.options,d=s.linePos=[],g=h.displayEmptyCellsAs,y=0;y<M;y++)if(typeof(l=s.Sl(f[y],o))!==E&&l!==it){if(typeof(v=s.Sl(f[F=y+1],o))===E||v===it)if(1===g)v=0;else if(2===g)for(F=y+2;F<=M;F++)if(typeof(b=o[f[F]])!==E&&b!==it){v=b;break}typeof v!==E&&v!==it?(l=s.Jzt(f[y],{Width:e,Height:i},o,u,a),p=s.Jzt(f[F],{Width:e,Height:i},o,u,a),_=l.Width/2,c={X:l.X+_,Y:l.Y+_},m={X:p.X+_,Y:p.Y+_},d[y]={P1:c,P2:m}):y++}if(0<(w=d.length))for(t.strokeStyle=s.options.getColor(h.seriesColor),t.lineCap="round",t.lineWidth=s.Wzt(a),y=0;y<w;y++)(D=d[y])&&(t.beginPath(),c=D.P1,m=D.P2,t.moveTo(r+c.X,n+c.Y),t.lineTo(r+m.X,n+m.Y),t.stroke(),t.closePath())},t.prototype.Xzt=function(t,r,n){var e,i,o,u,a,n,s,f,y,c,r,e=this,i=e.options,o=e.setting.options,u=it,a=e.Sl(t,r),n=e.Qzt(r,n),s=n.length,f=i.getColor.bind(e);return typeof a!==E&&a!==it&&(e.Pzt!==ct&&e.Gzt!==-ct||e.qzt(r),a===e.Pzt&&o.showLow&&(u=f(o.lowMarkerColor)),typeof(u=a!==e.Gzt||!o.showHigh||typeof u!==E&&u!==it?u:f(o.highMarkerColor))!==E&&u!==it||(i.displayDateAxis?0===(y=d(n,t))&&o.showFirst&&(u=f(o.firstMarkerColor)):0===t&&o.showFirst&&(u=f(o.firstMarkerColor))),typeof u!==E&&u!==it||(i.displayDateAxis?(c=d(n,t))===s-1&&o.showLast&&(u=f(o.lastMarkerColor)):t===s-1&&o.showLast&&(u=f(o.lastMarkerColor))),typeof(u=a<0&&o.showNegative&&(typeof u===E||u===it)?f(o.negativeColor):u)!==E&&u!==it||(0===(r=i.sparklineType)?o.showMarkers&&(u=f(o.markersColor)):1!==r&&2!==r||(u=f(o.seriesColor)))),u===R||u===it?"Transparent":u},t.prototype.Vzt=function(t,r,n,e,i,o,u,a){for(var s,f,y,c,m,M,h,M,h,d,h,d,l,M,v,s=this,f={Width:e,Height:i},y=s.Qzt(o,u),c=y.length,m=s.options.sparklineType,v=0;v<c;v++)M=y[v],h=s.Xzt(M,o,u),M=s.Jzt(M,f,o,u,a),t.fillStyle!==h&&(t.fillStyle=h),0===m?(t.save(),h=r+M.X+M.Width/2,d=n+M.Y+M.Height/2,t.translate(h,d),t.rotate(45*rt/180),t.fillRect(0-M.Width/2,0-M.Height/2,M.Width,M.Height),t.restore()):(h=r+M.X+M.Width/4,h=T(h),d=n+M.Y,l=M.Width/2,M=M.Height,t.fillRect(h,d,l,M))},t.prototype.Yzt=function(t,r,n,e,i,o,u,a){var s,f,u,e,i,u,o,s,f,s=this,f=s.setting&&s.setting.options;f&&f.displayXAxis&&s.$zt(o,u)&&(u={Width:e,Height:i},e=s.Zzt(a),i=u.Width-s.Zzt(a),o=u=T(s.tVt(u,o,a))+.5,s=s.options.getColor(f.axisColor),(f=a)<1&&(f=1),t.strokeStyle!==s&&(t.strokeStyle=s),t.lineWidth!==f&&(t.lineWidth=f),t.beginPath(),t.moveTo(r+e,n+u),t.lineTo(r+i,n+o),t.stroke())},t.prototype.nVt=function(t){var r,t,r=this.eVt(t);return r===-ct||(t=this.iVt(t))===ct||r===t||r*t<=0},t.prototype.$zt=function(t,r){var n,e,i,o,u,a,n=this.nVt(t);if(2===this.options.sparklineType&&(i=(e=this.Qzt(t,r)).length,!n)&&0<i)for(a=0;a<i;a++)if(typeof(u=t[o=e[a]])!==E&&u!==it)return!0;return n},t.prototype.rVt=function(t,r){var n=this.Lzt;return isNaN(n&&n.valueOf())&&this.oVt(t,r),this.Lzt},t.prototype.aVt=function(t,r){var n=this.Fzt;return isNaN(n&&n.valueOf())&&this.oVt(t,r),this.Fzt},t.prototype.oVt=function(t,r){for(var n,e,i,o,u,a,s,a,f,n=this,e=new Date(0,0,0),i=ct,o=n.Qzt(t,r),u=o.length,f=0;f<u;f++)s=r[a=o[f]],isNaN(s)||(a=n.Sl(a,t))!==it&&typeof a===E||isNaN(a)||typeof s!==E&&s!==it&&(e<s&&(e=s),s<i)&&(i=s);n.Fzt=e,n.Lzt=i},t.prototype.uVt=function(t,r,n,e){for(var i,o,u,a,s,f,y,c,m,M,h,d,l,r,i=this,o=i.rVt(r,n),u=i.aVt(r,n),a=[],c=i.Qzt(r,n),m=c.length,s=0;s<m;s++)(f=n[y=c[s]])&&!isNaN(f)&&a.push(f);if(a.sort(function(t,r){return t-r}),1<(M=a.length)&&o!==u){for(h=ct,l=void(d=0),s=1;s<M;s++)(f=(l=a[s])-a[s-1])<h&&0<f&&(h=f),d+=f;return r=(r=(t.Width-i.Zzt(e)-i.Zzt(e))*h/d/2)<2?2:r}return(t.Width-i.Zzt(e)-i.Zzt(e))/2},t.prototype.sVt=function(t,r,n,e){var i,r,i=this;return i.options.displayDateAxis?i.uVt(t,r,n,e):(r=i.Qzt(r,n).length,(t.Width-i.Zzt(e)-i.Zzt(e))/r)},t.prototype.cVt=function(t,r,n,e,i){var o,u,a,s,f,y,c,s,y,m,o=this,a=o.Zzt(i);return o.options.displayDateAxis?(u=o.sVt(t,n,e,i),(s=o.aVt(n,e))===(f=o.rVt(n,e))?a+u/2:(y=e[r])?(c=t.Width-a-o.Zzt(i),c-=u,s=s.valueOf()-f.valueOf(),a+T((y.valueOf()-f.valueOf())/s*c)):0):(u=o.sVt(t,n,e,i),y=d(o.Qzt(n,e),r),T(m=a+u*y))},t.prototype.fVt=function(t,r){var n,e,t,n=this,e=t.Width-n.Zzt(r)-n.Zzt(r);return e=ut(e,0),t=t.Height-n.Zzt(r)-n.Zzt(r),{Width:e,Height:t=ut(t,0)}},t.prototype.qzt=function(t){for(var r,n,e,i,r=this,n=t.length,i=0;i<n;i++)typeof(e=t[i])!==E&&e!==it&&((e="number"!=typeof e?0:e)<r.Pzt&&(r.Pzt=e),e>r.Gzt)&&(r.Gzt=e)},t.prototype.eVt=function(t){var r,t,n,r=this;return r.Gzt!==-ct&&r.Gzt||r.qzt(t),0===(n=(t=r.setting.options).maxAxisType)?r.Gzt:1===n?t.groupMaxValue:2===n?t.manualMax:r.Gzt},t.prototype.iVt=function(t){var r,t,n,r=this;return r.Pzt!==ct&&r.Pzt||r.qzt(t),0===(n=(t=r.setting.options).minAxisType)?r.Pzt:1===n?t.groupMinValue:2===n?t.manualMin:void 0},t.prototype.lVt=function(t,r,n,e){var t=this.fVt(t,e),e=this.eVt(n),i=this.iVt(n),o=e-i,u,a;if(e===i){if(0===e)return 0;o=at(e)}return(u=(u=n[r])||0)*(a=t.Height/o)},t.prototype.hVt=function(t,r,n,e){var i,o,u,o,o,i=this,o=i.options.sparklineType;if(0===o)return i.lVt(t,r,n,e);if(1!==o)return 2===o?typeof(u=n[r])===E||u===it||0===u||isNaN(u)?0:(o=i.fVt(t,e),0<=u?o.Height/2:-o.Height/2):void 0;if(u=n[r],1===i.setting.options.displayEmptyCellsAs&&(typeof u===E||u===it))return 0;if((o=i.lVt(t,r,n,e))>-i.Bzt&&o<i.Bzt){if(0<u)return o+i.Bzt;if(u<0)return o-i.Bzt}return o},t.prototype.dVt=function(t,r,n){var e,i,o,r,u,r,e=this,i=e.fVt(t,n),o=e.eVt(r),r=e.iVt(r);if(o===-ct||r===ct)return t.Height/2;if(u=o-r,o===r){if(0===o)return t.Height/2;(u=o)<0&&(o=0)}return r=i.Height/u,e.Zzt(n)+o*r},t.prototype.tVt=function(t,r,n){return 2===this.options.sparklineType?t.Height/2:this.dVt(t,r,n)},t.prototype.vVt=function(t,r,n,e){var i,t,e,o,u,t,u,a,i=this,t=i.fVt(t,e),e=i.eVt(n),o=i.iVt(n),u=e-o;if(e===o){if(0===e)return 0;u=e}return t=t.Height/u,typeof(u=i.Sl(r,n))!==E&&u!==it||(u=0),e!==o&&0<e*o?(a=0)<=u?(u-o)*t:(u-e)*t:u*t},t.prototype.mVt=function(t,r,n,e){var i,o,u,a,s,i=this,o=i.options.sparklineType;return 0===o?i.vVt(t,r,n,e):1===o?(u=i.vVt(t,r,n,e),-(a=i.Bzt)<u&&u<a&&0!==(s=typeof(s=i.Sl(r,n))!==E&&s!==it?s:0)?0<s?u+a:u-a:u):2===o?i.hVt(t,r,n,e):void 0},t.prototype.gVt=function(t,r,n,e,i){var o,u,e,a,s,f,y,f,y,s,t,n,o=this,u=o.sVt(r,n,e,i),e=o.cVt(r,t,n,e,i);return(u=T(u=u<0?0:u))%2==1&&(u+=1),a=o.hVt(r,t,n,i),s=o.tVt(r,n,i),f=o.eVt(n),y=o.iVt(n),f=f<(f=0)&&y<0?ut(o.Zzt(i),s):0<=a?s-a:s,y=o.mVt(r,t,n,i),s=new _(e,f,u,at(y)),0!==a&&(t=o.Zzt(i),s.Y<t&&s.Bottom<t+1?s.Height=T(s.Height+1):(n=r.Height-o.Zzt(i),s.Bottom>n&&s.Y>n-1&&(s.Y=n-y,s.Height=y))),s},t.prototype.Wzt=function(t){var t=this.setting.options.lineWeight*t;return t=t<1?1:t},t.prototype.Jzt=function(t,r,n,e,i){var o,u,e,i,t,a,n,o=this,u=o.Wzt(i);return++u<2&&(u=2),e=o.gVt(t,r,n,e,i),0===o.options.sparklineType&&(e.X=e.X+(e.Width-u)/2,typeof(i=o.Sl(t,n))!==E&&i!==it?(0<=i?e.Y-=u/2:e.Y=e.Bottom-u/2,e.Width=u,e.Height=u):(e.Width=0,e.Height=0)),o.setting.options.rightToLeft&&(t=e.X,n=(a=r.Width-t)-e.Width,e=new _(n,e.Y,e.Width,e.Height)),e},c.SparklineRender=t,c.SparklineExRenders={PIESPARKLINE:Ut,AREASPARKLINE:Zt,SCATTERSPARKLINE:tr,BULLETSPARKLINE:or,SPREADSPARKLINE:ur,STACKEDSPARKLINE:yr,HBARSPARKLINE:dr,VBARSPARKLINE:lr,VARISPARKLINE:vr,BOXPLOTSPARKLINE:Fr,CASCADESPARKLINE:_r,PARETOSPARKLINE:wr,MONTHSPARKLINE:xr,YEARSPARKLINE:Cr,GAUGEKPISPARKLINE:Kr,HISTOGRAMSPARKLINE:Xr,IMAGESPARKLINE:Zr}}},e={},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r=t={},Object.defineProperty(r,"__esModule",{value:!0}),r.Slicers=r.Sparklines=r.Formatter=r.Commands=r.Common=void 0,i=o("./src/common/common.entry.ts"),r.Common=i,i=o("./src/plugins/commands/commands.entry.ts"),r.Commands=i,i=o("./src/plugins/formatter/formatter.entry.ts"),r.Formatter=i,i=o("./src/plugins/sparkline/sparkline.entry.ts"),r.Sparklines=i,i=o("./src/plugins/slicer/slicer.entry.ts"),r.Slicers=i,(u={}).Spread=t}(),t.exports=u.Spread},"./node_modules_local/@grapecity/js-sheets-common/index.js":(t,r,n)=>{t.exports=n("./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js")}},e={},t=i("./node_modules_local/@grapecity/js-sheets-common/index.js"),(GC=void 0===GC?{}:GC).Spread=t})();